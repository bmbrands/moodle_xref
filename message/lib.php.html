<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : Detail view of lib.php</title>
    <link rel="stylesheet" href="../sample.css" type="text/css">
    <link rel="stylesheet" href="../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Aug 11 10:00:09 2016 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../';
subdir='message';
filename='lib.php.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="details-heading"><a href="./index.html">/message/</a> -> <a href="lib.php.source.html">lib.php</a> (summary)</h2>
<div class="details-summary">
<p class="viewlinks">[<a href="lib.php.source.html">Source view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="../_stats.html">Project Stats</a>]</p>
<p><b>Library functions for messaging</b></p>
<table>
<tr><td align="right">Copyright: </td><td>2008 Luis Rodrigues</td></tr>
<tr><td align="right">License: </td><td><a href="http://www.gnu.org/copyleft/gpl.html" target="_blank">http://www.gnu.org/copyleft/gpl.html</a> GNU GPL v3 or later</td></tr>
<tr><td align="right">File Size: </td><td>2976 lines (116 kb)</td></tr>
<tr><td align="right">Included or required: </td><td><a href="lib.php.xref.html">3 times</a></td></tr>
<tr><td align="right" valign="top">Referenced: </td><td>12 times</td></tr>
<tr><td align="right" valign="top">Includes or requires: </td><td>2 files<br>&nbsp;<a href="../message/search.html.html">message/search.html</a>
<br>&nbsp;<a href="../message/search_advanced.html.html">message/search_advanced.html</a>
</td></tr>
</table>
<h3>Defines 57 functions</h3>
<div class="inset">
&nbsp;&nbsp;<a href="#message_print_contact_selector">message_print_contact_selector</a>()<br>
&nbsp;&nbsp;<a href="#message_print_participants">message_print_participants</a>()<br>
&nbsp;&nbsp;<a href="#message_get_blocked_users">message_get_blocked_users</a>()<br>
&nbsp;&nbsp;<a href="#message_print_blocked_users">message_print_blocked_users</a>()<br>
&nbsp;&nbsp;<a href="#message_get_contacts">message_get_contacts</a>()<br>
&nbsp;&nbsp;<a href="#message_print_contacts">message_print_contacts</a>()<br>
&nbsp;&nbsp;<a href="#message_print_usergroup_selector">message_print_usergroup_selector</a>()<br>
&nbsp;&nbsp;<a href="#message_get_course_contexts">message_get_course_contexts</a>()<br>
&nbsp;&nbsp;<a href="#message_remove_url_params">message_remove_url_params</a>()<br>
&nbsp;&nbsp;<a href="#message_count_messages">message_count_messages</a>()<br>
&nbsp;&nbsp;<a href="#message_count_unread_messages">message_count_unread_messages</a>()<br>
&nbsp;&nbsp;<a href="#message_count_blocked_users">message_count_blocked_users</a>()<br>
&nbsp;&nbsp;<a href="#message_print_search">message_print_search</a>()<br>
&nbsp;&nbsp;<a href="#message_get_recent_conversations">message_get_recent_conversations</a>()<br>
&nbsp;&nbsp;<a href="#message_get_recent_notifications">message_get_recent_notifications</a>()<br>
&nbsp;&nbsp;<a href="#message_print_recent_conversations">message_print_recent_conversations</a>()<br>
&nbsp;&nbsp;<a href="#message_print_recent_notifications">message_print_recent_notifications</a>()<br>
&nbsp;&nbsp;<a href="#message_print_recent_messages_table">message_print_recent_messages_table</a>()<br>
&nbsp;&nbsp;<a href="#message_format_message_text">message_format_message_text</a>()<br>
&nbsp;&nbsp;<a href="#message_add_contact">message_add_contact</a>()<br>
&nbsp;&nbsp;<a href="#message_remove_contact">message_remove_contact</a>()<br>
&nbsp;&nbsp;<a href="#message_unblock_contact">message_unblock_contact</a>()<br>
&nbsp;&nbsp;<a href="#message_block_contact">message_block_contact</a>()<br>
&nbsp;&nbsp;<a href="#message_can_delete_message">message_can_delete_message</a>()<br>
&nbsp;&nbsp;<a href="#message_delete_message">message_delete_message</a>()<br>
&nbsp;&nbsp;<a href="#message_get_contact">message_get_contact</a>()<br>
&nbsp;&nbsp;<a href="#message_print_search_results">message_print_search_results</a>()<br>
&nbsp;&nbsp;<a href="#message_print_user">message_print_user</a>()<br>
&nbsp;&nbsp;<a href="#message_contact_link">message_contact_link</a>()<br>
&nbsp;&nbsp;<a href="#message_history_link">message_history_link</a>()<br>
&nbsp;&nbsp;<a href="#message_search_users">message_search_users</a>()<br>
&nbsp;&nbsp;<a href="#message_search">message_search</a>()<br>
&nbsp;&nbsp;<a href="#message_shorten_message">message_shorten_message</a>()<br>
&nbsp;&nbsp;<a href="#message_get_fragment">message_get_fragment</a>()<br>
&nbsp;&nbsp;<a href="#message_get_history">message_get_history</a>()<br>
&nbsp;&nbsp;<a href="#message_print_message_history">message_print_message_history</a>()<br>
&nbsp;&nbsp;<a href="#message_format_message">message_format_message</a>()<br>
&nbsp;&nbsp;<a href="#message_format_contexturl">message_format_contexturl</a>()<br>
&nbsp;&nbsp;<a href="#message_post_message">message_post_message</a>()<br>
&nbsp;&nbsp;<a href="#message_print_contactlist_user">message_print_contactlist_user</a>()<br>
&nbsp;&nbsp;<a href="#message_get_contact_add_remove_link">message_get_contact_add_remove_link</a>()<br>
&nbsp;&nbsp;<a href="#message_get_contact_block_link">message_get_contact_block_link</a>()<br>
&nbsp;&nbsp;<a href="#message_move_userfrom_unread2read">message_move_userfrom_unread2read</a>()<br>
&nbsp;&nbsp;<a href="#message_mark_messages_read">message_mark_messages_read</a>()<br>
&nbsp;&nbsp;<a href="#message_mark_message_read">message_mark_message_read</a>()<br>
&nbsp;&nbsp;<a href="#get_message_processors">get_message_processors</a>()<br>
&nbsp;&nbsp;<a href="#get_message_providers">get_message_providers</a>()<br>
&nbsp;&nbsp;<a href="#get_message_processor">get_message_processor</a>()<br>
&nbsp;&nbsp;<a href="#get_message_output_default_preferences">get_message_output_default_preferences</a>()<br>
&nbsp;&nbsp;<a href="#translate_message_default_setting">translate_message_default_setting</a>()<br>
&nbsp;&nbsp;<a href="#message_page_type_list">message_page_type_list</a>()<br>
&nbsp;&nbsp;<a href="#message_get_messages">message_get_messages</a>()<br>
&nbsp;&nbsp;<a href="#message_messenger_requirejs">message_messenger_requirejs</a>()<br>
&nbsp;&nbsp;<a href="#message_messenger_sendmessage_link_params">message_messenger_sendmessage_link_params</a>()<br>
&nbsp;&nbsp;<a href="#message_can_post_message">message_can_post_message</a>()<br>
&nbsp;&nbsp;<a href="#message_is_user_non_contact_blocked">message_is_user_non_contact_blocked</a>()<br>
&nbsp;&nbsp;<a href="#message_is_user_blocked">message_is_user_blocked</a>()<br>
</div>
</div>
<br><div class="details-funclist">
<div class="details-classtitle"><a name="functions"><b>Functions</b></a></div>
<div class="details-classinfo">
Functions that are not part of a class:<br><br>
<div class="inset"><table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_print_contact_selector" onClick="logFunction('message_print_contact_selector', 'lib.php.source.html#l74')" href="lib.php.source.html#l74">message_print_contact_selector</a>(<a href="../_variables/countunreadtotal.html">$countunreadtotal</a>, <a href="../_variables/viewing.html">$viewing</a>, <a href="../_variables/user1.html">$user1</a>, <a href="../_variables/user2.html">$user2</a>, <a href="../_variables/blockedusers.html">$blockedusers</a>, <a href="../_variables/onlinecontacts.html">$onlinecontacts</a>, <a href="../_variables/offlinecontacts.html">$offlinecontacts</a>, <a href="../_variables/strangers.html">$strangers</a>, <a href="../_variables/showactionlinks.html">$showactionlinks</a>, <a href="../_variables/page.html">$page</a>=0)&nbsp;&nbsp;
<a href="../_functions/message_print_contact_selector.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Print the selector that allows the user to view their contacts, course participants, their recent<BR>
conversations etc<BR>
</b><BR><b>param:</b> int $countunreadtotal how many unread messages does the user have?<br>
<b>param:</b> int $viewing What is the user viewing? ie MESSAGE_VIEW_UNREAD_MESSAGES, MESSAGE_VIEW_SEARCH etc<br>
<b>param:</b> object $user1 the user whose messages are being viewed<br>
<b>param:</b> object $user2 the user $user1 is talking to<br>
<b>param:</b> array $blockedusers an array of users blocked by $user1<br>
<b>param:</b> array $onlinecontacts an array of $user1's online contacts<br>
<b>param:</b> array $offlinecontacts an array of $user1's offline contacts<br>
<b>param:</b> array $strangers an array of users who have messaged $user1 who aren't contacts<br>
<b>param:</b> bool $showactionlinks show action links (add/remove contact etc)<br>
<b>param:</b> int $page if there are so many users listed that they have to be split into pages what page are we viewing<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_print_participants" onClick="logFunction('message_print_participants', 'lib.php.source.html#l148')" href="lib.php.source.html#l148">message_print_participants</a>(<a href="../_variables/context.html">$context</a>, <a href="../_variables/courseid.html">$courseid</a>, <a href="../_variables/contactselecturl.html">$contactselecturl</a>=null, <a href="../_variables/showactionlinks.html">$showactionlinks</a>=true, <a href="../_variables/titletodisplay.html">$titletodisplay</a>=null, <a href="../_variables/page.html">$page</a>=0, <a href="../_variables/user2.html">$user2</a>=null)&nbsp;&nbsp;
<a href="../_functions/message_print_participants.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Print course participants. Called by message_print_contact_selector()<BR>
</b><BR><b>param:</b> object $context the course context<br>
<b>param:</b> int $courseid the course ID<br>
<b>param:</b> string $contactselecturl the url to send the user to when a contact's name is clicked<br>
<b>param:</b> bool $showactionlinks show action links (add/remove contact etc) next to the users<br>
<b>param:</b> string $titletodisplay Optionally specify a title to display above the participants<br>
<b>param:</b> int $page if there are so many users listed that they have to be split into pages what page are we viewing<br>
<b>param:</b> object $user2 the user $user1 is talking to. They will be highlighted if they appear in the list of participants<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_get_blocked_users" onClick="logFunction('message_get_blocked_users', 'lib.php.source.html#l220')" href="lib.php.source.html#l220">message_get_blocked_users</a>(<a href="../_variables/user1.html">$user1</a>=null, <a href="../_variables/user2.html">$user2</a>=null)&nbsp;&nbsp;
<a href="../_functions/message_get_blocked_users.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Retrieve users blocked by $user1<BR>
</b><BR><b>param:</b> object $user1 the user whose messages are being viewed<br>
<b>param:</b> object $user2 the user $user1 is talking to. If they are being blocked<br>
<b>return:</b> array the users blocked by $user1<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_print_blocked_users" onClick="logFunction('message_print_blocked_users', 'lib.php.source.html#l263')" href="lib.php.source.html#l263">message_print_blocked_users</a>(<a href="../_variables/blockedusers.html">$blockedusers</a>, <a href="../_variables/contactselecturl.html">$contactselecturl</a>=null, <a href="../_variables/showactionlinks.html">$showactionlinks</a>=true, <a href="../_variables/titletodisplay.html">$titletodisplay</a>=null, <a href="../_variables/user2.html">$user2</a>=null)&nbsp;&nbsp;
<a href="../_functions/message_print_blocked_users.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Print users blocked by $user1. Called by message_print_contact_selector()<BR>
</b><BR><b>param:</b> array $blockedusers the users blocked by $user1<br>
<b>param:</b> string $contactselecturl the url to send the user to when a contact's name is clicked<br>
<b>param:</b> bool $showactionlinks show action links (add/remove contact etc) next to the users<br>
<b>param:</b> string $titletodisplay Optionally specify a title to display above the participants<br>
<b>param:</b> object $user2 the user $user1 is talking to. They will be highlighted if they appear in the list of blocked users<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_get_contacts" onClick="logFunction('message_get_contacts', 'lib.php.source.html#l301')" href="lib.php.source.html#l301">message_get_contacts</a>(<a href="../_variables/user1.html">$user1</a>=null, <a href="../_variables/user2.html">$user2</a>=null)&nbsp;&nbsp;
<a href="../_functions/message_get_contacts.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Retrieve $user1's contacts (online, offline and strangers)<BR>
</b><BR><b>param:</b> object $user1 the user whose messages are being viewed<br>
<b>param:</b> object $user2 the user $user1 is talking to. If they are a contact<br>
<b>return:</b> array containing 3 arrays. array($onlinecontacts, $offlinecontacts, $strangers)<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_print_contacts" onClick="logFunction('message_print_contacts', 'lib.php.source.html#l399')" href="lib.php.source.html#l399">message_print_contacts</a>(<a href="../_variables/onlinecontacts.html">$onlinecontacts</a>, <a href="../_variables/offlinecontacts.html">$offlinecontacts</a>, <a href="../_variables/strangers.html">$strangers</a>, <a href="../_variables/contactselecturl.html">$contactselecturl</a>=null, <a href="../_variables/minmessages.html">$minmessages</a>=0, <a href="../_variables/showactionlinks.html">$showactionlinks</a>=true, <a href="../_variables/titletodisplay.html">$titletodisplay</a>=null, <a href="../_variables/user2.html">$user2</a>=null)&nbsp;&nbsp;
<a href="../_functions/message_print_contacts.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Print $user1's contacts. Called by message_print_contact_selector()<BR>
</b><BR><b>param:</b> array $onlinecontacts $user1's contacts which are online<br>
<b>param:</b> array $offlinecontacts $user1's contacts which are offline<br>
<b>param:</b> array $strangers users which are not contacts but who have messaged $user1<br>
<b>param:</b> string $contactselecturl the url to send the user to when a contact's name is clicked<br>
<b>param:</b> int $minmessages The minimum number of unread messages required from a user for them to be displayed<br>
<b>param:</b> bool $showactionlinks show action links (add/remove contact etc) next to the users<br>
<b>param:</b> string $titletodisplay Optionally specify a title to display above the participants<br>
<b>param:</b> object $user2 the user $user1 is talking to. They will be highlighted if they appear in the list of contacts<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_print_usergroup_selector" onClick="logFunction('message_print_usergroup_selector', 'lib.php.source.html#l503')" href="lib.php.source.html#l503">message_print_usergroup_selector</a>(<a href="../_variables/viewing.html">$viewing</a>, <a href="../_variables/courses.html">$courses</a>, <a href="../_variables/coursecontexts.html">$coursecontexts</a>, <a href="../_variables/countunreadtotal.html">$countunreadtotal</a>, <a href="../_variables/countblocked.html">$countblocked</a>, <a href="../_variables/strunreadmessages.html">$strunreadmessages</a>, <a href="../_variables/user1.html">$user1</a> = null)&nbsp;&nbsp;
<a href="../_functions/message_print_usergroup_selector.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Print a select box allowing the user to choose to view new messages, course participants etc.<BR>
</b><BR>Called by message_print_contact_selector()<BR>
<b>param:</b> int $viewing What page is the user viewing ie MESSAGE_VIEW_UNREAD_MESSAGES, MESSAGE_VIEW_RECENT_CONVERSATIONS etc<br>
<b>param:</b> array $courses array of course objects. The courses the user is enrolled in.<br>
<b>param:</b> array $coursecontexts array of course contexts. Keyed on course id.<br>
<b>param:</b> int $countunreadtotal how many unread messages does the user have?<br>
<b>param:</b> int $countblocked how many users has the current user blocked?<br>
<b>param:</b> stdClass $user1 The user whose messages we are viewing.<br>
<b>param:</b> string $strunreadmessages a preconstructed message about the number of unread messages the user has<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_get_course_contexts" onClick="logFunction('message_get_course_contexts', 'lib.php.source.html#l562')" href="lib.php.source.html#l562">message_get_course_contexts</a>(<a href="../_variables/courses.html">$courses</a>)&nbsp;&nbsp;
<a href="../_functions/message_get_course_contexts.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Load the course contexts for all of the users courses<BR>
</b><BR><b>param:</b> array $courses array of course objects. The courses the user is enrolled in.<br>
<b>return:</b> array of course contexts<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_remove_url_params" onClick="logFunction('message_remove_url_params', 'lib.php.source.html#l578')" href="lib.php.source.html#l578">message_remove_url_params</a>(<a href="../_variables/moodleurl.html">$moodleurl</a>)&nbsp;&nbsp;
<a href="../_functions/message_remove_url_params.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>strip off action parameters like 'removecontact'<BR>
</b><BR><b>param:</b> moodle_url/string $moodleurl a URL. Typically the current page URL.<br>
<b>return:</b> string the URL minus parameters that perform actions (like adding/removing/blocking a contact).<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_count_messages" onClick="logFunction('message_count_messages', 'lib.php.source.html#l590')" href="lib.php.source.html#l590">message_count_messages</a>(<a href="../_variables/messagearray.html">$messagearray</a>, <a href="../_variables/field.html">$field</a>='', <a href="../_variables/value.html">$value</a>='')&nbsp;&nbsp;
<a href="../_functions/message_count_messages.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Count the number of messages with a field having a specified value.<BR>
if $field is empty then return count of the whole array<BR>
if $field is non-existent then return 0<BR>
</b><BR><b>param:</b> array $messagearray array of message objects<br>
<b>param:</b> string $field the field to inspect on the message objects<br>
<b>param:</b> string $value the value to test the field against<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_count_unread_messages" onClick="logFunction('message_count_unread_messages', 'lib.php.source.html#l610')" href="lib.php.source.html#l610">message_count_unread_messages</a>(<a href="../_variables/user1.html">$user1</a>=null, <a href="../_variables/user2.html">$user2</a>=null)&nbsp;&nbsp;
<a href="../_functions/message_count_unread_messages.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Returns the count of unread messages for user. Either from a specific user or from all users.<BR>
</b><BR><b>param:</b> object $user1 the first user. Defaults to $USER<br>
<b>param:</b> object $user2 the second user. If null this function will count all of user 1's unread messages.<br>
<b>return:</b> int the count of $user1's unread messages<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_count_blocked_users" onClick="logFunction('message_count_blocked_users', 'lib.php.source.html#l633')" href="lib.php.source.html#l633">message_count_blocked_users</a>(<a href="../_variables/user1.html">$user1</a>=null)&nbsp;&nbsp;
<a href="../_functions/message_count_blocked_users.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Count the number of users blocked by $user1<BR>
</b><BR><b>param:</b> object $user1 user object<br>
<b>return:</b> int the number of blocked users<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_print_search" onClick="logFunction('message_print_search', 'lib.php.source.html#l654')" href="lib.php.source.html#l654">message_print_search</a>(<a href="../_variables/advancedsearch.html">$advancedsearch</a> = false, <a href="../_variables/user1.html">$user1</a>=null)&nbsp;&nbsp;
<a href="../_functions/message_print_search.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Print the search form and search results if a search has been performed<BR>
</b><BR><b>param:</b> boolean $advancedsearch show basic or advanced search form<br>
<b>param:</b> object $user1 the current user<br>
<b>return:</b> boolean true if a search was performed<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_get_recent_conversations" onClick="logFunction('message_get_recent_conversations', 'lib.php.source.html#l712')" href="lib.php.source.html#l712">message_get_recent_conversations</a>(<a href="../_variables/user.html">$user</a>, <a href="../_variables/limitfrom.html">$limitfrom</a>=0, <a href="../_variables/limitto.html">$limitto</a>=100)&nbsp;&nbsp;
<a href="../_functions/message_get_recent_conversations.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Get the users recent conversations meaning all the people they've recently<BR>
sent or received a message from plus the most recent message sent to or received from each other user<BR>
</b><BR><b>param:</b> object $user the current user<br>
<b>param:</b> int $limitfrom can be used for paging<br>
<b>param:</b> int $limitto can be used for paging<br>
<b>return:</b> array<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_get_recent_notifications" onClick="logFunction('message_get_recent_notifications', 'lib.php.source.html#l818')" href="lib.php.source.html#l818">message_get_recent_notifications</a>(<a href="../_variables/user.html">$user</a>, <a href="../_variables/limitfrom.html">$limitfrom</a>=0, <a href="../_variables/limitto.html">$limitto</a>=100)&nbsp;&nbsp;
<a href="../_functions/message_get_recent_notifications.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Get the users recent event notifications<BR>
</b><BR><b>param:</b> object $user the current user<br>
<b>param:</b> int $limitfrom can be used for paging<br>
<b>param:</b> int $limitto can be used for paging<br>
<b>return:</b> array<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_print_recent_conversations" onClick="logFunction('message_print_recent_conversations', 'lib.php.source.html#l841')" href="lib.php.source.html#l841">message_print_recent_conversations</a>(<a href="../_variables/user1.html">$user1</a> = null, <a href="../_variables/showicontext.html">$showicontext</a> = false, <a href="../_variables/showactionlinks.html">$showactionlinks</a> = true)&nbsp;&nbsp;
<a href="../_functions/message_print_recent_conversations.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Print the user's recent conversations<BR>
</b><BR><b>param:</b> stdClass $user the current user<br>
<b>param:</b> bool $showicontext flag indicating whether or not to show text next to the action icons<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_print_recent_notifications" onClick="logFunction('message_print_recent_notifications', 'lib.php.source.html#l870')" href="lib.php.source.html#l870">message_print_recent_notifications</a>(<a href="../_variables/user.html">$user</a>=null)&nbsp;&nbsp;
<a href="../_functions/message_print_recent_notifications.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Print the user's recent notifications<BR>
</b><BR><b>param:</b> stdClass $user the current user<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_print_recent_messages_table" onClick="logFunction('message_print_recent_messages_table', 'lib.php.source.html#l893')" href="lib.php.source.html#l893">message_print_recent_messages_table</a>(<a href="../_variables/messages.html">$messages</a>, <a href="../_variables/user.html">$user</a> = null, <a href="../_variables/showotheruser.html">$showotheruser</a> = true, <a href="../_variables/showicontext.html">$showicontext</a> = false, <a href="../_variables/forcetexttohtml.html">$forcetexttohtml</a> = false, <a href="../_variables/showactionlinks.html">$showactionlinks</a> = true)&nbsp;&nbsp;
<a href="../_functions/message_print_recent_messages_table.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Print a list of recent messages<BR>
</b><BR><b>param:</b> array $messages the messages to display<br>
<b>param:</b> stdClass $user the current user<br>
<b>param:</b> bool $showotheruser display information on the other user?<br>
<b>param:</b> bool $showicontext show text next to the action icons?<br>
<b>param:</b> bool $forcetexttohtml Force text to go through @see text_to_html() via @see format_text()<br>
<b>param:</b> bool $showactionlinks<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_format_message_text" onClick="logFunction('message_format_message_text', 'lib.php.source.html#l972')" href="lib.php.source.html#l972">message_format_message_text</a>(<a href="../_variables/message.html">$message</a>, <a href="../_variables/forcetexttohtml.html">$forcetexttohtml</a> = false)&nbsp;&nbsp;
<a href="../_functions/message_format_message_text.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Try to guess how to convert the message to html.<BR>
</b><BR><b>param:</b> stdClass $message<br>
<b>param:</b> bool $forcetexttohtml<br>
<b>return:</b> string html fragment<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_add_contact" onClick="logFunction('message_add_contact', 'lib.php.source.html#l1024')" href="lib.php.source.html#l1024">message_add_contact</a>(<a href="../_variables/contactid.html">$contactid</a>, <a href="../_variables/blocked.html">$blocked</a>=0)&nbsp;&nbsp;
<a href="../_functions/message_add_contact.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Add the selected user as a contact for the current user<BR>
</b><BR><b>param:</b> int $contactid the ID of the user to add as a contact<br>
<b>param:</b> int $blocked 1 if you wish to block the contact<br>
<b>return:</b> bool/int false if the $contactid isnt a valid user id. True if no changes made.<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_remove_contact" onClick="logFunction('message_remove_contact', 'lib.php.source.html#l1101')" href="lib.php.source.html#l1101">message_remove_contact</a>(<a href="../_variables/contactid.html">$contactid</a>)&nbsp;&nbsp;
<a href="../_functions/message_remove_contact.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>remove a contact<BR>
</b><BR><b>param:</b> int $contactid the user ID of the contact to remove<br>
<b>return:</b> bool returns the result of delete_records()<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_unblock_contact" onClick="logFunction('message_unblock_contact', 'lib.php.source.html#l1129')" href="lib.php.source.html#l1129">message_unblock_contact</a>(<a href="../_variables/contactid.html">$contactid</a>)&nbsp;&nbsp;
<a href="../_functions/message_unblock_contact.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Unblock a contact. Note that this reverts the previously blocked user back to a non-contact.<BR>
</b><BR><b>param:</b> int $contactid the user ID of the contact to unblock<br>
<b>return:</b> bool returns the result of delete_records()<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_block_contact" onClick="logFunction('message_block_contact', 'lib.php.source.html#l1139')" href="lib.php.source.html#l1139">message_block_contact</a>(<a href="../_variables/contactid.html">$contactid</a>)&nbsp;&nbsp;
<a href="../_functions/message_block_contact.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Block a user.<BR>
</b><BR><b>param:</b> int $contactid the user ID of the user to block<br>
<b>return:</b> bool<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_can_delete_message" onClick="logFunction('message_can_delete_message', 'lib.php.source.html#l1149')" href="lib.php.source.html#l1149">message_can_delete_message</a>(<a href="../_variables/message.html">$message</a>, <a href="../_variables/userid.html">$userid</a>)&nbsp;&nbsp;
<a href="../_functions/message_can_delete_message.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Checks if a user can delete a message.<BR>
</b><BR><b>param:</b> stdClass $message the message to delete<br>
<b>param:</b> string $userid the user id of who we want to delete the message for (this may be done by the admin<br>
<b>return:</b> bool Returns true if a user can delete the message, false otherwise.<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_delete_message" onClick="logFunction('message_delete_message', 'lib.php.source.html#l1180')" href="lib.php.source.html#l1180">message_delete_message</a>(<a href="../_variables/message.html">$message</a>, <a href="../_variables/userid.html">$userid</a>)&nbsp;&nbsp;
<a href="../_functions/message_delete_message.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Deletes a message.<BR>
</b><BR>This function does not verify any permissions.<BR>
<BR>
<b>param:</b> stdClass $message the message to delete<br>
<b>param:</b> string $userid the user id of who we want to delete the message for (this may be done by the admin<br>
<b>return:</b> bool<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_get_contact" onClick="logFunction('message_get_contact', 'lib.php.source.html#l1229')" href="lib.php.source.html#l1229">message_get_contact</a>(<a href="../_variables/contactid.html">$contactid</a>)&nbsp;&nbsp;
<a href="../_functions/message_get_contact.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Load a user's contact record<BR>
</b><BR><b>param:</b> int $contactid the user ID of the user whose contact record you want<br>
<b>return:</b> array message contacts<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_print_search_results" onClick="logFunction('message_print_search_results', 'lib.php.source.html#l1240')" href="lib.php.source.html#l1240">message_print_search_results</a>(<a href="../_variables/frm.html">$frm</a>, <a href="../_variables/showicontext.html">$showicontext</a>=false, <a href="../_variables/currentuser.html">$currentuser</a>=null)&nbsp;&nbsp;
<a href="../_functions/message_print_search_results.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Print the results of a message search<BR>
</b><BR><b>param:</b> mixed $frm submitted form data<br>
<b>param:</b> bool $showicontext show text next to action icons?<br>
<b>param:</b> object $currentuser the current user<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_print_user" onClick="logFunction('message_print_user', 'lib.php.source.html#l1522')" href="lib.php.source.html#l1522">message_print_user</a>(<a href="../_variables/user.html">$user</a>=false, <a href="../_variables/iscontact.html">$iscontact</a>=false, <a href="../_variables/isblocked.html">$isblocked</a>=false, <a href="../_variables/includeicontext.html">$includeicontext</a>=false)&nbsp;&nbsp;
<a href="../_functions/message_print_user.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Print information on a user. Used when printing search results.<BR>
</b><BR><b>param:</b> object/bool $user the user to display or false if you just want $USER<br>
<b>param:</b> bool $iscontact is the user being displayed a contact?<br>
<b>param:</b> bool $isblocked is the user being displayed blocked?<br>
<b>param:</b> bool $includeicontext include text next to the action icons?<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_contact_link" onClick="logFunction('message_contact_link', 'lib.php.source.html#l1566')" href="lib.php.source.html#l1566">message_contact_link</a>(<a href="../_variables/userid.html">$userid</a>, <a href="../_variables/linktype.html">$linktype</a>='add', <a href="../_variables/return.html">$return</a>=false, <a href="../_variables/script.html">$script</a>=null, <a href="../_variables/text.html">$text</a>=false, <a href="../_variables/icon.html">$icon</a>=true)&nbsp;&nbsp;
<a href="../_functions/message_contact_link.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Print a message contact link<BR>
</b><BR><b>param:</b> int $userid the ID of the user to apply to action to<br>
<b>param:</b> string $linktype can be add, remove, block or unblock<br>
<b>param:</b> bool $return if true return the link as a string. If false echo the link.<br>
<b>param:</b> string $script the URL to send the user to when the link is clicked. If null, the current page.<br>
<b>param:</b> bool $text include text next to the icons?<br>
<b>param:</b> bool $icon include a graphical icon?<br>
<b>return:</b> string&nbsp;&nbsp;if $return is true otherwise bool<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_history_link" onClick="logFunction('message_history_link', 'lib.php.source.html#l1641')" href="lib.php.source.html#l1641">message_history_link</a>(<a href="../_variables/userid1.html">$userid1</a>, <a href="../_variables/userid2.html">$userid2</a>, <a href="../_variables/return.html">$return</a>=false, <a href="../_variables/keywords.html">$keywords</a>='', <a href="../_variables/position.html">$position</a>='', <a href="../_variables/linktext.html">$linktext</a>='')&nbsp;&nbsp;
<a href="../_functions/message_history_link.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>echo or return a link to take the user to the full message history between themselves and another user<BR>
</b><BR><b>param:</b> int $userid1 the ID of the user displayed on the left (usually the current user)<br>
<b>param:</b> int $userid2 the ID of the other user<br>
<b>param:</b> bool $return true to return the link as a string. False to echo the link.<br>
<b>param:</b> string $keywords any keywords to highlight in the message history<br>
<b>param:</b> string $position anchor name to jump to within the message history<br>
<b>param:</b> string $linktext optionally specify the link text<br>
<b>return:</b> string|bool. Returns a string if $return is true. Otherwise returns a boolean.<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_search_users" onClick="logFunction('message_search_users', 'lib.php.source.html#l1705')" href="lib.php.source.html#l1705">message_search_users</a>(<a href="../_variables/courseids.html">$courseids</a>, <a href="../_variables/searchtext.html">$searchtext</a>, <a href="../_variables/sort.html">$sort</a>='', <a href="../_variables/exceptions.html">$exceptions</a>='')&nbsp;&nbsp;
<a href="../_functions/message_search_users.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Search through course users.<BR>
</b><BR>If $courseids contains the site course then this function searches<BR>
through all undeleted and confirmed users.<BR>
<BR>
<b>param:</b> int|array $courseids Course ID or array of course IDs.<br>
<b>param:</b> string $searchtext the text to search for.<br>
<b>param:</b> string $sort the column name to order by.<br>
<b>param:</b> string|array $exceptions comma separated list or array of user IDs to exclude.<br>
<b>return:</b> array An array of {@link $USER} records.<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_search" onClick="logFunction('message_search', 'lib.php.source.html#l1798')" href="lib.php.source.html#l1798">message_search</a>(<a href="../_variables/searchterms.html">$searchterms</a>, <a href="../_variables/fromme.html">$fromme</a>=true, <a href="../_variables/tome.html">$tome</a>=true, <a href="../_variables/courseid.html">$courseid</a>='none', <a href="../_variables/userid.html">$userid</a>=0)&nbsp;&nbsp;
<a href="../_functions/message_search.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Search a user's messages<BR>
</b><BR>Returns a list of posts found using an array of search terms<BR>
eg&nbsp;&nbsp;&nbsp;word&nbsp;&nbsp;+word -word<BR>
<BR>
<b>param:</b> array $searchterms an array of search terms (strings)<br>
<b>param:</b> bool $fromme include messages from the user?<br>
<b>param:</b> bool $tome include messages to the user?<br>
<b>param:</b> mixed $courseid SITEID for admins searching all messages. Other behaviour not yet implemented<br>
<b>param:</b> int $userid the user ID of the current user<br>
<b>return:</b> mixed An array of messages or false if no matching messages were found<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_shorten_message" onClick="logFunction('message_shorten_message', 'lib.php.source.html#l1954')" href="lib.php.source.html#l1954">message_shorten_message</a>(<a href="../_variables/message.html">$message</a>, <a href="../_variables/minlength.html">$minlength</a> = 0)&nbsp;&nbsp;
<a href="../_functions/message_shorten_message.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Given a message object that we already know has a long message<BR>
this function truncates the message nicely to the first<BR>
sane place between $CFG-&gt;forum_longpost and $CFG-&gt;forum_shortpost<BR>
</b><BR><b>param:</b> string $message the message<br>
<b>param:</b> int $minlength the minimum length to trim the message to<br>
<b>return:</b> string the shortened message<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_get_fragment" onClick="logFunction('message_get_fragment', 'lib.php.source.html#l2010')" href="lib.php.source.html#l2010">message_get_fragment</a>(<a href="../_variables/message.html">$message</a>, <a href="../_variables/keywords.html">$keywords</a>)&nbsp;&nbsp;
<a href="../_functions/message_get_fragment.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Given a string and an array of keywords, this function looks<BR>
for the first keyword in the string, and then chops out a<BR>
small section from the text that shows that word in context.<BR>
</b><BR><b>param:</b> string $message the text to search<br>
<b>param:</b> array $keywords array of keywords to find<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_get_history" onClick="logFunction('message_get_history', 'lib.php.source.html#l2060')" href="lib.php.source.html#l2060">message_get_history</a>(<a href="../_variables/user1.html">$user1</a>, <a href="../_variables/user2.html">$user2</a>, <a href="../_variables/limitnum.html">$limitnum</a>=0, <a href="../_variables/viewingnewmessages.html">$viewingnewmessages</a>=false)&nbsp;&nbsp;
<a href="../_functions/message_get_history.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Retrieve the messages between two users<BR>
</b><BR><b>param:</b> object $user1 the current user<br>
<b>param:</b> object $user2 the other user<br>
<b>param:</b> int $limitnum the maximum number of messages to retrieve<br>
<b>param:</b> bool $viewingnewmessages are we currently viewing new messages?<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_print_message_history" onClick="logFunction('message_print_message_history', 'lib.php.source.html#l2117')" href="lib.php.source.html#l2117">message_print_message_history</a>(<a href="../_variables/user1.html">$user1</a>, <a href="../_variables/user2.html">$user2</a> ,<a href="../_variables/search.html">$search</a> = '', <a href="../_variables/messagelimit.html">$messagelimit</a> = 0, <a href="../_variables/messagehistorylink.html">$messagehistorylink</a> = false, <a href="../_variables/viewingnewmessages.html">$viewingnewmessages</a> = false, <a href="../_variables/showactionlinks.html">$showactionlinks</a> = true)&nbsp;&nbsp;
<a href="../_functions/message_print_message_history.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Print the message history between two users<BR>
</b><BR><b>param:</b> object $user1 the current user<br>
<b>param:</b> object $user2 the other user<br>
<b>param:</b> string $search search terms to highlight<br>
<b>param:</b> int $messagelimit maximum number of messages to return<br>
<b>param:</b> string $messagehistorylink the html for the message history link or false<br>
<b>param:</b> bool $viewingnewmessages are we currently viewing new messages?<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_format_message" onClick="logFunction('message_format_message', 'lib.php.source.html#l2244')" href="lib.php.source.html#l2244">message_format_message</a>(<a href="../_variables/message.html">$message</a>, <a href="../_variables/format.html">$format</a>='', <a href="../_variables/keywords.html">$keywords</a>='', <a href="../_variables/class.html">$class</a>='other')&nbsp;&nbsp;
<a href="../_functions/message_format_message.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Format a message for display in the message history<BR>
</b><BR><b>param:</b> object $message the message object<br>
<b>param:</b> string $format optional date format<br>
<b>param:</b> string $keywords keywords to highlight<br>
<b>param:</b> string $class CSS class to apply to the div around the message<br>
<b>return:</b> string the formatted message<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_format_contexturl" onClick="logFunction('message_format_contexturl', 'lib.php.source.html#l2285')" href="lib.php.source.html#l2285">message_format_contexturl</a>(<a href="../_variables/message.html">$message</a>)&nbsp;&nbsp;
<a href="../_functions/message_format_contexturl.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Format a the context url and context url name of a message for display<BR>
</b><BR><b>param:</b> object $message the message object<br>
<b>return:</b> string the formatted string<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_post_message" onClick="logFunction('message_post_message', 'lib.php.source.html#l2309')" href="lib.php.source.html#l2309">message_post_message</a>(<a href="../_variables/userfrom.html">$userfrom</a>, <a href="../_variables/userto.html">$userto</a>, <a href="../_variables/message.html">$message</a>, <a href="../_variables/format.html">$format</a>)&nbsp;&nbsp;
<a href="../_functions/message_post_message.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Send a message from one user to another. Will be delivered according to the message recipients messaging preferences<BR>
</b><BR><b>param:</b> object $userfrom the message sender<br>
<b>param:</b> object $userto the message recipient<br>
<b>param:</b> string $message the message<br>
<b>param:</b> int $format message format such as FORMAT_PLAIN or FORMAT_HTML<br>
<b>return:</b> int|false the ID of the new message or false<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_print_contactlist_user" onClick="logFunction('message_print_contactlist_user', 'lib.php.source.html#l2360')" href="lib.php.source.html#l2360">message_print_contactlist_user</a>(<a href="../_variables/contact.html">$contact</a>, <a href="../_variables/incontactlist.html">$incontactlist</a> = true, <a href="../_variables/isblocked.html">$isblocked</a> = false, <a href="../_variables/selectcontacturl.html">$selectcontacturl</a> = null, <a href="../_variables/showactionlinks.html">$showactionlinks</a> = true, <a href="../_variables/selecteduser.html">$selecteduser</a>=null)&nbsp;&nbsp;
<a href="../_functions/message_print_contactlist_user.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Print a row of contactlist displaying user picture, messages waiting and<BR>
block links etc<BR>
</b><BR><b>param:</b> object $contact contact object containing all fields required for $OUTPUT-&gt;user_picture()<br>
<b>param:</b> bool $incontactlist is the user a contact of ours?<br>
<b>param:</b> bool $isblocked is the user blocked?<br>
<b>param:</b> string $selectcontacturl the url to send the user to when a contact's name is clicked<br>
<b>param:</b> bool $showactionlinks display action links next to the other users (add contact, block user etc)<br>
<b>param:</b> object $selecteduser the user the current user is viewing (if any). They will be highlighted.<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_get_contact_add_remove_link" onClick="logFunction('message_get_contact_add_remove_link', 'lib.php.source.html#l2439')" href="lib.php.source.html#l2439">message_get_contact_add_remove_link</a>(<a href="../_variables/incontactlist.html">$incontactlist</a>, <a href="../_variables/isblocked.html">$isblocked</a>, <a href="../_variables/contact.html">$contact</a>, <a href="../_variables/script.html">$script</a>=null, <a href="../_variables/text.html">$text</a>=false, <a href="../_variables/icon.html">$icon</a>=true)&nbsp;&nbsp;
<a href="../_functions/message_get_contact_add_remove_link.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Constructs the add/remove contact link to display next to other users<BR>
</b><BR><b>param:</b> bool $incontactlist is the user a contact<br>
<b>param:</b> bool $isblocked is the user blocked<br>
<b>param:</b> stdClass $contact contact object<br>
<b>param:</b> string $script the URL to send the user to when the link is clicked. If null, the current page.<br>
<b>param:</b> bool $text include text next to the icons?<br>
<b>param:</b> bool $icon include a graphical icon?<br>
<b>return:</b> string<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_get_contact_block_link" onClick="logFunction('message_get_contact_block_link', 'lib.php.source.html#l2464')" href="lib.php.source.html#l2464">message_get_contact_block_link</a>(<a href="../_variables/incontactlist.html">$incontactlist</a>, <a href="../_variables/isblocked.html">$isblocked</a>, <a href="../_variables/contact.html">$contact</a>, <a href="../_variables/script.html">$script</a>=null, <a href="../_variables/text.html">$text</a>=false, <a href="../_variables/icon.html">$icon</a>=true)&nbsp;&nbsp;
<a href="../_functions/message_get_contact_block_link.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Constructs the block contact link to display next to other users<BR>
</b><BR><b>param:</b> bool $incontactlist is the user a contact?<br>
<b>param:</b> bool $isblocked is the user blocked?<br>
<b>param:</b> stdClass $contact contact object<br>
<b>param:</b> string $script the URL to send the user to when the link is clicked. If null, the current page.<br>
<b>param:</b> bool $text include text next to the icons?<br>
<b>param:</b> bool $icon include a graphical icon?<br>
<b>return:</b> string<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_move_userfrom_unread2read" onClick="logFunction('message_move_userfrom_unread2read', 'lib.php.source.html#l2491')" href="lib.php.source.html#l2491">message_move_userfrom_unread2read</a>(<a href="../_variables/userid.html">$userid</a>)&nbsp;&nbsp;
<a href="../_functions/message_move_userfrom_unread2read.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Moves messages from a particular user from the message table (unread messages) to message_read<BR>
This is typically only used when a user is deleted<BR>
</b><BR><b>param:</b> object $userid User id<br>
<b>return:</b> boolean success<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_mark_messages_read" onClick="logFunction('message_mark_messages_read', 'lib.php.source.html#l2510')" href="lib.php.source.html#l2510">message_mark_messages_read</a>(<a href="../_variables/touserid.html">$touserid</a>, <a href="../_variables/fromuserid.html">$fromuserid</a>)&nbsp;&nbsp;
<a href="../_functions/message_mark_messages_read.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>marks ALL messages being sent from $fromuserid to $touserid as read<BR>
</b><BR><b>param:</b> int $touserid the id of the message recipient<br>
<b>param:</b> int $fromuserid the id of the message sender<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_mark_message_read" onClick="logFunction('message_mark_message_read', 'lib.php.source.html#l2530')" href="lib.php.source.html#l2530">message_mark_message_read</a>(<a href="../_variables/message.html">$message</a>, <a href="../_variables/timeread.html">$timeread</a>, <a href="../_variables/messageworkingempty.html">$messageworkingempty</a>=false)&nbsp;&nbsp;
<a href="../_functions/message_mark_message_read.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Mark a single message as read<BR>
</b><BR><b>param:</b> stdClass $message An object with an object property ie $message-&gt;id which is an id in the message table<br>
<b>param:</b> int $timeread the timestamp for when the message should be marked read. Usually time().<br>
<b>param:</b> bool $messageworkingempty Is the message_working table already confirmed empty for this message?<br>
<b>return:</b> int the ID of the message in the message_read table<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="get_message_processors" onClick="logFunction('get_message_processors', 'lib.php.source.html#l2576')" href="lib.php.source.html#l2576">get_message_processors</a>(<a href="../_variables/ready.html">$ready</a> = false, <a href="../_variables/reset.html">$reset</a> = false, <a href="../_variables/resetonly.html">$resetonly</a> = false)&nbsp;&nbsp;
<a href="../_functions/get_message_processors.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Get all message processors, validate corresponding plugin existance and<BR>
system configuration<BR>
</b><BR><b>param:</b> bool $ready only return ready-to-use processors<br>
<b>param:</b> bool $reset Reset list of message processors (used in unit tests)<br>
<b>param:</b> bool $resetonly Just reset, then exit<br>
<b>return:</b> mixed $processors array of objects containing information on message processors<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="get_message_providers" onClick="logFunction('get_message_providers', 'lib.php.source.html#l2639')" href="lib.php.source.html#l2639">get_message_providers</a>()&nbsp;&nbsp;
<a href="../_functions/get_message_providers.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Get all message providers, validate their plugin existance and<BR>
system configuration<BR>
</b><BR><b>return:</b> mixed $processors array of objects containing information on message processors<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="get_message_processor" onClick="logFunction('get_message_processor', 'lib.php.source.html#l2669')" href="lib.php.source.html#l2669">get_message_processor</a>(<a href="../_variables/type.html">$type</a>)&nbsp;&nbsp;
<a href="../_functions/get_message_processor.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Get an instance of the message_output class for one of the output plugins.<BR>
</b><BR><b>param:</b> string $type the message output type. E.g. 'email' or 'jabber'.<br>
<b>return:</b> message_output message_output the requested class.<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="get_message_output_default_preferences" onClick="logFunction('get_message_output_default_preferences', 'lib.php.source.html#l2697')" href="lib.php.source.html#l2697">get_message_output_default_preferences</a>()&nbsp;&nbsp;
<a href="../_functions/get_message_output_default_preferences.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Get messaging outputs default (site) preferences<BR>
</b><BR><b>return:</b> object $processors object containing information on message processors<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="translate_message_default_setting" onClick="logFunction('translate_message_default_setting', 'lib.php.source.html#l2706')" href="lib.php.source.html#l2706">translate_message_default_setting</a>(<a href="../_variables/plugindefault.html">$plugindefault</a>, <a href="../_variables/processorname.html">$processorname</a>)&nbsp;&nbsp;
<a href="../_functions/translate_message_default_setting.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Translate message default settings from binary value to the array of string<BR>
representing the settings to be stored. Also validate the provided value and<BR>
use default if it is malformed.<BR>
</b><BR><b>param:</b> int&nbsp;&nbsp;&nbsp;&nbsp;$plugindefault Default setting suggested by plugin<br>
<b>param:</b> string $processorname The name of processor<br>
<b>return:</b> array&nbsp;&nbsp;$settings array of strings in the order: $permitted, $loggedin, $loggedoff.<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_page_type_list" onClick="logFunction('message_page_type_list', 'lib.php.source.html#l2754')" href="lib.php.source.html#l2754">message_page_type_list</a>(<a href="../_variables/pagetype.html">$pagetype</a>, <a href="../_variables/parentcontext.html">$parentcontext</a>, <a href="../_variables/currentcontext.html">$currentcontext</a>)&nbsp;&nbsp;
<a href="../_functions/message_page_type_list.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Return a list of page types<BR>
</b><BR><b>param:</b> string $pagetype current page type<br>
<b>param:</b> stdClass $parentcontext Block's parent context<br>
<b>param:</b> stdClass $currentcontext Current context of block<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_get_messages" onClick="logFunction('message_get_messages', 'lib.php.source.html#l2764')" href="lib.php.source.html#l2764">message_get_messages</a>(<a href="../_variables/useridto.html">$useridto</a>, <a href="../_variables/useridfrom.html">$useridfrom</a> = 0, <a href="../_variables/notifications.html">$notifications</a> = -1, <a href="../_variables/read.html">$read</a> = true,<a href="../_variables/sort.html">$sort</a> = 'mr.timecreated DESC', <a href="../_variables/limitfrom.html">$limitfrom</a> = 0, <a href="../_variables/limitnum.html">$limitnum</a> = 0)&nbsp;&nbsp;
<a href="../_functions/message_get_messages.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Get messages sent or/and received by the specified users.<BR>
Please note that this function return deleted messages too.<BR>
</b><BR><b>param:</b> int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$useridto&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the user id who received the message<br>
<b>param:</b> int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$useridfrom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the user id who sent the message. -10 or -20 for no-reply or support user<br>
<b>param:</b> int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$notifications&nbsp;&nbsp;1 for retrieving notifications, 0 for messages, -1 for both<br>
<b>param:</b> bool&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$read&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;true for retrieving read messages, false for unread<br>
<b>param:</b> string&nbsp;&nbsp;&nbsp;$sort&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the column name to order by including optionally direction<br>
<b>param:</b> int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$limitfrom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limit from<br>
<b>param:</b> int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$limitnum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limit num<br>
<b>return:</b> external_description<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_messenger_requirejs" onClick="logFunction('message_messenger_requirejs', 'lib.php.source.html#l2821')" href="lib.php.source.html#l2821">message_messenger_requirejs</a>()&nbsp;&nbsp;
<a href="../_functions/message_messenger_requirejs.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Requires the JS libraries to send a message using a dialog.<BR>
</b><BR><b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_messenger_sendmessage_link_params" onClick="logFunction('message_messenger_sendmessage_link_params', 'lib.php.source.html#l2856')" href="lib.php.source.html#l2856">message_messenger_sendmessage_link_params</a>(<a href="../_variables/user.html">$user</a>)&nbsp;&nbsp;
<a href="../_functions/message_messenger_sendmessage_link_params.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Returns the attributes to place on a link to open the 'Send message' dialog.<BR>
</b><BR><b>param:</b> object $user User object.<br>
<b>return:</b> void<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_can_post_message" onClick="logFunction('message_can_post_message', 'lib.php.source.html#l2879')" href="lib.php.source.html#l2879">message_can_post_message</a>(<a href="../_variables/recipient.html">$recipient</a>, <a href="../_variables/sender.html">$sender</a> = null)&nbsp;&nbsp;
<a href="../_functions/message_can_post_message.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Determines if a user is permitted to send another user a private message.<BR>
If no sender is provided then it defaults to the logged in user.<BR>
</b><BR><b>param:</b> object $recipient User object.<br>
<b>param:</b> object $sender User object.<br>
<b>return:</b> bool true if user is permitted, false otherwise.<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_is_user_non_contact_blocked" onClick="logFunction('message_is_user_non_contact_blocked', 'lib.php.source.html#l2913')" href="lib.php.source.html#l2913">message_is_user_non_contact_blocked</a>(<a href="../_variables/recipient.html">$recipient</a>, <a href="../_variables/sender.html">$sender</a> = null)&nbsp;&nbsp;
<a href="../_functions/message_is_user_non_contact_blocked.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Checks if the recipient is allowing messages from users that aren't a<BR>
contact. If not then it checks to make sure the sender is in the<BR>
recipient's contacts.<BR>
</b><BR><b>param:</b> object $recipient User object.<br>
<b>param:</b> object $sender User object.<br>
<b>return:</b> bool true if $sender is blocked, false otherwise.<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="message_is_user_blocked" onClick="logFunction('message_is_user_blocked', 'lib.php.source.html#l2946')" href="lib.php.source.html#l2946">message_is_user_blocked</a>(<a href="../_variables/recipient.html">$recipient</a>, <a href="../_variables/sender.html">$sender</a> = null)&nbsp;&nbsp;
<a href="../_functions/message_is_user_blocked.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Checks if the recipient has specifically blocked the sending user.<BR>
</b><BR>Note: This function will always return false if the sender has the<BR>
readallmessages capability at the system context level.<BR>
<BR>
<b>param:</b> object $recipient User object.<br>
<b>param:</b> object $sender User object.<br>
<b>return:</b> bool true if $sender is blocked, false otherwise.<br>
</td></tr></table>

<br>
</div></div>

</div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Aug 11 10:00:09 2016</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
