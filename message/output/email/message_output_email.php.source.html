<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /message/output/email/message_output_email.php source</title>
    <link rel="stylesheet" href="../../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Aug 11 10:00:09 2016 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../../';
subdir='message/output/email';
filename='message_output_email.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/message/output/email/</a> -> <a href="message_output_email.php.html">message_output_email.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="message_output_email.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="message_output_email.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * Contains the definiton of the email message processors (sends messages to users via email)</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * @package   message_email</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @copyright 2008 Luis Rodrigues and Martin Dougiamas</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> */</span>
<a name="l24"><span class="linenum">  24</span></a>  
<a name="l25"><span class="linenum">  25</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../../message/output/lib.php.html">/message/output/lib.php</a>');
<a name="l26"><span class="linenum">  26</span></a>  
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment">/**</span>
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment"> * The email message processor</span>
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment"> *</span>
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment"> * @package   message_email</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment"> * @copyright 2008 Luis Rodrigues and Martin Dougiamas</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> */</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('message_output_email')" href="../../../_classes/message_output_email.html" onMouseOver="classPopup(event,'message_output_email')">message_output_email</a> extends message_output {
<a name="l35"><span class="linenum">  35</span></a>      <span class="comment">/**</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment">     * Processes the message (sends by email).</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment">     * @param object $eventdata the event data submitted by the message sender plus $eventdata-&gt;savedmessageid</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment">     */</span>
<a name="l39"><span class="linenum">  39</span></a>      function <a class="function" onClick="logFunction('send_message')" href="../../../_functions/send_message.html" onMouseOver="funcPopup(event,'send_message')">send_message</a>(<a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../../_variables/eventdata.html">$eventdata</a>) {
<a name="l40"><span class="linenum">  40</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>;
<a name="l41"><span class="linenum">  41</span></a>  
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment">        // skip any messaging suspended and deleted users</span>
<a name="l43"><span class="linenum">  43</span></a>          if (<a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('userto')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../../_variables/userto.html">userto</a>-&gt;auth === 'nologin' or <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('userto')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../../_variables/userto.html">userto</a>-&gt;suspended or <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('userto')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../../_variables/userto.html">userto</a>-&gt;deleted) {
<a name="l44"><span class="linenum">  44</span></a>              return true;
<a name="l45"><span class="linenum">  45</span></a>          }
<a name="l46"><span class="linenum">  46</span></a>  
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment">        //the user the email is going to</span>
<a name="l48"><span class="linenum">  48</span></a>          <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../../_variables/recipient.html">$recipient</a> = null;
<a name="l49"><span class="linenum">  49</span></a>  
<a name="l50"><span class="linenum">  50</span></a>  <span class="comment">        //check if the recipient has a different email address specified in their messaging preferences Vs their user profile</span>
<a name="l51"><span class="linenum">  51</span></a>          <a class="var it38675" onMouseOver="hilite(38675)" onMouseOut="lolite()" onClick="logVariable('emailmessagingpreference')" href="../../../_variables/emailmessagingpreference.html">$emailmessagingpreference</a> = <a class="function" onClick="logFunction('get_user_preferences')" href="../../../_functions/get_user_preferences.html" onMouseOver="funcPopup(event,'get_user_preferences')">get_user_preferences</a>('message_processor_email_email', null, <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('userto')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../../_variables/userto.html">userto</a>);
<a name="l52"><span class="linenum">  52</span></a>          <a class="var it38675" onMouseOver="hilite(38675)" onMouseOut="lolite()" onClick="logVariable('emailmessagingpreference')" href="../../../_variables/emailmessagingpreference.html">$emailmessagingpreference</a> = <a class="function" onClick="logFunction('clean_param')" href="../../../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it38675" onMouseOver="hilite(38675)" onMouseOut="lolite()" onClick="logVariable('emailmessagingpreference')" href="../../../_variables/emailmessagingpreference.html">$emailmessagingpreference</a>, <a class="constant" onClick="logConstant('PARAM_EMAIL')" href="../../../_constants/PARAM_EMAIL.html" onMouseOver="constPopup(event,'PARAM_EMAIL')">PARAM_EMAIL</a>);
<a name="l53"><span class="linenum">  53</span></a>  
<a name="l54"><span class="linenum">  54</span></a>  <span class="comment">        // If the recipient has set an email address in their preferences use that instead of the one in their profile</span>
<a name="l55"><span class="linenum">  55</span></a>  <span class="comment">        // but only if overriding the notification email address is allowed</span>
<a name="l56"><span class="linenum">  56</span></a>          if (!empty(<a class="var it38675" onMouseOver="hilite(38675)" onMouseOut="lolite()" onClick="logVariable('emailmessagingpreference')" href="../../../_variables/emailmessagingpreference.html">$emailmessagingpreference</a>) &amp;&amp; !empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('messagingallowemailoverride')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/messagingallowemailoverride.html">messagingallowemailoverride</a>)) {
<a name="l57"><span class="linenum">  57</span></a>  <span class="comment">            //clone to avoid altering the actual user object</span>
<a name="l58"><span class="linenum">  58</span></a>              <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../../_variables/recipient.html">$recipient</a> = <a class="function" onClick="logFunction('clone')" href="../../../_functions/clone.html" onMouseOver="funcPopup(event,'clone')">clone</a>(<a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('userto')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../../_variables/userto.html">userto</a>);
<a name="l59"><span class="linenum">  59</span></a>              <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../../_variables/recipient.html">$recipient</a>-&gt;<a onClick="logVariable('email')" class="var it44820" onMouseOver="hilite(44820)" onMouseOut="lolite()" href="../../../_variables/email.html">email</a> = <a class="var it38675" onMouseOver="hilite(38675)" onMouseOut="lolite()" onClick="logVariable('emailmessagingpreference')" href="../../../_variables/emailmessagingpreference.html">$emailmessagingpreference</a>;
<a name="l60"><span class="linenum">  60</span></a>          } else {
<a name="l61"><span class="linenum">  61</span></a>              <a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../../_variables/recipient.html">$recipient</a> = <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('userto')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../../_variables/userto.html">userto</a>;
<a name="l62"><span class="linenum">  62</span></a>          }
<a name="l63"><span class="linenum">  63</span></a>  
<a name="l64"><span class="linenum">  64</span></a>  <span class="comment">        // Check if we have attachments to send.</span>
<a name="l65"><span class="linenum">  65</span></a>          <a class="var it1327" onMouseOver="hilite(1327)" onMouseOut="lolite()" onClick="logVariable('attachment')" href="../../../_variables/attachment.html">$attachment</a> = '';
<a name="l66"><span class="linenum">  66</span></a>          <a class="var it13952" onMouseOver="hilite(13952)" onMouseOut="lolite()" onClick="logVariable('attachname')" href="../../../_variables/attachname.html">$attachname</a> = '';
<a name="l67"><span class="linenum">  67</span></a>          if (!empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('allowattachments')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/allowattachments.html">allowattachments</a>) &amp;&amp; !empty(<a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('attachment')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../../_variables/attachment.html">attachment</a>)) {
<a name="l68"><span class="linenum">  68</span></a>              if (empty(<a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('attachname')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../../_variables/attachname.html">attachname</a>)) {
<a name="l69"><span class="linenum">  69</span></a>  <span class="comment">                // Attachment needs a file name.</span>
<a name="l70"><span class="linenum">  70</span></a>                  <a class="function" onClick="logFunction('debugging')" href="../../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Attachments should have a file name. No attachments have been sent.', <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../../../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l71"><span class="linenum">  71</span></a>              } else if (!(<a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('attachment')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../../_variables/attachment.html">attachment</a> instanceof stored_file)) {
<a name="l72"><span class="linenum">  72</span></a>  <span class="comment">                // Attachment should be of a type stored_file.</span>
<a name="l73"><span class="linenum">  73</span></a>                  <a class="function" onClick="logFunction('debugging')" href="../../../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('Attachments should be of type stored_file. No attachments have been sent.', <a class="constant" onClick="logConstant('DEBUG_DEVELOPER')" href="../../../_constants/DEBUG_DEVELOPER.html" onMouseOver="constPopup(event,'DEBUG_DEVELOPER')">DEBUG_DEVELOPER</a>);
<a name="l74"><span class="linenum">  74</span></a>              } else {
<a name="l75"><span class="linenum">  75</span></a>  <span class="comment">                // Copy attachment file to a temporary directory and get the file path.</span>
<a name="l76"><span class="linenum">  76</span></a>                  <a class="var it1327" onMouseOver="hilite(1327)" onMouseOut="lolite()" onClick="logVariable('attachment')" href="../../../_variables/attachment.html">$attachment</a> = <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('attachment')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../../_variables/attachment.html">attachment</a>-&gt;<a class="function" onClick="logFunction('copy_content_to_temp')" href="../../../_functions/copy_content_to_temp.html" onMouseOver="funcPopup(event,'copy_content_to_temp')">copy_content_to_temp</a>();
<a name="l77"><span class="linenum">  77</span></a>  
<a name="l78"><span class="linenum">  78</span></a>  <span class="comment">                // Get attachment file name.</span>
<a name="l79"><span class="linenum">  79</span></a>                  <a class="var it13952" onMouseOver="hilite(13952)" onMouseOut="lolite()" onClick="logVariable('attachname')" href="../../../_variables/attachname.html">$attachname</a> = <a class="function" onClick="logFunction('clean_filename')" href="../../../_functions/clean_filename.html" onMouseOver="funcPopup(event,'clean_filename')">clean_filename</a>(<a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('attachname')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../../_variables/attachname.html">attachname</a>);
<a name="l80"><span class="linenum">  80</span></a>              }
<a name="l81"><span class="linenum">  81</span></a>          }
<a name="l82"><span class="linenum">  82</span></a>  
<a name="l83"><span class="linenum">  83</span></a>  <span class="comment">        // Configure mail replies - this is used for incoming mail replies.</span>
<a name="l84"><span class="linenum">  84</span></a>          <a class="var it13954" onMouseOver="hilite(13954)" onMouseOut="lolite()" onClick="logVariable('replyto')" href="../../../_variables/replyto.html">$replyto</a> = '';
<a name="l85"><span class="linenum">  85</span></a>          <a class="var it13955" onMouseOver="hilite(13955)" onMouseOut="lolite()" onClick="logVariable('replytoname')" href="../../../_variables/replytoname.html">$replytoname</a> = '';
<a name="l86"><span class="linenum">  86</span></a>          if (isset(<a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('replyto')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../../_variables/replyto.html">replyto</a>)) {
<a name="l87"><span class="linenum">  87</span></a>              <a class="var it13954" onMouseOver="hilite(13954)" onMouseOut="lolite()" onClick="logVariable('replyto')" href="../../../_variables/replyto.html">$replyto</a> = <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('replyto')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../../_variables/replyto.html">replyto</a>;
<a name="l88"><span class="linenum">  88</span></a>              if (isset(<a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('replytoname')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../../_variables/replytoname.html">replytoname</a>)) {
<a name="l89"><span class="linenum">  89</span></a>                  <a class="var it13955" onMouseOver="hilite(13955)" onMouseOut="lolite()" onClick="logVariable('replytoname')" href="../../../_variables/replytoname.html">$replytoname</a> = <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('replytoname')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../../_variables/replytoname.html">replytoname</a>;
<a name="l90"><span class="linenum">  90</span></a>              }
<a name="l91"><span class="linenum">  91</span></a>          }
<a name="l92"><span class="linenum">  92</span></a>  
<a name="l93"><span class="linenum">  93</span></a>          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a> = <a class="function" onClick="logFunction('email_to_user')" href="../../../_functions/email_to_user.html" onMouseOver="funcPopup(event,'email_to_user')">email_to_user</a>(<a class="var it2752" onMouseOver="hilite(2752)" onMouseOut="lolite()" onClick="logVariable('recipient')" href="../../../_variables/recipient.html">$recipient</a>, <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('userfrom')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../../_variables/userfrom.html">userfrom</a>, <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('subject')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../../_variables/subject.html">subject</a>, <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('fullmessage')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../../_variables/fullmessage.html">fullmessage</a>,
<a name="l94"><span class="linenum">  94</span></a>                                  <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('eventdata')" href="../../../_variables/eventdata.html">$eventdata</a>-&gt;<a onClick="logVariable('fullmessagehtml')" class="var it42966" onMouseOver="hilite(42966)" onMouseOut="lolite()" href="../../../_variables/fullmessagehtml.html">fullmessagehtml</a>, <a class="var it1327" onMouseOver="hilite(1327)" onMouseOut="lolite()" onClick="logVariable('attachment')" href="../../../_variables/attachment.html">$attachment</a>, <a class="var it13952" onMouseOver="hilite(13952)" onMouseOut="lolite()" onClick="logVariable('attachname')" href="../../../_variables/attachname.html">$attachname</a>, true, <a class="var it13954" onMouseOver="hilite(13954)" onMouseOut="lolite()" onClick="logVariable('replyto')" href="../../../_variables/replyto.html">$replyto</a>, <a class="var it13955" onMouseOver="hilite(13955)" onMouseOut="lolite()" onClick="logVariable('replytoname')" href="../../../_variables/replytoname.html">$replytoname</a>);
<a name="l95"><span class="linenum">  95</span></a>  
<a name="l96"><span class="linenum">  96</span></a>  <span class="comment">        // Remove an attachment file if any.</span>
<a name="l97"><span class="linenum">  97</span></a>          if (!empty(<a class="var it1327" onMouseOver="hilite(1327)" onMouseOut="lolite()" onClick="logVariable('attachment')" href="../../../_variables/attachment.html">$attachment</a>) &amp;&amp; <a class="phpfunction" onClick="logFunction('file_exists')" href="../../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it1327" onMouseOver="hilite(1327)" onMouseOut="lolite()" onClick="logVariable('attachment')" href="../../../_variables/attachment.html">$attachment</a>)) {
<a name="l98"><span class="linenum">  98</span></a>              <a class="phpfunction" onClick="logFunction('unlink')" href="../../../_functions/unlink.html" onMouseOver="phpfuncPopup(event,'unlink')">unlink</a>(<a class="var it1327" onMouseOver="hilite(1327)" onMouseOut="lolite()" onClick="logVariable('attachment')" href="../../../_variables/attachment.html">$attachment</a>);
<a name="l99"><span class="linenum">  99</span></a>          }
<a name="l100"><span class="linenum"> 100</span></a>  
<a name="l101"><span class="linenum"> 101</span></a>          return <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a>;
<a name="l102"><span class="linenum"> 102</span></a>      }
<a name="l103"><span class="linenum"> 103</span></a>  
<a name="l104"><span class="linenum"> 104</span></a>      <span class="comment">/**</span>
<a name="l105"><span class="linenum"> 105</span></a>  <span class="comment">     * Creates necessary fields in the messaging config form.</span>
<a name="l106"><span class="linenum"> 106</span></a>  <span class="comment">     *</span>
<a name="l107"><span class="linenum"> 107</span></a>  <span class="comment">     * @param array $preferences An array of user preferences</span>
<a name="l108"><span class="linenum"> 108</span></a>  <span class="comment">     */</span>
<a name="l109"><span class="linenum"> 109</span></a>      function <a class="function" onClick="logFunction('config_form')" href="../../../_functions/config_form.html" onMouseOver="funcPopup(event,'config_form')">config_form</a>(<a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('preferences')" href="../../../_variables/preferences.html">$preferences</a>){
<a name="l110"><span class="linenum"> 110</span></a>          global <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../../_variables/USER.html">$USER</a>, <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>;
<a name="l111"><span class="linenum"> 111</span></a>          <a class="var it126" onMouseOver="hilite(126)" onMouseOut="lolite()" onClick="logVariable('string')" href="../../../_variables/string.html">$string</a> = '';
<a name="l112"><span class="linenum"> 112</span></a>  
<a name="l113"><span class="linenum"> 113</span></a>          <a class="var it1191" onMouseOver="hilite(1191)" onMouseOut="lolite()" onClick="logVariable('choices')" href="../../../_variables/choices.html">$choices</a> = array();
<a name="l114"><span class="linenum"> 114</span></a>          <a class="var it1191" onMouseOver="hilite(1191)" onMouseOut="lolite()" onClick="logVariable('choices')" href="../../../_variables/choices.html">$choices</a>['0'] = <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('textformat');
<a name="l115"><span class="linenum"> 115</span></a>          <a class="var it1191" onMouseOver="hilite(1191)" onMouseOut="lolite()" onClick="logVariable('choices')" href="../../../_variables/choices.html">$choices</a>['1'] = <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('htmlformat');
<a name="l116"><span class="linenum"> 116</span></a>          <a class="var it397" onMouseOver="hilite(397)" onMouseOut="lolite()" onClick="logVariable('current')" href="../../../_variables/current.html">$current</a> = <a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('preferences')" href="../../../_variables/preferences.html">$preferences</a>-&gt;<a onClick="logVariable('mailformat')" class="var it44821" onMouseOver="hilite(44821)" onMouseOut="lolite()" href="../../../_variables/mailformat.html">mailformat</a>;
<a name="l117"><span class="linenum"> 117</span></a>          <a class="var it126" onMouseOver="hilite(126)" onMouseOut="lolite()" onClick="logVariable('string')" href="../../../_variables/string.html">$string</a> .= <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('container')" href="../../../_functions/container.html" onMouseOver="funcPopup(event,'container')">container</a>(<a class="class" onClick="logClass('html_writer')" href="../../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('label')" href="../../../_functions/label.html" onMouseOver="funcPopup(event,'label')">label</a>(<a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailformat'), 'mailformat'));
<a name="l118"><span class="linenum"> 118</span></a>          <a class="var it126" onMouseOver="hilite(126)" onMouseOut="lolite()" onClick="logVariable('string')" href="../../../_variables/string.html">$string</a> .= <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('container')" href="../../../_functions/container.html" onMouseOver="funcPopup(event,'container')">container</a>(<a class="class" onClick="logClass('html_writer')" href="../../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('select')" href="../../../_functions/select.html" onMouseOver="funcPopup(event,'select')">select</a>(<a class="var it1191" onMouseOver="hilite(1191)" onMouseOut="lolite()" onClick="logVariable('choices')" href="../../../_variables/choices.html">$choices</a>, 'mailformat', <a class="var it397" onMouseOver="hilite(397)" onMouseOut="lolite()" onClick="logVariable('current')" href="../../../_variables/current.html">$current</a>, false, array('id' =&gt; 'mailformat')));
<a name="l119"><span class="linenum"> 119</span></a>  
<a name="l120"><span class="linenum"> 120</span></a>          if (!empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('allowusermailcharset')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/allowusermailcharset.html">allowusermailcharset</a>)) {
<a name="l121"><span class="linenum"> 121</span></a>              <a class="var it1191" onMouseOver="hilite(1191)" onMouseOut="lolite()" onClick="logVariable('choices')" href="../../../_variables/choices.html">$choices</a> = array();
<a name="l122"><span class="linenum"> 122</span></a>              <a class="var it8156" onMouseOver="hilite(8156)" onMouseOut="lolite()" onClick="logVariable('charsets')" href="../../../_variables/charsets.html">$charsets</a> = <a class="function" onClick="logFunction('get_list_of_charsets')" href="../../../_functions/get_list_of_charsets.html" onMouseOver="funcPopup(event,'get_list_of_charsets')">get_list_of_charsets</a>();
<a name="l123"><span class="linenum"> 123</span></a>              if (!empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sitemailcharset')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sitemailcharset.html">sitemailcharset</a>)) {
<a name="l124"><span class="linenum"> 124</span></a>                  <a class="var it1191" onMouseOver="hilite(1191)" onMouseOut="lolite()" onClick="logVariable('choices')" href="../../../_variables/choices.html">$choices</a>['0'] = <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('site').' ('.<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('sitemailcharset')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/sitemailcharset.html">sitemailcharset</a>.')';
<a name="l125"><span class="linenum"> 125</span></a>              } else {
<a name="l126"><span class="linenum"> 126</span></a>                  <a class="var it1191" onMouseOver="hilite(1191)" onMouseOut="lolite()" onClick="logVariable('choices')" href="../../../_variables/choices.html">$choices</a>['0'] = <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('site').' (UTF-8)';
<a name="l127"><span class="linenum"> 127</span></a>              }
<a name="l128"><span class="linenum"> 128</span></a>              <a class="var it1191" onMouseOver="hilite(1191)" onMouseOut="lolite()" onClick="logVariable('choices')" href="../../../_variables/choices.html">$choices</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it1191" onMouseOver="hilite(1191)" onMouseOut="lolite()" onClick="logVariable('choices')" href="../../../_variables/choices.html">$choices</a>, <a class="var it8156" onMouseOver="hilite(8156)" onMouseOut="lolite()" onClick="logVariable('charsets')" href="../../../_variables/charsets.html">$charsets</a>);
<a name="l129"><span class="linenum"> 129</span></a>              <a class="var it397" onMouseOver="hilite(397)" onMouseOut="lolite()" onClick="logVariable('current')" href="../../../_variables/current.html">$current</a> = <a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('preferences')" href="../../../_variables/preferences.html">$preferences</a>-&gt;<a onClick="logVariable('mailcharset')" class="var it44821" onMouseOver="hilite(44821)" onMouseOut="lolite()" href="../../../_variables/mailcharset.html">mailcharset</a>;
<a name="l130"><span class="linenum"> 130</span></a>              <a class="var it126" onMouseOver="hilite(126)" onMouseOut="lolite()" onClick="logVariable('string')" href="../../../_variables/string.html">$string</a> .= <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('container')" href="../../../_functions/container.html" onMouseOver="funcPopup(event,'container')">container</a>(<a class="class" onClick="logClass('html_writer')" href="../../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('label')" href="../../../_functions/label.html" onMouseOver="funcPopup(event,'label')">label</a>(<a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailcharset'), 'mailcharset'));
<a name="l131"><span class="linenum"> 131</span></a>              <a class="var it126" onMouseOver="hilite(126)" onMouseOut="lolite()" onClick="logVariable('string')" href="../../../_variables/string.html">$string</a> .= <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('container')" href="../../../_functions/container.html" onMouseOver="funcPopup(event,'container')">container</a>(
<a name="l132"><span class="linenum"> 132</span></a>                  <a class="class" onClick="logClass('html_writer')" href="../../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('select')" href="../../../_functions/select.html" onMouseOver="funcPopup(event,'select')">select</a>(<a class="var it1191" onMouseOver="hilite(1191)" onMouseOut="lolite()" onClick="logVariable('choices')" href="../../../_variables/choices.html">$choices</a>, 'preference_mailcharset', <a class="var it397" onMouseOver="hilite(397)" onMouseOut="lolite()" onClick="logVariable('current')" href="../../../_variables/current.html">$current</a>, false, array('id' =&gt; 'mailcharset'))
<a name="l133"><span class="linenum"> 133</span></a>              );
<a name="l134"><span class="linenum"> 134</span></a>          }
<a name="l135"><span class="linenum"> 135</span></a>  
<a name="l136"><span class="linenum"> 136</span></a>          if (!empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('messagingallowemailoverride')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/messagingallowemailoverride.html">messagingallowemailoverride</a>)) {
<a name="l137"><span class="linenum"> 137</span></a>              <a class="var it9350" onMouseOver="hilite(9350)" onMouseOut="lolite()" onClick="logVariable('inputattributes')" href="../../../_variables/inputattributes.html">$inputattributes</a> = array('size' =&gt; '30', 'name' =&gt; 'email_email', 'value' =&gt; <a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('preferences')" href="../../../_variables/preferences.html">$preferences</a>-&gt;<a onClick="logVariable('email_email')" class="var it44821" onMouseOver="hilite(44821)" onMouseOut="lolite()" href="../../../_variables/email_email.html">email_email</a>,
<a name="l138"><span class="linenum"> 138</span></a>                      'id' =&gt; 'email_email');
<a name="l139"><span class="linenum"> 139</span></a>              <a class="var it126" onMouseOver="hilite(126)" onMouseOut="lolite()" onClick="logVariable('string')" href="../../../_variables/string.html">$string</a> .= <a class="class" onClick="logClass('html_writer')" href="../../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('label')" href="../../../_functions/label.html" onMouseOver="funcPopup(event,'label')">label</a>(<a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('email', 'message_email'), 'email_email');
<a name="l140"><span class="linenum"> 140</span></a>              <a class="var it126" onMouseOver="hilite(126)" onMouseOut="lolite()" onClick="logVariable('string')" href="../../../_variables/string.html">$string</a> .= <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('container')" href="../../../_functions/container.html" onMouseOver="funcPopup(event,'container')">container</a>(<a class="class" onClick="logClass('html_writer')" href="../../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('empty_tag')" href="../../../_functions/empty_tag.html" onMouseOver="funcPopup(event,'empty_tag')">empty_tag</a>('input', <a class="var it9350" onMouseOver="hilite(9350)" onMouseOut="lolite()" onClick="logVariable('inputattributes')" href="../../../_variables/inputattributes.html">$inputattributes</a>));
<a name="l141"><span class="linenum"> 141</span></a>  
<a name="l142"><span class="linenum"> 142</span></a>              if (empty(<a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('preferences')" href="../../../_variables/preferences.html">$preferences</a>-&gt;<a onClick="logVariable('email_email')" class="var it44821" onMouseOver="hilite(44821)" onMouseOut="lolite()" href="../../../_variables/email_email.html">email_email</a>) &amp;&amp; !empty(<a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('preferences')" href="../../../_variables/preferences.html">$preferences</a>-&gt;<a onClick="logVariable('userdefaultemail')" class="var it44821" onMouseOver="hilite(44821)" onMouseOut="lolite()" href="../../../_variables/userdefaultemail.html">userdefaultemail</a>)) {
<a name="l143"><span class="linenum"> 143</span></a>                  <a class="var it126" onMouseOver="hilite(126)" onMouseOut="lolite()" onClick="logVariable('string')" href="../../../_variables/string.html">$string</a> .= <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('container')" href="../../../_functions/container.html" onMouseOver="funcPopup(event,'container')">container</a>(<a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('ifemailleftempty', 'message_email', <a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('preferences')" href="../../../_variables/preferences.html">$preferences</a>-&gt;<a onClick="logVariable('userdefaultemail')" class="var it44821" onMouseOver="hilite(44821)" onMouseOut="lolite()" href="../../../_variables/userdefaultemail.html">userdefaultemail</a>));
<a name="l144"><span class="linenum"> 144</span></a>              }
<a name="l145"><span class="linenum"> 145</span></a>  
<a name="l146"><span class="linenum"> 146</span></a>              if (!empty(<a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('preferences')" href="../../../_variables/preferences.html">$preferences</a>-&gt;<a onClick="logVariable('email_email')" class="var it44821" onMouseOver="hilite(44821)" onMouseOut="lolite()" href="../../../_variables/email_email.html">email_email</a>) &amp;&amp; !<a class="function" onClick="logFunction('validate_email')" href="../../../_functions/validate_email.html" onMouseOver="funcPopup(event,'validate_email')">validate_email</a>(<a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('preferences')" href="../../../_variables/preferences.html">$preferences</a>-&gt;<a onClick="logVariable('email_email')" class="var it44821" onMouseOver="hilite(44821)" onMouseOut="lolite()" href="../../../_variables/email_email.html">email_email</a>)) {
<a name="l147"><span class="linenum"> 147</span></a>                  <a class="var it126" onMouseOver="hilite(126)" onMouseOut="lolite()" onClick="logVariable('string')" href="../../../_variables/string.html">$string</a> .= <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('container')" href="../../../_functions/container.html" onMouseOver="funcPopup(event,'container')">container</a>(<a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('invalidemail'), 'error');
<a name="l148"><span class="linenum"> 148</span></a>              }
<a name="l149"><span class="linenum"> 149</span></a>  
<a name="l150"><span class="linenum"> 150</span></a>              <a class="var it126" onMouseOver="hilite(126)" onMouseOut="lolite()" onClick="logVariable('string')" href="../../../_variables/string.html">$string</a> .= '&lt;br/&gt;';
<a name="l151"><span class="linenum"> 151</span></a>          }
<a name="l152"><span class="linenum"> 152</span></a>  
<a name="l153"><span class="linenum"> 153</span></a>          return <a class="var it126" onMouseOver="hilite(126)" onMouseOut="lolite()" onClick="logVariable('string')" href="../../../_variables/string.html">$string</a>;
<a name="l154"><span class="linenum"> 154</span></a>      }
<a name="l155"><span class="linenum"> 155</span></a>  
<a name="l156"><span class="linenum"> 156</span></a>      <span class="comment">/**</span>
<a name="l157"><span class="linenum"> 157</span></a>  <span class="comment">     * Parses the submitted form data and saves it into preferences array.</span>
<a name="l158"><span class="linenum"> 158</span></a>  <span class="comment">     *</span>
<a name="l159"><span class="linenum"> 159</span></a>  <span class="comment">     * @param stdClass $form preferences form class</span>
<a name="l160"><span class="linenum"> 160</span></a>  <span class="comment">     * @param array $preferences preferences array</span>
<a name="l161"><span class="linenum"> 161</span></a>  <span class="comment">     */</span>
<a name="l162"><span class="linenum"> 162</span></a>      function <a class="function" onClick="logFunction('process_form')" href="../../../_functions/process_form.html" onMouseOver="funcPopup(event,'process_form')">process_form</a>(<a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../../_variables/form.html">$form</a>, &amp;<a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('preferences')" href="../../../_variables/preferences.html">$preferences</a>){
<a name="l163"><span class="linenum"> 163</span></a>          if (isset(<a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../../_variables/form.html">$form</a>-&gt;<a onClick="logVariable('email_email')" class="var it43215" onMouseOver="hilite(43215)" onMouseOut="lolite()" href="../../../_variables/email_email.html">email_email</a>)) {
<a name="l164"><span class="linenum"> 164</span></a>              <a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('preferences')" href="../../../_variables/preferences.html">$preferences</a>['message_processor_email_email'] = <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../../_variables/form.html">$form</a>-&gt;<a onClick="logVariable('email_email')" class="var it43215" onMouseOver="hilite(43215)" onMouseOut="lolite()" href="../../../_variables/email_email.html">email_email</a>;
<a name="l165"><span class="linenum"> 165</span></a>          }
<a name="l166"><span class="linenum"> 166</span></a>          if (isset(<a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../../_variables/form.html">$form</a>-&gt;<a onClick="logVariable('preference_mailcharset')" class="var it43215" onMouseOver="hilite(43215)" onMouseOut="lolite()" href="../../../_variables/preference_mailcharset.html">preference_mailcharset</a>)) {
<a name="l167"><span class="linenum"> 167</span></a>              <a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('preferences')" href="../../../_variables/preferences.html">$preferences</a>['mailcharset'] = <a class="var it371" onMouseOver="hilite(371)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../../_variables/form.html">$form</a>-&gt;<a onClick="logVariable('preference_mailcharset')" class="var it43215" onMouseOver="hilite(43215)" onMouseOut="lolite()" href="../../../_variables/preference_mailcharset.html">preference_mailcharset</a>;
<a name="l168"><span class="linenum"> 168</span></a>          }
<a name="l169"><span class="linenum"> 169</span></a>      }
<a name="l170"><span class="linenum"> 170</span></a>  
<a name="l171"><span class="linenum"> 171</span></a>      <span class="comment">/**</span>
<a name="l172"><span class="linenum"> 172</span></a>  <span class="comment">     * Returns the default message output settings for this output</span>
<a name="l173"><span class="linenum"> 173</span></a>  <span class="comment">     *</span>
<a name="l174"><span class="linenum"> 174</span></a>  <span class="comment">     * @return int The default settings</span>
<a name="l175"><span class="linenum"> 175</span></a>  <span class="comment">     */</span>
<a name="l176"><span class="linenum"> 176</span></a>      public function <a class="function" onClick="logFunction('get_default_messaging_settings')" href="../../../_functions/get_default_messaging_settings.html" onMouseOver="funcPopup(event,'get_default_messaging_settings')">get_default_messaging_settings</a>() {
<a name="l177"><span class="linenum"> 177</span></a>          return <a class="constant" onClick="logConstant('MESSAGE_PERMITTED')" href="../../../_constants/MESSAGE_PERMITTED.html" onMouseOver="constPopup(event,'MESSAGE_PERMITTED')">MESSAGE_PERMITTED</a> + <a class="constant" onClick="logConstant('MESSAGE_DEFAULT_LOGGEDIN')" href="../../../_constants/MESSAGE_DEFAULT_LOGGEDIN.html" onMouseOver="constPopup(event,'MESSAGE_DEFAULT_LOGGEDIN')">MESSAGE_DEFAULT_LOGGEDIN</a> + <a class="constant" onClick="logConstant('MESSAGE_DEFAULT_LOGGEDOFF')" href="../../../_constants/MESSAGE_DEFAULT_LOGGEDOFF.html" onMouseOver="constPopup(event,'MESSAGE_DEFAULT_LOGGEDOFF')">MESSAGE_DEFAULT_LOGGEDOFF</a>;
<a name="l178"><span class="linenum"> 178</span></a>      }
<a name="l179"><span class="linenum"> 179</span></a>  
<a name="l180"><span class="linenum"> 180</span></a>      <span class="comment">/**</span>
<a name="l181"><span class="linenum"> 181</span></a>  <span class="comment">     * Loads the config data from database to put on the form during initial form display</span>
<a name="l182"><span class="linenum"> 182</span></a>  <span class="comment">     *</span>
<a name="l183"><span class="linenum"> 183</span></a>  <span class="comment">     * @param array $preferences preferences array</span>
<a name="l184"><span class="linenum"> 184</span></a>  <span class="comment">     * @param int $userid the user id</span>
<a name="l185"><span class="linenum"> 185</span></a>  <span class="comment">     */</span>
<a name="l186"><span class="linenum"> 186</span></a>      function <a class="function" onClick="logFunction('load_data')" href="../../../_functions/load_data.html" onMouseOver="funcPopup(event,'load_data')">load_data</a>(&amp;<a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('preferences')" href="../../../_variables/preferences.html">$preferences</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a>){
<a name="l187"><span class="linenum"> 187</span></a>          <a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('preferences')" href="../../../_variables/preferences.html">$preferences</a>-&gt;<a onClick="logVariable('email_email')" class="var it44821" onMouseOver="hilite(44821)" onMouseOut="lolite()" href="../../../_variables/email_email.html">email_email</a> = <a class="function" onClick="logFunction('get_user_preferences')" href="../../../_functions/get_user_preferences.html" onMouseOver="funcPopup(event,'get_user_preferences')">get_user_preferences</a>( 'message_processor_email_email', '', <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../../../_variables/userid.html">$userid</a>);
<a name="l188"><span class="linenum"> 188</span></a>      }
<a name="l189"><span class="linenum"> 189</span></a>  
<a name="l190"><span class="linenum"> 190</span></a>      <span class="comment">/**</span>
<a name="l191"><span class="linenum"> 191</span></a>  <span class="comment">     * Returns true as message can be sent to internal support user.</span>
<a name="l192"><span class="linenum"> 192</span></a>  <span class="comment">     *</span>
<a name="l193"><span class="linenum"> 193</span></a>  <span class="comment">     * @return bool</span>
<a name="l194"><span class="linenum"> 194</span></a>  <span class="comment">     */</span>
<a name="l195"><span class="linenum"> 195</span></a>      public function <a class="function" onClick="logFunction('can_send_to_any_users')" href="../../../_functions/can_send_to_any_users.html" onMouseOver="funcPopup(event,'can_send_to_any_users')">can_send_to_any_users</a>() {
<a name="l196"><span class="linenum"> 196</span></a>          return true;
<a name="l197"><span class="linenum"> 197</span></a>      }
<a name="l198"><span class="linenum"> 198</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'debugging': ['debugging', 'Standard Debugging Function ', [['lib','weblib.php',3012]], 1007],
'copy_content_to_temp': ['copy_content_to_temp', 'Copy content of file to temporary folder and returns file path ', [['lib/filestorage','stored_file.php',482]], 6],
'send_message': ['send_message', 'Processes the message and sends a notification via jabber ', [['message/output/jabber','message_output_jabber.php',37],['message/tests','externallib_test.php',44],['message/output/popup','message_output_popup.php',37],['message/output/email','message_output_email.php',35],['message/output/airnotifier','message_output_airnotifier.php',39],['lib/classes/message','manager.php',48]], 15],
'container': ['container', 'Outputs a container. ', [['lib','outputrenderers.php',3126]], 195],
'get_string': ['get_string', 'Get String returns a requested string ', [['lib/classes','string_manager_install.php',95],['lib','moodlelib.php',6735],['lib','moodlelib.php',9695],['lib/external','externallib.php',102],['question/behaviour','behaviourbase.php',770],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38]], 20134],
'clone': ['clone', '', [['lib/editor/tinymce/tiny_mce/3.5.11/plugins/media/js','media.js',11]], 370],
'label': ['label', 'Renders form element label ', [['lib','outputcomponents.php',1741]], 107],
'get_default_messaging_settings': ['get_default_messaging_settings', 'Returns the message processors default settings Should the processor be enabled for logged in users by default? Should the processor be enabled for logged off users by default? Is enabling it disallowed, permitted or forced? ', [['message/output','lib.php',83],['message/output/email','message_output_email.php',171]], 1],
'config_form': ['config_form', 'Prints a form for configuring this authentication plugin. ', [['auth/radius','auth.php',171],['auth/nntp','auth.php',109],['auth/email','auth.php',221],['message/output/jabber','message_output_jabber.php',98],['auth/mnet','auth.php',619],['auth/imap','auth.php',144],['auth/webservice','auth.php',140],['auth/shibboleth','auth.php',230],['auth/pam','auth.php',121],['auth/manual','auth.php',160],['auth/none','auth.php',137],['auth/ldap','auth.php',1818],['lib','authlib.php',399],['auth/fc','auth.php',214],['auth/pop3','auth.php',140],['auth/cas','auth.php',233],['auth/db','auth.php',749],['message/output/popup','message_output_popup.php',68],['message/output/email','message_output_email.php',104],['message/output/airnotifier','message_output_airnotifier.php',135]], 3],
'get_user_preferences': ['get_user_preferences', 'Used to fetch user preference(s) ', [['lib','moodlelib.php',1974],['user','externallib.php',1381]], 188],
'validate_email': ['validate_email', 'Validates an email to make sure it makes sense. ', [['lib','weblib.php',1085]], 16],
'select': ['select', '', [['lib/jquery/ui-1.11.4/external/jquery','jquery.js',2845],['lib','outputcomponents.php',1265]], 591],
'load_data': ['load_data', '', [['mod/chat','locallib.php',51],['message/output/jabber','message_output_jabber.php',125],['user/profile','lib.php',291],['mod/data','locallib.php',77],['grade/report/user/tests','externallib_test.php',43],['mod/assign','locallib.php',8141],['mod/glossary','locallib.php',51],['mod/glossary','locallib.php',233],['message/output/popup','message_output_popup.php',87],['message/output/email','message_output_email.php',180],['message/output/airnotifier','message_output_airnotifier.php',204],['mod/forum','locallib.php',64]], 9],
'email_to_user': ['email_to_user', 'Send an email to a specified user ', [['lib','moodlelib.php',5546]], 20],
'empty_tag': ['empty_tag', 'Outputs an empty tag with attributes ', [['lib','outputcomponents.php',1106]], 522],
'can_send_to_any_users': ['can_send_to_any_users', 'Returns true if message can be sent to fake/internal user as well. If message_output support message to be sent to fake user, then it should return true, like email. ', [['message/output','lib.php',96],['message/output/email','message_output_email.php',190]], 2],
'process_form': ['process_form', 'Parses the submitted form data and saves it into preferences array. ', [['message/output/jabber','message_output_jabber.php',113],['grade/export','lib.php',143],['message/output/popup','message_output_popup.php',77],['message/output/email','message_output_email.php',156],['message/output/airnotifier','message_output_airnotifier.php',194]], 3],
'clean_filename': ['clean_filename', 'Cleans a given filename by removing suspicious or troublesome characters ', [['lib','moodlelib.php',6575]], 58],
'get_list_of_charsets': ['get_list_of_charsets', 'Returns a list of charset codes ', [['lib','moodlelib.php',6905]], 3],
'clean_param': ['clean_param', 'Used by {@link optional_param()} and {@link required_param()} to clean the variables and/or cast to specific types, based on an options field. <code> $course->format = clean_param($course->format, PARAM_ALPHA); $selectedgradeitem = clean_param($selectedgradeitem, PARAM_INT); </code> ', [['lib','moodlelib.php',769]], 635],
'file_exists': ['file_exists', '', [], 867],
'unlink': ['unlink', '', [], 256],
'array_merge': ['array_merge', '', [], 2944]};
CLASS_DATA={
'html_writer': ['html_writer', 'Simple html output class ', [['lib','outputcomponents.php',1062]], 5120],
'message_output_email': ['message_output_email', 'The email message processor ', [['message/output/email','message_output_email.php',27]], 0]};
CONST_DATA={
'PARAM_EMAIL': ['PARAM_EMAIL', '', [['lib','moodlelib.php',128]], 8],
'DEBUG_DEVELOPER': ['DEBUG_DEVELOPER', '', [['lib','setuplib.php',40]], 736],
'MESSAGE_DEFAULT_LOGGEDIN': ['MESSAGE_DEFAULT_LOGGEDIN', '', [['message','lib.php',60]], 6],
'MESSAGE_DEFAULT_LOGGEDOFF': ['MESSAGE_DEFAULT_LOGGEDOFF', '', [['message','lib.php',61]], 9],
'MESSAGE_PERMITTED': ['MESSAGE_PERMITTED', '', [['message','lib.php',64]], 10]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Aug 11 10:00:09 2016</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
