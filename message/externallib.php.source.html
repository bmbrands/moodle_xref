<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /message/externallib.php source</title>
    <link rel="stylesheet" href="../sample.css" type="text/css">
    <link rel="stylesheet" href="../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Aug 11 10:00:09 2016 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../';
subdir='message';
filename='externallib.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/message/</a> -> <a href="externallib.php.html">externallib.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="externallib.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="externallib.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment">/**</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> * External message API</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> *</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @package    core_message</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @category   external</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * @copyright  2011 Jerome Mouneyrac</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment"> */</span>
<a name="l26"><span class="linenum">  26</span></a>  
<a name="l27"><span class="linenum">  27</span></a>  require_once(&quot;<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/libdir.html">libdir</a>/externallib.php&quot;);
<a name="l28"><span class="linenum">  28</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a> . "<a class="filename" href="../message/lib.php.html">/message/lib.php</a>");
<a name="l29"><span class="linenum">  29</span></a>  
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment">/**</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment"> * Message external functions</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> *</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> * @package    core_message</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> * @category   external</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> * @copyright  2011 Jerome Mouneyrac</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment"> * @since Moodle 2.2</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment"> */</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('core_message_external')" href="../_classes/core_message_external.html" onMouseOver="classPopup(event,'core_message_external')">core_message_external</a> <span class="keyword">extends</span> <a class="class" onClick="logClass('external_api')" href="../_classes/external_api.html" onMouseOver="classPopup(event,'external_api')">external_api</a> {
<a name="l40"><span class="linenum">  40</span></a>  
<a name="l41"><span class="linenum">  41</span></a>      <span class="comment">/**</span>
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment">     * Returns description of method parameters</span>
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment">     *</span>
<a name="l44"><span class="linenum">  44</span></a>  <span class="comment">     * @return external_function_parameters</span>
<a name="l45"><span class="linenum">  45</span></a>  <span class="comment">     * @since Moodle 2.2</span>
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment">     */</span>
<a name="l47"><span class="linenum">  47</span></a>      public static function <a class="function" onClick="logFunction('send_instant_messages_parameters')" href="../_functions/send_instant_messages_parameters.html" onMouseOver="funcPopup(event,'send_instant_messages_parameters')">send_instant_messages_parameters</a>() {
<a name="l48"><span class="linenum">  48</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_function_parameters')" href="../_classes/external_function_parameters.html" onMouseOver="classPopup(event,'external_function_parameters')">external_function_parameters</a>(
<a name="l49"><span class="linenum">  49</span></a>              array(
<a name="l50"><span class="linenum">  50</span></a>                  'messages' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_multiple_structure')" href="../_classes/external_multiple_structure.html" onMouseOver="classPopup(event,'external_multiple_structure')">external_multiple_structure</a>(
<a name="l51"><span class="linenum">  51</span></a>                      <span class="keyword">new </span><a class="class" onClick="logClass('external_single_structure')" href="../_classes/external_single_structure.html" onMouseOver="classPopup(event,'external_single_structure')">external_single_structure</a>(
<a name="l52"><span class="linenum">  52</span></a>                          array(
<a name="l53"><span class="linenum">  53</span></a>                              'touserid' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'id of the user to send the private message'),
<a name="l54"><span class="linenum">  54</span></a>                              'text' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_RAW')" href="../_constants/PARAM_RAW.html" onMouseOver="constPopup(event,'PARAM_RAW')">PARAM_RAW</a>, 'the text of the message'),
<a name="l55"><span class="linenum">  55</span></a>                              'textformat' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_format_value')" href="../_classes/external_format_value.html" onMouseOver="classPopup(event,'external_format_value')">external_format_value</a>('text', <a class="constant" onClick="logConstant('VALUE_DEFAULT')" href="../_constants/VALUE_DEFAULT.html" onMouseOver="constPopup(event,'VALUE_DEFAULT')">VALUE_DEFAULT</a>),
<a name="l56"><span class="linenum">  56</span></a>                              'clientmsgid' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_ALPHANUMEXT')" href="../_constants/PARAM_ALPHANUMEXT.html" onMouseOver="constPopup(event,'PARAM_ALPHANUMEXT')">PARAM_ALPHANUMEXT</a>, 'your own client id for the message. If this id is provided, the fail message id will be returned to you', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l57"><span class="linenum">  57</span></a>                          )
<a name="l58"><span class="linenum">  58</span></a>                      )
<a name="l59"><span class="linenum">  59</span></a>                  )
<a name="l60"><span class="linenum">  60</span></a>              )
<a name="l61"><span class="linenum">  61</span></a>          );
<a name="l62"><span class="linenum">  62</span></a>      }
<a name="l63"><span class="linenum">  63</span></a>  
<a name="l64"><span class="linenum">  64</span></a>      <span class="comment">/**</span>
<a name="l65"><span class="linenum">  65</span></a>  <span class="comment">     * Send private messages from the current USER to other users</span>
<a name="l66"><span class="linenum">  66</span></a>  <span class="comment">     *</span>
<a name="l67"><span class="linenum">  67</span></a>  <span class="comment">     * @param array $messages An array of message to send.</span>
<a name="l68"><span class="linenum">  68</span></a>  <span class="comment">     * @return array</span>
<a name="l69"><span class="linenum">  69</span></a>  <span class="comment">     * @since Moodle 2.2</span>
<a name="l70"><span class="linenum">  70</span></a>  <span class="comment">     */</span>
<a name="l71"><span class="linenum">  71</span></a>      public static function <a class="function" onClick="logFunction('send_instant_messages')" href="../_functions/send_instant_messages.html" onMouseOver="funcPopup(event,'send_instant_messages')">send_instant_messages</a>(<a class="var it925" onMouseOver="hilite(925)" onMouseOut="lolite()" onClick="logVariable('messages')" href="../_variables/messages.html">$messages</a> = array()) {
<a name="l72"><span class="linenum">  72</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l73"><span class="linenum">  73</span></a>  
<a name="l74"><span class="linenum">  74</span></a>  <span class="comment">        // Check if messaging is enabled.</span>
<a name="l75"><span class="linenum">  75</span></a>          if (!<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('messaging')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/messaging.html">messaging</a>) {
<a name="l76"><span class="linenum">  76</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('disabled', 'message');
<a name="l77"><span class="linenum">  77</span></a>          }
<a name="l78"><span class="linenum">  78</span></a>  
<a name="l79"><span class="linenum">  79</span></a>  <span class="comment">        // Ensure the current user is allowed to run this function</span>
<a name="l80"><span class="linenum">  80</span></a>          <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_system')" href="../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>();
<a name="l81"><span class="linenum">  81</span></a>          self::<a class="function" onClick="logFunction('validate_context')" href="../_functions/validate_context.html" onMouseOver="funcPopup(event,'validate_context')">validate_context</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>);
<a name="l82"><span class="linenum">  82</span></a>          <a class="function" onClick="logFunction('require_capability')" href="../_functions/require_capability.html" onMouseOver="funcPopup(event,'require_capability')">require_capability</a>('moodle/site:sendmessage', <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>);
<a name="l83"><span class="linenum">  83</span></a>  
<a name="l84"><span class="linenum">  84</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = self::<a class="function" onClick="logFunction('validate_parameters')" href="../_functions/validate_parameters.html" onMouseOver="funcPopup(event,'validate_parameters')">validate_parameters</a>(self::<a class="function" onClick="logFunction('send_instant_messages_parameters')" href="../_functions/send_instant_messages_parameters.html" onMouseOver="funcPopup(event,'send_instant_messages_parameters')">send_instant_messages_parameters</a>(), array('messages' =&gt; <a class="var it925" onMouseOver="hilite(925)" onMouseOut="lolite()" onClick="logVariable('messages')" href="../_variables/messages.html">$messages</a>));
<a name="l85"><span class="linenum">  85</span></a>  
<a name="l86"><span class="linenum">  86</span></a>  <span class="comment">        //retrieve all tousers of the messages</span>
<a name="l87"><span class="linenum">  87</span></a>          <a class="var it24821" onMouseOver="hilite(24821)" onMouseOut="lolite()" onClick="logVariable('receivers')" href="../_variables/receivers.html">$receivers</a> = array();
<a name="l88"><span class="linenum">  88</span></a>          foreach(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['messages'] as <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>) {
<a name="l89"><span class="linenum">  89</span></a>              <a class="var it24821" onMouseOver="hilite(24821)" onMouseOut="lolite()" onClick="logVariable('receivers')" href="../_variables/receivers.html">$receivers</a>[] = <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>['touserid'];
<a name="l90"><span class="linenum">  90</span></a>          }
<a name="l91"><span class="linenum">  91</span></a>          <a class="function" onClick="logFunction('list')" href="../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it15792" onMouseOver="hilite(15792)" onMouseOut="lolite()" onClick="logVariable('sqluserids')" href="../_variables/sqluserids.html">$sqluserids</a>, <a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('sqlparams')" href="../_variables/sqlparams.html">$sqlparams</a>) = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it24821" onMouseOver="hilite(24821)" onMouseOut="lolite()" onClick="logVariable('receivers')" href="../_variables/receivers.html">$receivers</a>, <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'userid_');
<a name="l92"><span class="linenum">  92</span></a>          <a class="var it24822" onMouseOver="hilite(24822)" onMouseOut="lolite()" onClick="logVariable('tousers')" href="../_variables/tousers.html">$tousers</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_select')" href="../_functions/get_records_select.html" onMouseOver="funcPopup(event,'get_records_select')">get_records_select</a>(&quot;user&quot;, &quot;id &quot; . <a class="var it15792" onMouseOver="hilite(15792)" onMouseOut="lolite()" onClick="logVariable('sqluserids')" href="../_variables/sqluserids.html">$sqluserids</a> . &quot; AND deleted = 0&quot;, <a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('sqlparams')" href="../_variables/sqlparams.html">$sqlparams</a>);
<a name="l93"><span class="linenum">  93</span></a>          <a class="var it2395" onMouseOver="hilite(2395)" onMouseOut="lolite()" onClick="logVariable('blocklist')" href="../_variables/blocklist.html">$blocklist</a>   = array();
<a name="l94"><span class="linenum">  94</span></a>          <a class="var it24823" onMouseOver="hilite(24823)" onMouseOut="lolite()" onClick="logVariable('contactlist')" href="../_variables/contactlist.html">$contactlist</a> = array();
<a name="l95"><span class="linenum">  95</span></a>          <a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('sqlparams')" href="../_variables/sqlparams.html">$sqlparams</a>['contactid'] = <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../_variables/id.html">id</a>;
<a name="l96"><span class="linenum">  96</span></a>          <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../_variables/rs.html">$rs</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset_sql')" href="../_functions/get_recordset_sql.html" onMouseOver="funcPopup(event,'get_recordset_sql')">get_recordset_sql</a>(&quot;SELECT *
<a name="l97"><span class="linenum">  97</span></a>                                          FROM {message_contacts}
<a name="l98"><span class="linenum">  98</span></a>                                         WHERE userid <a class="var it15792" onMouseOver="hilite(15792)" onMouseOut="lolite()" onClick="logVariable('sqluserids')" href="../_variables/sqluserids.html">$sqluserids</a>
<a name="l99"><span class="linenum">  99</span></a>                                               AND contactid = :contactid&quot;, <a class="var it6048" onMouseOver="hilite(6048)" onMouseOut="lolite()" onClick="logVariable('sqlparams')" href="../_variables/sqlparams.html">$sqlparams</a>);
<a name="l100"><span class="linenum"> 100</span></a>          foreach (<a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../_variables/rs.html">$rs</a> as <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../_variables/record.html">$record</a>) {
<a name="l101"><span class="linenum"> 101</span></a>              if (<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('blocked')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../_variables/blocked.html">blocked</a>) {
<a name="l102"><span class="linenum"> 102</span></a>  <span class="comment">                // $record-&gt;userid is blocking current user</span>
<a name="l103"><span class="linenum"> 103</span></a>                  <a class="var it2395" onMouseOver="hilite(2395)" onMouseOut="lolite()" onClick="logVariable('blocklist')" href="../_variables/blocklist.html">$blocklist</a>[<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('userid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../_variables/userid.html">userid</a>] = true;
<a name="l104"><span class="linenum"> 104</span></a>              } else {
<a name="l105"><span class="linenum"> 105</span></a>  <span class="comment">                // $record-&gt;userid have current user as contact</span>
<a name="l106"><span class="linenum"> 106</span></a>                  <a class="var it24823" onMouseOver="hilite(24823)" onMouseOut="lolite()" onClick="logVariable('contactlist')" href="../_variables/contactlist.html">$contactlist</a>[<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('userid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../_variables/userid.html">userid</a>] = true;
<a name="l107"><span class="linenum"> 107</span></a>              }
<a name="l108"><span class="linenum"> 108</span></a>          }
<a name="l109"><span class="linenum"> 109</span></a>          <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../_variables/rs.html">$rs</a>-&gt;<a class="function" onClick="logFunction('close')" href="../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l110"><span class="linenum"> 110</span></a>  
<a name="l111"><span class="linenum"> 111</span></a>          <a class="var it24824" onMouseOver="hilite(24824)" onMouseOut="lolite()" onClick="logVariable('canreadallmessages')" href="../_variables/canreadallmessages.html">$canreadallmessages</a> = <a class="function" onClick="logFunction('has_capability')" href="../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/site:readallmessages', <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>);
<a name="l112"><span class="linenum"> 112</span></a>  
<a name="l113"><span class="linenum"> 113</span></a>          <a class="var it24825" onMouseOver="hilite(24825)" onMouseOut="lolite()" onClick="logVariable('resultmessages')" href="../_variables/resultmessages.html">$resultmessages</a> = array();
<a name="l114"><span class="linenum"> 114</span></a>          foreach (<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['messages'] as <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>) {
<a name="l115"><span class="linenum"> 115</span></a>              <a class="var it24826" onMouseOver="hilite(24826)" onMouseOut="lolite()" onClick="logVariable('resultmsg')" href="../_variables/resultmsg.html">$resultmsg</a> = array(); <span class="comment">//the infos about the success of the operation</span>
<a name="l116"><span class="linenum"> 116</span></a>  
<a name="l117"><span class="linenum"> 117</span></a>  <span class="comment">            //we are going to do some checking</span>
<a name="l118"><span class="linenum"> 118</span></a>  <span class="comment">            //code should match /messages/index.php checks</span>
<a name="l119"><span class="linenum"> 119</span></a>              <a class="var it432" onMouseOver="hilite(432)" onMouseOut="lolite()" onClick="logVariable('success')" href="../_variables/success.html">$success</a> = true;
<a name="l120"><span class="linenum"> 120</span></a>  
<a name="l121"><span class="linenum"> 121</span></a>  <span class="comment">            //check the user exists</span>
<a name="l122"><span class="linenum"> 122</span></a>              if (empty(<a class="var it24822" onMouseOver="hilite(24822)" onMouseOut="lolite()" onClick="logVariable('tousers')" href="../_variables/tousers.html">$tousers</a>[<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>['touserid']])) {
<a name="l123"><span class="linenum"> 123</span></a>                  <a class="var it432" onMouseOver="hilite(432)" onMouseOut="lolite()" onClick="logVariable('success')" href="../_variables/success.html">$success</a> = false;
<a name="l124"><span class="linenum"> 124</span></a>                  <a class="var it2692" onMouseOver="hilite(2692)" onMouseOut="lolite()" onClick="logVariable('errormessage')" href="../_variables/errormessage.html">$errormessage</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('touserdoesntexist', 'message', <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>['touserid']);
<a name="l125"><span class="linenum"> 125</span></a>              }
<a name="l126"><span class="linenum"> 126</span></a>  
<a name="l127"><span class="linenum"> 127</span></a>  <span class="comment">            //check that the touser is not blocking the current user</span>
<a name="l128"><span class="linenum"> 128</span></a>              if (<a class="var it432" onMouseOver="hilite(432)" onMouseOut="lolite()" onClick="logVariable('success')" href="../_variables/success.html">$success</a> and !empty(<a class="var it2395" onMouseOver="hilite(2395)" onMouseOut="lolite()" onClick="logVariable('blocklist')" href="../_variables/blocklist.html">$blocklist</a>[<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>['touserid']]) and !<a class="var it24824" onMouseOver="hilite(24824)" onMouseOut="lolite()" onClick="logVariable('canreadallmessages')" href="../_variables/canreadallmessages.html">$canreadallmessages</a>) {
<a name="l129"><span class="linenum"> 129</span></a>                  <a class="var it432" onMouseOver="hilite(432)" onMouseOut="lolite()" onClick="logVariable('success')" href="../_variables/success.html">$success</a> = false;
<a name="l130"><span class="linenum"> 130</span></a>                  <a class="var it2692" onMouseOver="hilite(2692)" onMouseOut="lolite()" onClick="logVariable('errormessage')" href="../_variables/errormessage.html">$errormessage</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('userisblockingyou', 'message');
<a name="l131"><span class="linenum"> 131</span></a>              }
<a name="l132"><span class="linenum"> 132</span></a>  
<a name="l133"><span class="linenum"> 133</span></a>  <span class="comment">            // Check if the user is a contact</span>
<a name="l134"><span class="linenum"> 134</span></a>  <span class="comment">            //TODO MDL-31118 performance improvement - edit the function so we can pass an array instead userid</span>
<a name="l135"><span class="linenum"> 135</span></a>              <a class="var it4786" onMouseOver="hilite(4786)" onMouseOut="lolite()" onClick="logVariable('blocknoncontacts')" href="../_variables/blocknoncontacts.html">$blocknoncontacts</a> = <a class="function" onClick="logFunction('get_user_preferences')" href="../_functions/get_user_preferences.html" onMouseOver="funcPopup(event,'get_user_preferences')">get_user_preferences</a>('message_blocknoncontacts', NULL, <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>['touserid']);
<a name="l136"><span class="linenum"> 136</span></a>  <span class="comment">            // message_blocknoncontacts option is on and current user is not in contact list</span>
<a name="l137"><span class="linenum"> 137</span></a>              if (<a class="var it432" onMouseOver="hilite(432)" onMouseOut="lolite()" onClick="logVariable('success')" href="../_variables/success.html">$success</a> &amp;&amp; empty(<a class="var it24823" onMouseOver="hilite(24823)" onMouseOut="lolite()" onClick="logVariable('contactlist')" href="../_variables/contactlist.html">$contactlist</a>[<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>['touserid']]) &amp;&amp; !empty(<a class="var it4786" onMouseOver="hilite(4786)" onMouseOut="lolite()" onClick="logVariable('blocknoncontacts')" href="../_variables/blocknoncontacts.html">$blocknoncontacts</a>)) {
<a name="l138"><span class="linenum"> 138</span></a>  <span class="comment">                // The user isn't a contact and they have selected to block non contacts so this message won't be sent.</span>
<a name="l139"><span class="linenum"> 139</span></a>                  <a class="var it432" onMouseOver="hilite(432)" onMouseOut="lolite()" onClick="logVariable('success')" href="../_variables/success.html">$success</a> = false;
<a name="l140"><span class="linenum"> 140</span></a>                  <a class="var it2692" onMouseOver="hilite(2692)" onMouseOut="lolite()" onClick="logVariable('errormessage')" href="../_variables/errormessage.html">$errormessage</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('userisblockingyounoncontact', 'message',
<a name="l141"><span class="linenum"> 141</span></a>                          <a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="class" onClick="logClass('core_user')" href="../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('get_user')" href="../_functions/get_user.html" onMouseOver="funcPopup(event,'get_user')">get_user</a>(<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>['touserid'])));
<a name="l142"><span class="linenum"> 142</span></a>              }
<a name="l143"><span class="linenum"> 143</span></a>  
<a name="l144"><span class="linenum"> 144</span></a>  <span class="comment">            //now we can send the message (at least try)</span>
<a name="l145"><span class="linenum"> 145</span></a>              if (<a class="var it432" onMouseOver="hilite(432)" onMouseOut="lolite()" onClick="logVariable('success')" href="../_variables/success.html">$success</a>) {
<a name="l146"><span class="linenum"> 146</span></a>  <span class="comment">                //TODO MDL-31118 performance improvement - edit the function so we can pass an array instead one touser object</span>
<a name="l147"><span class="linenum"> 147</span></a>                  <a class="var it432" onMouseOver="hilite(432)" onMouseOut="lolite()" onClick="logVariable('success')" href="../_variables/success.html">$success</a> = <a class="function" onClick="logFunction('message_post_message')" href="../_functions/message_post_message.html" onMouseOver="funcPopup(event,'message_post_message')">message_post_message</a>(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>, <a class="var it24822" onMouseOver="hilite(24822)" onMouseOut="lolite()" onClick="logVariable('tousers')" href="../_variables/tousers.html">$tousers</a>[<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>['touserid']],
<a name="l148"><span class="linenum"> 148</span></a>                          <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>['text'], <a class="function" onClick="logFunction('external_validate_format')" href="../_functions/external_validate_format.html" onMouseOver="funcPopup(event,'external_validate_format')">external_validate_format</a>(<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>['textformat']));
<a name="l149"><span class="linenum"> 149</span></a>              }
<a name="l150"><span class="linenum"> 150</span></a>  
<a name="l151"><span class="linenum"> 151</span></a>  <span class="comment">            //build the resultmsg</span>
<a name="l152"><span class="linenum"> 152</span></a>              if (isset(<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>['clientmsgid'])) {
<a name="l153"><span class="linenum"> 153</span></a>                  <a class="var it24826" onMouseOver="hilite(24826)" onMouseOut="lolite()" onClick="logVariable('resultmsg')" href="../_variables/resultmsg.html">$resultmsg</a>['clientmsgid'] = <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>['clientmsgid'];
<a name="l154"><span class="linenum"> 154</span></a>              }
<a name="l155"><span class="linenum"> 155</span></a>              if (<a class="var it432" onMouseOver="hilite(432)" onMouseOut="lolite()" onClick="logVariable('success')" href="../_variables/success.html">$success</a>) {
<a name="l156"><span class="linenum"> 156</span></a>                  <a class="var it24826" onMouseOver="hilite(24826)" onMouseOut="lolite()" onClick="logVariable('resultmsg')" href="../_variables/resultmsg.html">$resultmsg</a>['msgid'] = <a class="var it432" onMouseOver="hilite(432)" onMouseOut="lolite()" onClick="logVariable('success')" href="../_variables/success.html">$success</a>;
<a name="l157"><span class="linenum"> 157</span></a>              } else {
<a name="l158"><span class="linenum"> 158</span></a>  <span class="comment">                // WARNINGS: for backward compatibility we return this errormessage.</span>
<a name="l159"><span class="linenum"> 159</span></a>  <span class="comment">                //          We should have thrown exceptions as these errors prevent results to be returned.</span>
<a name="l160"><span class="linenum"> 160</span></a>  <span class="comment">                // See http://docs.moodle.org/dev/Errors_handling_in_web_services#When_to_send_a_warning_on_the_server_side .</span>
<a name="l161"><span class="linenum"> 161</span></a>                  <a class="var it24826" onMouseOver="hilite(24826)" onMouseOut="lolite()" onClick="logVariable('resultmsg')" href="../_variables/resultmsg.html">$resultmsg</a>['msgid'] = -1;
<a name="l162"><span class="linenum"> 162</span></a>                  <a class="var it24826" onMouseOver="hilite(24826)" onMouseOut="lolite()" onClick="logVariable('resultmsg')" href="../_variables/resultmsg.html">$resultmsg</a>['errormessage'] = <a class="var it2692" onMouseOver="hilite(2692)" onMouseOut="lolite()" onClick="logVariable('errormessage')" href="../_variables/errormessage.html">$errormessage</a>;
<a name="l163"><span class="linenum"> 163</span></a>              }
<a name="l164"><span class="linenum"> 164</span></a>  
<a name="l165"><span class="linenum"> 165</span></a>              <a class="var it24825" onMouseOver="hilite(24825)" onMouseOut="lolite()" onClick="logVariable('resultmessages')" href="../_variables/resultmessages.html">$resultmessages</a>[] = <a class="var it24826" onMouseOver="hilite(24826)" onMouseOut="lolite()" onClick="logVariable('resultmsg')" href="../_variables/resultmsg.html">$resultmsg</a>;
<a name="l166"><span class="linenum"> 166</span></a>          }
<a name="l167"><span class="linenum"> 167</span></a>  
<a name="l168"><span class="linenum"> 168</span></a>          return <a class="var it24825" onMouseOver="hilite(24825)" onMouseOut="lolite()" onClick="logVariable('resultmessages')" href="../_variables/resultmessages.html">$resultmessages</a>;
<a name="l169"><span class="linenum"> 169</span></a>      }
<a name="l170"><span class="linenum"> 170</span></a>  
<a name="l171"><span class="linenum"> 171</span></a>      <span class="comment">/**</span>
<a name="l172"><span class="linenum"> 172</span></a>  <span class="comment">     * Returns description of method result value</span>
<a name="l173"><span class="linenum"> 173</span></a>  <span class="comment">     *</span>
<a name="l174"><span class="linenum"> 174</span></a>  <span class="comment">     * @return external_description</span>
<a name="l175"><span class="linenum"> 175</span></a>  <span class="comment">     * @since Moodle 2.2</span>
<a name="l176"><span class="linenum"> 176</span></a>  <span class="comment">     */</span>
<a name="l177"><span class="linenum"> 177</span></a>      public static function <a class="function" onClick="logFunction('send_instant_messages_returns')" href="../_functions/send_instant_messages_returns.html" onMouseOver="funcPopup(event,'send_instant_messages_returns')">send_instant_messages_returns</a>() {
<a name="l178"><span class="linenum"> 178</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_multiple_structure')" href="../_classes/external_multiple_structure.html" onMouseOver="classPopup(event,'external_multiple_structure')">external_multiple_structure</a>(
<a name="l179"><span class="linenum"> 179</span></a>              <span class="keyword">new </span><a class="class" onClick="logClass('external_single_structure')" href="../_classes/external_single_structure.html" onMouseOver="classPopup(event,'external_single_structure')">external_single_structure</a>(
<a name="l180"><span class="linenum"> 180</span></a>                  array(
<a name="l181"><span class="linenum"> 181</span></a>                      'msgid' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'test this to know if it succeeds:  id of the created message if it succeeded, -1 when failed'),
<a name="l182"><span class="linenum"> 182</span></a>                      'clientmsgid' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_ALPHANUMEXT')" href="../_constants/PARAM_ALPHANUMEXT.html" onMouseOver="constPopup(event,'PARAM_ALPHANUMEXT')">PARAM_ALPHANUMEXT</a>, 'your own id for the message', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l183"><span class="linenum"> 183</span></a>                      'errormessage' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_TEXT')" href="../_constants/PARAM_TEXT.html" onMouseOver="constPopup(event,'PARAM_TEXT')">PARAM_TEXT</a>, 'error message - if it failed', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>)
<a name="l184"><span class="linenum"> 184</span></a>                  )
<a name="l185"><span class="linenum"> 185</span></a>              )
<a name="l186"><span class="linenum"> 186</span></a>          );
<a name="l187"><span class="linenum"> 187</span></a>      }
<a name="l188"><span class="linenum"> 188</span></a>  
<a name="l189"><span class="linenum"> 189</span></a>      <span class="comment">/**</span>
<a name="l190"><span class="linenum"> 190</span></a>  <span class="comment">     * Create contacts parameters description.</span>
<a name="l191"><span class="linenum"> 191</span></a>  <span class="comment">     *</span>
<a name="l192"><span class="linenum"> 192</span></a>  <span class="comment">     * @return external_function_parameters</span>
<a name="l193"><span class="linenum"> 193</span></a>  <span class="comment">     * @since Moodle 2.5</span>
<a name="l194"><span class="linenum"> 194</span></a>  <span class="comment">     */</span>
<a name="l195"><span class="linenum"> 195</span></a>      public static function <a class="function" onClick="logFunction('create_contacts_parameters')" href="../_functions/create_contacts_parameters.html" onMouseOver="funcPopup(event,'create_contacts_parameters')">create_contacts_parameters</a>() {
<a name="l196"><span class="linenum"> 196</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_function_parameters')" href="../_classes/external_function_parameters.html" onMouseOver="classPopup(event,'external_function_parameters')">external_function_parameters</a>(
<a name="l197"><span class="linenum"> 197</span></a>              array(
<a name="l198"><span class="linenum"> 198</span></a>                  'userids' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_multiple_structure')" href="../_classes/external_multiple_structure.html" onMouseOver="classPopup(event,'external_multiple_structure')">external_multiple_structure</a>(
<a name="l199"><span class="linenum"> 199</span></a>                      <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'User ID'),
<a name="l200"><span class="linenum"> 200</span></a>                      'List of user IDs'
<a name="l201"><span class="linenum"> 201</span></a>                  )
<a name="l202"><span class="linenum"> 202</span></a>              )
<a name="l203"><span class="linenum"> 203</span></a>          );
<a name="l204"><span class="linenum"> 204</span></a>      }
<a name="l205"><span class="linenum"> 205</span></a>  
<a name="l206"><span class="linenum"> 206</span></a>      <span class="comment">/**</span>
<a name="l207"><span class="linenum"> 207</span></a>  <span class="comment">     * Create contacts.</span>
<a name="l208"><span class="linenum"> 208</span></a>  <span class="comment">     *</span>
<a name="l209"><span class="linenum"> 209</span></a>  <span class="comment">     * @param array $userids array of user IDs.</span>
<a name="l210"><span class="linenum"> 210</span></a>  <span class="comment">     * @return external_description</span>
<a name="l211"><span class="linenum"> 211</span></a>  <span class="comment">     * @since Moodle 2.5</span>
<a name="l212"><span class="linenum"> 212</span></a>  <span class="comment">     */</span>
<a name="l213"><span class="linenum"> 213</span></a>      public static function <a class="function" onClick="logFunction('create_contacts')" href="../_functions/create_contacts.html" onMouseOver="funcPopup(event,'create_contacts')">create_contacts</a>(<a class="var it4024" onMouseOver="hilite(4024)" onMouseOut="lolite()" onClick="logVariable('userids')" href="../_variables/userids.html">$userids</a>) {
<a name="l214"><span class="linenum"> 214</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l215"><span class="linenum"> 215</span></a>  
<a name="l216"><span class="linenum"> 216</span></a>  <span class="comment">        // Check if messaging is enabled.</span>
<a name="l217"><span class="linenum"> 217</span></a>          if (!<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('messaging')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/messaging.html">messaging</a>) {
<a name="l218"><span class="linenum"> 218</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('disabled', 'message');
<a name="l219"><span class="linenum"> 219</span></a>          }
<a name="l220"><span class="linenum"> 220</span></a>  
<a name="l221"><span class="linenum"> 221</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array('userids' =&gt; <a class="var it4024" onMouseOver="hilite(4024)" onMouseOut="lolite()" onClick="logVariable('userids')" href="../_variables/userids.html">$userids</a>);
<a name="l222"><span class="linenum"> 222</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = self::<a class="function" onClick="logFunction('validate_parameters')" href="../_functions/validate_parameters.html" onMouseOver="funcPopup(event,'validate_parameters')">validate_parameters</a>(self::<a class="function" onClick="logFunction('create_contacts_parameters')" href="../_functions/create_contacts_parameters.html" onMouseOver="funcPopup(event,'create_contacts_parameters')">create_contacts_parameters</a>(), <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>);
<a name="l223"><span class="linenum"> 223</span></a>  
<a name="l224"><span class="linenum"> 224</span></a>          <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../_variables/warnings.html">$warnings</a> = array();
<a name="l225"><span class="linenum"> 225</span></a>          foreach (<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['userids'] as <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>) {
<a name="l226"><span class="linenum"> 226</span></a>              if (!<a class="function" onClick="logFunction('message_add_contact')" href="../_functions/message_add_contact.html" onMouseOver="funcPopup(event,'message_add_contact')">message_add_contact</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>)) {
<a name="l227"><span class="linenum"> 227</span></a>                  <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../_variables/warnings.html">$warnings</a>[] = array(
<a name="l228"><span class="linenum"> 228</span></a>                      'item' =&gt; 'user',
<a name="l229"><span class="linenum"> 229</span></a>                      'itemid' =&gt; <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>,
<a name="l230"><span class="linenum"> 230</span></a>                      'warningcode' =&gt; 'contactnotcreated',
<a name="l231"><span class="linenum"> 231</span></a>                      'message' =&gt; 'The contact could not be created'
<a name="l232"><span class="linenum"> 232</span></a>                  );
<a name="l233"><span class="linenum"> 233</span></a>              }
<a name="l234"><span class="linenum"> 234</span></a>          }
<a name="l235"><span class="linenum"> 235</span></a>          return <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../_variables/warnings.html">$warnings</a>;
<a name="l236"><span class="linenum"> 236</span></a>      }
<a name="l237"><span class="linenum"> 237</span></a>  
<a name="l238"><span class="linenum"> 238</span></a>      <span class="comment">/**</span>
<a name="l239"><span class="linenum"> 239</span></a>  <span class="comment">     * Create contacts return description.</span>
<a name="l240"><span class="linenum"> 240</span></a>  <span class="comment">     *</span>
<a name="l241"><span class="linenum"> 241</span></a>  <span class="comment">     * @return external_description</span>
<a name="l242"><span class="linenum"> 242</span></a>  <span class="comment">     * @since Moodle 2.5</span>
<a name="l243"><span class="linenum"> 243</span></a>  <span class="comment">     */</span>
<a name="l244"><span class="linenum"> 244</span></a>      public static function <a class="function" onClick="logFunction('create_contacts_returns')" href="../_functions/create_contacts_returns.html" onMouseOver="funcPopup(event,'create_contacts_returns')">create_contacts_returns</a>() {
<a name="l245"><span class="linenum"> 245</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_warnings')" href="../_classes/external_warnings.html" onMouseOver="classPopup(event,'external_warnings')">external_warnings</a>();
<a name="l246"><span class="linenum"> 246</span></a>      }
<a name="l247"><span class="linenum"> 247</span></a>  
<a name="l248"><span class="linenum"> 248</span></a>      <span class="comment">/**</span>
<a name="l249"><span class="linenum"> 249</span></a>  <span class="comment">     * Delete contacts parameters description.</span>
<a name="l250"><span class="linenum"> 250</span></a>  <span class="comment">     *</span>
<a name="l251"><span class="linenum"> 251</span></a>  <span class="comment">     * @return external_function_parameters</span>
<a name="l252"><span class="linenum"> 252</span></a>  <span class="comment">     * @since Moodle 2.5</span>
<a name="l253"><span class="linenum"> 253</span></a>  <span class="comment">     */</span>
<a name="l254"><span class="linenum"> 254</span></a>      public static function <a class="function" onClick="logFunction('delete_contacts_parameters')" href="../_functions/delete_contacts_parameters.html" onMouseOver="funcPopup(event,'delete_contacts_parameters')">delete_contacts_parameters</a>() {
<a name="l255"><span class="linenum"> 255</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_function_parameters')" href="../_classes/external_function_parameters.html" onMouseOver="classPopup(event,'external_function_parameters')">external_function_parameters</a>(
<a name="l256"><span class="linenum"> 256</span></a>              array(
<a name="l257"><span class="linenum"> 257</span></a>                  'userids' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_multiple_structure')" href="../_classes/external_multiple_structure.html" onMouseOver="classPopup(event,'external_multiple_structure')">external_multiple_structure</a>(
<a name="l258"><span class="linenum"> 258</span></a>                      <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'User ID'),
<a name="l259"><span class="linenum"> 259</span></a>                      'List of user IDs'
<a name="l260"><span class="linenum"> 260</span></a>                  )
<a name="l261"><span class="linenum"> 261</span></a>              )
<a name="l262"><span class="linenum"> 262</span></a>          );
<a name="l263"><span class="linenum"> 263</span></a>      }
<a name="l264"><span class="linenum"> 264</span></a>  
<a name="l265"><span class="linenum"> 265</span></a>      <span class="comment">/**</span>
<a name="l266"><span class="linenum"> 266</span></a>  <span class="comment">     * Delete contacts.</span>
<a name="l267"><span class="linenum"> 267</span></a>  <span class="comment">     *</span>
<a name="l268"><span class="linenum"> 268</span></a>  <span class="comment">     * @param array $userids array of user IDs.</span>
<a name="l269"><span class="linenum"> 269</span></a>  <span class="comment">     * @return null</span>
<a name="l270"><span class="linenum"> 270</span></a>  <span class="comment">     * @since Moodle 2.5</span>
<a name="l271"><span class="linenum"> 271</span></a>  <span class="comment">     */</span>
<a name="l272"><span class="linenum"> 272</span></a>      public static function <a class="function" onClick="logFunction('delete_contacts')" href="../_functions/delete_contacts.html" onMouseOver="funcPopup(event,'delete_contacts')">delete_contacts</a>(<a class="var it4024" onMouseOver="hilite(4024)" onMouseOut="lolite()" onClick="logVariable('userids')" href="../_variables/userids.html">$userids</a>) {
<a name="l273"><span class="linenum"> 273</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l274"><span class="linenum"> 274</span></a>  
<a name="l275"><span class="linenum"> 275</span></a>  <span class="comment">        // Check if messaging is enabled.</span>
<a name="l276"><span class="linenum"> 276</span></a>          if (!<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('messaging')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/messaging.html">messaging</a>) {
<a name="l277"><span class="linenum"> 277</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('disabled', 'message');
<a name="l278"><span class="linenum"> 278</span></a>          }
<a name="l279"><span class="linenum"> 279</span></a>  
<a name="l280"><span class="linenum"> 280</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array('userids' =&gt; <a class="var it4024" onMouseOver="hilite(4024)" onMouseOut="lolite()" onClick="logVariable('userids')" href="../_variables/userids.html">$userids</a>);
<a name="l281"><span class="linenum"> 281</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = self::<a class="function" onClick="logFunction('validate_parameters')" href="../_functions/validate_parameters.html" onMouseOver="funcPopup(event,'validate_parameters')">validate_parameters</a>(self::<a class="function" onClick="logFunction('delete_contacts_parameters')" href="../_functions/delete_contacts_parameters.html" onMouseOver="funcPopup(event,'delete_contacts_parameters')">delete_contacts_parameters</a>(), <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>);
<a name="l282"><span class="linenum"> 282</span></a>  
<a name="l283"><span class="linenum"> 283</span></a>          foreach (<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['userids'] as <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>) {
<a name="l284"><span class="linenum"> 284</span></a>              <a class="function" onClick="logFunction('message_remove_contact')" href="../_functions/message_remove_contact.html" onMouseOver="funcPopup(event,'message_remove_contact')">message_remove_contact</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>);
<a name="l285"><span class="linenum"> 285</span></a>          }
<a name="l286"><span class="linenum"> 286</span></a>  
<a name="l287"><span class="linenum"> 287</span></a>          return null;
<a name="l288"><span class="linenum"> 288</span></a>      }
<a name="l289"><span class="linenum"> 289</span></a>  
<a name="l290"><span class="linenum"> 290</span></a>      <span class="comment">/**</span>
<a name="l291"><span class="linenum"> 291</span></a>  <span class="comment">     * Delete contacts return description.</span>
<a name="l292"><span class="linenum"> 292</span></a>  <span class="comment">     *</span>
<a name="l293"><span class="linenum"> 293</span></a>  <span class="comment">     * @return external_description</span>
<a name="l294"><span class="linenum"> 294</span></a>  <span class="comment">     * @since Moodle 2.5</span>
<a name="l295"><span class="linenum"> 295</span></a>  <span class="comment">     */</span>
<a name="l296"><span class="linenum"> 296</span></a>      public static function <a class="function" onClick="logFunction('delete_contacts_returns')" href="../_functions/delete_contacts_returns.html" onMouseOver="funcPopup(event,'delete_contacts_returns')">delete_contacts_returns</a>() {
<a name="l297"><span class="linenum"> 297</span></a>          return null;
<a name="l298"><span class="linenum"> 298</span></a>      }
<a name="l299"><span class="linenum"> 299</span></a>  
<a name="l300"><span class="linenum"> 300</span></a>      <span class="comment">/**</span>
<a name="l301"><span class="linenum"> 301</span></a>  <span class="comment">     * Block contacts parameters description.</span>
<a name="l302"><span class="linenum"> 302</span></a>  <span class="comment">     *</span>
<a name="l303"><span class="linenum"> 303</span></a>  <span class="comment">     * @return external_function_parameters</span>
<a name="l304"><span class="linenum"> 304</span></a>  <span class="comment">     * @since Moodle 2.5</span>
<a name="l305"><span class="linenum"> 305</span></a>  <span class="comment">     */</span>
<a name="l306"><span class="linenum"> 306</span></a>      public static function <a class="function" onClick="logFunction('block_contacts_parameters')" href="../_functions/block_contacts_parameters.html" onMouseOver="funcPopup(event,'block_contacts_parameters')">block_contacts_parameters</a>() {
<a name="l307"><span class="linenum"> 307</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_function_parameters')" href="../_classes/external_function_parameters.html" onMouseOver="classPopup(event,'external_function_parameters')">external_function_parameters</a>(
<a name="l308"><span class="linenum"> 308</span></a>              array(
<a name="l309"><span class="linenum"> 309</span></a>                  'userids' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_multiple_structure')" href="../_classes/external_multiple_structure.html" onMouseOver="classPopup(event,'external_multiple_structure')">external_multiple_structure</a>(
<a name="l310"><span class="linenum"> 310</span></a>                      <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'User ID'),
<a name="l311"><span class="linenum"> 311</span></a>                      'List of user IDs'
<a name="l312"><span class="linenum"> 312</span></a>                  )
<a name="l313"><span class="linenum"> 313</span></a>              )
<a name="l314"><span class="linenum"> 314</span></a>          );
<a name="l315"><span class="linenum"> 315</span></a>      }
<a name="l316"><span class="linenum"> 316</span></a>  
<a name="l317"><span class="linenum"> 317</span></a>      <span class="comment">/**</span>
<a name="l318"><span class="linenum"> 318</span></a>  <span class="comment">     * Block contacts.</span>
<a name="l319"><span class="linenum"> 319</span></a>  <span class="comment">     *</span>
<a name="l320"><span class="linenum"> 320</span></a>  <span class="comment">     * @param array $userids array of user IDs.</span>
<a name="l321"><span class="linenum"> 321</span></a>  <span class="comment">     * @return external_description</span>
<a name="l322"><span class="linenum"> 322</span></a>  <span class="comment">     * @since Moodle 2.5</span>
<a name="l323"><span class="linenum"> 323</span></a>  <span class="comment">     */</span>
<a name="l324"><span class="linenum"> 324</span></a>      public static function <a class="function" onClick="logFunction('block_contacts')" href="../_functions/block_contacts.html" onMouseOver="funcPopup(event,'block_contacts')">block_contacts</a>(<a class="var it4024" onMouseOver="hilite(4024)" onMouseOut="lolite()" onClick="logVariable('userids')" href="../_variables/userids.html">$userids</a>) {
<a name="l325"><span class="linenum"> 325</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l326"><span class="linenum"> 326</span></a>  
<a name="l327"><span class="linenum"> 327</span></a>  <span class="comment">        // Check if messaging is enabled.</span>
<a name="l328"><span class="linenum"> 328</span></a>          if (!<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('messaging')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/messaging.html">messaging</a>) {
<a name="l329"><span class="linenum"> 329</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('disabled', 'message');
<a name="l330"><span class="linenum"> 330</span></a>          }
<a name="l331"><span class="linenum"> 331</span></a>  
<a name="l332"><span class="linenum"> 332</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array('userids' =&gt; <a class="var it4024" onMouseOver="hilite(4024)" onMouseOut="lolite()" onClick="logVariable('userids')" href="../_variables/userids.html">$userids</a>);
<a name="l333"><span class="linenum"> 333</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = self::<a class="function" onClick="logFunction('validate_parameters')" href="../_functions/validate_parameters.html" onMouseOver="funcPopup(event,'validate_parameters')">validate_parameters</a>(self::<a class="function" onClick="logFunction('block_contacts_parameters')" href="../_functions/block_contacts_parameters.html" onMouseOver="funcPopup(event,'block_contacts_parameters')">block_contacts_parameters</a>(), <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>);
<a name="l334"><span class="linenum"> 334</span></a>  
<a name="l335"><span class="linenum"> 335</span></a>          <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../_variables/warnings.html">$warnings</a> = array();
<a name="l336"><span class="linenum"> 336</span></a>          foreach (<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['userids'] as <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>) {
<a name="l337"><span class="linenum"> 337</span></a>              if (!<a class="function" onClick="logFunction('message_block_contact')" href="../_functions/message_block_contact.html" onMouseOver="funcPopup(event,'message_block_contact')">message_block_contact</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>)) {
<a name="l338"><span class="linenum"> 338</span></a>                  <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../_variables/warnings.html">$warnings</a>[] = array(
<a name="l339"><span class="linenum"> 339</span></a>                      'item' =&gt; 'user',
<a name="l340"><span class="linenum"> 340</span></a>                      'itemid' =&gt; <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>,
<a name="l341"><span class="linenum"> 341</span></a>                      'warningcode' =&gt; 'contactnotblocked',
<a name="l342"><span class="linenum"> 342</span></a>                      'message' =&gt; 'The contact could not be blocked'
<a name="l343"><span class="linenum"> 343</span></a>                  );
<a name="l344"><span class="linenum"> 344</span></a>              }
<a name="l345"><span class="linenum"> 345</span></a>          }
<a name="l346"><span class="linenum"> 346</span></a>          return <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../_variables/warnings.html">$warnings</a>;
<a name="l347"><span class="linenum"> 347</span></a>      }
<a name="l348"><span class="linenum"> 348</span></a>  
<a name="l349"><span class="linenum"> 349</span></a>      <span class="comment">/**</span>
<a name="l350"><span class="linenum"> 350</span></a>  <span class="comment">     * Block contacts return description.</span>
<a name="l351"><span class="linenum"> 351</span></a>  <span class="comment">     *</span>
<a name="l352"><span class="linenum"> 352</span></a>  <span class="comment">     * @return external_description</span>
<a name="l353"><span class="linenum"> 353</span></a>  <span class="comment">     * @since Moodle 2.5</span>
<a name="l354"><span class="linenum"> 354</span></a>  <span class="comment">     */</span>
<a name="l355"><span class="linenum"> 355</span></a>      public static function <a class="function" onClick="logFunction('block_contacts_returns')" href="../_functions/block_contacts_returns.html" onMouseOver="funcPopup(event,'block_contacts_returns')">block_contacts_returns</a>() {
<a name="l356"><span class="linenum"> 356</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_warnings')" href="../_classes/external_warnings.html" onMouseOver="classPopup(event,'external_warnings')">external_warnings</a>();
<a name="l357"><span class="linenum"> 357</span></a>      }
<a name="l358"><span class="linenum"> 358</span></a>  
<a name="l359"><span class="linenum"> 359</span></a>      <span class="comment">/**</span>
<a name="l360"><span class="linenum"> 360</span></a>  <span class="comment">     * Unblock contacts parameters description.</span>
<a name="l361"><span class="linenum"> 361</span></a>  <span class="comment">     *</span>
<a name="l362"><span class="linenum"> 362</span></a>  <span class="comment">     * @return external_function_parameters</span>
<a name="l363"><span class="linenum"> 363</span></a>  <span class="comment">     * @since Moodle 2.5</span>
<a name="l364"><span class="linenum"> 364</span></a>  <span class="comment">     */</span>
<a name="l365"><span class="linenum"> 365</span></a>      public static function <a class="function" onClick="logFunction('unblock_contacts_parameters')" href="../_functions/unblock_contacts_parameters.html" onMouseOver="funcPopup(event,'unblock_contacts_parameters')">unblock_contacts_parameters</a>() {
<a name="l366"><span class="linenum"> 366</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_function_parameters')" href="../_classes/external_function_parameters.html" onMouseOver="classPopup(event,'external_function_parameters')">external_function_parameters</a>(
<a name="l367"><span class="linenum"> 367</span></a>              array(
<a name="l368"><span class="linenum"> 368</span></a>                  'userids' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_multiple_structure')" href="../_classes/external_multiple_structure.html" onMouseOver="classPopup(event,'external_multiple_structure')">external_multiple_structure</a>(
<a name="l369"><span class="linenum"> 369</span></a>                      <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'User ID'),
<a name="l370"><span class="linenum"> 370</span></a>                      'List of user IDs'
<a name="l371"><span class="linenum"> 371</span></a>                  )
<a name="l372"><span class="linenum"> 372</span></a>              )
<a name="l373"><span class="linenum"> 373</span></a>          );
<a name="l374"><span class="linenum"> 374</span></a>      }
<a name="l375"><span class="linenum"> 375</span></a>  
<a name="l376"><span class="linenum"> 376</span></a>      <span class="comment">/**</span>
<a name="l377"><span class="linenum"> 377</span></a>  <span class="comment">     * Unblock contacts.</span>
<a name="l378"><span class="linenum"> 378</span></a>  <span class="comment">     *</span>
<a name="l379"><span class="linenum"> 379</span></a>  <span class="comment">     * @param array $userids array of user IDs.</span>
<a name="l380"><span class="linenum"> 380</span></a>  <span class="comment">     * @return null</span>
<a name="l381"><span class="linenum"> 381</span></a>  <span class="comment">     * @since Moodle 2.5</span>
<a name="l382"><span class="linenum"> 382</span></a>  <span class="comment">     */</span>
<a name="l383"><span class="linenum"> 383</span></a>      public static function <a class="function" onClick="logFunction('unblock_contacts')" href="../_functions/unblock_contacts.html" onMouseOver="funcPopup(event,'unblock_contacts')">unblock_contacts</a>(<a class="var it4024" onMouseOver="hilite(4024)" onMouseOut="lolite()" onClick="logVariable('userids')" href="../_variables/userids.html">$userids</a>) {
<a name="l384"><span class="linenum"> 384</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l385"><span class="linenum"> 385</span></a>  
<a name="l386"><span class="linenum"> 386</span></a>  <span class="comment">        // Check if messaging is enabled.</span>
<a name="l387"><span class="linenum"> 387</span></a>          if (!<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('messaging')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/messaging.html">messaging</a>) {
<a name="l388"><span class="linenum"> 388</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('disabled', 'message');
<a name="l389"><span class="linenum"> 389</span></a>          }
<a name="l390"><span class="linenum"> 390</span></a>  
<a name="l391"><span class="linenum"> 391</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array('userids' =&gt; <a class="var it4024" onMouseOver="hilite(4024)" onMouseOut="lolite()" onClick="logVariable('userids')" href="../_variables/userids.html">$userids</a>);
<a name="l392"><span class="linenum"> 392</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = self::<a class="function" onClick="logFunction('validate_parameters')" href="../_functions/validate_parameters.html" onMouseOver="funcPopup(event,'validate_parameters')">validate_parameters</a>(self::<a class="function" onClick="logFunction('unblock_contacts_parameters')" href="../_functions/unblock_contacts_parameters.html" onMouseOver="funcPopup(event,'unblock_contacts_parameters')">unblock_contacts_parameters</a>(), <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>);
<a name="l393"><span class="linenum"> 393</span></a>  
<a name="l394"><span class="linenum"> 394</span></a>          foreach (<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['userids'] as <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>) {
<a name="l395"><span class="linenum"> 395</span></a>              <a class="function" onClick="logFunction('message_unblock_contact')" href="../_functions/message_unblock_contact.html" onMouseOver="funcPopup(event,'message_unblock_contact')">message_unblock_contact</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>);
<a name="l396"><span class="linenum"> 396</span></a>          }
<a name="l397"><span class="linenum"> 397</span></a>  
<a name="l398"><span class="linenum"> 398</span></a>          return null;
<a name="l399"><span class="linenum"> 399</span></a>      }
<a name="l400"><span class="linenum"> 400</span></a>  
<a name="l401"><span class="linenum"> 401</span></a>      <span class="comment">/**</span>
<a name="l402"><span class="linenum"> 402</span></a>  <span class="comment">     * Unblock contacts return description.</span>
<a name="l403"><span class="linenum"> 403</span></a>  <span class="comment">     *</span>
<a name="l404"><span class="linenum"> 404</span></a>  <span class="comment">     * @return external_description</span>
<a name="l405"><span class="linenum"> 405</span></a>  <span class="comment">     * @since Moodle 2.5</span>
<a name="l406"><span class="linenum"> 406</span></a>  <span class="comment">     */</span>
<a name="l407"><span class="linenum"> 407</span></a>      public static function <a class="function" onClick="logFunction('unblock_contacts_returns')" href="../_functions/unblock_contacts_returns.html" onMouseOver="funcPopup(event,'unblock_contacts_returns')">unblock_contacts_returns</a>() {
<a name="l408"><span class="linenum"> 408</span></a>          return null;
<a name="l409"><span class="linenum"> 409</span></a>      }
<a name="l410"><span class="linenum"> 410</span></a>  
<a name="l411"><span class="linenum"> 411</span></a>      <span class="comment">/**</span>
<a name="l412"><span class="linenum"> 412</span></a>  <span class="comment">     * Get contacts parameters description.</span>
<a name="l413"><span class="linenum"> 413</span></a>  <span class="comment">     *</span>
<a name="l414"><span class="linenum"> 414</span></a>  <span class="comment">     * @return external_function_parameters</span>
<a name="l415"><span class="linenum"> 415</span></a>  <span class="comment">     * @since Moodle 2.5</span>
<a name="l416"><span class="linenum"> 416</span></a>  <span class="comment">     */</span>
<a name="l417"><span class="linenum"> 417</span></a>      public static function <a class="function" onClick="logFunction('get_contacts_parameters')" href="../_functions/get_contacts_parameters.html" onMouseOver="funcPopup(event,'get_contacts_parameters')">get_contacts_parameters</a>() {
<a name="l418"><span class="linenum"> 418</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_function_parameters')" href="../_classes/external_function_parameters.html" onMouseOver="classPopup(event,'external_function_parameters')">external_function_parameters</a>(array());
<a name="l419"><span class="linenum"> 419</span></a>      }
<a name="l420"><span class="linenum"> 420</span></a>  
<a name="l421"><span class="linenum"> 421</span></a>      <span class="comment">/**</span>
<a name="l422"><span class="linenum"> 422</span></a>  <span class="comment">     * Get contacts.</span>
<a name="l423"><span class="linenum"> 423</span></a>  <span class="comment">     *</span>
<a name="l424"><span class="linenum"> 424</span></a>  <span class="comment">     * @param array $userids array of user IDs.</span>
<a name="l425"><span class="linenum"> 425</span></a>  <span class="comment">     * @return external_description</span>
<a name="l426"><span class="linenum"> 426</span></a>  <span class="comment">     * @since Moodle 2.5</span>
<a name="l427"><span class="linenum"> 427</span></a>  <span class="comment">     */</span>
<a name="l428"><span class="linenum"> 428</span></a>      public static function <a class="function" onClick="logFunction('get_contacts')" href="../_functions/get_contacts.html" onMouseOver="funcPopup(event,'get_contacts')">get_contacts</a>() {
<a name="l429"><span class="linenum"> 429</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>;
<a name="l430"><span class="linenum"> 430</span></a>  
<a name="l431"><span class="linenum"> 431</span></a>  <span class="comment">        // Check if messaging is enabled.</span>
<a name="l432"><span class="linenum"> 432</span></a>          if (!<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('messaging')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/messaging.html">messaging</a>) {
<a name="l433"><span class="linenum"> 433</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('disabled', 'message');
<a name="l434"><span class="linenum"> 434</span></a>          }
<a name="l435"><span class="linenum"> 435</span></a>  
<a name="l436"><span class="linenum"> 436</span></a>          require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a> . '<a class="filename" href="../user/lib.php.html">/user/lib.php</a>');
<a name="l437"><span class="linenum"> 437</span></a>  
<a name="l438"><span class="linenum"> 438</span></a>          <a class="function" onClick="logFunction('list')" href="../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it24827" onMouseOver="hilite(24827)" onMouseOut="lolite()" onClick="logVariable('online')" href="../_variables/online.html">$online</a>, <a class="var it24828" onMouseOver="hilite(24828)" onMouseOut="lolite()" onClick="logVariable('offline')" href="../_variables/offline.html">$offline</a>, <a class="var it24829" onMouseOver="hilite(24829)" onMouseOut="lolite()" onClick="logVariable('strangers')" href="../_variables/strangers.html">$strangers</a>) = <a class="function" onClick="logFunction('message_get_contacts')" href="../_functions/message_get_contacts.html" onMouseOver="funcPopup(event,'message_get_contacts')">message_get_contacts</a>();
<a name="l439"><span class="linenum"> 439</span></a>          <a class="var it24830" onMouseOver="hilite(24830)" onMouseOut="lolite()" onClick="logVariable('allcontacts')" href="../_variables/allcontacts.html">$allcontacts</a> = array('online' =&gt; <a class="var it24827" onMouseOver="hilite(24827)" onMouseOut="lolite()" onClick="logVariable('online')" href="../_variables/online.html">$online</a>, 'offline' =&gt; <a class="var it24828" onMouseOver="hilite(24828)" onMouseOut="lolite()" onClick="logVariable('offline')" href="../_variables/offline.html">$offline</a>, 'strangers' =&gt; <a class="var it24829" onMouseOver="hilite(24829)" onMouseOut="lolite()" onClick="logVariable('strangers')" href="../_variables/strangers.html">$strangers</a>);
<a name="l440"><span class="linenum"> 440</span></a>          foreach (<a class="var it24830" onMouseOver="hilite(24830)" onMouseOut="lolite()" onClick="logVariable('allcontacts')" href="../_variables/allcontacts.html">$allcontacts</a> as <a class="var it109" onMouseOver="hilite(109)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../_variables/mode.html">$mode</a> =&gt; <a class="var it1802" onMouseOver="hilite(1802)" onMouseOut="lolite()" onClick="logVariable('contacts')" href="../_variables/contacts.html">$contacts</a>) {
<a name="l441"><span class="linenum"> 441</span></a>              foreach (<a class="var it1802" onMouseOver="hilite(1802)" onMouseOut="lolite()" onClick="logVariable('contacts')" href="../_variables/contacts.html">$contacts</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it1803" onMouseOver="hilite(1803)" onMouseOut="lolite()" onClick="logVariable('contact')" href="../_variables/contact.html">$contact</a>) {
<a name="l442"><span class="linenum"> 442</span></a>                  <a class="var it24831" onMouseOver="hilite(24831)" onMouseOut="lolite()" onClick="logVariable('newcontact')" href="../_variables/newcontact.html">$newcontact</a> = array(
<a name="l443"><span class="linenum"> 443</span></a>                      'id' =&gt; <a class="var it1803" onMouseOver="hilite(1803)" onMouseOut="lolite()" onClick="logVariable('contact')" href="../_variables/contact.html">$contact</a>-&gt;<a onClick="logVariable('id')" class="var it44228" onMouseOver="hilite(44228)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l444"><span class="linenum"> 444</span></a>                      'fullname' =&gt; <a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it1803" onMouseOver="hilite(1803)" onMouseOut="lolite()" onClick="logVariable('contact')" href="../_variables/contact.html">$contact</a>),
<a name="l445"><span class="linenum"> 445</span></a>                      'unread' =&gt; <a class="var it1803" onMouseOver="hilite(1803)" onMouseOut="lolite()" onClick="logVariable('contact')" href="../_variables/contact.html">$contact</a>-&gt;messagecount
<a name="l446"><span class="linenum"> 446</span></a>                  );
<a name="l447"><span class="linenum"> 447</span></a>  
<a name="l448"><span class="linenum"> 448</span></a>                  <a class="var it7923" onMouseOver="hilite(7923)" onMouseOut="lolite()" onClick="logVariable('userpicture')" href="../_variables/userpicture.html">$userpicture</a> = <span class="keyword">new </span><a class="class" onClick="logClass('user_picture')" href="../_classes/user_picture.html" onMouseOver="classPopup(event,'user_picture')">user_picture</a>(<a class="var it1803" onMouseOver="hilite(1803)" onMouseOut="lolite()" onClick="logVariable('contact')" href="../_variables/contact.html">$contact</a>);
<a name="l449"><span class="linenum"> 449</span></a>                  <a class="var it7923" onMouseOver="hilite(7923)" onMouseOut="lolite()" onClick="logVariable('userpicture')" href="../_variables/userpicture.html">$userpicture</a>-&gt;<a onClick="logVariable('size')" class="var it42996" onMouseOver="hilite(42996)" onMouseOut="lolite()" href="../_variables/size.html">size</a> = 1; <span class="comment">// Size f1.</span>
<a name="l450"><span class="linenum"> 450</span></a>                  <a class="var it24831" onMouseOver="hilite(24831)" onMouseOut="lolite()" onClick="logVariable('newcontact')" href="../_variables/newcontact.html">$newcontact</a>['profileimageurl'] = <a class="var it7923" onMouseOver="hilite(7923)" onMouseOut="lolite()" onClick="logVariable('userpicture')" href="../_variables/userpicture.html">$userpicture</a>-&gt;<a class="function" onClick="logFunction('get_url')" href="../_functions/get_url.html" onMouseOver="funcPopup(event,'get_url')">get_url</a>(<a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>)-&gt;<a class="function" onClick="logFunction('out')" href="../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>(false);
<a name="l451"><span class="linenum"> 451</span></a>                  <a class="var it7923" onMouseOver="hilite(7923)" onMouseOut="lolite()" onClick="logVariable('userpicture')" href="../_variables/userpicture.html">$userpicture</a>-&gt;<a onClick="logVariable('size')" class="var it42996" onMouseOver="hilite(42996)" onMouseOut="lolite()" href="../_variables/size.html">size</a> = 0; <span class="comment">// Size f2.</span>
<a name="l452"><span class="linenum"> 452</span></a>                  <a class="var it24831" onMouseOver="hilite(24831)" onMouseOut="lolite()" onClick="logVariable('newcontact')" href="../_variables/newcontact.html">$newcontact</a>['profileimageurlsmall'] = <a class="var it7923" onMouseOver="hilite(7923)" onMouseOut="lolite()" onClick="logVariable('userpicture')" href="../_variables/userpicture.html">$userpicture</a>-&gt;<a class="function" onClick="logFunction('get_url')" href="../_functions/get_url.html" onMouseOver="funcPopup(event,'get_url')">get_url</a>(<a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>)-&gt;<a class="function" onClick="logFunction('out')" href="../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>(false);
<a name="l453"><span class="linenum"> 453</span></a>  
<a name="l454"><span class="linenum"> 454</span></a>                  <a class="var it24830" onMouseOver="hilite(24830)" onMouseOut="lolite()" onClick="logVariable('allcontacts')" href="../_variables/allcontacts.html">$allcontacts</a>[<a class="var it109" onMouseOver="hilite(109)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../_variables/mode.html">$mode</a>][<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = <a class="var it24831" onMouseOver="hilite(24831)" onMouseOut="lolite()" onClick="logVariable('newcontact')" href="../_variables/newcontact.html">$newcontact</a>;
<a name="l455"><span class="linenum"> 455</span></a>              }
<a name="l456"><span class="linenum"> 456</span></a>          }
<a name="l457"><span class="linenum"> 457</span></a>          return <a class="var it24830" onMouseOver="hilite(24830)" onMouseOut="lolite()" onClick="logVariable('allcontacts')" href="../_variables/allcontacts.html">$allcontacts</a>;
<a name="l458"><span class="linenum"> 458</span></a>      }
<a name="l459"><span class="linenum"> 459</span></a>  
<a name="l460"><span class="linenum"> 460</span></a>      <span class="comment">/**</span>
<a name="l461"><span class="linenum"> 461</span></a>  <span class="comment">     * Get contacts return description.</span>
<a name="l462"><span class="linenum"> 462</span></a>  <span class="comment">     *</span>
<a name="l463"><span class="linenum"> 463</span></a>  <span class="comment">     * @return external_description</span>
<a name="l464"><span class="linenum"> 464</span></a>  <span class="comment">     * @since Moodle 2.5</span>
<a name="l465"><span class="linenum"> 465</span></a>  <span class="comment">     */</span>
<a name="l466"><span class="linenum"> 466</span></a>      public static function <a class="function" onClick="logFunction('get_contacts_returns')" href="../_functions/get_contacts_returns.html" onMouseOver="funcPopup(event,'get_contacts_returns')">get_contacts_returns</a>() {
<a name="l467"><span class="linenum"> 467</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_single_structure')" href="../_classes/external_single_structure.html" onMouseOver="classPopup(event,'external_single_structure')">external_single_structure</a>(
<a name="l468"><span class="linenum"> 468</span></a>              array(
<a name="l469"><span class="linenum"> 469</span></a>                  'online' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_multiple_structure')" href="../_classes/external_multiple_structure.html" onMouseOver="classPopup(event,'external_multiple_structure')">external_multiple_structure</a>(
<a name="l470"><span class="linenum"> 470</span></a>                      <span class="keyword">new </span><a class="class" onClick="logClass('external_single_structure')" href="../_classes/external_single_structure.html" onMouseOver="classPopup(event,'external_single_structure')">external_single_structure</a>(
<a name="l471"><span class="linenum"> 471</span></a>                          array(
<a name="l472"><span class="linenum"> 472</span></a>                              'id' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'User ID'),
<a name="l473"><span class="linenum"> 473</span></a>                              'fullname' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_NOTAGS')" href="../_constants/PARAM_NOTAGS.html" onMouseOver="constPopup(event,'PARAM_NOTAGS')">PARAM_NOTAGS</a>, 'User full name'),
<a name="l474"><span class="linenum"> 474</span></a>                              'profileimageurl' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_URL')" href="../_constants/PARAM_URL.html" onMouseOver="constPopup(event,'PARAM_URL')">PARAM_URL</a>, 'User picture URL', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l475"><span class="linenum"> 475</span></a>                              'profileimageurlsmall' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_URL')" href="../_constants/PARAM_URL.html" onMouseOver="constPopup(event,'PARAM_URL')">PARAM_URL</a>, 'Small user picture URL', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l476"><span class="linenum"> 476</span></a>                              'unread' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'Unread message count')
<a name="l477"><span class="linenum"> 477</span></a>                          )
<a name="l478"><span class="linenum"> 478</span></a>                      ),
<a name="l479"><span class="linenum"> 479</span></a>                      'List of online contacts'
<a name="l480"><span class="linenum"> 480</span></a>                  ),
<a name="l481"><span class="linenum"> 481</span></a>                  'offline' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_multiple_structure')" href="../_classes/external_multiple_structure.html" onMouseOver="classPopup(event,'external_multiple_structure')">external_multiple_structure</a>(
<a name="l482"><span class="linenum"> 482</span></a>                      <span class="keyword">new </span><a class="class" onClick="logClass('external_single_structure')" href="../_classes/external_single_structure.html" onMouseOver="classPopup(event,'external_single_structure')">external_single_structure</a>(
<a name="l483"><span class="linenum"> 483</span></a>                          array(
<a name="l484"><span class="linenum"> 484</span></a>                              'id' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'User ID'),
<a name="l485"><span class="linenum"> 485</span></a>                              'fullname' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_NOTAGS')" href="../_constants/PARAM_NOTAGS.html" onMouseOver="constPopup(event,'PARAM_NOTAGS')">PARAM_NOTAGS</a>, 'User full name'),
<a name="l486"><span class="linenum"> 486</span></a>                              'profileimageurl' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_URL')" href="../_constants/PARAM_URL.html" onMouseOver="constPopup(event,'PARAM_URL')">PARAM_URL</a>, 'User picture URL', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l487"><span class="linenum"> 487</span></a>                              'profileimageurlsmall' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_URL')" href="../_constants/PARAM_URL.html" onMouseOver="constPopup(event,'PARAM_URL')">PARAM_URL</a>, 'Small user picture URL', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l488"><span class="linenum"> 488</span></a>                              'unread' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'Unread message count')
<a name="l489"><span class="linenum"> 489</span></a>                          )
<a name="l490"><span class="linenum"> 490</span></a>                      ),
<a name="l491"><span class="linenum"> 491</span></a>                      'List of offline contacts'
<a name="l492"><span class="linenum"> 492</span></a>                  ),
<a name="l493"><span class="linenum"> 493</span></a>                  'strangers' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_multiple_structure')" href="../_classes/external_multiple_structure.html" onMouseOver="classPopup(event,'external_multiple_structure')">external_multiple_structure</a>(
<a name="l494"><span class="linenum"> 494</span></a>                      <span class="keyword">new </span><a class="class" onClick="logClass('external_single_structure')" href="../_classes/external_single_structure.html" onMouseOver="classPopup(event,'external_single_structure')">external_single_structure</a>(
<a name="l495"><span class="linenum"> 495</span></a>                          array(
<a name="l496"><span class="linenum"> 496</span></a>                              'id' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'User ID'),
<a name="l497"><span class="linenum"> 497</span></a>                              'fullname' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_NOTAGS')" href="../_constants/PARAM_NOTAGS.html" onMouseOver="constPopup(event,'PARAM_NOTAGS')">PARAM_NOTAGS</a>, 'User full name'),
<a name="l498"><span class="linenum"> 498</span></a>                              'profileimageurl' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_URL')" href="../_constants/PARAM_URL.html" onMouseOver="constPopup(event,'PARAM_URL')">PARAM_URL</a>, 'User picture URL', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l499"><span class="linenum"> 499</span></a>                              'profileimageurlsmall' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_URL')" href="../_constants/PARAM_URL.html" onMouseOver="constPopup(event,'PARAM_URL')">PARAM_URL</a>, 'Small user picture URL', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l500"><span class="linenum"> 500</span></a>                              'unread' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'Unread message count')
<a name="l501"><span class="linenum"> 501</span></a>                          )
<a name="l502"><span class="linenum"> 502</span></a>                      ),
<a name="l503"><span class="linenum"> 503</span></a>                      'List of users that are not in the user\'s contact list but have sent a message'
<a name="l504"><span class="linenum"> 504</span></a>                  )
<a name="l505"><span class="linenum"> 505</span></a>              )
<a name="l506"><span class="linenum"> 506</span></a>          );
<a name="l507"><span class="linenum"> 507</span></a>      }
<a name="l508"><span class="linenum"> 508</span></a>  
<a name="l509"><span class="linenum"> 509</span></a>      <span class="comment">/**</span>
<a name="l510"><span class="linenum"> 510</span></a>  <span class="comment">     * Search contacts parameters description.</span>
<a name="l511"><span class="linenum"> 511</span></a>  <span class="comment">     *</span>
<a name="l512"><span class="linenum"> 512</span></a>  <span class="comment">     * @return external_function_parameters</span>
<a name="l513"><span class="linenum"> 513</span></a>  <span class="comment">     * @since Moodle 2.5</span>
<a name="l514"><span class="linenum"> 514</span></a>  <span class="comment">     */</span>
<a name="l515"><span class="linenum"> 515</span></a>      public static function <a class="function" onClick="logFunction('search_contacts_parameters')" href="../_functions/search_contacts_parameters.html" onMouseOver="funcPopup(event,'search_contacts_parameters')">search_contacts_parameters</a>() {
<a name="l516"><span class="linenum"> 516</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_function_parameters')" href="../_classes/external_function_parameters.html" onMouseOver="classPopup(event,'external_function_parameters')">external_function_parameters</a>(
<a name="l517"><span class="linenum"> 517</span></a>              array(
<a name="l518"><span class="linenum"> 518</span></a>                  'searchtext' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_CLEAN')" href="../_constants/PARAM_CLEAN.html" onMouseOver="constPopup(event,'PARAM_CLEAN')">PARAM_CLEAN</a>, 'String the user\'s fullname has to match to be found'),
<a name="l519"><span class="linenum"> 519</span></a>                  'onlymycourses' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_BOOL')" href="../_constants/PARAM_BOOL.html" onMouseOver="constPopup(event,'PARAM_BOOL')">PARAM_BOOL</a>, 'Limit search to the user\'s courses',
<a name="l520"><span class="linenum"> 520</span></a>                      <a class="constant" onClick="logConstant('VALUE_DEFAULT')" href="../_constants/VALUE_DEFAULT.html" onMouseOver="constPopup(event,'VALUE_DEFAULT')">VALUE_DEFAULT</a>, false)
<a name="l521"><span class="linenum"> 521</span></a>              )
<a name="l522"><span class="linenum"> 522</span></a>          );
<a name="l523"><span class="linenum"> 523</span></a>      }
<a name="l524"><span class="linenum"> 524</span></a>  
<a name="l525"><span class="linenum"> 525</span></a>      <span class="comment">/**</span>
<a name="l526"><span class="linenum"> 526</span></a>  <span class="comment">     * Search contacts.</span>
<a name="l527"><span class="linenum"> 527</span></a>  <span class="comment">     *</span>
<a name="l528"><span class="linenum"> 528</span></a>  <span class="comment">     * @param string $searchtext query string.</span>
<a name="l529"><span class="linenum"> 529</span></a>  <span class="comment">     * @param bool $onlymycourses limit the search to the user's courses only.</span>
<a name="l530"><span class="linenum"> 530</span></a>  <span class="comment">     * @return external_description</span>
<a name="l531"><span class="linenum"> 531</span></a>  <span class="comment">     * @since Moodle 2.5</span>
<a name="l532"><span class="linenum"> 532</span></a>  <span class="comment">     */</span>
<a name="l533"><span class="linenum"> 533</span></a>      public static function <a class="function" onClick="logFunction('search_contacts')" href="../_functions/search_contacts.html" onMouseOver="funcPopup(event,'search_contacts')">search_contacts</a>(<a class="var it12992" onMouseOver="hilite(12992)" onMouseOut="lolite()" onClick="logVariable('searchtext')" href="../_variables/searchtext.html">$searchtext</a>, <a class="var it24832" onMouseOver="hilite(24832)" onMouseOut="lolite()" onClick="logVariable('onlymycourses')" href="../_variables/onlymycourses.html">$onlymycourses</a> = false) {
<a name="l534"><span class="linenum"> 534</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>, <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>;
<a name="l535"><span class="linenum"> 535</span></a>          require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a> . '<a class="filename" href="../user/lib.php.html">/user/lib.php</a>');
<a name="l536"><span class="linenum"> 536</span></a>  
<a name="l537"><span class="linenum"> 537</span></a>  <span class="comment">        // Check if messaging is enabled.</span>
<a name="l538"><span class="linenum"> 538</span></a>          if (!<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('messaging')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/messaging.html">messaging</a>) {
<a name="l539"><span class="linenum"> 539</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('disabled', 'message');
<a name="l540"><span class="linenum"> 540</span></a>          }
<a name="l541"><span class="linenum"> 541</span></a>  
<a name="l542"><span class="linenum"> 542</span></a>          require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/libdir.html">libdir</a> . '/enrollib.php');
<a name="l543"><span class="linenum"> 543</span></a>  
<a name="l544"><span class="linenum"> 544</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array('searchtext' =&gt; <a class="var it12992" onMouseOver="hilite(12992)" onMouseOut="lolite()" onClick="logVariable('searchtext')" href="../_variables/searchtext.html">$searchtext</a>, 'onlymycourses' =&gt; <a class="var it24832" onMouseOver="hilite(24832)" onMouseOut="lolite()" onClick="logVariable('onlymycourses')" href="../_variables/onlymycourses.html">$onlymycourses</a>);
<a name="l545"><span class="linenum"> 545</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = self::<a class="function" onClick="logFunction('validate_parameters')" href="../_functions/validate_parameters.html" onMouseOver="funcPopup(event,'validate_parameters')">validate_parameters</a>(self::<a class="function" onClick="logFunction('search_contacts_parameters')" href="../_functions/search_contacts_parameters.html" onMouseOver="funcPopup(event,'search_contacts_parameters')">search_contacts_parameters</a>(), <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>);
<a name="l546"><span class="linenum"> 546</span></a>  
<a name="l547"><span class="linenum"> 547</span></a>  <span class="comment">        // Extra validation, we do not allow empty queries.</span>
<a name="l548"><span class="linenum"> 548</span></a>          if (<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['searchtext'] === '') {
<a name="l549"><span class="linenum"> 549</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('querystringcannotbeempty');
<a name="l550"><span class="linenum"> 550</span></a>          }
<a name="l551"><span class="linenum"> 551</span></a>  
<a name="l552"><span class="linenum"> 552</span></a>          <a class="var it2413" onMouseOver="hilite(2413)" onMouseOut="lolite()" onClick="logVariable('courseids')" href="../_variables/courseids.html">$courseids</a> = array();
<a name="l553"><span class="linenum"> 553</span></a>          if (<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['onlymycourses']) {
<a name="l554"><span class="linenum"> 554</span></a>              <a class="var it3759" onMouseOver="hilite(3759)" onMouseOut="lolite()" onClick="logVariable('mycourses')" href="../_variables/mycourses.html">$mycourses</a> = <a class="function" onClick="logFunction('enrol_get_my_courses')" href="../_functions/enrol_get_my_courses.html" onMouseOver="funcPopup(event,'enrol_get_my_courses')">enrol_get_my_courses</a>(array('id'));
<a name="l555"><span class="linenum"> 555</span></a>              foreach (<a class="var it3759" onMouseOver="hilite(3759)" onMouseOut="lolite()" onClick="logVariable('mycourses')" href="../_variables/mycourses.html">$mycourses</a> as <a class="var it8665" onMouseOver="hilite(8665)" onMouseOut="lolite()" onClick="logVariable('mycourse')" href="../_variables/mycourse.html">$mycourse</a>) {
<a name="l556"><span class="linenum"> 556</span></a>                  <a class="var it2413" onMouseOver="hilite(2413)" onMouseOut="lolite()" onClick="logVariable('courseids')" href="../_variables/courseids.html">$courseids</a>[] = <a class="var it8665" onMouseOver="hilite(8665)" onMouseOut="lolite()" onClick="logVariable('mycourse')" href="../_variables/mycourse.html">$mycourse</a>-&gt;<a onClick="logVariable('id')" class="var it43519" onMouseOver="hilite(43519)" onMouseOut="lolite()" href="../_variables/id.html">id</a>;
<a name="l557"><span class="linenum"> 557</span></a>              }
<a name="l558"><span class="linenum"> 558</span></a>          } else {
<a name="l559"><span class="linenum"> 559</span></a>              <a class="var it2413" onMouseOver="hilite(2413)" onMouseOut="lolite()" onClick="logVariable('courseids')" href="../_variables/courseids.html">$courseids</a>[] = <a class="constant" onClick="logConstant('SITEID')" href="../_constants/SITEID.html" onMouseOver="constPopup(event,'SITEID')">SITEID</a>;
<a name="l560"><span class="linenum"> 560</span></a>          }
<a name="l561"><span class="linenum"> 561</span></a>  
<a name="l562"><span class="linenum"> 562</span></a>  <span class="comment">        // Retrieving the users matching the query.</span>
<a name="l563"><span class="linenum"> 563</span></a>          <a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../_variables/users.html">$users</a> = <a class="function" onClick="logFunction('message_search_users')" href="../_functions/message_search_users.html" onMouseOver="funcPopup(event,'message_search_users')">message_search_users</a>(<a class="var it2413" onMouseOver="hilite(2413)" onMouseOut="lolite()" onClick="logVariable('courseids')" href="../_variables/courseids.html">$courseids</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['searchtext']);
<a name="l564"><span class="linenum"> 564</span></a>          <a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../_variables/results.html">$results</a> = array();
<a name="l565"><span class="linenum"> 565</span></a>          foreach (<a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../_variables/users.html">$users</a> as <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>) {
<a name="l566"><span class="linenum"> 566</span></a>              <a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../_variables/results.html">$results</a>[<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/id.html">id</a>] = <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>;
<a name="l567"><span class="linenum"> 567</span></a>          }
<a name="l568"><span class="linenum"> 568</span></a>  
<a name="l569"><span class="linenum"> 569</span></a>  <span class="comment">        // Reorganising information.</span>
<a name="l570"><span class="linenum"> 570</span></a>          foreach (<a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../_variables/results.html">$results</a> as &amp;<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>) {
<a name="l571"><span class="linenum"> 571</span></a>              <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a> = array(
<a name="l572"><span class="linenum"> 572</span></a>                  'id' =&gt; <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l573"><span class="linenum"> 573</span></a>                  'fullname' =&gt; <a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)
<a name="l574"><span class="linenum"> 574</span></a>              );
<a name="l575"><span class="linenum"> 575</span></a>  
<a name="l576"><span class="linenum"> 576</span></a>  <span class="comment">            // Avoid undefined property notice as phone not specified.</span>
<a name="l577"><span class="linenum"> 577</span></a>              <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('phone1')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/phone1.html">phone1</a> = null;
<a name="l578"><span class="linenum"> 578</span></a>              <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('phone2')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/phone2.html">phone2</a> = null;
<a name="l579"><span class="linenum"> 579</span></a>  
<a name="l580"><span class="linenum"> 580</span></a>              <a class="var it7923" onMouseOver="hilite(7923)" onMouseOut="lolite()" onClick="logVariable('userpicture')" href="../_variables/userpicture.html">$userpicture</a> = <span class="keyword">new </span><a class="class" onClick="logClass('user_picture')" href="../_classes/user_picture.html" onMouseOver="classPopup(event,'user_picture')">user_picture</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l581"><span class="linenum"> 581</span></a>              <a class="var it7923" onMouseOver="hilite(7923)" onMouseOut="lolite()" onClick="logVariable('userpicture')" href="../_variables/userpicture.html">$userpicture</a>-&gt;<a onClick="logVariable('size')" class="var it42996" onMouseOver="hilite(42996)" onMouseOut="lolite()" href="../_variables/size.html">size</a> = 1; <span class="comment">// Size f1.</span>
<a name="l582"><span class="linenum"> 582</span></a>              <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>['profileimageurl'] = <a class="var it7923" onMouseOver="hilite(7923)" onMouseOut="lolite()" onClick="logVariable('userpicture')" href="../_variables/userpicture.html">$userpicture</a>-&gt;<a class="function" onClick="logFunction('get_url')" href="../_functions/get_url.html" onMouseOver="funcPopup(event,'get_url')">get_url</a>(<a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>)-&gt;<a class="function" onClick="logFunction('out')" href="../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>(false);
<a name="l583"><span class="linenum"> 583</span></a>              <a class="var it7923" onMouseOver="hilite(7923)" onMouseOut="lolite()" onClick="logVariable('userpicture')" href="../_variables/userpicture.html">$userpicture</a>-&gt;<a onClick="logVariable('size')" class="var it42996" onMouseOver="hilite(42996)" onMouseOut="lolite()" href="../_variables/size.html">size</a> = 0; <span class="comment">// Size f2.</span>
<a name="l584"><span class="linenum"> 584</span></a>              <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>['profileimageurlsmall'] = <a class="var it7923" onMouseOver="hilite(7923)" onMouseOut="lolite()" onClick="logVariable('userpicture')" href="../_variables/userpicture.html">$userpicture</a>-&gt;<a class="function" onClick="logFunction('get_url')" href="../_functions/get_url.html" onMouseOver="funcPopup(event,'get_url')">get_url</a>(<a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>)-&gt;<a class="function" onClick="logFunction('out')" href="../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>(false);
<a name="l585"><span class="linenum"> 585</span></a>  
<a name="l586"><span class="linenum"> 586</span></a>              <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>;
<a name="l587"><span class="linenum"> 587</span></a>          }
<a name="l588"><span class="linenum"> 588</span></a>  
<a name="l589"><span class="linenum"> 589</span></a>          return <a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../_variables/results.html">$results</a>;
<a name="l590"><span class="linenum"> 590</span></a>      }
<a name="l591"><span class="linenum"> 591</span></a>  
<a name="l592"><span class="linenum"> 592</span></a>      <span class="comment">/**</span>
<a name="l593"><span class="linenum"> 593</span></a>  <span class="comment">     * Search contacts return description.</span>
<a name="l594"><span class="linenum"> 594</span></a>  <span class="comment">     *</span>
<a name="l595"><span class="linenum"> 595</span></a>  <span class="comment">     * @return external_description</span>
<a name="l596"><span class="linenum"> 596</span></a>  <span class="comment">     * @since Moodle 2.5</span>
<a name="l597"><span class="linenum"> 597</span></a>  <span class="comment">     */</span>
<a name="l598"><span class="linenum"> 598</span></a>      public static function <a class="function" onClick="logFunction('search_contacts_returns')" href="../_functions/search_contacts_returns.html" onMouseOver="funcPopup(event,'search_contacts_returns')">search_contacts_returns</a>() {
<a name="l599"><span class="linenum"> 599</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_multiple_structure')" href="../_classes/external_multiple_structure.html" onMouseOver="classPopup(event,'external_multiple_structure')">external_multiple_structure</a>(
<a name="l600"><span class="linenum"> 600</span></a>              <span class="keyword">new </span><a class="class" onClick="logClass('external_single_structure')" href="../_classes/external_single_structure.html" onMouseOver="classPopup(event,'external_single_structure')">external_single_structure</a>(
<a name="l601"><span class="linenum"> 601</span></a>                  array(
<a name="l602"><span class="linenum"> 602</span></a>                      'id' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'User ID'),
<a name="l603"><span class="linenum"> 603</span></a>                      'fullname' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_NOTAGS')" href="../_constants/PARAM_NOTAGS.html" onMouseOver="constPopup(event,'PARAM_NOTAGS')">PARAM_NOTAGS</a>, 'User full name'),
<a name="l604"><span class="linenum"> 604</span></a>                      'profileimageurl' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_URL')" href="../_constants/PARAM_URL.html" onMouseOver="constPopup(event,'PARAM_URL')">PARAM_URL</a>, 'User picture URL', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l605"><span class="linenum"> 605</span></a>                      'profileimageurlsmall' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_URL')" href="../_constants/PARAM_URL.html" onMouseOver="constPopup(event,'PARAM_URL')">PARAM_URL</a>, 'Small user picture URL', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>)
<a name="l606"><span class="linenum"> 606</span></a>                  )
<a name="l607"><span class="linenum"> 607</span></a>              ),
<a name="l608"><span class="linenum"> 608</span></a>              'List of contacts'
<a name="l609"><span class="linenum"> 609</span></a>          );
<a name="l610"><span class="linenum"> 610</span></a>      }
<a name="l611"><span class="linenum"> 611</span></a>  
<a name="l612"><span class="linenum"> 612</span></a>      <span class="comment">/**</span>
<a name="l613"><span class="linenum"> 613</span></a>  <span class="comment">     * Get messages parameters description.</span>
<a name="l614"><span class="linenum"> 614</span></a>  <span class="comment">     *</span>
<a name="l615"><span class="linenum"> 615</span></a>  <span class="comment">     * @return external_function_parameters</span>
<a name="l616"><span class="linenum"> 616</span></a>  <span class="comment">     * @since 2.8</span>
<a name="l617"><span class="linenum"> 617</span></a>  <span class="comment">     */</span>
<a name="l618"><span class="linenum"> 618</span></a>      public static function <a class="function" onClick="logFunction('get_messages_parameters')" href="../_functions/get_messages_parameters.html" onMouseOver="funcPopup(event,'get_messages_parameters')">get_messages_parameters</a>() {
<a name="l619"><span class="linenum"> 619</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_function_parameters')" href="../_classes/external_function_parameters.html" onMouseOver="classPopup(event,'external_function_parameters')">external_function_parameters</a>(
<a name="l620"><span class="linenum"> 620</span></a>              array(
<a name="l621"><span class="linenum"> 621</span></a>                  'useridto' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'the user id who received the message, 0 for any user', <a class="constant" onClick="logConstant('VALUE_REQUIRED')" href="../_constants/VALUE_REQUIRED.html" onMouseOver="constPopup(event,'VALUE_REQUIRED')">VALUE_REQUIRED</a>),
<a name="l622"><span class="linenum"> 622</span></a>                  'useridfrom' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(
<a name="l623"><span class="linenum"> 623</span></a>                      <a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'the user id who send the message, 0 for any user. -10 or -20 for no-reply or support user',
<a name="l624"><span class="linenum"> 624</span></a>                      <a class="constant" onClick="logConstant('VALUE_DEFAULT')" href="../_constants/VALUE_DEFAULT.html" onMouseOver="constPopup(event,'VALUE_DEFAULT')">VALUE_DEFAULT</a>, 0),
<a name="l625"><span class="linenum"> 625</span></a>                  'type' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(
<a name="l626"><span class="linenum"> 626</span></a>                      <a class="constant" onClick="logConstant('PARAM_ALPHA')" href="../_constants/PARAM_ALPHA.html" onMouseOver="constPopup(event,'PARAM_ALPHA')">PARAM_ALPHA</a>, 'type of message to return, expected values are: notifications, conversations and both',
<a name="l627"><span class="linenum"> 627</span></a>                      <a class="constant" onClick="logConstant('VALUE_DEFAULT')" href="../_constants/VALUE_DEFAULT.html" onMouseOver="constPopup(event,'VALUE_DEFAULT')">VALUE_DEFAULT</a>, 'both'),
<a name="l628"><span class="linenum"> 628</span></a>                  'read' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_BOOL')" href="../_constants/PARAM_BOOL.html" onMouseOver="constPopup(event,'PARAM_BOOL')">PARAM_BOOL</a>, 'true for getting read messages, false for unread', <a class="constant" onClick="logConstant('VALUE_DEFAULT')" href="../_constants/VALUE_DEFAULT.html" onMouseOver="constPopup(event,'VALUE_DEFAULT')">VALUE_DEFAULT</a>, true),
<a name="l629"><span class="linenum"> 629</span></a>                  'newestfirst' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(
<a name="l630"><span class="linenum"> 630</span></a>                      <a class="constant" onClick="logConstant('PARAM_BOOL')" href="../_constants/PARAM_BOOL.html" onMouseOver="constPopup(event,'PARAM_BOOL')">PARAM_BOOL</a>, 'true for ordering by newest first, false for oldest first',
<a name="l631"><span class="linenum"> 631</span></a>                      <a class="constant" onClick="logConstant('VALUE_DEFAULT')" href="../_constants/VALUE_DEFAULT.html" onMouseOver="constPopup(event,'VALUE_DEFAULT')">VALUE_DEFAULT</a>, true),
<a name="l632"><span class="linenum"> 632</span></a>                  'limitfrom' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'limit from', <a class="constant" onClick="logConstant('VALUE_DEFAULT')" href="../_constants/VALUE_DEFAULT.html" onMouseOver="constPopup(event,'VALUE_DEFAULT')">VALUE_DEFAULT</a>, 0),
<a name="l633"><span class="linenum"> 633</span></a>                  'limitnum' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'limit number', <a class="constant" onClick="logConstant('VALUE_DEFAULT')" href="../_constants/VALUE_DEFAULT.html" onMouseOver="constPopup(event,'VALUE_DEFAULT')">VALUE_DEFAULT</a>, 0)
<a name="l634"><span class="linenum"> 634</span></a>              )
<a name="l635"><span class="linenum"> 635</span></a>          );
<a name="l636"><span class="linenum"> 636</span></a>      }
<a name="l637"><span class="linenum"> 637</span></a>  
<a name="l638"><span class="linenum"> 638</span></a>      <span class="comment">/**</span>
<a name="l639"><span class="linenum"> 639</span></a>  <span class="comment">     * Get messages function implementation.</span>
<a name="l640"><span class="linenum"> 640</span></a>  <span class="comment">     *</span>
<a name="l641"><span class="linenum"> 641</span></a>  <span class="comment">     * @since  2.8</span>
<a name="l642"><span class="linenum"> 642</span></a>  <span class="comment">     * @throws invalid_parameter_exception</span>
<a name="l643"><span class="linenum"> 643</span></a>  <span class="comment">     * @throws moodle_exception</span>
<a name="l644"><span class="linenum"> 644</span></a>  <span class="comment">     * @param  int      $useridto       the user id who received the message</span>
<a name="l645"><span class="linenum"> 645</span></a>  <span class="comment">     * @param  int      $useridfrom     the user id who send the message. -10 or -20 for no-reply or support user</span>
<a name="l646"><span class="linenum"> 646</span></a>  <span class="comment">     * @param  string   $type           type of message to return, expected values: notifications, conversations and both</span>
<a name="l647"><span class="linenum"> 647</span></a>  <span class="comment">     * @param  bool     $read           true for retreiving read messages, false for unread</span>
<a name="l648"><span class="linenum"> 648</span></a>  <span class="comment">     * @param  bool     $newestfirst    true for ordering by newest first, false for oldest first</span>
<a name="l649"><span class="linenum"> 649</span></a>  <span class="comment">     * @param  int      $limitfrom      limit from</span>
<a name="l650"><span class="linenum"> 650</span></a>  <span class="comment">     * @param  int      $limitnum       limit num</span>
<a name="l651"><span class="linenum"> 651</span></a>  <span class="comment">     * @return external_description</span>
<a name="l652"><span class="linenum"> 652</span></a>  <span class="comment">     */</span>
<a name="l653"><span class="linenum"> 653</span></a>      public static function <a class="function" onClick="logFunction('get_messages')" href="../_functions/get_messages.html" onMouseOver="funcPopup(event,'get_messages')">get_messages</a>(<a class="var it3418" onMouseOver="hilite(3418)" onMouseOut="lolite()" onClick="logVariable('useridto')" href="../_variables/useridto.html">$useridto</a>, <a class="var it3417" onMouseOver="hilite(3417)" onMouseOut="lolite()" onClick="logVariable('useridfrom')" href="../_variables/useridfrom.html">$useridfrom</a> = 0, <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a> = 'both', <a class="var it2155" onMouseOver="hilite(2155)" onMouseOut="lolite()" onClick="logVariable('read')" href="../_variables/read.html">$read</a> = true,
<a name="l654"><span class="linenum"> 654</span></a>                                          <a class="var it24833" onMouseOver="hilite(24833)" onMouseOut="lolite()" onClick="logVariable('newestfirst')" href="../_variables/newestfirst.html">$newestfirst</a> = true, <a class="var it1013" onMouseOver="hilite(1013)" onMouseOut="lolite()" onClick="logVariable('limitfrom')" href="../_variables/limitfrom.html">$limitfrom</a> = 0, <a class="var it1014" onMouseOver="hilite(1014)" onMouseOut="lolite()" onClick="logVariable('limitnum')" href="../_variables/limitnum.html">$limitnum</a> = 0) {
<a name="l655"><span class="linenum"> 655</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>;
<a name="l656"><span class="linenum"> 656</span></a>  
<a name="l657"><span class="linenum"> 657</span></a>          <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../_variables/warnings.html">$warnings</a> = array();
<a name="l658"><span class="linenum"> 658</span></a>  
<a name="l659"><span class="linenum"> 659</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array(
<a name="l660"><span class="linenum"> 660</span></a>              'useridto' =&gt; <a class="var it3418" onMouseOver="hilite(3418)" onMouseOut="lolite()" onClick="logVariable('useridto')" href="../_variables/useridto.html">$useridto</a>,
<a name="l661"><span class="linenum"> 661</span></a>              'useridfrom' =&gt; <a class="var it3417" onMouseOver="hilite(3417)" onMouseOut="lolite()" onClick="logVariable('useridfrom')" href="../_variables/useridfrom.html">$useridfrom</a>,
<a name="l662"><span class="linenum"> 662</span></a>              'type' =&gt; <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>,
<a name="l663"><span class="linenum"> 663</span></a>              'read' =&gt; <a class="var it2155" onMouseOver="hilite(2155)" onMouseOut="lolite()" onClick="logVariable('read')" href="../_variables/read.html">$read</a>,
<a name="l664"><span class="linenum"> 664</span></a>              'newestfirst' =&gt; <a class="var it24833" onMouseOver="hilite(24833)" onMouseOut="lolite()" onClick="logVariable('newestfirst')" href="../_variables/newestfirst.html">$newestfirst</a>,
<a name="l665"><span class="linenum"> 665</span></a>              'limitfrom' =&gt; <a class="var it1013" onMouseOver="hilite(1013)" onMouseOut="lolite()" onClick="logVariable('limitfrom')" href="../_variables/limitfrom.html">$limitfrom</a>,
<a name="l666"><span class="linenum"> 666</span></a>              'limitnum' =&gt; <a class="var it1014" onMouseOver="hilite(1014)" onMouseOut="lolite()" onClick="logVariable('limitnum')" href="../_variables/limitnum.html">$limitnum</a>
<a name="l667"><span class="linenum"> 667</span></a>          );
<a name="l668"><span class="linenum"> 668</span></a>  
<a name="l669"><span class="linenum"> 669</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = self::<a class="function" onClick="logFunction('validate_parameters')" href="../_functions/validate_parameters.html" onMouseOver="funcPopup(event,'validate_parameters')">validate_parameters</a>(self::<a class="function" onClick="logFunction('get_messages_parameters')" href="../_functions/get_messages_parameters.html" onMouseOver="funcPopup(event,'get_messages_parameters')">get_messages_parameters</a>(), <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>);
<a name="l670"><span class="linenum"> 670</span></a>  
<a name="l671"><span class="linenum"> 671</span></a>          <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_system')" href="../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>();
<a name="l672"><span class="linenum"> 672</span></a>          self::<a class="function" onClick="logFunction('validate_context')" href="../_functions/validate_context.html" onMouseOver="funcPopup(event,'validate_context')">validate_context</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>);
<a name="l673"><span class="linenum"> 673</span></a>  
<a name="l674"><span class="linenum"> 674</span></a>          <a class="var it3418" onMouseOver="hilite(3418)" onMouseOut="lolite()" onClick="logVariable('useridto')" href="../_variables/useridto.html">$useridto</a> = <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['useridto'];
<a name="l675"><span class="linenum"> 675</span></a>          <a class="var it3417" onMouseOver="hilite(3417)" onMouseOut="lolite()" onClick="logVariable('useridfrom')" href="../_variables/useridfrom.html">$useridfrom</a> = <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['useridfrom'];
<a name="l676"><span class="linenum"> 676</span></a>          <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a> = <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['type'];
<a name="l677"><span class="linenum"> 677</span></a>          <a class="var it2155" onMouseOver="hilite(2155)" onMouseOut="lolite()" onClick="logVariable('read')" href="../_variables/read.html">$read</a> = <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['read'];
<a name="l678"><span class="linenum"> 678</span></a>          <a class="var it24833" onMouseOver="hilite(24833)" onMouseOut="lolite()" onClick="logVariable('newestfirst')" href="../_variables/newestfirst.html">$newestfirst</a> = <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['newestfirst'];
<a name="l679"><span class="linenum"> 679</span></a>          <a class="var it1013" onMouseOver="hilite(1013)" onMouseOut="lolite()" onClick="logVariable('limitfrom')" href="../_variables/limitfrom.html">$limitfrom</a> = <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['limitfrom'];
<a name="l680"><span class="linenum"> 680</span></a>          <a class="var it1014" onMouseOver="hilite(1014)" onMouseOut="lolite()" onClick="logVariable('limitnum')" href="../_variables/limitnum.html">$limitnum</a> = <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['limitnum'];
<a name="l681"><span class="linenum"> 681</span></a>  
<a name="l682"><span class="linenum"> 682</span></a>          <a class="var it24834" onMouseOver="hilite(24834)" onMouseOut="lolite()" onClick="logVariable('allowedvalues')" href="../_variables/allowedvalues.html">$allowedvalues</a> = array('notifications', 'conversations', 'both');
<a name="l683"><span class="linenum"> 683</span></a>          if (!<a class="phpfunction" onClick="logFunction('in_array')" href="../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a>, <a class="var it24834" onMouseOver="hilite(24834)" onMouseOut="lolite()" onClick="logVariable('allowedvalues')" href="../_variables/allowedvalues.html">$allowedvalues</a>)) {
<a name="l684"><span class="linenum"> 684</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('invalid_parameter_exception')" href="../_classes/invalid_parameter_exception.html" onMouseOver="classPopup(event,'invalid_parameter_exception')">invalid_parameter_exception</a>('Invalid value for type <a class="function" onClick="logFunction('parameter')" href="../_functions/parameter.html" onMouseOver="funcPopup(event,'parameter')">parameter</a> (value: ' . <a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a> . '),' .
<a name="l685"><span class="linenum"> 685</span></a>                  'allowed values are: ' . <a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(',', <a class="var it24834" onMouseOver="hilite(24834)" onMouseOut="lolite()" onClick="logVariable('allowedvalues')" href="../_variables/allowedvalues.html">$allowedvalues</a>));
<a name="l686"><span class="linenum"> 686</span></a>          }
<a name="l687"><span class="linenum"> 687</span></a>  
<a name="l688"><span class="linenum"> 688</span></a>  <span class="comment">        // Check if private messaging between users is allowed.</span>
<a name="l689"><span class="linenum"> 689</span></a>          if (empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('messaging')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/messaging.html">messaging</a>)) {
<a name="l690"><span class="linenum"> 690</span></a>  <span class="comment">            // If we are retreiving only conversations, and messaging is disabled, throw an exception.</span>
<a name="l691"><span class="linenum"> 691</span></a>              if (<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a> == &quot;conversations&quot;) {
<a name="l692"><span class="linenum"> 692</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('disabled', 'message');
<a name="l693"><span class="linenum"> 693</span></a>              }
<a name="l694"><span class="linenum"> 694</span></a>              if (<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a> == &quot;both&quot;) {
<a name="l695"><span class="linenum"> 695</span></a>                  <a class="var it3502" onMouseOver="hilite(3502)" onMouseOut="lolite()" onClick="logVariable('warning')" href="../_variables/warning.html">$warning</a> = array();
<a name="l696"><span class="linenum"> 696</span></a>                  <a class="var it3502" onMouseOver="hilite(3502)" onMouseOut="lolite()" onClick="logVariable('warning')" href="../_variables/warning.html">$warning</a>['item'] = 'message';
<a name="l697"><span class="linenum"> 697</span></a>                  <a class="var it3502" onMouseOver="hilite(3502)" onMouseOut="lolite()" onClick="logVariable('warning')" href="../_variables/warning.html">$warning</a>['itemid'] = <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../_variables/id.html">id</a>;
<a name="l698"><span class="linenum"> 698</span></a>                  <a class="var it3502" onMouseOver="hilite(3502)" onMouseOut="lolite()" onClick="logVariable('warning')" href="../_variables/warning.html">$warning</a>['warningcode'] = '1';
<a name="l699"><span class="linenum"> 699</span></a>                  <a class="var it3502" onMouseOver="hilite(3502)" onMouseOut="lolite()" onClick="logVariable('warning')" href="../_variables/warning.html">$warning</a>['message'] = 'Private messages (conversations) are not enabled in this site.
<a name="l700"><span class="linenum"> 700</span></a>                      Only notifications will be returned';
<a name="l701"><span class="linenum"> 701</span></a>                  <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../_variables/warnings.html">$warnings</a>[] = <a class="var it3502" onMouseOver="hilite(3502)" onMouseOut="lolite()" onClick="logVariable('warning')" href="../_variables/warning.html">$warning</a>;
<a name="l702"><span class="linenum"> 702</span></a>              }
<a name="l703"><span class="linenum"> 703</span></a>          }
<a name="l704"><span class="linenum"> 704</span></a>  
<a name="l705"><span class="linenum"> 705</span></a>          if (!empty(<a class="var it3418" onMouseOver="hilite(3418)" onMouseOut="lolite()" onClick="logVariable('useridto')" href="../_variables/useridto.html">$useridto</a>)) {
<a name="l706"><span class="linenum"> 706</span></a>              if (<a class="class" onClick="logClass('core_user')" href="../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('is_real_user')" href="../_functions/is_real_user.html" onMouseOver="funcPopup(event,'is_real_user')">is_real_user</a>(<a class="var it3418" onMouseOver="hilite(3418)" onMouseOut="lolite()" onClick="logVariable('useridto')" href="../_variables/useridto.html">$useridto</a>)) {
<a name="l707"><span class="linenum"> 707</span></a>                  <a class="var it6922" onMouseOver="hilite(6922)" onMouseOut="lolite()" onClick="logVariable('userto')" href="../_variables/userto.html">$userto</a> = <a class="class" onClick="logClass('core_user')" href="../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('get_user')" href="../_functions/get_user.html" onMouseOver="funcPopup(event,'get_user')">get_user</a>(<a class="var it3418" onMouseOver="hilite(3418)" onMouseOut="lolite()" onClick="logVariable('useridto')" href="../_variables/useridto.html">$useridto</a>, '*', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l708"><span class="linenum"> 708</span></a>              } else {
<a name="l709"><span class="linenum"> 709</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('invaliduser');
<a name="l710"><span class="linenum"> 710</span></a>              }
<a name="l711"><span class="linenum"> 711</span></a>          }
<a name="l712"><span class="linenum"> 712</span></a>  
<a name="l713"><span class="linenum"> 713</span></a>          if (!empty(<a class="var it3417" onMouseOver="hilite(3417)" onMouseOut="lolite()" onClick="logVariable('useridfrom')" href="../_variables/useridfrom.html">$useridfrom</a>)) {
<a name="l714"><span class="linenum"> 714</span></a>  <span class="comment">            // We use get_user here because the from user can be the noreply or support user.</span>
<a name="l715"><span class="linenum"> 715</span></a>              <a class="var it6660" onMouseOver="hilite(6660)" onMouseOut="lolite()" onClick="logVariable('userfrom')" href="../_variables/userfrom.html">$userfrom</a> = <a class="class" onClick="logClass('core_user')" href="../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('get_user')" href="../_functions/get_user.html" onMouseOver="funcPopup(event,'get_user')">get_user</a>(<a class="var it3417" onMouseOver="hilite(3417)" onMouseOut="lolite()" onClick="logVariable('useridfrom')" href="../_variables/useridfrom.html">$useridfrom</a>, '*', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l716"><span class="linenum"> 716</span></a>          }
<a name="l717"><span class="linenum"> 717</span></a>  
<a name="l718"><span class="linenum"> 718</span></a>  <span class="comment">        // Check if the current user is the sender/receiver or just a privileged user.</span>
<a name="l719"><span class="linenum"> 719</span></a>          if (<a class="var it3418" onMouseOver="hilite(3418)" onMouseOut="lolite()" onClick="logVariable('useridto')" href="../_variables/useridto.html">$useridto</a> != <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../_variables/id.html">id</a> and <a class="var it3417" onMouseOver="hilite(3417)" onMouseOut="lolite()" onClick="logVariable('useridfrom')" href="../_variables/useridfrom.html">$useridfrom</a> != <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../_variables/id.html">id</a> and
<a name="l720"><span class="linenum"> 720</span></a>               !<a class="function" onClick="logFunction('has_capability')" href="../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/site:readallmessages', <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>)) {
<a name="l721"><span class="linenum"> 721</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('accessdenied', 'admin');
<a name="l722"><span class="linenum"> 722</span></a>          }
<a name="l723"><span class="linenum"> 723</span></a>  
<a name="l724"><span class="linenum"> 724</span></a>  <span class="comment">        // Which type of messages to retrieve.</span>
<a name="l725"><span class="linenum"> 725</span></a>          <a class="var it1809" onMouseOver="hilite(1809)" onMouseOut="lolite()" onClick="logVariable('notifications')" href="../_variables/notifications.html">$notifications</a> = -1;
<a name="l726"><span class="linenum"> 726</span></a>          if (<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a> != 'both') {
<a name="l727"><span class="linenum"> 727</span></a>              <a class="var it1809" onMouseOver="hilite(1809)" onMouseOut="lolite()" onClick="logVariable('notifications')" href="../_variables/notifications.html">$notifications</a> = (<a class="var it90" onMouseOver="hilite(90)" onMouseOut="lolite()" onClick="logVariable('type')" href="../_variables/type.html">$type</a> == 'notifications') ? 1 : 0;
<a name="l728"><span class="linenum"> 728</span></a>          }
<a name="l729"><span class="linenum"> 729</span></a>  
<a name="l730"><span class="linenum"> 730</span></a>          <a class="var it24835" onMouseOver="hilite(24835)" onMouseOut="lolite()" onClick="logVariable('orderdirection')" href="../_variables/orderdirection.html">$orderdirection</a> = <a class="var it24833" onMouseOver="hilite(24833)" onMouseOut="lolite()" onClick="logVariable('newestfirst')" href="../_variables/newestfirst.html">$newestfirst</a> ? 'DESC' : 'ASC';
<a name="l731"><span class="linenum"> 731</span></a>          <a class="var it1015" onMouseOver="hilite(1015)" onMouseOut="lolite()" onClick="logVariable('sort')" href="../_variables/sort.html">$sort</a> = &quot;mr.timecreated <a class="var it24835" onMouseOver="hilite(24835)" onMouseOut="lolite()" onClick="logVariable('orderdirection')" href="../_variables/orderdirection.html">$orderdirection</a>&quot;;
<a name="l732"><span class="linenum"> 732</span></a>  
<a name="l733"><span class="linenum"> 733</span></a>          if (<a class="var it925" onMouseOver="hilite(925)" onMouseOut="lolite()" onClick="logVariable('messages')" href="../_variables/messages.html">$messages</a> = <a class="function" onClick="logFunction('message_get_messages')" href="../_functions/message_get_messages.html" onMouseOver="funcPopup(event,'message_get_messages')">message_get_messages</a>(<a class="var it3418" onMouseOver="hilite(3418)" onMouseOut="lolite()" onClick="logVariable('useridto')" href="../_variables/useridto.html">$useridto</a>, <a class="var it3417" onMouseOver="hilite(3417)" onMouseOut="lolite()" onClick="logVariable('useridfrom')" href="../_variables/useridfrom.html">$useridfrom</a>, <a class="var it1809" onMouseOver="hilite(1809)" onMouseOut="lolite()" onClick="logVariable('notifications')" href="../_variables/notifications.html">$notifications</a>, <a class="var it2155" onMouseOver="hilite(2155)" onMouseOut="lolite()" onClick="logVariable('read')" href="../_variables/read.html">$read</a>, <a class="var it1015" onMouseOver="hilite(1015)" onMouseOut="lolite()" onClick="logVariable('sort')" href="../_variables/sort.html">$sort</a>, <a class="var it1013" onMouseOver="hilite(1013)" onMouseOut="lolite()" onClick="logVariable('limitfrom')" href="../_variables/limitfrom.html">$limitfrom</a>, <a class="var it1014" onMouseOver="hilite(1014)" onMouseOut="lolite()" onClick="logVariable('limitnum')" href="../_variables/limitnum.html">$limitnum</a>)) {
<a name="l734"><span class="linenum"> 734</span></a>              <a class="var it24836" onMouseOver="hilite(24836)" onMouseOut="lolite()" onClick="logVariable('canviewfullname')" href="../_variables/canviewfullname.html">$canviewfullname</a> = <a class="function" onClick="logFunction('has_capability')" href="../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/site:viewfullnames', <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>);
<a name="l735"><span class="linenum"> 735</span></a>  
<a name="l736"><span class="linenum"> 736</span></a>  <span class="comment">            // In some cases, we don't need to get the to/from user objects from the sql query.</span>
<a name="l737"><span class="linenum"> 737</span></a>              <a class="var it24837" onMouseOver="hilite(24837)" onMouseOut="lolite()" onClick="logVariable('userfromfullname')" href="../_variables/userfromfullname.html">$userfromfullname</a> = '';
<a name="l738"><span class="linenum"> 738</span></a>              <a class="var it24838" onMouseOver="hilite(24838)" onMouseOut="lolite()" onClick="logVariable('usertofullname')" href="../_variables/usertofullname.html">$usertofullname</a> = '';
<a name="l739"><span class="linenum"> 739</span></a>  
<a name="l740"><span class="linenum"> 740</span></a>  <span class="comment">            // In this case, the useridto field is not empty, so we can get the user destinatary fullname from there.</span>
<a name="l741"><span class="linenum"> 741</span></a>              if (!empty(<a class="var it3418" onMouseOver="hilite(3418)" onMouseOut="lolite()" onClick="logVariable('useridto')" href="../_variables/useridto.html">$useridto</a>)) {
<a name="l742"><span class="linenum"> 742</span></a>                  <a class="var it24838" onMouseOver="hilite(24838)" onMouseOut="lolite()" onClick="logVariable('usertofullname')" href="../_variables/usertofullname.html">$usertofullname</a> = <a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it6922" onMouseOver="hilite(6922)" onMouseOut="lolite()" onClick="logVariable('userto')" href="../_variables/userto.html">$userto</a>, <a class="var it24836" onMouseOver="hilite(24836)" onMouseOut="lolite()" onClick="logVariable('canviewfullname')" href="../_variables/canviewfullname.html">$canviewfullname</a>);
<a name="l743"><span class="linenum"> 743</span></a>  <span class="comment">                // The user from may or may not be filled.</span>
<a name="l744"><span class="linenum"> 744</span></a>                  if (!empty(<a class="var it3417" onMouseOver="hilite(3417)" onMouseOut="lolite()" onClick="logVariable('useridfrom')" href="../_variables/useridfrom.html">$useridfrom</a>)) {
<a name="l745"><span class="linenum"> 745</span></a>                      <a class="var it24837" onMouseOver="hilite(24837)" onMouseOut="lolite()" onClick="logVariable('userfromfullname')" href="../_variables/userfromfullname.html">$userfromfullname</a> = <a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it6660" onMouseOver="hilite(6660)" onMouseOut="lolite()" onClick="logVariable('userfrom')" href="../_variables/userfrom.html">$userfrom</a>, <a class="var it24836" onMouseOver="hilite(24836)" onMouseOut="lolite()" onClick="logVariable('canviewfullname')" href="../_variables/canviewfullname.html">$canviewfullname</a>);
<a name="l746"><span class="linenum"> 746</span></a>                  }
<a name="l747"><span class="linenum"> 747</span></a>              } else {
<a name="l748"><span class="linenum"> 748</span></a>  <span class="comment">                // If the useridto field is empty, the useridfrom must be filled.</span>
<a name="l749"><span class="linenum"> 749</span></a>                  <a class="var it24837" onMouseOver="hilite(24837)" onMouseOut="lolite()" onClick="logVariable('userfromfullname')" href="../_variables/userfromfullname.html">$userfromfullname</a> = <a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it6660" onMouseOver="hilite(6660)" onMouseOut="lolite()" onClick="logVariable('userfrom')" href="../_variables/userfrom.html">$userfrom</a>, <a class="var it24836" onMouseOver="hilite(24836)" onMouseOut="lolite()" onClick="logVariable('canviewfullname')" href="../_variables/canviewfullname.html">$canviewfullname</a>);
<a name="l750"><span class="linenum"> 750</span></a>              }
<a name="l751"><span class="linenum"> 751</span></a>              foreach (<a class="var it925" onMouseOver="hilite(925)" onMouseOut="lolite()" onClick="logVariable('messages')" href="../_variables/messages.html">$messages</a> as <a class="var it4734" onMouseOver="hilite(4734)" onMouseOut="lolite()" onClick="logVariable('mid')" href="../_variables/mid.html">$mid</a> =&gt; <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>) {
<a name="l752"><span class="linenum"> 752</span></a>  
<a name="l753"><span class="linenum"> 753</span></a>  <span class="comment">                // Do not return deleted messages.</span>
<a name="l754"><span class="linenum"> 754</span></a>                  if ((<a class="var it3418" onMouseOver="hilite(3418)" onMouseOut="lolite()" onClick="logVariable('useridto')" href="../_variables/useridto.html">$useridto</a> == <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../_variables/id.html">id</a> and <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>-&gt;<a onClick="logVariable('timeusertodeleted')" class="var it42910" onMouseOver="hilite(42910)" onMouseOut="lolite()" href="../_variables/timeusertodeleted.html">timeusertodeleted</a>) or
<a name="l755"><span class="linenum"> 755</span></a>                          (<a class="var it3417" onMouseOver="hilite(3417)" onMouseOut="lolite()" onClick="logVariable('useridfrom')" href="../_variables/useridfrom.html">$useridfrom</a> == <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../_variables/id.html">id</a> and <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>-&gt;<a onClick="logVariable('timeuserfromdeleted')" class="var it42910" onMouseOver="hilite(42910)" onMouseOut="lolite()" href="../_variables/timeuserfromdeleted.html">timeuserfromdeleted</a>)) {
<a name="l756"><span class="linenum"> 756</span></a>  
<a name="l757"><span class="linenum"> 757</span></a>                      unset(<a class="var it925" onMouseOver="hilite(925)" onMouseOut="lolite()" onClick="logVariable('messages')" href="../_variables/messages.html">$messages</a>[<a class="var it4734" onMouseOver="hilite(4734)" onMouseOut="lolite()" onClick="logVariable('mid')" href="../_variables/mid.html">$mid</a>]);
<a name="l758"><span class="linenum"> 758</span></a>                      continue;
<a name="l759"><span class="linenum"> 759</span></a>                  }
<a name="l760"><span class="linenum"> 760</span></a>  
<a name="l761"><span class="linenum"> 761</span></a>  <span class="comment">                // We need to get the user from the query.</span>
<a name="l762"><span class="linenum"> 762</span></a>                  if (empty(<a class="var it24837" onMouseOver="hilite(24837)" onMouseOut="lolite()" onClick="logVariable('userfromfullname')" href="../_variables/userfromfullname.html">$userfromfullname</a>)) {
<a name="l763"><span class="linenum"> 763</span></a>  <span class="comment">                    // Check for non-reply and support users.</span>
<a name="l764"><span class="linenum"> 764</span></a>                      if (<a class="class" onClick="logClass('core_user')" href="../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('is_real_user')" href="../_functions/is_real_user.html" onMouseOver="funcPopup(event,'is_real_user')">is_real_user</a>(<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>-&gt;<a onClick="logVariable('useridfrom')" class="var it42910" onMouseOver="hilite(42910)" onMouseOut="lolite()" href="../_variables/useridfrom.html">useridfrom</a>)) {
<a name="l765"><span class="linenum"> 765</span></a>                          <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = new stdClass();
<a name="l766"><span class="linenum"> 766</span></a>                          <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="function" onClick="logFunction('username_load_fields_from_object')" href="../_functions/username_load_fields_from_object.html" onMouseOver="funcPopup(event,'username_load_fields_from_object')">username_load_fields_from_object</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>, 'userfrom');
<a name="l767"><span class="linenum"> 767</span></a>                          <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>-&gt;<a onClick="logVariable('userfromfullname')" class="var it42910" onMouseOver="hilite(42910)" onMouseOut="lolite()" href="../_variables/userfromfullname.html">userfromfullname</a> = <a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it24836" onMouseOver="hilite(24836)" onMouseOut="lolite()" onClick="logVariable('canviewfullname')" href="../_variables/canviewfullname.html">$canviewfullname</a>);
<a name="l768"><span class="linenum"> 768</span></a>                      } else {
<a name="l769"><span class="linenum"> 769</span></a>                          <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="class" onClick="logClass('core_user')" href="../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('get_user')" href="../_functions/get_user.html" onMouseOver="funcPopup(event,'get_user')">get_user</a>(<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>-&gt;<a onClick="logVariable('useridfrom')" class="var it42910" onMouseOver="hilite(42910)" onMouseOut="lolite()" href="../_variables/useridfrom.html">useridfrom</a>);
<a name="l770"><span class="linenum"> 770</span></a>                          <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>-&gt;<a onClick="logVariable('userfromfullname')" class="var it42910" onMouseOver="hilite(42910)" onMouseOut="lolite()" href="../_variables/userfromfullname.html">userfromfullname</a> = <a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it24836" onMouseOver="hilite(24836)" onMouseOut="lolite()" onClick="logVariable('canviewfullname')" href="../_variables/canviewfullname.html">$canviewfullname</a>);
<a name="l771"><span class="linenum"> 771</span></a>                      }
<a name="l772"><span class="linenum"> 772</span></a>                  } else {
<a name="l773"><span class="linenum"> 773</span></a>                      <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>-&gt;<a onClick="logVariable('userfromfullname')" class="var it42910" onMouseOver="hilite(42910)" onMouseOut="lolite()" href="../_variables/userfromfullname.html">userfromfullname</a> = <a class="var it24837" onMouseOver="hilite(24837)" onMouseOut="lolite()" onClick="logVariable('userfromfullname')" href="../_variables/userfromfullname.html">$userfromfullname</a>;
<a name="l774"><span class="linenum"> 774</span></a>                  }
<a name="l775"><span class="linenum"> 775</span></a>  
<a name="l776"><span class="linenum"> 776</span></a>  <span class="comment">                // We need to get the user from the query.</span>
<a name="l777"><span class="linenum"> 777</span></a>                  if (empty(<a class="var it24838" onMouseOver="hilite(24838)" onMouseOut="lolite()" onClick="logVariable('usertofullname')" href="../_variables/usertofullname.html">$usertofullname</a>)) {
<a name="l778"><span class="linenum"> 778</span></a>                      <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = new stdClass();
<a name="l779"><span class="linenum"> 779</span></a>                      <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="function" onClick="logFunction('username_load_fields_from_object')" href="../_functions/username_load_fields_from_object.html" onMouseOver="funcPopup(event,'username_load_fields_from_object')">username_load_fields_from_object</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>, 'userto');
<a name="l780"><span class="linenum"> 780</span></a>                      <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>-&gt;<a onClick="logVariable('usertofullname')" class="var it42910" onMouseOver="hilite(42910)" onMouseOut="lolite()" href="../_variables/usertofullname.html">usertofullname</a> = <a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it24836" onMouseOver="hilite(24836)" onMouseOut="lolite()" onClick="logVariable('canviewfullname')" href="../_variables/canviewfullname.html">$canviewfullname</a>);
<a name="l781"><span class="linenum"> 781</span></a>                  } else {
<a name="l782"><span class="linenum"> 782</span></a>                      <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>-&gt;<a onClick="logVariable('usertofullname')" class="var it42910" onMouseOver="hilite(42910)" onMouseOut="lolite()" href="../_variables/usertofullname.html">usertofullname</a> = <a class="var it24838" onMouseOver="hilite(24838)" onMouseOut="lolite()" onClick="logVariable('usertofullname')" href="../_variables/usertofullname.html">$usertofullname</a>;
<a name="l783"><span class="linenum"> 783</span></a>                  }
<a name="l784"><span class="linenum"> 784</span></a>  
<a name="l785"><span class="linenum"> 785</span></a>  <span class="comment">                // This field is only available in the message_read table.</span>
<a name="l786"><span class="linenum"> 786</span></a>                  if (!isset(<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>-&gt;<a onClick="logVariable('timeread')" class="var it42910" onMouseOver="hilite(42910)" onMouseOut="lolite()" href="../_variables/timeread.html">timeread</a>)) {
<a name="l787"><span class="linenum"> 787</span></a>                      <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>-&gt;<a onClick="logVariable('timeread')" class="var it42910" onMouseOver="hilite(42910)" onMouseOut="lolite()" href="../_variables/timeread.html">timeread</a> = 0;
<a name="l788"><span class="linenum"> 788</span></a>                  }
<a name="l789"><span class="linenum"> 789</span></a>  
<a name="l790"><span class="linenum"> 790</span></a>                  <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>-&gt;<a onClick="logVariable('text')" class="var it42910" onMouseOver="hilite(42910)" onMouseOut="lolite()" href="../_variables/text.html">text</a> = <a class="function" onClick="logFunction('message_format_message_text')" href="../_functions/message_format_message_text.html" onMouseOver="funcPopup(event,'message_format_message_text')">message_format_message_text</a>(<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>);
<a name="l791"><span class="linenum"> 791</span></a>                  <a class="var it925" onMouseOver="hilite(925)" onMouseOut="lolite()" onClick="logVariable('messages')" href="../_variables/messages.html">$messages</a>[<a class="var it4734" onMouseOver="hilite(4734)" onMouseOut="lolite()" onClick="logVariable('mid')" href="../_variables/mid.html">$mid</a>] = (array) <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>;
<a name="l792"><span class="linenum"> 792</span></a>              }
<a name="l793"><span class="linenum"> 793</span></a>          }
<a name="l794"><span class="linenum"> 794</span></a>  
<a name="l795"><span class="linenum"> 795</span></a>          <a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../_variables/results.html">$results</a> = array(
<a name="l796"><span class="linenum"> 796</span></a>              'messages' =&gt; <a class="var it925" onMouseOver="hilite(925)" onMouseOut="lolite()" onClick="logVariable('messages')" href="../_variables/messages.html">$messages</a>,
<a name="l797"><span class="linenum"> 797</span></a>              'warnings' =&gt; <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../_variables/warnings.html">$warnings</a>
<a name="l798"><span class="linenum"> 798</span></a>          );
<a name="l799"><span class="linenum"> 799</span></a>  
<a name="l800"><span class="linenum"> 800</span></a>          return <a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../_variables/results.html">$results</a>;
<a name="l801"><span class="linenum"> 801</span></a>      }
<a name="l802"><span class="linenum"> 802</span></a>  
<a name="l803"><span class="linenum"> 803</span></a>      <span class="comment">/**</span>
<a name="l804"><span class="linenum"> 804</span></a>  <span class="comment">     * Get messages return description.</span>
<a name="l805"><span class="linenum"> 805</span></a>  <span class="comment">     *</span>
<a name="l806"><span class="linenum"> 806</span></a>  <span class="comment">     * @return external_single_structure</span>
<a name="l807"><span class="linenum"> 807</span></a>  <span class="comment">     * @since 2.8</span>
<a name="l808"><span class="linenum"> 808</span></a>  <span class="comment">     */</span>
<a name="l809"><span class="linenum"> 809</span></a>      public static function <a class="function" onClick="logFunction('get_messages_returns')" href="../_functions/get_messages_returns.html" onMouseOver="funcPopup(event,'get_messages_returns')">get_messages_returns</a>() {
<a name="l810"><span class="linenum"> 810</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_single_structure')" href="../_classes/external_single_structure.html" onMouseOver="classPopup(event,'external_single_structure')">external_single_structure</a>(
<a name="l811"><span class="linenum"> 811</span></a>              array(
<a name="l812"><span class="linenum"> 812</span></a>                  'messages' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_multiple_structure')" href="../_classes/external_multiple_structure.html" onMouseOver="classPopup(event,'external_multiple_structure')">external_multiple_structure</a>(
<a name="l813"><span class="linenum"> 813</span></a>                      <span class="keyword">new </span><a class="class" onClick="logClass('external_single_structure')" href="../_classes/external_single_structure.html" onMouseOver="classPopup(event,'external_single_structure')">external_single_structure</a>(
<a name="l814"><span class="linenum"> 814</span></a>                          array(
<a name="l815"><span class="linenum"> 815</span></a>                              'id' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'Message id'),
<a name="l816"><span class="linenum"> 816</span></a>                              'useridfrom' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'User from id'),
<a name="l817"><span class="linenum"> 817</span></a>                              'useridto' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'User to id'),
<a name="l818"><span class="linenum"> 818</span></a>                              'subject' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_TEXT')" href="../_constants/PARAM_TEXT.html" onMouseOver="constPopup(event,'PARAM_TEXT')">PARAM_TEXT</a>, 'The message subject'),
<a name="l819"><span class="linenum"> 819</span></a>                              'text' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_RAW')" href="../_constants/PARAM_RAW.html" onMouseOver="constPopup(event,'PARAM_RAW')">PARAM_RAW</a>, 'The message text formated'),
<a name="l820"><span class="linenum"> 820</span></a>                              'fullmessage' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_RAW')" href="../_constants/PARAM_RAW.html" onMouseOver="constPopup(event,'PARAM_RAW')">PARAM_RAW</a>, 'The message'),
<a name="l821"><span class="linenum"> 821</span></a>                              'fullmessageformat' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_format_value')" href="../_classes/external_format_value.html" onMouseOver="classPopup(event,'external_format_value')">external_format_value</a>('fullmessage'),
<a name="l822"><span class="linenum"> 822</span></a>                              'fullmessagehtml' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_RAW')" href="../_constants/PARAM_RAW.html" onMouseOver="constPopup(event,'PARAM_RAW')">PARAM_RAW</a>, 'The message in html'),
<a name="l823"><span class="linenum"> 823</span></a>                              'smallmessage' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_RAW')" href="../_constants/PARAM_RAW.html" onMouseOver="constPopup(event,'PARAM_RAW')">PARAM_RAW</a>, 'The shorten message'),
<a name="l824"><span class="linenum"> 824</span></a>                              'notification' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'Is a notification?'),
<a name="l825"><span class="linenum"> 825</span></a>                              'contexturl' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_RAW')" href="../_constants/PARAM_RAW.html" onMouseOver="constPopup(event,'PARAM_RAW')">PARAM_RAW</a>, 'Context URL'),
<a name="l826"><span class="linenum"> 826</span></a>                              'contexturlname' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_TEXT')" href="../_constants/PARAM_TEXT.html" onMouseOver="constPopup(event,'PARAM_TEXT')">PARAM_TEXT</a>, 'Context URL link name'),
<a name="l827"><span class="linenum"> 827</span></a>                              'timecreated' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'Time created'),
<a name="l828"><span class="linenum"> 828</span></a>                              'timeread' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'Time read'),
<a name="l829"><span class="linenum"> 829</span></a>                              'usertofullname' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_TEXT')" href="../_constants/PARAM_TEXT.html" onMouseOver="constPopup(event,'PARAM_TEXT')">PARAM_TEXT</a>, 'User to full name'),
<a name="l830"><span class="linenum"> 830</span></a>                              'userfromfullname' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_TEXT')" href="../_constants/PARAM_TEXT.html" onMouseOver="constPopup(event,'PARAM_TEXT')">PARAM_TEXT</a>, 'User from full name')
<a name="l831"><span class="linenum"> 831</span></a>                          ), 'message'
<a name="l832"><span class="linenum"> 832</span></a>                      )
<a name="l833"><span class="linenum"> 833</span></a>                  ),
<a name="l834"><span class="linenum"> 834</span></a>                  'warnings' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_warnings')" href="../_classes/external_warnings.html" onMouseOver="classPopup(event,'external_warnings')">external_warnings</a>()
<a name="l835"><span class="linenum"> 835</span></a>              )
<a name="l836"><span class="linenum"> 836</span></a>          );
<a name="l837"><span class="linenum"> 837</span></a>      }
<a name="l838"><span class="linenum"> 838</span></a>  
<a name="l839"><span class="linenum"> 839</span></a>      <span class="comment">/**</span>
<a name="l840"><span class="linenum"> 840</span></a>  <span class="comment">     * Get blocked users parameters description.</span>
<a name="l841"><span class="linenum"> 841</span></a>  <span class="comment">     *</span>
<a name="l842"><span class="linenum"> 842</span></a>  <span class="comment">     * @return external_function_parameters</span>
<a name="l843"><span class="linenum"> 843</span></a>  <span class="comment">     * @since 2.9</span>
<a name="l844"><span class="linenum"> 844</span></a>  <span class="comment">     */</span>
<a name="l845"><span class="linenum"> 845</span></a>      public static function <a class="function" onClick="logFunction('get_blocked_users_parameters')" href="../_functions/get_blocked_users_parameters.html" onMouseOver="funcPopup(event,'get_blocked_users_parameters')">get_blocked_users_parameters</a>() {
<a name="l846"><span class="linenum"> 846</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_function_parameters')" href="../_classes/external_function_parameters.html" onMouseOver="classPopup(event,'external_function_parameters')">external_function_parameters</a>(
<a name="l847"><span class="linenum"> 847</span></a>              array(
<a name="l848"><span class="linenum"> 848</span></a>                  'userid' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>,
<a name="l849"><span class="linenum"> 849</span></a>                                  'the user whose blocked users we want to retrieve',
<a name="l850"><span class="linenum"> 850</span></a>                                  <a class="constant" onClick="logConstant('VALUE_REQUIRED')" href="../_constants/VALUE_REQUIRED.html" onMouseOver="constPopup(event,'VALUE_REQUIRED')">VALUE_REQUIRED</a>),
<a name="l851"><span class="linenum"> 851</span></a>              )
<a name="l852"><span class="linenum"> 852</span></a>          );
<a name="l853"><span class="linenum"> 853</span></a>      }
<a name="l854"><span class="linenum"> 854</span></a>  
<a name="l855"><span class="linenum"> 855</span></a>      <span class="comment">/**</span>
<a name="l856"><span class="linenum"> 856</span></a>  <span class="comment">     * Retrieve a list of users blocked</span>
<a name="l857"><span class="linenum"> 857</span></a>  <span class="comment">     *</span>
<a name="l858"><span class="linenum"> 858</span></a>  <span class="comment">     * @param  int $userid the user whose blocked users we want to retrieve</span>
<a name="l859"><span class="linenum"> 859</span></a>  <span class="comment">     * @return external_description</span>
<a name="l860"><span class="linenum"> 860</span></a>  <span class="comment">     * @since 2.9</span>
<a name="l861"><span class="linenum"> 861</span></a>  <span class="comment">     */</span>
<a name="l862"><span class="linenum"> 862</span></a>      public static function <a class="function" onClick="logFunction('get_blocked_users')" href="../_functions/get_blocked_users.html" onMouseOver="funcPopup(event,'get_blocked_users')">get_blocked_users</a>(<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>) {
<a name="l863"><span class="linenum"> 863</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>, <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>;
<a name="l864"><span class="linenum"> 864</span></a>  
<a name="l865"><span class="linenum"> 865</span></a>  <span class="comment">        // Warnings array, it can be empty at the end but is mandatory.</span>
<a name="l866"><span class="linenum"> 866</span></a>          <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../_variables/warnings.html">$warnings</a> = array();
<a name="l867"><span class="linenum"> 867</span></a>  
<a name="l868"><span class="linenum"> 868</span></a>  <span class="comment">        // Validate params.</span>
<a name="l869"><span class="linenum"> 869</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array(
<a name="l870"><span class="linenum"> 870</span></a>              'userid' =&gt; <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>
<a name="l871"><span class="linenum"> 871</span></a>          );
<a name="l872"><span class="linenum"> 872</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = self::<a class="function" onClick="logFunction('validate_parameters')" href="../_functions/validate_parameters.html" onMouseOver="funcPopup(event,'validate_parameters')">validate_parameters</a>(self::<a class="function" onClick="logFunction('get_blocked_users_parameters')" href="../_functions/get_blocked_users_parameters.html" onMouseOver="funcPopup(event,'get_blocked_users_parameters')">get_blocked_users_parameters</a>(), <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>);
<a name="l873"><span class="linenum"> 873</span></a>          <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a> = <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['userid'];
<a name="l874"><span class="linenum"> 874</span></a>  
<a name="l875"><span class="linenum"> 875</span></a>  <span class="comment">        // Validate context.</span>
<a name="l876"><span class="linenum"> 876</span></a>          <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_system')" href="../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>();
<a name="l877"><span class="linenum"> 877</span></a>          self::<a class="function" onClick="logFunction('validate_context')" href="../_functions/validate_context.html" onMouseOver="funcPopup(event,'validate_context')">validate_context</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>);
<a name="l878"><span class="linenum"> 878</span></a>  
<a name="l879"><span class="linenum"> 879</span></a>  <span class="comment">        // Check if private messaging between users is allowed.</span>
<a name="l880"><span class="linenum"> 880</span></a>          if (empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('messaging')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/messaging.html">messaging</a>)) {
<a name="l881"><span class="linenum"> 881</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('disabled', 'message');
<a name="l882"><span class="linenum"> 882</span></a>          }
<a name="l883"><span class="linenum"> 883</span></a>  
<a name="l884"><span class="linenum"> 884</span></a>          <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="class" onClick="logClass('core_user')" href="../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('get_user')" href="../_functions/get_user.html" onMouseOver="funcPopup(event,'get_user')">get_user</a>(<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>, '*', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l885"><span class="linenum"> 885</span></a>          <a class="class" onClick="logClass('core_user')" href="../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('require_active_user')" href="../_functions/require_active_user.html" onMouseOver="funcPopup(event,'require_active_user')">require_active_user</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l886"><span class="linenum"> 886</span></a>  
<a name="l887"><span class="linenum"> 887</span></a>  <span class="comment">        // Check if we have permissions for retrieve the information.</span>
<a name="l888"><span class="linenum"> 888</span></a>          if (<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a> != <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../_variables/id.html">id</a> and !<a class="function" onClick="logFunction('has_capability')" href="../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/site:readallmessages', <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>)) {
<a name="l889"><span class="linenum"> 889</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('accessdenied', 'admin');
<a name="l890"><span class="linenum"> 890</span></a>          }
<a name="l891"><span class="linenum"> 891</span></a>  
<a name="l892"><span class="linenum"> 892</span></a>  <span class="comment">        // Now, we can get safely all the blocked users.</span>
<a name="l893"><span class="linenum"> 893</span></a>          <a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../_variables/users.html">$users</a> = <a class="function" onClick="logFunction('message_get_blocked_users')" href="../_functions/message_get_blocked_users.html" onMouseOver="funcPopup(event,'message_get_blocked_users')">message_get_blocked_users</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l894"><span class="linenum"> 894</span></a>  
<a name="l895"><span class="linenum"> 895</span></a>          <a class="var it16338" onMouseOver="hilite(16338)" onMouseOut="lolite()" onClick="logVariable('blockedusers')" href="../_variables/blockedusers.html">$blockedusers</a> = array();
<a name="l896"><span class="linenum"> 896</span></a>          foreach (<a class="var it1062" onMouseOver="hilite(1062)" onMouseOut="lolite()" onClick="logVariable('users')" href="../_variables/users.html">$users</a> as <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>) {
<a name="l897"><span class="linenum"> 897</span></a>              <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a> = array(
<a name="l898"><span class="linenum"> 898</span></a>                  'id' =&gt; <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l899"><span class="linenum"> 899</span></a>                  'fullname' =&gt; <a class="function" onClick="logFunction('fullname')" href="../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>),
<a name="l900"><span class="linenum"> 900</span></a>              );
<a name="l901"><span class="linenum"> 901</span></a>  
<a name="l902"><span class="linenum"> 902</span></a>              <a class="var it7923" onMouseOver="hilite(7923)" onMouseOut="lolite()" onClick="logVariable('userpicture')" href="../_variables/userpicture.html">$userpicture</a> = <span class="keyword">new </span><a class="class" onClick="logClass('user_picture')" href="../_classes/user_picture.html" onMouseOver="classPopup(event,'user_picture')">user_picture</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l903"><span class="linenum"> 903</span></a>              <a class="var it7923" onMouseOver="hilite(7923)" onMouseOut="lolite()" onClick="logVariable('userpicture')" href="../_variables/userpicture.html">$userpicture</a>-&gt;<a onClick="logVariable('size')" class="var it42996" onMouseOver="hilite(42996)" onMouseOut="lolite()" href="../_variables/size.html">size</a> = 1; <span class="comment">// Size f1.</span>
<a name="l904"><span class="linenum"> 904</span></a>              <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>['profileimageurl'] = <a class="var it7923" onMouseOver="hilite(7923)" onMouseOut="lolite()" onClick="logVariable('userpicture')" href="../_variables/userpicture.html">$userpicture</a>-&gt;<a class="function" onClick="logFunction('get_url')" href="../_functions/get_url.html" onMouseOver="funcPopup(event,'get_url')">get_url</a>(<a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>)-&gt;<a class="function" onClick="logFunction('out')" href="../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>(false);
<a name="l905"><span class="linenum"> 905</span></a>  
<a name="l906"><span class="linenum"> 906</span></a>              <a class="var it16338" onMouseOver="hilite(16338)" onMouseOut="lolite()" onClick="logVariable('blockedusers')" href="../_variables/blockedusers.html">$blockedusers</a>[] = <a class="var it2101" onMouseOver="hilite(2101)" onMouseOut="lolite()" onClick="logVariable('newuser')" href="../_variables/newuser.html">$newuser</a>;
<a name="l907"><span class="linenum"> 907</span></a>          }
<a name="l908"><span class="linenum"> 908</span></a>  
<a name="l909"><span class="linenum"> 909</span></a>          <a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../_variables/results.html">$results</a> = array(
<a name="l910"><span class="linenum"> 910</span></a>              'users' =&gt; <a class="var it16338" onMouseOver="hilite(16338)" onMouseOut="lolite()" onClick="logVariable('blockedusers')" href="../_variables/blockedusers.html">$blockedusers</a>,
<a name="l911"><span class="linenum"> 911</span></a>              'warnings' =&gt; <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../_variables/warnings.html">$warnings</a>
<a name="l912"><span class="linenum"> 912</span></a>          );
<a name="l913"><span class="linenum"> 913</span></a>          return <a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../_variables/results.html">$results</a>;
<a name="l914"><span class="linenum"> 914</span></a>      }
<a name="l915"><span class="linenum"> 915</span></a>  
<a name="l916"><span class="linenum"> 916</span></a>      <span class="comment">/**</span>
<a name="l917"><span class="linenum"> 917</span></a>  <span class="comment">     * Get blocked users return description.</span>
<a name="l918"><span class="linenum"> 918</span></a>  <span class="comment">     *</span>
<a name="l919"><span class="linenum"> 919</span></a>  <span class="comment">     * @return external_single_structure</span>
<a name="l920"><span class="linenum"> 920</span></a>  <span class="comment">     * @since 2.9</span>
<a name="l921"><span class="linenum"> 921</span></a>  <span class="comment">     */</span>
<a name="l922"><span class="linenum"> 922</span></a>      public static function <a class="function" onClick="logFunction('get_blocked_users_returns')" href="../_functions/get_blocked_users_returns.html" onMouseOver="funcPopup(event,'get_blocked_users_returns')">get_blocked_users_returns</a>() {
<a name="l923"><span class="linenum"> 923</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_single_structure')" href="../_classes/external_single_structure.html" onMouseOver="classPopup(event,'external_single_structure')">external_single_structure</a>(
<a name="l924"><span class="linenum"> 924</span></a>              array(
<a name="l925"><span class="linenum"> 925</span></a>                  'users' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_multiple_structure')" href="../_classes/external_multiple_structure.html" onMouseOver="classPopup(event,'external_multiple_structure')">external_multiple_structure</a>(
<a name="l926"><span class="linenum"> 926</span></a>                      <span class="keyword">new </span><a class="class" onClick="logClass('external_single_structure')" href="../_classes/external_single_structure.html" onMouseOver="classPopup(event,'external_single_structure')">external_single_structure</a>(
<a name="l927"><span class="linenum"> 927</span></a>                          array(
<a name="l928"><span class="linenum"> 928</span></a>                              'id' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'User ID'),
<a name="l929"><span class="linenum"> 929</span></a>                              'fullname' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_NOTAGS')" href="../_constants/PARAM_NOTAGS.html" onMouseOver="constPopup(event,'PARAM_NOTAGS')">PARAM_NOTAGS</a>, 'User full name'),
<a name="l930"><span class="linenum"> 930</span></a>                              'profileimageurl' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_URL')" href="../_constants/PARAM_URL.html" onMouseOver="constPopup(event,'PARAM_URL')">PARAM_URL</a>, 'User picture URL', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>)
<a name="l931"><span class="linenum"> 931</span></a>                          )
<a name="l932"><span class="linenum"> 932</span></a>                      ),
<a name="l933"><span class="linenum"> 933</span></a>                      'List of blocked users'
<a name="l934"><span class="linenum"> 934</span></a>                  ),
<a name="l935"><span class="linenum"> 935</span></a>                  'warnings' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_warnings')" href="../_classes/external_warnings.html" onMouseOver="classPopup(event,'external_warnings')">external_warnings</a>()
<a name="l936"><span class="linenum"> 936</span></a>              )
<a name="l937"><span class="linenum"> 937</span></a>          );
<a name="l938"><span class="linenum"> 938</span></a>      }
<a name="l939"><span class="linenum"> 939</span></a>  
<a name="l940"><span class="linenum"> 940</span></a>      <span class="comment">/**</span>
<a name="l941"><span class="linenum"> 941</span></a>  <span class="comment">     * Returns description of method parameters</span>
<a name="l942"><span class="linenum"> 942</span></a>  <span class="comment">     *</span>
<a name="l943"><span class="linenum"> 943</span></a>  <span class="comment">     * @return external_function_parameters</span>
<a name="l944"><span class="linenum"> 944</span></a>  <span class="comment">     * @since 2.9</span>
<a name="l945"><span class="linenum"> 945</span></a>  <span class="comment">     */</span>
<a name="l946"><span class="linenum"> 946</span></a>      public static function <a class="function" onClick="logFunction('mark_message_read_parameters')" href="../_functions/mark_message_read_parameters.html" onMouseOver="funcPopup(event,'mark_message_read_parameters')">mark_message_read_parameters</a>() {
<a name="l947"><span class="linenum"> 947</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_function_parameters')" href="../_classes/external_function_parameters.html" onMouseOver="classPopup(event,'external_function_parameters')">external_function_parameters</a>(
<a name="l948"><span class="linenum"> 948</span></a>              array(
<a name="l949"><span class="linenum"> 949</span></a>                  'messageid' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'id of the <a class="function" onClick="logFunction('message')" href="../_functions/message.html" onMouseOver="funcPopup(event,'message')">message</a> (in the message table)'),
<a name="l950"><span class="linenum"> 950</span></a>                  'timeread' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'timestamp for when the message should be marked read')
<a name="l951"><span class="linenum"> 951</span></a>              )
<a name="l952"><span class="linenum"> 952</span></a>          );
<a name="l953"><span class="linenum"> 953</span></a>      }
<a name="l954"><span class="linenum"> 954</span></a>  
<a name="l955"><span class="linenum"> 955</span></a>      <span class="comment">/**</span>
<a name="l956"><span class="linenum"> 956</span></a>  <span class="comment">     * Mark a single message as read, trigger message_viewed event</span>
<a name="l957"><span class="linenum"> 957</span></a>  <span class="comment">     *</span>
<a name="l958"><span class="linenum"> 958</span></a>  <span class="comment">     * @param  int $messageid id of the message (in the message table)</span>
<a name="l959"><span class="linenum"> 959</span></a>  <span class="comment">     * @param  int $timeread timestamp for when the message should be marked read</span>
<a name="l960"><span class="linenum"> 960</span></a>  <span class="comment">     * @return external_description</span>
<a name="l961"><span class="linenum"> 961</span></a>  <span class="comment">     * @throws invalid_parameter_exception</span>
<a name="l962"><span class="linenum"> 962</span></a>  <span class="comment">     * @throws moodle_exception</span>
<a name="l963"><span class="linenum"> 963</span></a>  <span class="comment">     * @since 2.9</span>
<a name="l964"><span class="linenum"> 964</span></a>  <span class="comment">     */</span>
<a name="l965"><span class="linenum"> 965</span></a>      public static function <a class="function" onClick="logFunction('mark_message_read')" href="../_functions/mark_message_read.html" onMouseOver="funcPopup(event,'mark_message_read')">mark_message_read</a>(<a class="var it5664" onMouseOver="hilite(5664)" onMouseOut="lolite()" onClick="logVariable('messageid')" href="../_variables/messageid.html">$messageid</a>, <a class="var it3421" onMouseOver="hilite(3421)" onMouseOut="lolite()" onClick="logVariable('timeread')" href="../_variables/timeread.html">$timeread</a>) {
<a name="l966"><span class="linenum"> 966</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>;
<a name="l967"><span class="linenum"> 967</span></a>  
<a name="l968"><span class="linenum"> 968</span></a>  <span class="comment">        // Check if private messaging between users is allowed.</span>
<a name="l969"><span class="linenum"> 969</span></a>          if (empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('messaging')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/messaging.html">messaging</a>)) {
<a name="l970"><span class="linenum"> 970</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('disabled', 'message');
<a name="l971"><span class="linenum"> 971</span></a>          }
<a name="l972"><span class="linenum"> 972</span></a>  
<a name="l973"><span class="linenum"> 973</span></a>  <span class="comment">        // Warnings array, it can be empty at the end but is mandatory.</span>
<a name="l974"><span class="linenum"> 974</span></a>          <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../_variables/warnings.html">$warnings</a> = array();
<a name="l975"><span class="linenum"> 975</span></a>  
<a name="l976"><span class="linenum"> 976</span></a>  <span class="comment">        // Validate params.</span>
<a name="l977"><span class="linenum"> 977</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array(
<a name="l978"><span class="linenum"> 978</span></a>              'messageid' =&gt; <a class="var it5664" onMouseOver="hilite(5664)" onMouseOut="lolite()" onClick="logVariable('messageid')" href="../_variables/messageid.html">$messageid</a>,
<a name="l979"><span class="linenum"> 979</span></a>              'timeread' =&gt; <a class="var it3421" onMouseOver="hilite(3421)" onMouseOut="lolite()" onClick="logVariable('timeread')" href="../_variables/timeread.html">$timeread</a>
<a name="l980"><span class="linenum"> 980</span></a>          );
<a name="l981"><span class="linenum"> 981</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = self::<a class="function" onClick="logFunction('validate_parameters')" href="../_functions/validate_parameters.html" onMouseOver="funcPopup(event,'validate_parameters')">validate_parameters</a>(self::<a class="function" onClick="logFunction('mark_message_read_parameters')" href="../_functions/mark_message_read_parameters.html" onMouseOver="funcPopup(event,'mark_message_read_parameters')">mark_message_read_parameters</a>(), <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>);
<a name="l982"><span class="linenum"> 982</span></a>  
<a name="l983"><span class="linenum"> 983</span></a>  <span class="comment">        // Validate context.</span>
<a name="l984"><span class="linenum"> 984</span></a>          <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_system')" href="../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>();
<a name="l985"><span class="linenum"> 985</span></a>          self::<a class="function" onClick="logFunction('validate_context')" href="../_functions/validate_context.html" onMouseOver="funcPopup(event,'validate_context')">validate_context</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>);
<a name="l986"><span class="linenum"> 986</span></a>  
<a name="l987"><span class="linenum"> 987</span></a>          <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('message', array('id' =&gt; <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['messageid']), '*', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l988"><span class="linenum"> 988</span></a>  
<a name="l989"><span class="linenum"> 989</span></a>          if (<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>-&gt;<a onClick="logVariable('useridto')" class="var it42910" onMouseOver="hilite(42910)" onMouseOut="lolite()" href="../_variables/useridto.html">useridto</a> != <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../_variables/id.html">id</a>) {
<a name="l990"><span class="linenum"> 990</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('invalid_parameter_exception')" href="../_classes/invalid_parameter_exception.html" onMouseOver="classPopup(event,'invalid_parameter_exception')">invalid_parameter_exception</a>('Invalid messageid, you don\'t have permissions to mark this message as read');
<a name="l991"><span class="linenum"> 991</span></a>          }
<a name="l992"><span class="linenum"> 992</span></a>  
<a name="l993"><span class="linenum"> 993</span></a>          <a class="var it5664" onMouseOver="hilite(5664)" onMouseOut="lolite()" onClick="logVariable('messageid')" href="../_variables/messageid.html">$messageid</a> = <a class="function" onClick="logFunction('message_mark_message_read')" href="../_functions/message_mark_message_read.html" onMouseOver="funcPopup(event,'message_mark_message_read')">message_mark_message_read</a>(<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['timeread']);
<a name="l994"><span class="linenum"> 994</span></a>  
<a name="l995"><span class="linenum"> 995</span></a>          <a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../_variables/results.html">$results</a> = array(
<a name="l996"><span class="linenum"> 996</span></a>              'messageid' =&gt; <a class="var it5664" onMouseOver="hilite(5664)" onMouseOut="lolite()" onClick="logVariable('messageid')" href="../_variables/messageid.html">$messageid</a>,
<a name="l997"><span class="linenum"> 997</span></a>              'warnings' =&gt; <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../_variables/warnings.html">$warnings</a>
<a name="l998"><span class="linenum"> 998</span></a>          );
<a name="l999"><span class="linenum"> 999</span></a>          return <a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../_variables/results.html">$results</a>;
<a name="l1000"><span class="linenum">1000</span></a>      }
<a name="l1001"><span class="linenum">1001</span></a>  
<a name="l1002"><span class="linenum">1002</span></a>      <span class="comment">/**</span>
<a name="l1003"><span class="linenum">1003</span></a>  <span class="comment">     * Returns description of method result value</span>
<a name="l1004"><span class="linenum">1004</span></a>  <span class="comment">     *</span>
<a name="l1005"><span class="linenum">1005</span></a>  <span class="comment">     * @return external_description</span>
<a name="l1006"><span class="linenum">1006</span></a>  <span class="comment">     * @since 2.9</span>
<a name="l1007"><span class="linenum">1007</span></a>  <span class="comment">     */</span>
<a name="l1008"><span class="linenum">1008</span></a>      public static function <a class="function" onClick="logFunction('mark_message_read_returns')" href="../_functions/mark_message_read_returns.html" onMouseOver="funcPopup(event,'mark_message_read_returns')">mark_message_read_returns</a>() {
<a name="l1009"><span class="linenum">1009</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_single_structure')" href="../_classes/external_single_structure.html" onMouseOver="classPopup(event,'external_single_structure')">external_single_structure</a>(
<a name="l1010"><span class="linenum">1010</span></a>              array(
<a name="l1011"><span class="linenum">1011</span></a>                  'messageid' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'the id of the message in the message_read table'),
<a name="l1012"><span class="linenum">1012</span></a>                  'warnings' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_warnings')" href="../_classes/external_warnings.html" onMouseOver="classPopup(event,'external_warnings')">external_warnings</a>()
<a name="l1013"><span class="linenum">1013</span></a>              )
<a name="l1014"><span class="linenum">1014</span></a>          );
<a name="l1015"><span class="linenum">1015</span></a>      }
<a name="l1016"><span class="linenum">1016</span></a>  
<a name="l1017"><span class="linenum">1017</span></a>      <span class="comment">/**</span>
<a name="l1018"><span class="linenum">1018</span></a>  <span class="comment">     * Returns description of method parameters</span>
<a name="l1019"><span class="linenum">1019</span></a>  <span class="comment">     *</span>
<a name="l1020"><span class="linenum">1020</span></a>  <span class="comment">     * @return external_function_parameters</span>
<a name="l1021"><span class="linenum">1021</span></a>  <span class="comment">     * @since 3.1</span>
<a name="l1022"><span class="linenum">1022</span></a>  <span class="comment">     */</span>
<a name="l1023"><span class="linenum">1023</span></a>      public static function <a class="function" onClick="logFunction('delete_message_parameters')" href="../_functions/delete_message_parameters.html" onMouseOver="funcPopup(event,'delete_message_parameters')">delete_message_parameters</a>() {
<a name="l1024"><span class="linenum">1024</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_function_parameters')" href="../_classes/external_function_parameters.html" onMouseOver="classPopup(event,'external_function_parameters')">external_function_parameters</a>(
<a name="l1025"><span class="linenum">1025</span></a>              array(
<a name="l1026"><span class="linenum">1026</span></a>                  'messageid' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'The message id'),
<a name="l1027"><span class="linenum">1027</span></a>                  'userid' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'The user id of who we want to delete the message for'),
<a name="l1028"><span class="linenum">1028</span></a>                  'read' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_BOOL')" href="../_constants/PARAM_BOOL.html" onMouseOver="constPopup(event,'PARAM_BOOL')">PARAM_BOOL</a>, 'If is a message read', <a class="constant" onClick="logConstant('VALUE_DEFAULT')" href="../_constants/VALUE_DEFAULT.html" onMouseOver="constPopup(event,'VALUE_DEFAULT')">VALUE_DEFAULT</a>, true)
<a name="l1029"><span class="linenum">1029</span></a>              )
<a name="l1030"><span class="linenum">1030</span></a>          );
<a name="l1031"><span class="linenum">1031</span></a>      }
<a name="l1032"><span class="linenum">1032</span></a>  
<a name="l1033"><span class="linenum">1033</span></a>      <span class="comment">/**</span>
<a name="l1034"><span class="linenum">1034</span></a>  <span class="comment">     * Deletes a message</span>
<a name="l1035"><span class="linenum">1035</span></a>  <span class="comment">     *</span>
<a name="l1036"><span class="linenum">1036</span></a>  <span class="comment">     * @param  int $messageid the message id</span>
<a name="l1037"><span class="linenum">1037</span></a>  <span class="comment">     * @param  int $userid the user id of who we want to delete the message for</span>
<a name="l1038"><span class="linenum">1038</span></a>  <span class="comment">     * @param  bool $read if is a message read (default to true)</span>
<a name="l1039"><span class="linenum">1039</span></a>  <span class="comment">     * @return external_description</span>
<a name="l1040"><span class="linenum">1040</span></a>  <span class="comment">     * @throws moodle_exception</span>
<a name="l1041"><span class="linenum">1041</span></a>  <span class="comment">     * @since 3.1</span>
<a name="l1042"><span class="linenum">1042</span></a>  <span class="comment">     */</span>
<a name="l1043"><span class="linenum">1043</span></a>      public static function <a class="function" onClick="logFunction('delete_message')" href="../_functions/delete_message.html" onMouseOver="funcPopup(event,'delete_message')">delete_message</a>(<a class="var it5664" onMouseOver="hilite(5664)" onMouseOut="lolite()" onClick="logVariable('messageid')" href="../_variables/messageid.html">$messageid</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>, <a class="var it2155" onMouseOver="hilite(2155)" onMouseOut="lolite()" onClick="logVariable('read')" href="../_variables/read.html">$read</a> = true) {
<a name="l1044"><span class="linenum">1044</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l1045"><span class="linenum">1045</span></a>  
<a name="l1046"><span class="linenum">1046</span></a>  <span class="comment">        // Check if private messaging between users is allowed.</span>
<a name="l1047"><span class="linenum">1047</span></a>          if (empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('messaging')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/messaging.html">messaging</a>)) {
<a name="l1048"><span class="linenum">1048</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('disabled', 'message');
<a name="l1049"><span class="linenum">1049</span></a>          }
<a name="l1050"><span class="linenum">1050</span></a>  
<a name="l1051"><span class="linenum">1051</span></a>  <span class="comment">        // Warnings array, it can be empty at the end but is mandatory.</span>
<a name="l1052"><span class="linenum">1052</span></a>          <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../_variables/warnings.html">$warnings</a> = array();
<a name="l1053"><span class="linenum">1053</span></a>  
<a name="l1054"><span class="linenum">1054</span></a>  <span class="comment">        // Validate params.</span>
<a name="l1055"><span class="linenum">1055</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array(
<a name="l1056"><span class="linenum">1056</span></a>              'messageid' =&gt; <a class="var it5664" onMouseOver="hilite(5664)" onMouseOut="lolite()" onClick="logVariable('messageid')" href="../_variables/messageid.html">$messageid</a>,
<a name="l1057"><span class="linenum">1057</span></a>              'userid' =&gt; <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('userid')" href="../_variables/userid.html">$userid</a>,
<a name="l1058"><span class="linenum">1058</span></a>              'read' =&gt; <a class="var it2155" onMouseOver="hilite(2155)" onMouseOut="lolite()" onClick="logVariable('read')" href="../_variables/read.html">$read</a>
<a name="l1059"><span class="linenum">1059</span></a>          );
<a name="l1060"><span class="linenum">1060</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = self::<a class="function" onClick="logFunction('validate_parameters')" href="../_functions/validate_parameters.html" onMouseOver="funcPopup(event,'validate_parameters')">validate_parameters</a>(self::<a class="function" onClick="logFunction('delete_message_parameters')" href="../_functions/delete_message_parameters.html" onMouseOver="funcPopup(event,'delete_message_parameters')">delete_message_parameters</a>(), <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>);
<a name="l1061"><span class="linenum">1061</span></a>  
<a name="l1062"><span class="linenum">1062</span></a>  <span class="comment">        // Validate context.</span>
<a name="l1063"><span class="linenum">1063</span></a>          <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_system')" href="../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>();
<a name="l1064"><span class="linenum">1064</span></a>          self::<a class="function" onClick="logFunction('validate_context')" href="../_functions/validate_context.html" onMouseOver="funcPopup(event,'validate_context')">validate_context</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>);
<a name="l1065"><span class="linenum">1065</span></a>  
<a name="l1066"><span class="linenum">1066</span></a>          <a class="var it24839" onMouseOver="hilite(24839)" onMouseOut="lolite()" onClick="logVariable('messagestable')" href="../_variables/messagestable.html">$messagestable</a> = <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['read'] ? 'message_read' : 'message';
<a name="l1067"><span class="linenum">1067</span></a>          <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>(<a class="var it24839" onMouseOver="hilite(24839)" onMouseOut="lolite()" onClick="logVariable('messagestable')" href="../_variables/messagestable.html">$messagestable</a>, array('id' =&gt; <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['messageid']), '*', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l1068"><span class="linenum">1068</span></a>  
<a name="l1069"><span class="linenum">1069</span></a>          <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="class" onClick="logClass('core_user')" href="../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('get_user')" href="../_functions/get_user.html" onMouseOver="funcPopup(event,'get_user')">get_user</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['userid'], '*', <a class="constant" onClick="logConstant('MUST_EXIST')" href="../_constants/MUST_EXIST.html" onMouseOver="constPopup(event,'MUST_EXIST')">MUST_EXIST</a>);
<a name="l1070"><span class="linenum">1070</span></a>          <a class="class" onClick="logClass('core_user')" href="../_classes/core_user.html" onMouseOver="classPopup(event,'core_user')">core_user</a>::<a class="function" onClick="logFunction('require_active_user')" href="../_functions/require_active_user.html" onMouseOver="funcPopup(event,'require_active_user')">require_active_user</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l1071"><span class="linenum">1071</span></a>  
<a name="l1072"><span class="linenum">1072</span></a>          <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a> = false;
<a name="l1073"><span class="linenum">1073</span></a>          if (<a class="function" onClick="logFunction('message_can_delete_message')" href="../_functions/message_can_delete_message.html" onMouseOver="funcPopup(event,'message_can_delete_message')">message_can_delete_message</a>(<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)) {
<a name="l1074"><span class="linenum">1074</span></a>              <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a> = <a class="function" onClick="logFunction('message_delete_message')" href="../_functions/message_delete_message.html" onMouseOver="funcPopup(event,'message_delete_message')">message_delete_message</a>(<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/id.html">id</a>);;
<a name="l1075"><span class="linenum">1075</span></a>          } else {
<a name="l1076"><span class="linenum">1076</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('You do not have permission to delete this message');
<a name="l1077"><span class="linenum">1077</span></a>          }
<a name="l1078"><span class="linenum">1078</span></a>  
<a name="l1079"><span class="linenum">1079</span></a>          <a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../_variables/results.html">$results</a> = array(
<a name="l1080"><span class="linenum">1080</span></a>              'status' =&gt; <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('status')" href="../_variables/status.html">$status</a>,
<a name="l1081"><span class="linenum">1081</span></a>              'warnings' =&gt; <a class="var it3500" onMouseOver="hilite(3500)" onMouseOut="lolite()" onClick="logVariable('warnings')" href="../_variables/warnings.html">$warnings</a>
<a name="l1082"><span class="linenum">1082</span></a>          );
<a name="l1083"><span class="linenum">1083</span></a>          return <a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../_variables/results.html">$results</a>;
<a name="l1084"><span class="linenum">1084</span></a>      }
<a name="l1085"><span class="linenum">1085</span></a>  
<a name="l1086"><span class="linenum">1086</span></a>      <span class="comment">/**</span>
<a name="l1087"><span class="linenum">1087</span></a>  <span class="comment">     * Returns description of method result value</span>
<a name="l1088"><span class="linenum">1088</span></a>  <span class="comment">     *</span>
<a name="l1089"><span class="linenum">1089</span></a>  <span class="comment">     * @return external_description</span>
<a name="l1090"><span class="linenum">1090</span></a>  <span class="comment">     * @since 3.1</span>
<a name="l1091"><span class="linenum">1091</span></a>  <span class="comment">     */</span>
<a name="l1092"><span class="linenum">1092</span></a>      public static function <a class="function" onClick="logFunction('delete_message_returns')" href="../_functions/delete_message_returns.html" onMouseOver="funcPopup(event,'delete_message_returns')">delete_message_returns</a>() {
<a name="l1093"><span class="linenum">1093</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_single_structure')" href="../_classes/external_single_structure.html" onMouseOver="classPopup(event,'external_single_structure')">external_single_structure</a>(
<a name="l1094"><span class="linenum">1094</span></a>              array(
<a name="l1095"><span class="linenum">1095</span></a>                  'status' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_BOOL')" href="../_constants/PARAM_BOOL.html" onMouseOver="constPopup(event,'PARAM_BOOL')">PARAM_BOOL</a>, 'True if the message was deleted, false otherwise'),
<a name="l1096"><span class="linenum">1096</span></a>                  'warnings' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_warnings')" href="../_classes/external_warnings.html" onMouseOver="classPopup(event,'external_warnings')">external_warnings</a>()
<a name="l1097"><span class="linenum">1097</span></a>              )
<a name="l1098"><span class="linenum">1098</span></a>          );
<a name="l1099"><span class="linenum">1099</span></a>      }
<a name="l1100"><span class="linenum">1100</span></a>  
<a name="l1101"><span class="linenum">1101</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'message_remove_contact': ['message_remove_contact', 'remove a contact ', [['message','lib.php',1101]], 4],
'message_get_messages': ['message_get_messages', 'Get messages sent or/and received by the specified users. Please note that this function return deleted messages too. ', [['message','lib.php',2764]], 6],
'unblock_contacts_returns': ['unblock_contacts_returns', 'Unblock contacts return description. ', [['message','externallib.php',401]], 0],
'get_blocked_users_parameters': ['get_blocked_users_parameters', 'Get blocked users parameters description. ', [['message','externallib.php',839]], 1],
'get_contacts_parameters': ['get_contacts_parameters', 'Get contacts parameters description. ', [['message','externallib.php',411]], 0],
'message_can_delete_message': ['message_can_delete_message', 'Checks if a user can delete a message. ', [['message','lib.php',1149]], 3],
'message_search_users': ['message_search_users', 'Search through course users. ', [['message','lib.php',1705]], 7],
'validate_context': ['validate_context', 'Makes sure user may execute functions in this context. ', [['lib','externallib.php',448]], 256],
'validate_parameters': ['validate_parameters', 'Validates submitted function parameters, if anything is incorrect invalid_parameter_exception is thrown. This is a simple recursive method which is intended to be called from each implementation method of external API. ', [['lib','externallib.php',279]], 340],
'delete_contacts_returns': ['delete_contacts_returns', 'Delete contacts return description. ', [['message','externallib.php',290]], 0],
'get_user_preferences': ['get_user_preferences', 'Used to fetch user preference(s) ', [['lib','moodlelib.php',1974],['user','externallib.php',1381]], 188],
'require_active_user': ['require_active_user', 'Check if the given user is an active user in the site. ', [['lib/classes','user.php',247]], 29],
'message_delete_message': ['message_delete_message', 'Deletes a message. ', [['message','lib.php',1180]], 6],
'get_contacts_returns': ['get_contacts_returns', 'Get contacts return description. ', [['message','externallib.php',460]], 3],
'get_messages_returns': ['get_messages_returns', 'Get messages return description. ', [['message','externallib.php',803]], 15],
'mark_message_read_parameters': ['mark_message_read_parameters', 'Returns description of method parameters ', [['message','externallib.php',940]], 1],
'has_capability': ['has_capability', 'Wrapper round the has_capability funciton that automatically passes in the quiz context. ', [['mod/quiz','attemptlib.php',299],['mod/quiz','attemptlib.php',922],['lib','accesslib.php',344]], 2064],
'parameter': ['parameter', '', [['lib/adodb/drivers','adodb-odbtp.inc.php',511],['lib/adodb/drivers','adodb-mssql.inc.php',708],['lib/adodb','adodb.inc.php',981],['lib/adodb/drivers','adodb-oci8.inc.php',1184]], 25],
'create_contacts_returns': ['create_contacts_returns', 'Create contacts return description. ', [['message','externallib.php',238]], 5],
'delete_message': ['delete_message', 'Deletes a message ', [['message','externallib.php',1033]], 9],
'message_post_message': ['message_post_message', 'Send a message from one user to another. Will be delivered according to the message recipients messaging preferences ', [['message','lib.php',2309]], 23],
'list': ['list', '', [['mod/data/preset/imagegallery','jstemplate.js',9]], 2229],
'fullname': ['fullname', 'Returns a persons full name ', [['lib','moodlelib.php',3249],['mod/assign','locallib.php',3915]], 546],
'message': ['message', 'Send XMPP Message ', [['lib/jabber/XMPP','XMPP.php',156],['mod/lesson','renderer.php',145]], 31],
'delete_message_parameters': ['delete_message_parameters', 'Returns description of method parameters ', [['message','externallib.php',1017]], 1],
'send_instant_messages_returns': ['send_instant_messages_returns', 'Returns description of method result value ', [['message','externallib.php',171]], 1],
'message_block_contact': ['message_block_contact', 'Block a user. ', [['message','lib.php',1139]], 12],
'send_instant_messages': ['send_instant_messages', 'Send private messages from the current USER to other users ', [['message','externallib.php',64]], 1],
'search_contacts_parameters': ['search_contacts_parameters', 'Search contacts parameters description. ', [['message','externallib.php',509]], 1],
'get_records_select': ['get_records_select', 'Load a list of records based on a select query. ', [['competency/classes','persistent.php',751],['lib/dml','moodle_database.php',1332]], 166],
'external_validate_format': ['external_validate_format', 'Validate text field format against known FORMAT_XXX ', [['lib','externallib.php',833]], 13],
'enrol_get_my_courses': ['enrol_get_my_courses', 'Returns list of courses current $USER is enrolled in and can access ', [['lib','enrollib.php',512]], 30],
'get_recordset_sql': ['get_recordset_sql', 'Get a number of records as an moodle_recordset.  $sql must be a complete SQL query. Since this method is a little less readable, use of it should be restricted to code where it\'s possible there might be large datasets being returned.  For known small datasets use get_records_sql - it leads to simpler code. ', [['lib/dml','pdo_moodle_database.php',252],['lib/dml','oci_native_moodle_database.php',1106],['lib/dml','pgsql_native_moodle_database.php',688],['lib/dml','mssql_native_moodle_database.php',736],['lib/dml','mysqli_native_moodle_database.php',993],['lib/dml','sqlsrv_native_moodle_database.php',811],['lib/dml/tests','dml_test.php',5544]], 283],
'send_instant_messages_parameters': ['send_instant_messages_parameters', 'Returns description of method parameters ', [['message','externallib.php',41]], 1],
'delete_contacts_parameters': ['delete_contacts_parameters', 'Delete contacts parameters description. ', [['message','externallib.php',248]], 1],
'get_blocked_users': ['get_blocked_users', 'Retrieve a list of users blocked ', [['message','externallib.php',855]], 3],
'mark_message_read': ['mark_message_read', 'Mark a single message as read, trigger message_viewed event ', [['message','externallib.php',955]], 3],
'create_contacts_parameters': ['create_contacts_parameters', 'Create contacts parameters description. ', [['message','externallib.php',189]], 1],
'unblock_contacts': ['unblock_contacts', 'Unblock contacts. ', [['message','externallib.php',376]], 5],
'require_capability': ['require_capability', 'Wrapper round the require_capability funciton that automatically passes in the quiz context. ', [['mod/quiz','attemptlib.php',306],['mod/quiz','attemptlib.php',929],['lib','accesslib.php',762],['backup/util/ui','restore_ui_components.php',157]], 690],
'mark_message_read_returns': ['mark_message_read_returns', 'Returns description of method result value ', [['message','externallib.php',1002]], 1],
'message_unblock_contact': ['message_unblock_contact', 'Unblock a contact. Note that this reverts the previously blocked user back to a non-contact. ', [['message','lib.php',1129]], 5],
'message_add_contact': ['message_add_contact', 'Add the selected user as a contact for the current user ', [['message','lib.php',1024]], 25],
'get_messages_parameters': ['get_messages_parameters', 'Get messages parameters description. ', [['message','externallib.php',612]], 1],
'search_contacts_returns': ['search_contacts_returns', 'Search contacts return description. ', [['message','externallib.php',592]], 5],
'message_get_blocked_users': ['message_get_blocked_users', 'Retrieve users blocked by $user1 ', [['message','lib.php',220]], 5],
'out': ['out', 'Returns the selector for use in a CSS rule ', [['lib','csslib.php',1540],['lib','csslib.php',1698],['lib','csslib.php',2078],['lib','csslib.php',2162],['lib','csslib.php',2306],['lib','csslib.php',2495],['lib','csslib.php',3240],['mod/feedback/classes','responses_table.php',332],['lib','moodlelib.php',9729],['lib','weblib.php',545],['lib','tablelib.php',1594],['report/loglive/classes','table_log_ajax.php',37]], 626],
'message_get_contacts': ['message_get_contacts', 'Retrieve $user1\'s contacts (online, offline and strangers) ', [['message','lib.php',301]], 7],
'close': ['close', 'Close archive, write changes to disk. ', [['lib/filestorage','zip_archive.php',183],['lib/dml','mssql_native_moodle_recordset.php',87],['auth/fc','fcFPP.php',78],['lib/dml','mysqli_native_moodle_recordset.php',86],['lib/spout/src/Spout/Reader','ReaderInterface.php',30],['lib/spout/src/Spout/Writer/ODS/Internal','Workbook.php',81],['lib/dml','pdo_moodle_recordset.php',79],['lib','csvlib.class.php',256],['lib/horde/framework/Horde/Socket','Client.php',135],['backup/util/helper','backup_null_iterator.class.php',53],['admin/tool/uploaduser','locallib.php',149],['lib/tcpdf','tcpdf.php',2943],['lib/phpunit/classes','phpmailer_sink.php',41],['lib/phpmailer','class.smtp.php',582],['lib/dml','sqlsrv_native_moodle_recordset.php',133],['lib/classes/dml','recordset_walk.php',153],['lib/spout/src/Spout/Writer/XLSX/Helper','SharedStringsHelper.php',84],['grade/export','lib.php',689],['lib','excellib.class.php',93],['backup/util/loggers','file_logger.class.php',69],['grade','lib.php',324],['backup/util/helper','backup_array_iterator.class.php',63],['lib/horde/framework/Horde/Imap/Client','Base.php',1846],['mod/assign/feedback/offline','importgradeslib.php',204],['lib/dml','oci_native_moodle_recordset.php',80],['lib/adodb','adodb.inc.php',2361],['lib/adodb','adodb.inc.php',3090],['lib/adodb','adodb.inc.php',3870],['lib/google/src/Google/Logger','File.php',132],['lib/phpunit/classes','event_sink.php',39],['lib/horde/framework/Horde','Stream.php',585],['backup/util/loggers','base_logger.class.php',89],['lib/phpexcel/PHPExcel/Shared','ZipArchive.php',71],['question/engine/tests','helpers.php',1241],['lib/spout/src/Spout/Writer','AbstractWriter.php',312],['lib','odslib.class.php',71],['lib/spout/src/Spout/Writer/Common/Internal','WorksheetInterface.php',34],['lib/spout/src/Spout/Writer/ODS/Internal','Worksheet.php',214],['lib/spout/src/Spout/Writer','WriterInterface.php',84],['lib/spout/src/Spout/Writer/XLSX/Internal','Worksheet.php',174],['lib/spout/src/Spout/Reader','AbstractReader.php',183],['lib/phpunit/classes','message_sink.php',39],['lib/spout/src/Spout/Writer/Common/Internal','WorkbookInterface.php',65],['lib/spout/src/Spout/Writer/XLSX/Internal','Workbook.php',95],['lib/pear/Net','GeoIP.php',556],['lib/tests','completionlib_test.php',907],['lib/pear/Auth','RADIUS.php',550],['lib/pear/Auth','RADIUS.php',710],['lib/pear/Auth','RADIUS.php',829],['lib','webdavlib.php',176],['lib/dml','pgsql_native_moodle_recordset.php',107]], 1128],
'block_contacts_returns': ['block_contacts_returns', 'Block contacts return description. ', [['message','externallib.php',349]], 5],
'delete_message_returns': ['delete_message_returns', 'Returns description of method result value ', [['message','externallib.php',1086]], 5],
'get_url': ['get_url', 'Get URL related to the action ', [['lib/classes/event','competency_plan_unlinked.php',81],['lib/classes/event','grouping_group_assigned.php',57],['lib/classes/event','enrol_instance_deleted.php',79],['report/log/classes/event','user_report_viewed.php',82],['mod/quiz/classes/event','attempt_reviewed.php',72],['lib/classes/event','role_unassigned.php',72],['mod/workshop/classes/event','submission_deleted.php',72],['mod/forum/classes/event','discussion_updated.php',74],['lib/classes/event','course_module_instance_list_viewed.php',84],['lib/classes/event','course_created.php',73],['mod/forum/classes/event','readtracking_enabled.php',73],['mod/wiki/classes/event','page_created.php',77],['lib/classes/event','competency_viewed.php',79],['mod/choice/classes/event','answer_updated.php',81],['lib/simplepie/library/SimplePie','Copyright.php',96],['lib/classes/event','search_indexed.php',69],['lib/classes/event','badge_criteria_updated.php',71],['mod/wiki/classes/event','page_version_deleted.php',83],['lib/classes/event','competency_user_competency_rated_in_plan.php',97],['mod/glossary/classes/event','entry_deleted.php',73],['lib/classes/event','competency_template_viewed.php',81],['admin/tool/langimport/classes/event','langpack_removed.php',80],['mod/glossary/classes/event','category_deleted.php',65],['lib/classes/event','badge_deleted.php',67],['mod/quiz/classes/event','user_override_updated.php',73],['lib/classes/event','message_contact_added.php',57],['lib/classes/event','cohort_member_added.php',68],['lib/classes/event','blog_entry_updated.php',92],['mod/forum/classes/event','assessable_uploaded.php',95],['lib/classes/event','group_deleted.php',74],['lib/classes/event','role_allow_assign_updated.php',65],['mod/lesson/classes/event','highscore_added.php',68],['mod/forum/classes/event','discussion_pinned.php',64],['lib/classes/event','competency_plan_reopened.php',84],['mod/lesson/classes/event','essay_attempt_viewed.php',57],['mod/wiki/classes/event','page_locks_deleted.php',83],['mod/glossary/classes/event','comment_created.php',37],['lib/classes/event','webservice_service_deleted.php',68],['mod/forum/classes/event','discussion_subscription_created.php',75],['admin/tool/log/store/database/tests/fixtures','event.php',44],['mod/workshop/classes/event','assessable_uploaded.php',102],['lib/classes/event','user_loggedout.php',72],['lib/classes/event','webservice_token_created.php',74],['mod/data/classes/event','field_deleted.php',76],['mod/book/classes/event','chapter_created.php',88],['mod/survey/classes/event','report_downloaded.php',73],['mod/workshop/classes/event','phase_switched.php',84],['lib/classes/event','course_reset_started.php',62],['mod/workshop/classes/event','assessment_evaluated.php',75],['lib/classes/event','blog_association_created.php',75],['report/outline/classes/event','activity_report_viewed.php',75],['lib/classes/event','competency_plan_updated.php',84],['mod/choice/classes/event','answer_submitted.php',81],['mod/lesson/classes/event','lesson_ended.php',58],['lib/classes/event','role_allow_switch_updated.php',65],['lib/classes/event','competency_user_competency_rated_in_course.php',97],['mod/quiz/report','attemptsreport_options.php',133],['report/participation/classes/event','report_viewed.php',86],['lib/classes/event','role_capabilities_updated.php',69],['mod/survey/classes/event','response_submitted.php',71],['lib/classes/event','badge_archived.php',65],['mod/workshop/classes/event','assessment_reevaluated.php',85],['report/outline/classes/event','report_viewed.php',83],['lib/classes/event','mnet_access_control_updated.php',66],['mod/assign/classes/event','base.php',90],['mod/lesson/classes/event','essay_assessed.php',87],['lib/filebrowser','file_info.php',226],['mod/book/tool/print/classes/event','book_printed.php',85],['lib/classes/event','grouping_deleted.php',81],['lib/classes/event','course_viewed.php',84],['mod/forum/classes/event','user_report_viewed.php',74],['mod/quiz/classes/event','attempt_summary_viewed.php',75],['lib/classes/event','webservice_service_user_added.php',68],['mod/forum/classes/event','discussion_unpinned.php',64],['lib/classes/event','grouping_group_unassigned.php',57],['mod/chat/classes/event','message_sent.php',68],['lib/classes/event','role_assigned.php',75],['mod/glossary/classes/event','entry_viewed.php',67],['mod/data/classes/event','record_created.php',75],['lib/classes/event','role_deleted.php',73],['mod/wiki/classes/event','page_version_viewed.php',84],['admin/tool/log/store/standard/tests/fixtures','event.php',44],['admin/tool/monitor/classes/event','rule_created.php',68],['lib/classes/event','competency_user_competency_plan_viewed.php',90],['mod/data/classes/event','comment_deleted.php',37],['mod/forum/classes/event','course_module_viewed.php',50],['mod/workshop/classes/event','submission_updated.php',72],['mod/choice/classes/event','report_viewed.php',72],['mod/lesson/classes/event','group_override_deleted.php',73],['mod/wiki/classes/event','page_map_viewed.php',83],['admin/tool/log/store/legacy/tests/fixtures','event.php',44],['mod/lesson/classes/event','question_answered.php',63],['mod/choice/classes/event','report_downloaded.php',73],['lib/classes/event','competency_user_evidence_created.php',82],['lib/classes/event','course_module_completion_updated.php',73],['lib/classes/event','note_updated.php',75],['lib/classes/event','note_created.php',75],['lib/classes/event','competency_framework_created.php',81],['lib/classes/event','course_resources_list_viewed.php',69],['lib/filebrowser','file_info_stored.php',156],['mod/forum/classes/event','subscribers_viewed.php',74],['mod/book/tool/exportimscp/classes/event','book_exported.php',85],['lib','outputcomponents.php',326],['lib','outputcomponents.php',2756],['lib/classes/event','user_enrolment_deleted.php',73],['lib/classes/event','webservice_service_updated.php',68],['mod/lesson/classes/event','group_override_created.php',74],['mod/scorm/classes/event','attempt_deleted.php',71],['lib/classes/event','competency_user_competency_review_request_cancelled.php',81],['lib/classes/event','webservice_service_created.php',74],['mod/wiki/classes/event','page_version_restored.php',83],['mod/forum/classes/event','discussion_deleted.php',75],['lib/classes/event','competency_framework_updated.php',82],['lib/classes/event','blog_comment_created.php',38],['mod/lesson/classes/event','lesson_restarted.php',57],['mod/wiki/classes/event','page_updated.php',83],['mod/assign/submission/comments/classes/event','comment_created.php',37],['lib','modinfolib.php',1230],['lib/classes/event','course_module_updated.php',76],['report/questioninstances/classes/event','report_viewed.php',83],['lib/classes/event','message_contact_blocked.php',57],['lib/classes/event','competency_template_updated.php',84],['lib/classes/event','badge_disabled.php',65],['lib/classes/event','badge_enabled.php',65],['mod/quiz/classes/event','edit_page_viewed.php',72],['mod/scorm/classes/event','tracks_viewed.php',73],['mod/wiki/classes/event','page_diff_viewed.php',85],['lib/classes/event','grouping_created.php',74],['lib/classes/event','group_updated.php',74],['mod/book/classes/event','chapter_updated.php',88],['lib/classes/event','user_loggedin.php',73],['mod/forum/classes/event','subscription_created.php',74],['mod/quiz/classes/event','group_override_updated.php',73],['lib/classes/event','competency_plan_created.php',81],['mod/glossary/classes/event','entry_disapproved.php',65],['lib/classes/event','message_viewed.php',63],['lib/classes/event','comment_created.php',77],['lib/classes/event','competency_evidence_created.php',116],['lib/classes/event','comment_deleted.php',77],['lib/classes/event','competency_user_competency_review_requested.php',81],['mod/quiz/classes/event','attempt_abandoned.php',81],['mod/scorm/classes/event','user_report_viewed.php',71],['mod/quiz/classes/event','attempt_becameoverdue.php',84],['mod/quiz/classes/event','group_override_created.php',74],['mod/book/tool/print/classes/event','chapter_printed.php',88],['mod/data/classes/event','record_deleted.php',75],['lib/classes/event','competency_user_competency_viewed.php',90],['mod/lesson/classes/event','question_viewed.php',63],['lib/classes/event','user_profile_viewed.php',76],['mod/lesson/classes/event','user_override_deleted.php',72],['lib/classes/event','cohort_member_removed.php',69],['mod/lesson/classes/event','lesson_started.php',57],['mod/lesson/classes/event','page_updated.php',82],['mod/workshop/classes/event','submission_viewed.php',72],['mod/glossary/classes/event','entry_created.php',71],['mod/wiki/classes/event','page_history_viewed.php',77],['lib/classes/event','competency_plan_review_request_cancelled.php',84],['mod/quiz/classes/event','attempt_viewed.php',73],['mod/data/classes/event','field_updated.php',76],['lib/classes/event','grouping_updated.php',74],['lib/classes/event','question_category_created.php',66],['lib/classes/event','user_login_failed.php',76],['mod/scorm/classes/event','report_viewed.php',72],['mod/chat/classes/event','sessions_viewed.php',74],['mod/quiz/classes/event','user_override_deleted.php',72],['mod/quiz/classes/event','attempt_submitted.php',81],['mod/lesson/classes/event','group_override_updated.php',73],['mod/workshop/classes/event','submission_created.php',72],['mod/assign/submission/onlinetext/classes/event','assessable_uploaded.php',92],['lib/classes/event','competency_updated.php',79],['mod/lesson/classes/event','page_moved.php',65],['blocks/rss_client/classes/output','channel_image.php',101],['badges/lib','backpacklib.php',116],['lib/classes/event','course_completed.php',91],['lib/classes/event','competency_created.php',79],['mod/lesson/classes/event','highscores_viewed.php',60],['lib/classes/event','message_contact_unblocked.php',57],['lib','accesslib.php',6143],['lib','accesslib.php',6200],['lib','accesslib.php',6451],['lib','accesslib.php',6638],['lib','accesslib.php',6878],['lib','accesslib.php',7098],['lib','accesslib.php',7341],['mod/wiki/classes/event','comment_deleted.php',38],['lib/classes/event','user_enrolment_created.php',72],['lib/classes/event','course_module_created.php',105],['lib/classes/event','webservice_service_user_removed.php',68],['report/log/classes/event','report_viewed.php',85],['mod/assign/submission/file/classes/event','assessable_uploaded.php',94],['lib/classes/event','group_member_added.php',87],['mod/forum/classes/event','discussion_viewed.php',69],['mod/workshop/classes/event','submission_reassessed.php',86],['mod/workshop/classes/event','assessment_evaluations_reset.php',84],['mod/forum/classes/event','discussion_moved.php',75],['mod/lesson/classes/event','lesson_resumed.php',57],['lib/classes/event','comments_viewed.php',69],['mod/data/classes/event','template_viewed.php',74],['mod/wiki/classes/event','page_deleted.php',83],['mod/quiz/classes/event','report_viewed.php',75],['mod/scorm/classes/event','sco_launched.php',73],['mod/glossary/classes/event','entry_updated.php',71],['mod/lesson/classes/event','user_override_created.php',72],['mod/glossary/classes/event','category_updated.php',65],['lib/classes/event','course_updated.php',76],['mod/feedback/classes/event','response_submitted.php',102],['mod/book/classes/event','chapter_deleted.php',88],['mod/wiki/classes/event','comment_created.php',38],['report/completion/classes/event','report_viewed.php',67],['lib/classes/event','recent_activity_viewed.php',76],['mod/quiz/classes/event','question_manually_graded.php',74],['lib/classes/event','user_enrolment_updated.php',72],['lib/classes/event','competency_comment_created.php',49],['report/completion/classes/event','user_report_viewed.php',77],['report/stats/classes/event','report_viewed.php',83],['lib/classes/event','calendar_event_created.php',77],['lib/classes/event','course_section_updated.php',75],['lib/classes/event','message_sent.php',91],['lib/classes/event','calendar_subscription_deleted.php',75],['lib/classes/event','course_category_updated.php',60],['lib/classes/event','user_password_updated.php',95],['mod/forum/classes/event','subscription_deleted.php',74],['lib/classes/event','user_loggedinas.php',85],['lib/classes/event','competency_template_created.php',81],['lib/classes/event','user_created.php',66],['report/loglive/classes/event','report_viewed.php',75],['mod/book/classes/event','chapter_viewed.php',88],['lib/classes/event','badge_awarded.php',72],['lib/classes/event','calendar_subscription_created.php',76],['lib/classes/event','enrol_instance_created.php',78],['lib/classes/event','user_list_viewed.php',74],['mod/forum/classes/event','post_deleted.php',76],['mod/quiz/classes/event','group_override_deleted.php',73],['mod/assign/submission/comments/classes/event','comment_deleted.php',37],['lib/classes/event','badge_created.php',65],['lib/classes/event','base.php',639],['lib/classes/event','competency_framework_viewed.php',78],['mod/glossary/classes/event','course_module_viewed.php',53],['lib/classes/event','group_member_removed.php',78],['lib/classes/event','grade_report_viewed.php',72],['lib/classes/event','calendar_event_updated.php',77],['lib/classes/event','user_updated.php',66],['mod/lesson/classes/event','page_created.php',63],['enrol','locallib.php',1412],['lib/classes/event','blog_comment_deleted.php',38],['backup/util/ui','restore_ui_components.php',98],['lib/classes/event','course_completion_updated.php',65],['lib/classes/event','competency_plan_review_started.php',84],['lib/classes/event','course_user_report_viewed.php',75],['mod/folder/classes/event','all_files_downloaded.php',69],['mod/workshop/classes/event','assessments_reset.php',83],['mod/glossary/classes/event','comment_deleted.php',37],['mod/data/classes/event','template_updated.php',85],['admin/tool/log/store/legacy/classes/event','legacy_logged.php',43],['lib/filebrowser','file_info_context_course.php',505],['lib/classes/event','notes_viewed.php',71],['lib/classes/event','competency_plan_viewed.php',81],['mod/data/classes/event','record_updated.php',75],['lib/classes/event','competency_plan_unapproved.php',84],['mod/lesson/classes/event','content_page_viewed.php',57],['mod/quiz/classes/event','attempt_started.php',80],['lib/classes/event','competency_user_competency_rated.php',91],['mod/forum/classes/event','post_updated.php',76],['lib/classes/event','competency_plan_review_requested.php',84],['lib/classes/event','user_graded.php',115],['mod/forum/classes/event','post_created.php',76],['mod/scorm/classes/event','cmielement_submitted.php',67],['lib/classes/event','enrol_instance_updated.php',79],['admin/tool/capability/classes/event','report_viewed.php',74],['mod/data/classes/event','field_created.php',77],['mod/folder/classes/event','folder_updated.php',66],['lib/classes/event','badge_updated.php',65],['lib/tests/fixtures','event_fixtures.php',47],['lib/tests/fixtures','event_fixtures.php',273],['mod/survey/classes/event','report_viewed.php',73],['mod/quiz/classes/event','attempt_deleted.php',72],['mod/glossary/classes/event','entry_approved.php',65],['mod/wiki/classes/event','comments_viewed.php',68],['mod/wiki/classes/event','page_viewed.php',95],['mod/forum/classes/event','readtracking_disabled.php',73],['admin/tool/langimport/classes/event','langpack_imported.php',89],['lib/classes/event','competency_plan_review_stopped.php',84],['admin/tool/langimport/classes/event','langpack_updated.php',89],['lib/tests','customcontext_test.php',33],['lib/tests','customcontext_test.php',57],['lib/tests','customcontext_test.php',81],['lib/classes/event','competency_user_competency_viewed_in_plan.php',94],['lib/classes/event','competency_user_competency_viewed_in_course.php',93],['mod/glossary/classes/event','category_created.php',65],['report/stats/classes/event','user_report_viewed.php',76],['lib/classes/event','dashboards_reset.php',68],['lib/classes/event','calendar_subscription_updated.php',76],['lib/classes/event','cohort_updated.php',67],['admin/tool/monitor/classes/event','rule_updated.php',68],['mod/lesson/classes/event','page_deleted.php',63],['lib/classes/event','mnet_access_control_created.php',66],['mod/forum/classes/event','discussion_created.php',74],['lib/classes/event','blog_entries_viewed.php',80],['mod/quiz/classes/event','attempt_preview_started.php',73],['lib/classes/event','competency_user_evidence_updated.php',82],['lib/classes/event','course_restored.php',76],['mod/data/classes/event','comment_created.php',37],['lib/classes/event','group_created.php',74],['lib/classes/event','badge_criteria_deleted.php',70],['lib/classes/event','competency_plan_completed.php',84],['mod/lesson/classes/event','user_override_updated.php',73],['lib/classes/event','role_allow_override_updated.php',65],['mod/forum/classes/event','discussion_subscription_deleted.php',75],['lib/classes/event','cohort_deleted.php',67],['lib/classes/event','badge_criteria_created.php',70],['lib/classes/event','blog_entry_created.php',94],['mod/scorm/classes/event','interactions_viewed.php',72],['mod/workshop/classes/event','submission_assessed.php',85],['lib/classes/event','badge_duplicated.php',65],['lib/classes/event','course_category_created.php',57],['lib/classes/event','cohort_created.php',67],['lib/classes/event','competency_plan_approved.php',84],['mod/choice/classes/event','answer_deleted.php',65],['lib/classes/event','competency_user_competency_review_started.php',81],['lib/classes/event','course_reset_ended.php',62],['mod/quiz/classes/event','user_override_created.php',72],['mod/forum/classes/event','course_searched.php',75],['lib/classes/event','message_contact_removed.php',57],['admin/tool/monitor/classes/event','rule_deleted.php',68],['lib/classes/event','competency_user_competency_review_stopped.php',81],['lib/classes/event','course_module_viewed.php',71]], 259],
'instance': ['instance', 'Returns an instance of the cache_factor method. ', [['cache','disabledlib.php',171],['cache','disabledlib.php',296],['lib/classes','useragent.php',101],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',80],['lib/htmlpurifier/HTMLPurifier','URISchemeRegistry.php',9],['search/classes','manager.php',109],['cache','locallib.php',52],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',53],['lib/classes','plugin_manager.php',103],['lib/htmlpurifier','HTMLPurifier.php',251],['course/format','lib.php',156],['lib/classes/update','checker.php',62],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',31],['admin/tool/installaddon/classes','installer.php',40],['lib','modinfolib.php',373],['cache/classes','helper.php',76],['lib/tests','string_manager_standard_test.php',124],['lib/portfolio','exporter.php',251],['lib/classes/update','validator.php',88],['search/classes','document_factory.php',49],['lib','accesslib.php',6235],['lib','accesslib.php',6487],['lib','accesslib.php',6665],['lib','accesslib.php',6919],['lib','accesslib.php',7180],['lib','accesslib.php',7392],['backup/cc/cc_lib','cc_utils.php',387],['backup/cc/cc_lib','cc_utils.php',443],['lib','filterlib.php',80],['search/tests/fixtures','testable_core_search.php',43],['lib/tests/fixtures','testable_update_checker.php',45],['backup/cc','validator.php',35],['cache/classes','config.php',87],['cache/classes','factory.php',114],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',29]], 4647],
'block_contacts_parameters': ['block_contacts_parameters', 'Block contacts parameters description. ', [['message','externallib.php',300]], 1],
'username_load_fields_from_object': ['username_load_fields_from_object', 'Reduces lines of duplicated code for getting user name fields. ', [['lib','moodlelib.php',3418]], 27],
'get_user': ['get_user', 'Returns user data checking the internal static cache. ', [['search/classes','engine.php',119],['lib/classes','user.php',55]], 53],
'message_format_message_text': ['message_format_message_text', 'Try to guess how to convert the message to html. ', [['message','lib.php',972]], 3],
'get_contacts': ['get_contacts', 'Get contacts. ', [['message','externallib.php',421]], 3],
'get_blocked_users_returns': ['get_blocked_users_returns', 'Get blocked users return description. ', [['message','externallib.php',916]], 3],
'message_mark_message_read': ['message_mark_message_read', 'Mark a single message as read ', [['message','lib.php',2530]], 9],
'get_record': ['get_record', 'Load a single record. ', [['competency/classes','persistent.php',738],['lib/dml','moodle_database.php',1462]], 3224],
'unblock_contacts_parameters': ['unblock_contacts_parameters', 'Unblock contacts parameters description. ', [['message','externallib.php',359]], 1],
'search_contacts': ['search_contacts', 'Search contacts. ', [['message','externallib.php',525]], 6],
'get_in_or_equal': ['get_in_or_equal', 'Constructs \'IN()\' or \'=\' sql fragment ', [['lib/dml','oci_native_moodle_database.php',1635],['lib/dml','moodle_database.php',711]], 438],
'get_messages': ['get_messages', 'Returns all redirected messages. ', [['lib/phpunit/classes','phpmailer_sink.php',60],['mod/lesson','locallib.php',1270],['message','externallib.php',638],['lib/classes/update','validator.php',152],['lib/phpunit/classes','message_sink.php',58]], 112],
'block_contacts': ['block_contacts', 'Block contacts. ', [['message','externallib.php',317]], 7],
'delete_contacts': ['delete_contacts', 'Delete contacts. ', [['message','externallib.php',265]], 5],
'get_string': ['get_string', 'Get String returns a requested string ', [['lib/classes','string_manager_install.php',95],['lib','moodlelib.php',6735],['lib','moodlelib.php',9695],['lib/external','externallib.php',102],['question/behaviour','behaviourbase.php',770],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38]], 20134],
'is_real_user': ['is_real_user', 'Return true is user id is greater than self::NOREPLY_USER and alternatively check db. ', [['lib/classes','user.php',225]], 22],
'create_contacts': ['create_contacts', 'Create contacts. ', [['message','externallib.php',206]], 12],
'in_array': ['in_array', '', [], 1234],
'implode': ['implode', '', [], 1281]};
CLASS_DATA={
'external_single_structure': ['external_single_structure', 'Associative array description class ', [['lib','externallib.php',580]], 460],
'external_api': ['external_api', 'Base class for external api methods. ', [['lib','externallib.php',47]], 808],
'external_function_parameters': ['external_function_parameters', 'Description of top level - PHP function parameters. ', [['lib','externallib.php',638]], 344],
'external_warnings': ['external_warnings', 'Standard Moodle web service warnings ', [['lib','externallib.php',768]], 150],
'invalid_parameter_exception': ['invalid_parameter_exception', 'Exception indicating malformed parameter problem. This exception is not supposed to be thrown when processing user submitted data in forms. It is more suitable for WS and other low level stuff. ', [['lib','setuplib.php',259]], 88],
'external_format_value': ['external_format_value', 'A pre-filled external_value class for text format. ', [['lib','externallib.php',799]], 70],
'moodle_exception': ['moodle_exception', 'Base Moodle Exception class ', [['lib','setuplib.php',75]], 606],
'external_multiple_structure': ['external_multiple_structure', 'Bulk array description class. ', [['lib','externallib.php',609]], 350],
'core_message_external': ['core_message_external', 'Message external functions ', [['message','externallib.php',30]], 116],
'user_picture': ['user_picture', 'Data structure representing a user picture. ', [['lib','outputcomponents.php',142]], 165],
'core_user': ['core_user', 'User class to access user details. ', [['lib/classes','user.php',27]], 457],
'external_value': ['external_value', 'Scalar value description class ', [['lib','externallib.php',546]], 2505],
'context_system': ['context_system', 'System context class ', [['lib','accesslib.php',6157]], 1147]};
CONST_DATA={
'PARAM_BOOL': ['PARAM_BOOL', '', [['lib','moodlelib.php',108]], 802],
'SITEID': ['SITEID', '', [['admin/cli','install.php',219],['lib/db','install.php',87],['','install.php',242],['lib','setup.php',755]], 608],
'PARAM_RAW': ['PARAM_RAW', '', [['lib','moodlelib.php',193]], 921],
'MUST_EXIST': ['MUST_EXIST', '', [['lib','dmllib.php',52]], 1384],
'VALUE_REQUIRED': ['VALUE_REQUIRED', '', [['lib','moodlelib.php',332]], 144],
'PARAM_URL': ['PARAM_URL', '', [['lib','moodlelib.php',239]], 165],
'PARAM_NOTAGS': ['PARAM_NOTAGS', '', [['lib','moodlelib.php',172]], 217],
'VALUE_OPTIONAL': ['VALUE_OPTIONAL', '', [['lib','moodlelib.php',337]], 761],
'PARAM_CLEAN': ['PARAM_CLEAN', '', [['lib','moodlelib.php',258]], 60],
'PARAM_ALPHANUMEXT': ['PARAM_ALPHANUMEXT', '', [['lib','moodlelib.php',93]], 200],
'PARAM_TEXT': ['PARAM_TEXT', '', [['lib','moodlelib.php',228]], 542],
'PARAM_INT': ['PARAM_INT', '', [['lib','moodlelib.php',156]], 3812],
'PARAM_ALPHA': ['PARAM_ALPHA', '', [['lib','moodlelib.php',77]], 398],
'VALUE_DEFAULT': ['VALUE_DEFAULT', '', [['lib','moodlelib.php',342]], 304],
'SQL_PARAMS_NAMED': ['SQL_PARAMS_NAMED', '', [['lib/dml','moodle_database.php',32]], 315]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Aug 11 10:00:09 2016</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
