<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /grade/import/xml/lib.php source</title>
    <link rel="stylesheet" href="../../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Aug 11 10:00:09 2016 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../../';
subdir='grade/import/xml';
filename='lib.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/grade/import/xml/</a> -> <a href="lib.php.html">lib.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="lib.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="lib.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">//</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">//</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">//</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l16"><span class="linenum">  16</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l17"><span class="linenum">  17</span></a>  
<a name="l18"><span class="linenum">  18</span></a>  require_once <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/libdir.html">libdir</a>.'/gradelib.php';
<a name="l19"><span class="linenum">  19</span></a>  require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/libdir.html">libdir</a>.'/xmlize.php');
<a name="l20"><span class="linenum">  20</span></a>  require_once <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../../grade/lib.php.html">/grade/lib.php</a>';
<a name="l21"><span class="linenum">  21</span></a>  require_once <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../../grade/import/lib.php.html">/grade/import/lib.php</a>';
<a name="l22"><span class="linenum">  22</span></a>  
<a name="l23"><span class="linenum">  23</span></a>  function <a class="function" onClick="logFunction('import_xml_grades')" href="../../../_functions/import_xml_grades.html" onMouseOver="funcPopup(event,'import_xml_grades')">import_xml_grades</a>(<a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../../_variables/text.html">$text</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../../_variables/course.html">$course</a>, &amp;<a class="var it275" onMouseOver="hilite(275)" onMouseOut="lolite()" onClick="logVariable('error')" href="../../../_variables/error.html">$error</a>) {
<a name="l24"><span class="linenum">  24</span></a>      global <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../../_variables/USER.html">$USER</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l25"><span class="linenum">  25</span></a>  
<a name="l26"><span class="linenum">  26</span></a>      <a class="var it8106" onMouseOver="hilite(8106)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../../_variables/importcode.html">$importcode</a> = <a class="function" onClick="logFunction('get_new_importcode')" href="../../../_functions/get_new_importcode.html" onMouseOver="funcPopup(event,'get_new_importcode')">get_new_importcode</a>();
<a name="l27"><span class="linenum">  27</span></a>  
<a name="l28"><span class="linenum">  28</span></a>      <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../../_variables/status.html">$status</a> = true;
<a name="l29"><span class="linenum">  29</span></a>  
<a name="l30"><span class="linenum">  30</span></a>      <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../../_variables/content.html">$content</a> = <a class="function" onClick="logFunction('xmlize')" href="../../../_functions/xmlize.html" onMouseOver="funcPopup(event,'xmlize')">xmlize</a>(<a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../../_variables/text.html">$text</a>);
<a name="l31"><span class="linenum">  31</span></a>  
<a name="l32"><span class="linenum">  32</span></a>      if (!empty(<a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../../_variables/content.html">$content</a>['results']['#']['result'])) {
<a name="l33"><span class="linenum">  33</span></a>          <a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../../../_variables/results.html">$results</a> = <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../../../_variables/content.html">$content</a>['results']['#']['result'];
<a name="l34"><span class="linenum">  34</span></a>  
<a name="l35"><span class="linenum">  35</span></a>          foreach (<a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../../../_variables/results.html">$results</a> as <a class="var it107" onMouseOver="hilite(107)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../../_variables/i.html">$i</a> =&gt; <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a>) {
<a name="l36"><span class="linenum">  36</span></a>              <a class="var it30092" onMouseOver="hilite(30092)" onMouseOut="lolite()" onClick="logVariable('gradeidnumber')" href="../../../_variables/gradeidnumber.html">$gradeidnumber</a> = <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a>['#']['assignment'][0]['#'];
<a name="l37"><span class="linenum">  37</span></a>              if (!<a class="var it3403" onMouseOver="hilite(3403)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../../_variables/grade_items.html">$grade_items</a> = <a class="class" onClick="logClass('grade_item')" href="../../../_classes/grade_item.html" onMouseOver="classPopup(event,'grade_item')">grade_item</a>::<a class="function" onClick="logFunction('fetch_all')" href="../../../_functions/fetch_all.html" onMouseOver="funcPopup(event,'fetch_all')">fetch_all</a>(array('idnumber'=&gt;<a class="var it30092" onMouseOver="hilite(30092)" onMouseOut="lolite()" onClick="logVariable('gradeidnumber')" href="../../../_variables/gradeidnumber.html">$gradeidnumber</a>, 'courseid'=&gt;<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>))) {
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment">                // gradeitem does not exist</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="comment">                // no data in temp table so far, abort</span>
<a name="l40"><span class="linenum">  40</span></a>                  <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../../_variables/status.html">$status</a> = false;
<a name="l41"><span class="linenum">  41</span></a>                  <a class="var it275" onMouseOver="hilite(275)" onMouseOut="lolite()" onClick="logVariable('error')" href="../../../_variables/error.html">$error</a>  = <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('errincorrectgradeidnumber', 'gradeimport_xml', <a class="var it30092" onMouseOver="hilite(30092)" onMouseOut="lolite()" onClick="logVariable('gradeidnumber')" href="../../../_variables/gradeidnumber.html">$gradeidnumber</a>);
<a name="l42"><span class="linenum">  42</span></a>                  break;
<a name="l43"><span class="linenum">  43</span></a>              } else if (<a class="phpfunction" onClick="logFunction('count')" href="../../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it3403" onMouseOver="hilite(3403)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../../_variables/grade_items.html">$grade_items</a>) != 1) {
<a name="l44"><span class="linenum">  44</span></a>                  <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../../_variables/status.html">$status</a> = false;
<a name="l45"><span class="linenum">  45</span></a>                  <a class="var it275" onMouseOver="hilite(275)" onMouseOut="lolite()" onClick="logVariable('error')" href="../../../_variables/error.html">$error</a>  = <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('errduplicategradeidnumber', 'gradeimport_xml', <a class="var it30092" onMouseOver="hilite(30092)" onMouseOut="lolite()" onClick="logVariable('gradeidnumber')" href="../../../_variables/gradeidnumber.html">$gradeidnumber</a>);
<a name="l46"><span class="linenum">  46</span></a>                  break;
<a name="l47"><span class="linenum">  47</span></a>              } else {
<a name="l48"><span class="linenum">  48</span></a>                  <a class="var it967" onMouseOver="hilite(967)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../../_variables/grade_item.html">$grade_item</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it3403" onMouseOver="hilite(3403)" onMouseOut="lolite()" onClick="logVariable('grade_items')" href="../../../_variables/grade_items.html">$grade_items</a>);
<a name="l49"><span class="linenum">  49</span></a>              }
<a name="l50"><span class="linenum">  50</span></a>  
<a name="l51"><span class="linenum">  51</span></a>  <span class="comment">            // grade item locked, abort</span>
<a name="l52"><span class="linenum">  52</span></a>              if (<a class="var it967" onMouseOver="hilite(967)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../../_variables/grade_item.html">$grade_item</a>-&gt;<a class="function" onClick="logFunction('is_locked')" href="../../../_functions/is_locked.html" onMouseOver="funcPopup(event,'is_locked')">is_locked</a>()) {
<a name="l53"><span class="linenum">  53</span></a>                  <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../../_variables/status.html">$status</a> = false;
<a name="l54"><span class="linenum">  54</span></a>                  <a class="var it275" onMouseOver="hilite(275)" onMouseOut="lolite()" onClick="logVariable('error')" href="../../../_variables/error.html">$error</a>  = <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('gradeitemlocked', 'grades');
<a name="l55"><span class="linenum">  55</span></a>                  break;
<a name="l56"><span class="linenum">  56</span></a>              }
<a name="l57"><span class="linenum">  57</span></a>  
<a name="l58"><span class="linenum">  58</span></a>  <span class="comment">            // check if user exist and convert idnumber to user id</span>
<a name="l59"><span class="linenum">  59</span></a>              <a class="var it30093" onMouseOver="hilite(30093)" onMouseOut="lolite()" onClick="logVariable('useridnumber')" href="../../../_variables/useridnumber.html">$useridnumber</a> = <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a>['#']['student'][0]['#'];
<a name="l60"><span class="linenum">  60</span></a>              if (!<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user', array('idnumber' =&gt;<a class="var it30093" onMouseOver="hilite(30093)" onMouseOut="lolite()" onClick="logVariable('useridnumber')" href="../../../_variables/useridnumber.html">$useridnumber</a>))) {
<a name="l61"><span class="linenum">  61</span></a>  <span class="comment">                // no user found, abort</span>
<a name="l62"><span class="linenum">  62</span></a>                  <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../../_variables/status.html">$status</a> = false;
<a name="l63"><span class="linenum">  63</span></a>                  <a class="var it275" onMouseOver="hilite(275)" onMouseOut="lolite()" onClick="logVariable('error')" href="../../../_variables/error.html">$error</a> = <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('errincorrectuseridnumber', 'gradeimport_xml', <a class="var it30093" onMouseOver="hilite(30093)" onMouseOut="lolite()" onClick="logVariable('useridnumber')" href="../../../_variables/useridnumber.html">$useridnumber</a>);
<a name="l64"><span class="linenum">  64</span></a>                  break;
<a name="l65"><span class="linenum">  65</span></a>              }
<a name="l66"><span class="linenum">  66</span></a>  
<a name="l67"><span class="linenum">  67</span></a>  <span class="comment">            // check if grade_grade is locked and if so, abort</span>
<a name="l68"><span class="linenum">  68</span></a>              if (<a class="var it4757" onMouseOver="hilite(4757)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../../_variables/grade_grade.html">$grade_grade</a> = <span class="keyword">new </span><a class="class" onClick="logClass('grade_grade')" href="../../../_classes/grade_grade.html" onMouseOver="classPopup(event,'grade_grade')">grade_grade</a>(array('itemid'=&gt;<a class="var it967" onMouseOver="hilite(967)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../../_variables/grade_item.html">$grade_item</a>-&gt;<a onClick="logVariable('id')" class="var it43312" onMouseOver="hilite(43312)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>, 'userid'=&gt;<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>))) {
<a name="l69"><span class="linenum">  69</span></a>                  <a class="var it4757" onMouseOver="hilite(4757)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../../_variables/grade_grade.html">$grade_grade</a>-&gt;<a onClick="logVariable('grade_item')" class="var it43318" onMouseOver="hilite(43318)" onMouseOut="lolite()" href="../../../_variables/grade_item.html">grade_item</a> =&amp; <a class="var it967" onMouseOver="hilite(967)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../../_variables/grade_item.html">$grade_item</a>;
<a name="l70"><span class="linenum">  70</span></a>                  if (<a class="var it4757" onMouseOver="hilite(4757)" onMouseOut="lolite()" onClick="logVariable('grade_grade')" href="../../../_variables/grade_grade.html">$grade_grade</a>-&gt;<a class="function" onClick="logFunction('is_locked')" href="../../../_functions/is_locked.html" onMouseOver="funcPopup(event,'is_locked')">is_locked</a>()) {
<a name="l71"><span class="linenum">  71</span></a>  <span class="comment">                    // individual grade locked, abort</span>
<a name="l72"><span class="linenum">  72</span></a>                      <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../../_variables/status.html">$status</a> = false;
<a name="l73"><span class="linenum">  73</span></a>                      <a class="var it275" onMouseOver="hilite(275)" onMouseOut="lolite()" onClick="logVariable('error')" href="../../../_variables/error.html">$error</a>  = <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('gradelocked', 'grades');
<a name="l74"><span class="linenum">  74</span></a>                      break;
<a name="l75"><span class="linenum">  75</span></a>                  }
<a name="l76"><span class="linenum">  76</span></a>              }
<a name="l77"><span class="linenum">  77</span></a>  
<a name="l78"><span class="linenum">  78</span></a>              <a class="var it8647" onMouseOver="hilite(8647)" onMouseOut="lolite()" onClick="logVariable('newgrade')" href="../../../_variables/newgrade.html">$newgrade</a> = new stdClass();
<a name="l79"><span class="linenum">  79</span></a>              <a class="var it8647" onMouseOver="hilite(8647)" onMouseOut="lolite()" onClick="logVariable('newgrade')" href="../../../_variables/newgrade.html">$newgrade</a>-&gt;<a onClick="logVariable('itemid')" class="var it44154" onMouseOver="hilite(44154)" onMouseOut="lolite()" href="../../../_variables/itemid.html">itemid</a>     = <a class="var it967" onMouseOver="hilite(967)" onMouseOut="lolite()" onClick="logVariable('grade_item')" href="../../../_variables/grade_item.html">$grade_item</a>-&gt;<a onClick="logVariable('id')" class="var it43312" onMouseOver="hilite(43312)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>;
<a name="l80"><span class="linenum">  80</span></a>              <a class="var it8647" onMouseOver="hilite(8647)" onMouseOut="lolite()" onClick="logVariable('newgrade')" href="../../../_variables/newgrade.html">$newgrade</a>-&gt;<a onClick="logVariable('userid')" class="var it44154" onMouseOver="hilite(44154)" onMouseOut="lolite()" href="../../../_variables/userid.html">userid</a>     = <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>;
<a name="l81"><span class="linenum">  81</span></a>              <a class="var it8647" onMouseOver="hilite(8647)" onMouseOut="lolite()" onClick="logVariable('newgrade')" href="../../../_variables/newgrade.html">$newgrade</a>-&gt;<a onClick="logVariable('importcode')" class="var it44154" onMouseOver="hilite(44154)" onMouseOut="lolite()" href="../../../_variables/importcode.html">importcode</a> = <a class="var it8106" onMouseOver="hilite(8106)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../../_variables/importcode.html">$importcode</a>;
<a name="l82"><span class="linenum">  82</span></a>              <a class="var it8647" onMouseOver="hilite(8647)" onMouseOut="lolite()" onClick="logVariable('newgrade')" href="../../../_variables/newgrade.html">$newgrade</a>-&gt;<a onClick="logVariable('importer')" class="var it44154" onMouseOver="hilite(44154)" onMouseOut="lolite()" href="../../../_variables/importer.html">importer</a>   = <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>;
<a name="l83"><span class="linenum">  83</span></a>  
<a name="l84"><span class="linenum">  84</span></a>  <span class="comment">            // check grade value exists and is a numeric grade</span>
<a name="l85"><span class="linenum">  85</span></a>              if (isset(<a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a>['#']['score'][0]['#']) &amp;&amp; <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a>['#']['score'][0]['#'] !== '-') {
<a name="l86"><span class="linenum">  86</span></a>                  if (<a class="phpfunction" onClick="logFunction('is_numeric')" href="../../../_functions/is_numeric.html" onMouseOver="phpfuncPopup(event,'is_numeric')">is_numeric</a>(<a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a>['#']['score'][0]['#'])) {
<a name="l87"><span class="linenum">  87</span></a>                      <a class="var it8647" onMouseOver="hilite(8647)" onMouseOut="lolite()" onClick="logVariable('newgrade')" href="../../../_variables/newgrade.html">$newgrade</a>-&gt;<a onClick="logVariable('finalgrade')" class="var it44154" onMouseOver="hilite(44154)" onMouseOut="lolite()" href="../../../_variables/finalgrade.html">finalgrade</a> = <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a>['#']['score'][0]['#'];
<a name="l88"><span class="linenum">  88</span></a>                  } else {
<a name="l89"><span class="linenum">  89</span></a>                      <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../../_variables/status.html">$status</a> = false;
<a name="l90"><span class="linenum">  90</span></a>                      <a class="var it275" onMouseOver="hilite(275)" onMouseOut="lolite()" onClick="logVariable('error')" href="../../../_variables/error.html">$error</a> = <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('badgrade', 'grades');
<a name="l91"><span class="linenum">  91</span></a>                      break;
<a name="l92"><span class="linenum">  92</span></a>                  }
<a name="l93"><span class="linenum">  93</span></a>              } else {
<a name="l94"><span class="linenum">  94</span></a>                  <a class="var it8647" onMouseOver="hilite(8647)" onMouseOut="lolite()" onClick="logVariable('newgrade')" href="../../../_variables/newgrade.html">$newgrade</a>-&gt;<a onClick="logVariable('finalgrade')" class="var it44154" onMouseOver="hilite(44154)" onMouseOut="lolite()" href="../../../_variables/finalgrade.html">finalgrade</a> = NULL;
<a name="l95"><span class="linenum">  95</span></a>              }
<a name="l96"><span class="linenum">  96</span></a>  
<a name="l97"><span class="linenum">  97</span></a>  <span class="comment">            // check grade feedback exists</span>
<a name="l98"><span class="linenum">  98</span></a>              if (isset(<a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a>['#']['feedback'][0]['#'])) {
<a name="l99"><span class="linenum">  99</span></a>                  <a class="var it8647" onMouseOver="hilite(8647)" onMouseOut="lolite()" onClick="logVariable('newgrade')" href="../../../_variables/newgrade.html">$newgrade</a>-&gt;<a onClick="logVariable('feedback')" class="var it44154" onMouseOver="hilite(44154)" onMouseOut="lolite()" href="../../../_variables/feedback.html">feedback</a> = <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a>['#']['feedback'][0]['#'];
<a name="l100"><span class="linenum"> 100</span></a>              } else {
<a name="l101"><span class="linenum"> 101</span></a>                  <a class="var it8647" onMouseOver="hilite(8647)" onMouseOut="lolite()" onClick="logVariable('newgrade')" href="../../../_variables/newgrade.html">$newgrade</a>-&gt;<a onClick="logVariable('feedback')" class="var it44154" onMouseOver="hilite(44154)" onMouseOut="lolite()" href="../../../_variables/feedback.html">feedback</a> = NULL;
<a name="l102"><span class="linenum"> 102</span></a>              }
<a name="l103"><span class="linenum"> 103</span></a>  
<a name="l104"><span class="linenum"> 104</span></a>  <span class="comment">            // insert this grade into a temp table</span>
<a name="l105"><span class="linenum"> 105</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('grade_import_values', <a class="var it8647" onMouseOver="hilite(8647)" onMouseOut="lolite()" onClick="logVariable('newgrade')" href="../../../_variables/newgrade.html">$newgrade</a>);
<a name="l106"><span class="linenum"> 106</span></a>          }
<a name="l107"><span class="linenum"> 107</span></a>  
<a name="l108"><span class="linenum"> 108</span></a>      } else {
<a name="l109"><span class="linenum"> 109</span></a>  <span class="comment">        // no results section found in xml,</span>
<a name="l110"><span class="linenum"> 110</span></a>  <span class="comment">        // assuming bad format, abort import</span>
<a name="l111"><span class="linenum"> 111</span></a>          <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../../_variables/status.html">$status</a> = false;
<a name="l112"><span class="linenum"> 112</span></a>          <a class="var it275" onMouseOver="hilite(275)" onMouseOut="lolite()" onClick="logVariable('error')" href="../../../_variables/error.html">$error</a> = <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('errbadxmlformat', 'gradeimport_xml');
<a name="l113"><span class="linenum"> 113</span></a>      }
<a name="l114"><span class="linenum"> 114</span></a>  
<a name="l115"><span class="linenum"> 115</span></a>      if (<a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../../_variables/status.html">$status</a>) {
<a name="l116"><span class="linenum"> 116</span></a>          return <a class="var it8106" onMouseOver="hilite(8106)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../../_variables/importcode.html">$importcode</a>;
<a name="l117"><span class="linenum"> 117</span></a>  
<a name="l118"><span class="linenum"> 118</span></a>      } else {
<a name="l119"><span class="linenum"> 119</span></a>          <a class="function" onClick="logFunction('import_cleanup')" href="../../../_functions/import_cleanup.html" onMouseOver="funcPopup(event,'import_cleanup')">import_cleanup</a>(<a class="var it8106" onMouseOver="hilite(8106)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../../_variables/importcode.html">$importcode</a>);
<a name="l120"><span class="linenum"> 120</span></a>          return false;
<a name="l121"><span class="linenum"> 121</span></a>      }
<a name="l122"><span class="linenum"> 122</span></a>  }
<a name="l123"><span class="linenum"> 123</span></a>  
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'import_xml_grades': ['import_xml_grades', '', [['grade/import/xml','lib.php',23]], 2],
'fetch_all': ['fetch_all', 'Finds and returns all grade_item instances based on params. ', [['lib/grade','grade_item.php',385],['lib/grade','grade_category.php',209],['lib/grade','grade_scale.php',100],['lib/grade','grade_object.php',138],['completion','data_object.php',165],['lib/grade','grade_grade.php',645],['lib/grade','grade_outcome.php',193],['completion','completion_aggregation.php',79],['completion/criteria','completion_criteria.php',153],['completion','completion_criteria_completion.php',84]], 66],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required, Some conversions and safety checks are carried out. Lobs are supported. If the return ID isn\'t required, then this just reports success as true/false. $data is an object containing needed data ', [['lib/dml','pdo_moodle_database.php',387],['lib/dml','oci_native_moodle_database.php',1297],['lib/dml','pgsql_native_moodle_database.php',889],['lib/dml','mssql_native_moodle_database.php',962],['lib/dml','mysqli_native_moodle_database.php',1185],['question/engine/upgrade','upgradelib.php',124],['lib/dml','sqlsrv_native_moodle_database.php',1045],['lib/dml/tests','dml_test.php',5548]], 1611],
'get_new_importcode': ['get_new_importcode', 'Returns new improtcode for current user ', [['grade/import','lib.php',20]], 8],
'get_record': ['get_record', 'Load a single record. ', [['competency/classes','persistent.php',738],['lib/dml','moodle_database.php',1462]], 3224],
'is_locked': ['is_locked', 'Returns the locked state of this grade_item (if the grade_item is locked OR no specific $userid is given) or the locked state of a specific grade within this item if a specific $userid is given and the grade_item is unlocked. ', [['lib/grade','grade_item.php',518],['lib/grade','grade_category.php',2484],['user/profile','lib.php',364],['lib/grade','grade_grade.php',265],['lib','badgeslib.php',337],['backup/util/settings','setting_dependency.class.php',187],['backup/util/settings','setting_dependency.class.php',340],['backup/util/settings','setting_dependency.class.php',534],['backup/util/settings','setting_dependency.class.php',598]], 57],
'import_cleanup': ['import_cleanup', 'removes entries from grade import buffer tables grade_import_value and grade_import_newitem after a successful import, or during an import abort ', [['grade/import','lib.php',218]], 6],
'xmlize': ['xmlize', 'Create an array structure from an XML string. ', [['lib','xmlize.php',44]], 33],
'get_string': ['get_string', 'Get String returns a requested string ', [['lib/classes','string_manager_install.php',95],['lib','moodlelib.php',6735],['lib','moodlelib.php',9695],['lib/external','externallib.php',102],['question/behaviour','behaviourbase.php',770],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38]], 20134],
'reset': ['reset', '', [], 1213],
'is_numeric': ['is_numeric', '', [], 672],
'count': ['count', '', [], 4095]};
CLASS_DATA={
'grade_item': ['grade_item', 'Class representing a grade item. ', [['lib/grade','grade_item.php',29]], 246],
'grade_grade': ['grade_grade', 'grade_grades is an object mapped to DB table {prefix}grade_grades ', [['lib/grade','grade_grade.php',30]], 154]};
CONST_DATA={
};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Aug 11 10:00:09 2016</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
