<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /grade/import/lib.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu May 28 19:17:31 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='grade/import';
filename='lib.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/grade/import/</a> -> <a href="lib.php.html">lib.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="lib.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="lib.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">//</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">//</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">//</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l16"><span class="linenum">  16</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l17"><span class="linenum">  17</span></a>  
<a name="l18"><span class="linenum">  18</span></a>  require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a>.'/gradelib.php');
<a name="l19"><span class="linenum">  19</span></a>  
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment">/**</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * Returns new improtcode for current user</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @return int importcode</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> */</span>
<a name="l24"><span class="linenum">  24</span></a>  function <a class="function" onClick="logFunction('get_new_importcode')" href="../../_functions/get_new_importcode.html" onMouseOver="funcPopup(event,'get_new_importcode')">get_new_importcode</a>() {
<a name="l25"><span class="linenum">  25</span></a>      global <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l26"><span class="linenum">  26</span></a>  
<a name="l27"><span class="linenum">  27</span></a>      <a class="var it3011" onMouseOver="hilite(3011)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../_variables/importcode.html">$importcode</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l28"><span class="linenum">  28</span></a>      while (<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('grade_import_values', array('importcode' =&gt; <a class="var it3011" onMouseOver="hilite(3011)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../_variables/importcode.html">$importcode</a>, 'importer' =&gt; <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l29"><span class="linenum">  29</span></a>          <a class="var it3011" onMouseOver="hilite(3011)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../_variables/importcode.html">$importcode</a>--;
<a name="l30"><span class="linenum">  30</span></a>      }
<a name="l31"><span class="linenum">  31</span></a>  
<a name="l32"><span class="linenum">  32</span></a>      return <a class="var it3011" onMouseOver="hilite(3011)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../_variables/importcode.html">$importcode</a>;
<a name="l33"><span class="linenum">  33</span></a>  }
<a name="l34"><span class="linenum">  34</span></a>  
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment">/**</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment"> * given an import code, commits all entries in buffer tables</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment"> * (grade_import_value and grade_import_newitem)</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment"> * If this function is called, we assume that all data collected</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="comment"> * up to this point is fine and we can go ahead and commit</span>
<a name="l40"><span class="linenum">  40</span></a>  <span class="comment"> * @param int courseid - id of the course</span>
<a name="l41"><span class="linenum">  41</span></a>  <span class="comment"> * @param string importcode - import batch identifier</span>
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment"> * @param feedback print feedback and continue button</span>
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment"> * @return bool success</span>
<a name="l44"><span class="linenum">  44</span></a>  <span class="comment"> */</span>
<a name="l45"><span class="linenum">  45</span></a>  function <a class="function" onClick="logFunction('grade_import_commit')" href="../../_functions/grade_import_commit.html" onMouseOver="funcPopup(event,'grade_import_commit')">grade_import_commit</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>, <a class="var it3011" onMouseOver="hilite(3011)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../_variables/importcode.html">$importcode</a>, <a class="var it18740" onMouseOver="hilite(18740)" onMouseOut="lolite()" onClick="logVariable('importfeedback')" href="../../_variables/importfeedback.html">$importfeedback</a>=true, <a class="var it14981" onMouseOver="hilite(14981)" onMouseOut="lolite()" onClick="logVariable('verbose')" href="../../_variables/verbose.html">$verbose</a>=true) {
<a name="l46"><span class="linenum">  46</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>;
<a name="l47"><span class="linenum">  47</span></a>  
<a name="l48"><span class="linenum">  48</span></a>      <a class="var it365" onMouseOver="hilite(365)" onMouseOut="lolite()" onClick="logVariable('failed')" href="../../_variables/failed.html">$failed</a> = false;
<a name="l49"><span class="linenum">  49</span></a>      <a class="var it18741" onMouseOver="hilite(18741)" onMouseOut="lolite()" onClick="logVariable('executionerrors')" href="../../_variables/executionerrors.html">$executionerrors</a> = false;
<a name="l50"><span class="linenum">  50</span></a>      <a class="var it18742" onMouseOver="hilite(18742)" onMouseOut="lolite()" onClick="logVariable('commitstart')" href="../../_variables/commitstart.html">$commitstart</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>(); <span class="comment">// start time in case we need to roll back</span>
<a name="l51"><span class="linenum">  51</span></a>      <a class="var it18743" onMouseOver="hilite(18743)" onMouseOut="lolite()" onClick="logVariable('newitemids')" href="../../_variables/newitemids.html">$newitemids</a> = array(); <span class="comment">// array to hold new grade_item ids from grade_import_newitem table, mapping array</span>
<a name="l52"><span class="linenum">  52</span></a>  
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment">    /// first select distinct new grade_items with this batch</span>
<a name="l54"><span class="linenum">  54</span></a>      <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array(<a class="var it3011" onMouseOver="hilite(3011)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../_variables/importcode.html">$importcode</a>, <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l55"><span class="linenum">  55</span></a>      if (<a class="var it18744" onMouseOver="hilite(18744)" onMouseOut="lolite()" onClick="logVariable('newitems')" href="../../_variables/newitems.html">$newitems</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(&quot;SELECT *
<a name="l56"><span class="linenum">  56</span></a>                                             FROM {grade_import_newitem}
<a name="l57"><span class="linenum">  57</span></a>                                            WHERE importcode = ? AND importer=?&quot;, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>)) {
<a name="l58"><span class="linenum">  58</span></a>  
<a name="l59"><span class="linenum">  59</span></a>  <span class="comment">        // instances of the new grade_items created, cached</span>
<a name="l60"><span class="linenum">  60</span></a>  <span class="comment">        // in case grade_update fails, so that we can remove them</span>
<a name="l61"><span class="linenum">  61</span></a>          <a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('instances')" href="../../_variables/instances.html">$instances</a> = array();
<a name="l62"><span class="linenum">  62</span></a>          foreach (<a class="var it18744" onMouseOver="hilite(18744)" onMouseOut="lolite()" onClick="logVariable('newitems')" href="../../_variables/newitems.html">$newitems</a> as <a class="var it1054" onMouseOver="hilite(1054)" onMouseOut="lolite()" onClick="logVariable('newitem')" href="../../_variables/newitem.html">$newitem</a>) {
<a name="l63"><span class="linenum">  63</span></a>  <span class="comment">            // get all grades with this item</span>
<a name="l64"><span class="linenum">  64</span></a>  
<a name="l65"><span class="linenum">  65</span></a>              <a class="var it18745" onMouseOver="hilite(18745)" onMouseOut="lolite()" onClick="logVariable('gradeimportparams')" href="../../_variables/gradeimportparams.html">$gradeimportparams</a> = array('newgradeitem' =&gt; <a class="var it1054" onMouseOver="hilite(1054)" onMouseOut="lolite()" onClick="logVariable('newitem')" href="../../_variables/newitem.html">$newitem</a>-&gt;<a onClick="logVariable('id')" class="var it40193" onMouseOver="hilite(40193)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'importcode' =&gt; <a class="var it3011" onMouseOver="hilite(3011)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../_variables/importcode.html">$importcode</a>, 'importer' =&gt; <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l66"><span class="linenum">  66</span></a>              if (<a class="var it663" onMouseOver="hilite(663)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('grade_import_values', <a class="var it18745" onMouseOver="hilite(18745)" onMouseOut="lolite()" onClick="logVariable('gradeimportparams')" href="../../_variables/gradeimportparams.html">$gradeimportparams</a>)) {
<a name="l67"><span class="linenum">  67</span></a>  <span class="comment">                /// create a new grade item for this - must use false as second param!</span>
<a name="l68"><span class="linenum">  68</span></a>  <span class="comment">                /// TODO: we need some bounds here too</span>
<a name="l69"><span class="linenum">  69</span></a>                  <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a> = <span class="keyword">new </span><a class="class" onClick="logClass('grade_item')" href="../../_classes/grade_item.html" onMouseOver="classPopup(event,'grade_item')">grade_item</a>(array('courseid'=&gt;<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>, 'itemtype'=&gt;'manual', 'itemname'=&gt;<a class="var it1054" onMouseOver="hilite(1054)" onMouseOut="lolite()" onClick="logVariable('newitem')" href="../../_variables/newitem.html">$newitem</a>-&gt;<a onClick="logVariable('itemname')" class="var it40193" onMouseOver="hilite(40193)" onMouseOut="lolite()" href="../../_variables/itemname.html">itemname</a>), false);
<a name="l70"><span class="linenum">  70</span></a>                  <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a class="function" onClick="logFunction('insert')" href="../../_functions/insert.html" onMouseOver="funcPopup(event,'insert')">insert</a>('import');
<a name="l71"><span class="linenum">  71</span></a>                  <a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('instances')" href="../../_variables/instances.html">$instances</a>[] = <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>;
<a name="l72"><span class="linenum">  72</span></a>  
<a name="l73"><span class="linenum">  73</span></a>  <span class="comment">                // insert each individual grade to this new grade item</span>
<a name="l74"><span class="linenum">  74</span></a>                  foreach (<a class="var it663" onMouseOver="hilite(663)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a> as <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>) {
<a name="l75"><span class="linenum">  75</span></a>                      if (!<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a class="function" onClick="logFunction('update_final_grade')" href="../../_functions/update_final_grade.html" onMouseOver="funcPopup(event,'update_final_grade')">update_final_grade</a>(<a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('userid')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>, <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('finalgrade')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/finalgrade.html">finalgrade</a>, 'import', <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('feedback')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/feedback.html">feedback</a>, <a class="constant" onClick="logConstant('FORMAT_MOODLE')" href="../../_constants/FORMAT_MOODLE.html" onMouseOver="constPopup(event,'FORMAT_MOODLE')">FORMAT_MOODLE</a>)) {
<a name="l76"><span class="linenum">  76</span></a>                          <a class="var it365" onMouseOver="hilite(365)" onMouseOut="lolite()" onClick="logVariable('failed')" href="../../_variables/failed.html">$failed</a> = true;
<a name="l77"><span class="linenum">  77</span></a>                          break 2;
<a name="l78"><span class="linenum">  78</span></a>                      }
<a name="l79"><span class="linenum">  79</span></a>                  }
<a name="l80"><span class="linenum">  80</span></a>              }
<a name="l81"><span class="linenum">  81</span></a>          }
<a name="l82"><span class="linenum">  82</span></a>  
<a name="l83"><span class="linenum">  83</span></a>          if (<a class="var it365" onMouseOver="hilite(365)" onMouseOut="lolite()" onClick="logVariable('failed')" href="../../_variables/failed.html">$failed</a>) {
<a name="l84"><span class="linenum">  84</span></a>              foreach (<a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('instances')" href="../../_variables/instances.html">$instances</a> as <a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>) {
<a name="l85"><span class="linenum">  85</span></a>                  <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a class="function" onClick="logFunction('delete')" href="../../_functions/delete.html" onMouseOver="funcPopup(event,'delete')">delete</a>('import');
<a name="l86"><span class="linenum">  86</span></a>              }
<a name="l87"><span class="linenum">  87</span></a>              <a class="function" onClick="logFunction('import_cleanup')" href="../../_functions/import_cleanup.html" onMouseOver="funcPopup(event,'import_cleanup')">import_cleanup</a>(<a class="var it3011" onMouseOver="hilite(3011)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../_variables/importcode.html">$importcode</a>);
<a name="l88"><span class="linenum">  88</span></a>              return false;
<a name="l89"><span class="linenum">  89</span></a>          }
<a name="l90"><span class="linenum">  90</span></a>      }
<a name="l91"><span class="linenum">  91</span></a>  
<a name="l92"><span class="linenum">  92</span></a>  <span class="comment">    /// then find all existing items</span>
<a name="l93"><span class="linenum">  93</span></a>  
<a name="l94"><span class="linenum">  94</span></a>      if (<a class="var it11504" onMouseOver="hilite(11504)" onMouseOut="lolite()" onClick="logVariable('gradeitems')" href="../../_variables/gradeitems.html">$gradeitems</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(&quot;SELECT DISTINCT (itemid)
<a name="l95"><span class="linenum">  95</span></a>                                               FROM {grade_import_values}
<a name="l96"><span class="linenum">  96</span></a>                                              WHERE importcode = ? AND importer=? AND itemid &gt; 0&quot;,
<a name="l97"><span class="linenum">  97</span></a>                                              array(<a class="var it3011" onMouseOver="hilite(3011)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../_variables/importcode.html">$importcode</a>, <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>))) {
<a name="l98"><span class="linenum">  98</span></a>  
<a name="l99"><span class="linenum">  99</span></a>          <a class="var it18746" onMouseOver="hilite(18746)" onMouseOut="lolite()" onClick="logVariable('modifieditems')" href="../../_variables/modifieditems.html">$modifieditems</a> = array();
<a name="l100"><span class="linenum"> 100</span></a>  
<a name="l101"><span class="linenum"> 101</span></a>          foreach (<a class="var it11504" onMouseOver="hilite(11504)" onMouseOut="lolite()" onClick="logVariable('gradeitems')" href="../../_variables/gradeitems.html">$gradeitems</a> as <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>=&gt;<a class="var it2596" onMouseOver="hilite(2596)" onMouseOut="lolite()" onClick="logVariable('notused')" href="../../_variables/notused.html">$notused</a>) {
<a name="l102"><span class="linenum"> 102</span></a>  
<a name="l103"><span class="linenum"> 103</span></a>              if (!<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a> = <span class="keyword">new </span><a class="class" onClick="logClass('grade_item')" href="../../_classes/grade_item.html" onMouseOver="classPopup(event,'grade_item')">grade_item</a>(array('id'=&gt;<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>))) {
<a name="l104"><span class="linenum"> 104</span></a>  <span class="comment">                // not supposed to happen, but just in case</span>
<a name="l105"><span class="linenum"> 105</span></a>                  <a class="function" onClick="logFunction('import_cleanup')" href="../../_functions/import_cleanup.html" onMouseOver="funcPopup(event,'import_cleanup')">import_cleanup</a>(<a class="var it3011" onMouseOver="hilite(3011)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../_variables/importcode.html">$importcode</a>);
<a name="l106"><span class="linenum"> 106</span></a>                  return false;
<a name="l107"><span class="linenum"> 107</span></a>              }
<a name="l108"><span class="linenum"> 108</span></a>  <span class="comment">            // get all grades with this item</span>
<a name="l109"><span class="linenum"> 109</span></a>              <a class="var it18745" onMouseOver="hilite(18745)" onMouseOut="lolite()" onClick="logVariable('gradeimportparams')" href="../../_variables/gradeimportparams.html">$gradeimportparams</a> = array('itemid' =&gt; <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>, 'importcode' =&gt; <a class="var it3011" onMouseOver="hilite(3011)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../_variables/importcode.html">$importcode</a>, 'importer' =&gt; <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l110"><span class="linenum"> 110</span></a>              if (<a class="var it663" onMouseOver="hilite(663)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('grade_import_values', <a class="var it18745" onMouseOver="hilite(18745)" onMouseOut="lolite()" onClick="logVariable('gradeimportparams')" href="../../_variables/gradeimportparams.html">$gradeimportparams</a>)) {
<a name="l111"><span class="linenum"> 111</span></a>  
<a name="l112"><span class="linenum"> 112</span></a>  <span class="comment">                // make the grades array for update_grade</span>
<a name="l113"><span class="linenum"> 113</span></a>                  foreach (<a class="var it663" onMouseOver="hilite(663)" onMouseOut="lolite()" onClick="logVariable('grades')" href="../../_variables/grades.html">$grades</a> as <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>) {
<a name="l114"><span class="linenum"> 114</span></a>                      if (!<a class="var it18740" onMouseOver="hilite(18740)" onMouseOut="lolite()" onClick="logVariable('importfeedback')" href="../../_variables/importfeedback.html">$importfeedback</a>) {
<a name="l115"><span class="linenum"> 115</span></a>                          <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('feedback')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/feedback.html">feedback</a> = false; <span class="comment">// ignore it</span>
<a name="l116"><span class="linenum"> 116</span></a>                      }
<a name="l117"><span class="linenum"> 117</span></a>                      if (!<a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a class="function" onClick="logFunction('update_final_grade')" href="../../_functions/update_final_grade.html" onMouseOver="funcPopup(event,'update_final_grade')">update_final_grade</a>(<a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('userid')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>, <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('finalgrade')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/finalgrade.html">finalgrade</a>, 'import', <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('feedback')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/feedback.html">feedback</a>)) {
<a name="l118"><span class="linenum"> 118</span></a>                          <a class="var it18747" onMouseOver="hilite(18747)" onMouseOut="lolite()" onClick="logVariable('errordata')" href="../../_variables/errordata.html">$errordata</a> = new stdClass();
<a name="l119"><span class="linenum"> 119</span></a>                          <a class="var it18747" onMouseOver="hilite(18747)" onMouseOut="lolite()" onClick="logVariable('errordata')" href="../../_variables/errordata.html">$errordata</a>-&gt;<a onClick="logVariable('itemname')" class="var it41345" onMouseOver="hilite(41345)" onMouseOut="lolite()" href="../../_variables/itemname.html">itemname</a> = <a class="var it3925" onMouseOver="hilite(3925)" onMouseOut="lolite()" onClick="logVariable('gradeitem')" href="../../_variables/gradeitem.html">$gradeitem</a>-&gt;<a onClick="logVariable('itemname')" class="var it39531" onMouseOver="hilite(39531)" onMouseOut="lolite()" href="../../_variables/itemname.html">itemname</a>;
<a name="l120"><span class="linenum"> 120</span></a>                          <a class="var it18747" onMouseOver="hilite(18747)" onMouseOut="lolite()" onClick="logVariable('errordata')" href="../../_variables/errordata.html">$errordata</a>-&gt;<a onClick="logVariable('userid')" class="var it41345" onMouseOver="hilite(41345)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> = <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../_variables/grade.html">$grade</a>-&gt;<a onClick="logVariable('userid')" class="var it39944" onMouseOver="hilite(39944)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a>;
<a name="l121"><span class="linenum"> 121</span></a>                          <a class="var it18741" onMouseOver="hilite(18741)" onMouseOut="lolite()" onClick="logVariable('executionerrors')" href="../../_variables/executionerrors.html">$executionerrors</a>[] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('errorsettinggrade', 'grades', <a class="var it18747" onMouseOver="hilite(18747)" onMouseOut="lolite()" onClick="logVariable('errordata')" href="../../_variables/errordata.html">$errordata</a>);
<a name="l122"><span class="linenum"> 122</span></a>                          <a class="var it365" onMouseOver="hilite(365)" onMouseOut="lolite()" onClick="logVariable('failed')" href="../../_variables/failed.html">$failed</a> = true;
<a name="l123"><span class="linenum"> 123</span></a>                          break 2;
<a name="l124"><span class="linenum"> 124</span></a>                      }
<a name="l125"><span class="linenum"> 125</span></a>                  }
<a name="l126"><span class="linenum"> 126</span></a>  <span class="comment">                //$itemdetails -&gt; idnumber = $gradeitem-&gt;idnumber;</span>
<a name="l127"><span class="linenum"> 127</span></a>                  <a class="var it18746" onMouseOver="hilite(18746)" onMouseOut="lolite()" onClick="logVariable('modifieditems')" href="../../_variables/modifieditems.html">$modifieditems</a>[] = <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>;
<a name="l128"><span class="linenum"> 128</span></a>  
<a name="l129"><span class="linenum"> 129</span></a>              }
<a name="l130"><span class="linenum"> 130</span></a>          }
<a name="l131"><span class="linenum"> 131</span></a>  
<a name="l132"><span class="linenum"> 132</span></a>          if (<a class="var it365" onMouseOver="hilite(365)" onMouseOut="lolite()" onClick="logVariable('failed')" href="../../_variables/failed.html">$failed</a>) {
<a name="l133"><span class="linenum"> 133</span></a>              if (<a class="var it18741" onMouseOver="hilite(18741)" onMouseOut="lolite()" onClick="logVariable('executionerrors')" href="../../_variables/executionerrors.html">$executionerrors</a> &amp;&amp; <a class="var it14981" onMouseOver="hilite(14981)" onMouseOut="lolite()" onClick="logVariable('verbose')" href="../../_variables/verbose.html">$verbose</a>) {
<a name="l134"><span class="linenum"> 134</span></a>                  echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('gradeimportfailed', 'grades'));
<a name="l135"><span class="linenum"> 135</span></a>                  foreach (<a class="var it18741" onMouseOver="hilite(18741)" onMouseOut="lolite()" onClick="logVariable('executionerrors')" href="../../_variables/executionerrors.html">$executionerrors</a> as <a class="var it15456" onMouseOver="hilite(15456)" onMouseOut="lolite()" onClick="logVariable('errorstr')" href="../../_variables/errorstr.html">$errorstr</a>) {
<a name="l136"><span class="linenum"> 136</span></a>                      echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="var it15456" onMouseOver="hilite(15456)" onMouseOut="lolite()" onClick="logVariable('errorstr')" href="../../_variables/errorstr.html">$errorstr</a>);
<a name="l137"><span class="linenum"> 137</span></a>                  }
<a name="l138"><span class="linenum"> 138</span></a>              }
<a name="l139"><span class="linenum"> 139</span></a>              <a class="function" onClick="logFunction('import_cleanup')" href="../../_functions/import_cleanup.html" onMouseOver="funcPopup(event,'import_cleanup')">import_cleanup</a>(<a class="var it3011" onMouseOver="hilite(3011)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../_variables/importcode.html">$importcode</a>);
<a name="l140"><span class="linenum"> 140</span></a>              return false;
<a name="l141"><span class="linenum"> 141</span></a>          }
<a name="l142"><span class="linenum"> 142</span></a>      }
<a name="l143"><span class="linenum"> 143</span></a>  
<a name="l144"><span class="linenum"> 144</span></a>      if (<a class="var it14981" onMouseOver="hilite(14981)" onMouseOut="lolite()" onClick="logVariable('verbose')" href="../../_variables/verbose.html">$verbose</a>) {
<a name="l145"><span class="linenum"> 145</span></a>          echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('importsuccess', 'grades'), 'notifysuccess');
<a name="l146"><span class="linenum"> 146</span></a>          <a class="var it18748" onMouseOver="hilite(18748)" onMouseOut="lolite()" onClick="logVariable('unenrolledusers')" href="../../_variables/unenrolledusers.html">$unenrolledusers</a> = <a class="function" onClick="logFunction('get_unenrolled_users_in_import')" href="../../_functions/get_unenrolled_users_in_import.html" onMouseOver="funcPopup(event,'get_unenrolled_users_in_import')">get_unenrolled_users_in_import</a>(<a class="var it3011" onMouseOver="hilite(3011)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../_variables/importcode.html">$importcode</a>, <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>);
<a name="l147"><span class="linenum"> 147</span></a>          if (<a class="var it18748" onMouseOver="hilite(18748)" onMouseOut="lolite()" onClick="logVariable('unenrolledusers')" href="../../_variables/unenrolledusers.html">$unenrolledusers</a>) {
<a name="l148"><span class="linenum"> 148</span></a>              <a class="var it301" onMouseOver="hilite(301)" onMouseOut="lolite()" onClick="logVariable('list')" href="../../_variables/list.html">$list</a> = array();
<a name="l149"><span class="linenum"> 149</span></a>              foreach (<a class="var it18748" onMouseOver="hilite(18748)" onMouseOut="lolite()" onClick="logVariable('unenrolledusers')" href="../../_variables/unenrolledusers.html">$unenrolledusers</a> as <a class="var it6456" onMouseOver="hilite(6456)" onMouseOut="lolite()" onClick="logVariable('u')" href="../../_variables/u.html">$u</a>) {
<a name="l150"><span class="linenum"> 150</span></a>                  <a class="var it6456" onMouseOver="hilite(6456)" onMouseOut="lolite()" onClick="logVariable('u')" href="../../_variables/u.html">$u</a>-&gt;<a onClick="logVariable('fullname')" class="var it40644" onMouseOver="hilite(40644)" onMouseOut="lolite()" href="../../_variables/fullname.html">fullname</a> = <a class="function" onClick="logFunction('fullname')" href="../../_functions/fullname.html" onMouseOver="funcPopup(event,'fullname')">fullname</a>(<a class="var it6456" onMouseOver="hilite(6456)" onMouseOut="lolite()" onClick="logVariable('u')" href="../../_variables/u.html">$u</a>);
<a name="l151"><span class="linenum"> 151</span></a>                  <a class="var it301" onMouseOver="hilite(301)" onMouseOut="lolite()" onClick="logVariable('list')" href="../../_variables/list.html">$list</a>[] = <a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('usergrade', 'grades', <a class="var it6456" onMouseOver="hilite(6456)" onMouseOut="lolite()" onClick="logVariable('u')" href="../../_variables/u.html">$u</a>);
<a name="l152"><span class="linenum"> 152</span></a>              }
<a name="l153"><span class="linenum"> 153</span></a>              echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="function" onClick="logFunction('get_string')" href="../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('unenrolledusersinimport', 'grades', <a class="class" onClick="logClass('html_writer')" href="../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('alist')" href="../../_functions/alist.html" onMouseOver="funcPopup(event,'alist')">alist</a>(<a class="var it301" onMouseOver="hilite(301)" onMouseOut="lolite()" onClick="logVariable('list')" href="../../_variables/list.html">$list</a>)), 'notifysuccess');
<a name="l154"><span class="linenum"> 154</span></a>          }
<a name="l155"><span class="linenum"> 155</span></a>          echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('continue_button')" href="../../_functions/continue_button.html" onMouseOver="funcPopup(event,'continue_button')">continue_button</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/wwwroot.html">wwwroot</a>.'/grade/index.php?id='.<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>);
<a name="l156"><span class="linenum"> 156</span></a>      }
<a name="l157"><span class="linenum"> 157</span></a>  <span class="comment">    // clean up</span>
<a name="l158"><span class="linenum"> 158</span></a>      <a class="function" onClick="logFunction('import_cleanup')" href="../../_functions/import_cleanup.html" onMouseOver="funcPopup(event,'import_cleanup')">import_cleanup</a>(<a class="var it3011" onMouseOver="hilite(3011)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../_variables/importcode.html">$importcode</a>);
<a name="l159"><span class="linenum"> 159</span></a>  
<a name="l160"><span class="linenum"> 160</span></a>      return true;
<a name="l161"><span class="linenum"> 161</span></a>  }
<a name="l162"><span class="linenum"> 162</span></a>  
<a name="l163"><span class="linenum"> 163</span></a>  <span class="comment">/**</span>
<a name="l164"><span class="linenum"> 164</span></a>  <span class="comment"> * This function returns an array of grades that were included in the import,</span>
<a name="l165"><span class="linenum"> 165</span></a>  <span class="comment"> * but where the user does not currently have a graded role on the course. These grades</span>
<a name="l166"><span class="linenum"> 166</span></a>  <span class="comment"> * are still stored in the database, but will not be visible in the gradebook unless</span>
<a name="l167"><span class="linenum"> 167</span></a>  <span class="comment"> * this user subsequently enrols on the course in a graded roles.</span>
<a name="l168"><span class="linenum"> 168</span></a>  <span class="comment"> *</span>
<a name="l169"><span class="linenum"> 169</span></a>  <span class="comment"> * The returned objects have fields user firstname, lastname and useridnumber, and gradeidnumber.</span>
<a name="l170"><span class="linenum"> 170</span></a>  <span class="comment"> *</span>
<a name="l171"><span class="linenum"> 171</span></a>  <span class="comment"> * @param integer $importcode import batch identifier</span>
<a name="l172"><span class="linenum"> 172</span></a>  <span class="comment"> * @param integer $courseid the course we are importing to.</span>
<a name="l173"><span class="linenum"> 173</span></a>  <span class="comment"> * @return mixed and array of user objects, or false if none.</span>
<a name="l174"><span class="linenum"> 174</span></a>  <span class="comment"> */</span>
<a name="l175"><span class="linenum"> 175</span></a>  function <a class="function" onClick="logFunction('get_unenrolled_users_in_import')" href="../../_functions/get_unenrolled_users_in_import.html" onMouseOver="funcPopup(event,'get_unenrolled_users_in_import')">get_unenrolled_users_in_import</a>(<a class="var it3011" onMouseOver="hilite(3011)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../_variables/importcode.html">$importcode</a>, <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>) {
<a name="l176"><span class="linenum"> 176</span></a>      global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l177"><span class="linenum"> 177</span></a>  
<a name="l178"><span class="linenum"> 178</span></a>      <a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../../_variables/coursecontext.html">$coursecontext</a> = <a class="class" onClick="logClass('context_course')" href="../../_classes/context_course.html" onMouseOver="classPopup(event,'context_course')">context_course</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>);
<a name="l179"><span class="linenum"> 179</span></a>  
<a name="l180"><span class="linenum"> 180</span></a>  <span class="comment">    // We want to query both the current context and parent contexts.</span>
<a name="l181"><span class="linenum"> 181</span></a>      <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it7804" onMouseOver="hilite(7804)" onMouseOut="lolite()" onClick="logVariable('relatedctxsql')" href="../../_variables/relatedctxsql.html">$relatedctxsql</a>, <a class="var it7805" onMouseOver="hilite(7805)" onMouseOut="lolite()" onClick="logVariable('relatedctxparams')" href="../../_variables/relatedctxparams.html">$relatedctxparams</a>) = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it1590" onMouseOver="hilite(1590)" onMouseOut="lolite()" onClick="logVariable('coursecontext')" href="../../_variables/coursecontext.html">$coursecontext</a>-&gt;<a class="function" onClick="logFunction('get_parent_context_ids')" href="../../_functions/get_parent_context_ids.html" onMouseOver="funcPopup(event,'get_parent_context_ids')">get_parent_context_ids</a>(true), <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'relatedctx');
<a name="l182"><span class="linenum"> 182</span></a>  
<a name="l183"><span class="linenum"> 183</span></a>  <span class="comment">    // Users with a gradeable role.</span>
<a name="l184"><span class="linenum"> 184</span></a>      <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it18749" onMouseOver="hilite(18749)" onMouseOut="lolite()" onClick="logVariable('gradebookrolessql')" href="../../_variables/gradebookrolessql.html">$gradebookrolessql</a>, <a class="var it18750" onMouseOver="hilite(18750)" onMouseOut="lolite()" onClick="logVariable('gradebookrolesparams')" href="../../_variables/gradebookrolesparams.html">$gradebookrolesparams</a>) = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(',', <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('gradebookroles')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../_variables/gradebookroles.html">gradebookroles</a>), <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'grbr');
<a name="l185"><span class="linenum"> 185</span></a>  
<a name="l186"><span class="linenum"> 186</span></a>  <span class="comment">    // Enrolled users.</span>
<a name="l187"><span class="linenum"> 187</span></a>      <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_course')" href="../../_classes/context_course.html" onMouseOver="classPopup(event,'context_course')">context_course</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../_variables/courseid.html">$courseid</a>);
<a name="l188"><span class="linenum"> 188</span></a>      <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it18752" onMouseOver="hilite(18752)" onMouseOut="lolite()" onClick="logVariable('enrolledsql')" href="../../_variables/enrolledsql.html">$enrolledsql</a>, <a class="var it18753" onMouseOver="hilite(18753)" onMouseOut="lolite()" onClick="logVariable('enrolledparams')" href="../../_variables/enrolledparams.html">$enrolledparams</a>) = <a class="function" onClick="logFunction('get_enrolled_sql')" href="../../_functions/get_enrolled_sql.html" onMouseOver="funcPopup(event,'get_enrolled_sql')">get_enrolled_sql</a>(<a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l189"><span class="linenum"> 189</span></a>      <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it124" onMouseOver="hilite(124)" onMouseOut="lolite()" onClick="logVariable('sort')" href="../../_variables/sort.html">$sort</a>, <a class="var it533" onMouseOver="hilite(533)" onMouseOut="lolite()" onClick="logVariable('sortparams')" href="../../_variables/sortparams.html">$sortparams</a>) = <a class="function" onClick="logFunction('users_order_by_sql')" href="../../_functions/users_order_by_sql.html" onMouseOver="funcPopup(event,'users_order_by_sql')">users_order_by_sql</a>('u');
<a name="l190"><span class="linenum"> 190</span></a>  
<a name="l191"><span class="linenum"> 191</span></a>      <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;SELECT giv.id, u.firstname, u.lastname, u.idnumber AS useridnumber,
<a name="l192"><span class="linenum"> 192</span></a>                     COALESCE(gi.idnumber, gin.itemname) AS gradeidnumber
<a name="l193"><span class="linenum"> 193</span></a>                FROM {grade_import_values} giv
<a name="l194"><span class="linenum"> 194</span></a>                JOIN {user} u
<a name="l195"><span class="linenum"> 195</span></a>                     ON giv.userid = u.id
<a name="l196"><span class="linenum"> 196</span></a>                LEFT JOIN {grade_items} gi
<a name="l197"><span class="linenum"> 197</span></a>                          ON gi.id = giv.itemid
<a name="l198"><span class="linenum"> 198</span></a>                LEFT JOIN {grade_import_newitem} gin
<a name="l199"><span class="linenum"> 199</span></a>                          ON gin.id = giv.newgradeitem
<a name="l200"><span class="linenum"> 200</span></a>                LEFT <a class="function" onClick="logFunction('JOIN')" href="../../_functions/join.html" onMouseOver="funcPopup(event,'join')">JOIN</a> (<a class="var it18752" onMouseOver="hilite(18752)" onMouseOut="lolite()" onClick="logVariable('enrolledsql')" href="../../_variables/enrolledsql.html">$enrolledsql</a>) je
<a name="l201"><span class="linenum"> 201</span></a>                          ON je.id = u.id
<a name="l202"><span class="linenum"> 202</span></a>                LEFT JOIN {role_assignments} ra
<a name="l203"><span class="linenum"> 203</span></a>                          <a class="function" onClick="logFunction('ON')" href="../../_functions/on.html" onMouseOver="funcPopup(event,'on')">ON</a> (giv.userid = ra.userid AND ra.roleid <a class="var it18749" onMouseOver="hilite(18749)" onMouseOut="lolite()" onClick="logVariable('gradebookrolessql')" href="../../_variables/gradebookrolessql.html">$gradebookrolessql</a> AND ra.contextid <a class="var it7804" onMouseOver="hilite(7804)" onMouseOut="lolite()" onClick="logVariable('relatedctxsql')" href="../../_variables/relatedctxsql.html">$relatedctxsql</a>)
<a name="l204"><span class="linenum"> 204</span></a>               WHERE giv.importcode = :importcode
<a name="l205"><span class="linenum"> 205</span></a>                     AND (ra.id IS NULL OR je.id IS NULL)
<a name="l206"><span class="linenum"> 206</span></a>            ORDER BY gradeidnumber, <a class="var it124" onMouseOver="hilite(124)" onMouseOut="lolite()" onClick="logVariable('sort')" href="../../_variables/sort.html">$sort</a>&quot;;
<a name="l207"><span class="linenum"> 207</span></a>      <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it18750" onMouseOver="hilite(18750)" onMouseOut="lolite()" onClick="logVariable('gradebookrolesparams')" href="../../_variables/gradebookrolesparams.html">$gradebookrolesparams</a>, <a class="var it18753" onMouseOver="hilite(18753)" onMouseOut="lolite()" onClick="logVariable('enrolledparams')" href="../../_variables/enrolledparams.html">$enrolledparams</a>, <a class="var it533" onMouseOver="hilite(533)" onMouseOut="lolite()" onClick="logVariable('sortparams')" href="../../_variables/sortparams.html">$sortparams</a>, <a class="var it7805" onMouseOver="hilite(7805)" onMouseOut="lolite()" onClick="logVariable('relatedctxparams')" href="../../_variables/relatedctxparams.html">$relatedctxparams</a>);
<a name="l208"><span class="linenum"> 208</span></a>      <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['importcode'] = <a class="var it3011" onMouseOver="hilite(3011)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../_variables/importcode.html">$importcode</a>;
<a name="l209"><span class="linenum"> 209</span></a>  
<a name="l210"><span class="linenum"> 210</span></a>      return <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l211"><span class="linenum"> 211</span></a>  }
<a name="l212"><span class="linenum"> 212</span></a>  
<a name="l213"><span class="linenum"> 213</span></a>  <span class="comment">/**</span>
<a name="l214"><span class="linenum"> 214</span></a>  <span class="comment"> * removes entries from grade import buffer tables grade_import_value and grade_import_newitem</span>
<a name="l215"><span class="linenum"> 215</span></a>  <span class="comment"> * after a successful import, or during an import abort</span>
<a name="l216"><span class="linenum"> 216</span></a>  <span class="comment"> * @param string importcode - import batch identifier</span>
<a name="l217"><span class="linenum"> 217</span></a>  <span class="comment"> */</span>
<a name="l218"><span class="linenum"> 218</span></a>  function <a class="function" onClick="logFunction('import_cleanup')" href="../../_functions/import_cleanup.html" onMouseOver="funcPopup(event,'import_cleanup')">import_cleanup</a>(<a class="var it3011" onMouseOver="hilite(3011)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../_variables/importcode.html">$importcode</a>) {
<a name="l219"><span class="linenum"> 219</span></a>      global <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l220"><span class="linenum"> 220</span></a>  
<a name="l221"><span class="linenum"> 221</span></a>  <span class="comment">    // remove entries from buffer table</span>
<a name="l222"><span class="linenum"> 222</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('grade_import_values', array('importcode' =&gt; <a class="var it3011" onMouseOver="hilite(3011)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../_variables/importcode.html">$importcode</a>, 'importer' =&gt; <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l223"><span class="linenum"> 223</span></a>      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('grade_import_newitem', array('importcode' =&gt; <a class="var it3011" onMouseOver="hilite(3011)" onMouseOut="lolite()" onClick="logVariable('importcode')" href="../../_variables/importcode.html">$importcode</a>, 'importer' =&gt; <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l224"><span class="linenum"> 224</span></a>  }
<a name="l225"><span class="linenum"> 225</span></a>  
<a name="l226"><span class="linenum"> 226</span></a>  
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'continue_button': ['continue_button', 'Displays a continue button ', [['backup/util/ui','renderer.php',501],['lib','outputrenderers.php',2875]], 104],
'get_new_importcode': ['get_new_importcode', 'Returns new improtcode for current user ', [['grade/import','lib.php',20]], 3],
'notification': ['notification', 'Output a notification (that is, a status message about something that has just happened). ', [['lib','outputrenderers.php',2762],['lib','outputrenderers.php',4128],['lib','outputrenderers.php',4201]], 495],
'get_unenrolled_users_in_import': ['get_unenrolled_users_in_import', 'This function returns an array of grades that were included in the import, but where the user does not currently have a graded role on the course. These grades are still stored in the database, but will not be visible in the gradebook unless this user subsequently enrols on the course in a graded roles. ', [['grade/import','lib.php',163]], 1],
'on': ['on', '', [['lib/requirejs','require.js',506]], 3494],
'fullname': ['fullname', 'Returns a persons full name ', [['lib','moodlelib.php',3234],['mod/assign','locallib.php',3440]], 532],
'grade_import_commit': ['grade_import_commit', 'given an import code, commits all entries in buffer tables (grade_import_value and grade_import_newitem) If this function is called, we assume that all data collected up to this point is fine and we can go ahead and commit ', [['grade/import','lib.php',35]], 6],
'get_string': ['get_string', 'Return a core get_string() call ', [['lib/external','externallib.php',112],['lib','moodlelib.php',6538],['lib','moodlelib.php',9417],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38],['lib/classes','string_manager_install.php',95],['question/behaviour','behaviourbase.php',756]], 19235],
'delete': ['delete', 'Deletes a key pair ', [['lib/zend/Zend/Service/Amazon/Ec2','Keypair.php',110],['lib/google/src/Google/Service','Reseller.php',440],['lib/phpexcel/PHPExcel/Shared/PCLZip','pclzip.lib.php',1006],['lib/adodb','adodb-active-recordx.inc.php',949],['lib/zend/Zend/Service/Delicious','Post.php',236],['lib/grade','grade_object.php',270],['lib/zend/Zend/Gdata','Gapps.php',258],['lib/google/src/Google/Service','Fusiontables.php',644],['lib/google/src/Google/Service','Fusiontables.php',809],['lib/google/src/Google/Service','Fusiontables.php',934],['lib/google/src/Google/Service','Fusiontables.php',1127],['lib/google/src/Google/Service','Fusiontables.php',1188],['blog','locallib.php',325],['lib/google/src/Google/Service','Blogger.php',1051],['lib/google/src/Google/Service','Blogger.php',1212],['lib/google/src/Google/Service','Blogger.php',1434],['lib/portfolio','plugin.php',692],['lib/google/src/Google/Service','AdExchangeBuyer.php',605],['lib/google/src/Google/Service','Manager.php',240],['lib/google/src/Google/Service','Manager.php',320],['lib/zend/Zend/Service/Amazon/Ec2','Securitygroups.php',137],['lib','webdavlib.php',691],['lib/grade','grade_item.php',354],['lib/google/src/Google/Service','Gmail.php',686],['lib/google/src/Google/Service','Gmail.php',843],['lib/google/src/Google/Service','Gmail.php',936],['lib/google/src/Google/Service','Gmail.php',1146],['course','lib.php',3133],['lib/google/src/Google/Service','Mirror.php',424],['lib/google/src/Google/Service','Mirror.php',592],['lib/google/src/Google/Service','Mirror.php',660],['lib/google/src/Google/Service','Mirror.php',771],['lib/google/src/Google/Service','Genomics.php',632],['lib/google/src/Google/Service','Genomics.php',731],['lib/google/src/Google/Service','Genomics.php',963],['lib/google/src/Google/Service','Genomics.php',1327],['lib/google/src/Google/Service','Genomics.php',1399],['cache/classes','interfaces.php',161],['lib/google/src/Google/Service','Dfareporting.php',470],['lib/zend/Zend/Gdata/Gbase','ItemEntry.php',133],['lib/google/src/Google/Service','Licensing.php',221],['lib/google/src/Google/Service','Drive.php',1462],['lib/google/src/Google/Service','Drive.php',1536],['lib/google/src/Google/Service','Drive.php',1681],['lib/google/src/Google/Service','Drive.php',1932],['lib/google/src/Google/Service','Drive.php',2002],['lib/google/src/Google/Service','Drive.php',2131],['lib/google/src/Google/Service','Drive.php',2294],['lib/google/src/Google/Service','Drive.php',2414],['completion','data_object.php',272],['lib/google/src/Google/Service','Books.php',1804],['lib/zend/Zend/Gdata','App.php',914],['lib/google/src/Google/Cache','Memcache.php',142],['lib/google/src/Google/Service','Bigquery.php',512],['lib/google/src/Google/Service','Bigquery.php',822],['cache','disabledlib.php',102],['lib/zend/Zend/Server','Cache.php',132],['lib/zend/Zend/Gdata/App','Entry.php',212],['cache/stores/memcached','lib.php',368],['lib/google/src/Google/Service','YouTube.php',1470],['lib/google/src/Google/Service','YouTube.php',1979],['lib/google/src/Google/Service','YouTube.php',2277],['lib/google/src/Google/Service','YouTube.php',2510],['lib/google/src/Google/Service','YouTube.php',2657],['lib/google/src/Google/Service','YouTube.php',2998],['lib/google/src/Google/Service','YouTube.php',3196],['lib/google/src/Google/Service','Webmasters.php',298],['lib/google/src/Google/Service','Webmasters.php',388],['lib/google/src/Google/Service','Autoscaler.php',314],['lib/google/src/Google/Service','Autoscaler.php',428],['calendar','lib.php',2388],['lib/zend/Zend/Service/Amazon','Sqs.php',129],['lib/google/src/Google/Service','ShoppingContent.php',553],['lib/google/src/Google/Service','ShoppingContent.php',735],['lib/google/src/Google/Service','ShoppingContent.php',969],['mod/lesson','locallib.php',1039],['mod/lesson','locallib.php',2274],['lib/google/src/Google/Service','SQLAdmin.php',628],['lib/google/src/Google/Service','SQLAdmin.php',923],['lib/google/src/Google/Service','Fitness.php',458],['lib/google/src/Google/Service','Fitness.php',563],['lib/google/src/Google/Service','TagManager.php',1049],['lib/google/src/Google/Service','TagManager.php',1140],['lib/google/src/Google/Service','TagManager.php',1233],['lib/google/src/Google/Service','TagManager.php',1326],['lib/google/src/Google/Service','TagManager.php',1419],['lib/google/src/Google/Service','TagManager.php',1513],['lib/google/src/Google/Service','TagManager.php',1607],['lib/google/src/Google/Service','TagManager.php',1757],['lib/google/src/Google/Service','Directory.php',1300],['lib/google/src/Google/Service','Directory.php',1477],['lib/google/src/Google/Service','Directory.php',1587],['lib/google/src/Google/Service','Directory.php',1642],['lib/google/src/Google/Service','Directory.php',1769],['lib/google/src/Google/Service','Directory.php',1838],['lib/google/src/Google/Service','Directory.php',1935],['lib/google/src/Google/Service','Directory.php',2042],['lib/google/src/Google/Service','Directory.php',2144],['lib/google/src/Google/Service','Directory.php',2205],['lib/google/src/Google/Service','Directory.php',2405],['lib/google/src/Google/Service','Directory.php',2480],['cache/stores/static','lib.php',374],['lib/google/src/Google/Service','AppState.php',153],['lib/google/src/Google/Service','Taskqueue.php',292],['lib/google/src/Google/Service','Container.php',343],['lib/google/src/Google/Service','AndroidPublisher.php',1177],['lib/google/src/Google/Service','AndroidPublisher.php',1257],['lib/google/src/Google/Service','AndroidPublisher.php',1595],['lib/google/src/Google/Service','AndroidPublisher.php',1690],['lib/google/src/Google/Service','AndroidPublisher.php',1972],['repository','lib.php',427],['repository','lib.php',2012],['lib','accesslib.php',5529],['lib/google/src/Google/Service','AdSenseHost.php',733],['lib/google/src/Google/Service','AdSenseHost.php',1009],['lib/google/src/Google/Service','AdSenseHost.php',1167],['cache/stores/memcache','lib.php',401],['lib','filelib.php',3440],['lib/google/src/Google/Service','MapsEngine.php',1692],['lib/google/src/Google/Service','MapsEngine.php',1990],['lib/google/src/Google/Service','MapsEngine.php',2343],['lib/google/src/Google/Service','MapsEngine.php',2650],['lib/google/src/Google/Service','MapsEngine.php',2911],['lib/grade','grade_grade.php',955],['comment','lib.php',786],['lib/google/src/Google/Service','SiteVerification.php',138],['lib/google/src/Google/Service','Prediction.php',261],['cache/stores/session','lib.php',417],['cache/classes','dummystore.php',198],['lib/google/src/Google/Service','Compute.php',2812],['lib/google/src/Google/Service','Compute.php',2896],['lib/google/src/Google/Service','Compute.php',3139],['lib/google/src/Google/Service','Compute.php',3225],['lib/google/src/Google/Service','Compute.php',3361],['lib/google/src/Google/Service','Compute.php',3463],['lib/google/src/Google/Service','Compute.php',3543],['lib/google/src/Google/Service','Compute.php',3662],['lib/google/src/Google/Service','Compute.php',3725],['lib/google/src/Google/Service','Compute.php',3844],['lib/google/src/Google/Service','Compute.php',3941],['lib/google/src/Google/Service','Compute.php',4080],['lib/google/src/Google/Service','Compute.php',4406],['lib/google/src/Google/Service','Compute.php',4543],['lib/google/src/Google/Service','Compute.php',4660],['lib/google/src/Google/Service','Compute.php',4740],['lib/google/src/Google/Service','Compute.php',4806],['lib/google/src/Google/Service','Compute.php',4927],['lib/google/src/Google/Service','Compute.php',5069],['lib/google/src/Google/Service','Compute.php',5229],['lib/google/src/Google/Service','Compute.php',5360],['badges/criteria','award_criteria.php',330],['badges/criteria','award_criteria_manual.php',220],['lib/google/src/Google/Service','Calendar.php',886],['lib/google/src/Google/Service','Calendar.php',1040],['lib/google/src/Google/Service','Calendar.php',1228],['lib/google/src/Google/Service','Calendar.php',1362],['lib/google/src/Google/Service','Analytics.php',2068],['lib/google/src/Google/Service','Analytics.php',2211],['lib/google/src/Google/Service','Analytics.php',2293],['lib/google/src/Google/Service','Analytics.php',2414],['lib/google/src/Google/Service','Analytics.php',2631],['lib/google/src/Google/Service','Analytics.php',2760],['lib/google/src/Google/Service','Analytics.php',2851],['lib/google/src/Google/Service','Analytics.php',3181],['lib/google/src/Google/Service','Analytics.php',3406],['lib/google/src/Google/Service','Tasks.php',309],['lib/google/src/Google/Service','Tasks.php',427],['cache/classes','loaders.php',777],['cache/classes','loaders.php',1491],['cache/classes','loaders.php',1859],['cache/stores/mongodb','lib.php',361],['lib/grade','grade_category.php',259],['cache/stores/file','lib.php',392],['lib/google/src/Google/Service','Storage.php',945],['lib/google/src/Google/Service','Storage.php',1060],['lib/google/src/Google/Service','Storage.php',1227],['lib/google/src/Google/Service','Storage.php',1349],['lib/google/src/Google/Service','Storage.php',1565],['admin/tool/uploadcourse/classes','course.php',226],['lib/google/src/Google/Cache','Null.php',51],['lib/filestorage','stored_file.php',323],['lib/filebrowser','virtual_root_file.php',69],['lib/google/src/Google/Service','AdSense.php',1257],['lib/google/src/Google/Service','AdSense.php',1729],['lib/google/src/Google/Service','Pubsub.php',239],['lib/google/src/Google/Service','Pubsub.php',378],['lib/grade','grade_scale.php',136],['lib/filebrowser','file_info.php',418],['lib/google/src/Google/Cache','File.php',106],['lib/htmlpurifier/HTMLPurifier','Zipper.php',89],['lib/google/src/Google/Service','Dns.php',370],['lib/filebrowser','file_info_stored.php',631],['lib/google/src/Google/Service','Replicapool.php',374],['lib/google/src/Google/Service','Resourceviews.php',419],['lib','badgeslib.php',620],['lib/google/src/Google/Cache','Apc.php',103],['lib/adodb','adodb-active-record.inc.php',792],['mnet','peer.php',122],['lib/grade','grade_outcome.php',97]], 260],
'get_records': ['get_records', 'Get a number of records as an array of objects where all the given conditions met. ', [['lib/dml','moodle_database.php',1236],['lib','coursecatlib.php',654],['question','category_class.php',63]], 860],
'update_final_grade': ['update_final_grade', 'Updates final grade value for given user, this is a only way to update final grades from gradebook and import because it logs the change in history table and deals with overridden flag. This flag is set to prevent later overriding from raw grades submitted from modules. ', [['lib/grade','grade_item.php',1521]], 14],
'join': ['join', 'Join a room. For internal use by the Games SDK only. Calling this method directly is unsupported. (rooms.join) ', [['lib/google/src/Google/Service','Games.php',1715],['lib/google/src/Google/Service','Games.php',2099]], 949],
'get_record': ['get_record', 'Get a single database record as an object where all the given conditions met. ', [['lib/dml','moodle_database.php',1413]], 2960],
'get_parent_context_ids': ['get_parent_context_ids', 'Returns parent contexts of this context in reversed order, i.e. parent first, then grand parent, etc. ', [['lib','accesslib.php',5674]], 58],
'list': ['list', '', [['mod/data/preset/imagegallery','jstemplate.js',9]], 1891],
'insert': ['insert', 'Creates a customer resource if one does not already exist. (customers.insert) ', [['lib/google/src/Google/Service','Reseller.php',309],['lib/google/src/Google/Service','Reseller.php',473],['lib/adodb','adodb-active-recordx.inc.php',899],['lib/grade','grade_object.php',325],['lib/google/src/Google/Service','Replicapoolupdater.php',294],['lib/google/src/Google/Service','Fusiontables.php',674],['lib/google/src/Google/Service','Fusiontables.php',838],['lib/google/src/Google/Service','Fusiontables.php',1012],['lib/google/src/Google/Service','Fusiontables.php',1217],['lib/google/src/Google/Service','Blogger.php',1243],['lib/google/src/Google/Service','Blogger.php',1493],['lib/google/src/Google/Service','Doubleclicksearch.php',285],['lib/google/src/Google/Service','AdExchangeBuyer.php',476],['lib/google/src/Google/Service','AdExchangeBuyer.php',635],['lib/google/src/Google/Service','Manager.php',271],['lib/google/src/Google/Service','Manager.php',349],['lib/grade','grade_item.php',385],['lib/google/src/Google/Service','Gmail.php',993],['lib/google/src/Google/Service','Plus.php',475],['lib/google/src/Google/Service','Mirror.php',393],['lib/google/src/Google/Service','Mirror.php',451],['lib/google/src/Google/Service','Mirror.php',605],['lib/google/src/Google/Service','Mirror.php',687],['lib/google/src/Google/Service','Mirror.php',801],['lib/google/src/Google/Service','Urlshortener.php',124],['lib/google/src/Google/Service','Dfareporting.php',499],['lib/google/src/Google/Service','PlusDomains.php',481],['lib/google/src/Google/Service','PlusDomains.php',606],['lib/google/src/Google/Service','PlusDomains.php',732],['lib/google/src/Google/Service','PlusDomains.php',781],['lib/google/src/Google/Service','GroupsMigration.php',85],['lib/google/src/Google/Service','Licensing.php',253],['lib/google/src/Google/Service','Drive.php',1491],['lib/google/src/Google/Service','Drive.php',1568],['lib/google/src/Google/Service','Drive.php',1727],['lib/google/src/Google/Service','Drive.php',1961],['lib/google/src/Google/Service','Drive.php',2045],['lib/google/src/Google/Service','Drive.php',2164],['lib/google/src/Google/Service','Drive.php',2328],['completion','data_object.php',316],['lib/google/src/Google/Service','Books.php',1835],['lib/google/src/Google/Service','Bigquery.php',548],['lib/google/src/Google/Service','Bigquery.php',672],['lib/google/src/Google/Service','Bigquery.php',856],['lib/google/src/Google/Service','YouTube.php',1323],['lib/google/src/Google/Service','YouTube.php',1423],['lib/google/src/Google/Service','YouTube.php',1498],['lib/google/src/Google/Service','YouTube.php',2025],['lib/google/src/Google/Service','YouTube.php',2323],['lib/google/src/Google/Service','YouTube.php',2525],['lib/google/src/Google/Service','YouTube.php',2685],['lib/google/src/Google/Service','YouTube.php',3013],['lib/google/src/Google/Service','YouTube.php',3254],['lib/google/src/Google/Service','Coordinate.php',491],['lib/google/src/Google/Service','Autoscaler.php',346],['lib/google/src/Google/Service','ShoppingContent.php',582],['lib/google/src/Google/Service','ShoppingContent.php',764],['lib/google/src/Google/Service','ShoppingContent.php',1000],['lib/google/src/Google/Service','SQLAdmin.php',698],['lib/google/src/Google/Service','SQLAdmin.php',959],['lib/google/src/Google/Service','Directory.php',1504],['lib/google/src/Google/Service','Directory.php',1601],['lib/google/src/Google/Service','Directory.php',1671],['lib/google/src/Google/Service','Directory.php',1964],['lib/google/src/Google/Service','Directory.php',2071],['lib/google/src/Google/Service','Directory.php',2239],['lib/google/src/Google/Service','Directory.php',2419],['lib/google/src/Google/Service','Taskqueue.php',323],['lib/google/src/Google/Service','AndroidPublisher.php',1211],['lib/google/src/Google/Service','AndroidPublisher.php',2002],['lib/google/src/Google/Service','AdSenseHost.php',786],['lib/google/src/Google/Service','AdSenseHost.php',1041],['lib/google/src/Google/Service','AdSenseHost.php',1182],['lib/google/src/Google/Service','MapsEngine.php',2780],['lib/google/src/Google/Service','MapsEngine.php',3184],['lib/grade','grade_grade.php',928],['lib/google/src/Google/Service','SiteVerification.php',180],['lib/google/src/Google/Service','Prediction.php',290],['lib/google/src/Google/Service','Compute.php',2844],['lib/google/src/Google/Service','Compute.php',2944],['lib/google/src/Google/Service','Compute.php',3171],['lib/google/src/Google/Service','Compute.php',3255],['lib/google/src/Google/Service','Compute.php',3393],['lib/google/src/Google/Service','Compute.php',3493],['lib/google/src/Google/Service','Compute.php',3573],['lib/google/src/Google/Service','Compute.php',3757],['lib/google/src/Google/Service','Compute.php',3891],['lib/google/src/Google/Service','Compute.php',3973],['lib/google/src/Google/Service','Compute.php',4165],['lib/google/src/Google/Service','Compute.php',4436],['lib/google/src/Google/Service','Compute.php',4690],['lib/google/src/Google/Service','Compute.php',4838],['lib/google/src/Google/Service','Compute.php',4959],['lib/google/src/Google/Service','Compute.php',5120],['lib/google/src/Google/Service','Compute.php',5259],['lib/google/src/Google/Service','Calendar.php',915],['lib/google/src/Google/Service','Calendar.php',1067],['lib/google/src/Google/Service','Calendar.php',1255],['lib/google/src/Google/Service','Calendar.php',1422],['lib/google/src/Google/Service','Analytics.php',2082],['lib/google/src/Google/Service','Analytics.php',2326],['lib/google/src/Google/Service','Analytics.php',2444],['lib/google/src/Google/Service','Analytics.php',2539],['lib/google/src/Google/Service','Analytics.php',2666],['lib/google/src/Google/Service','Analytics.php',2776],['lib/google/src/Google/Service','Analytics.php',2883],['lib/google/src/Google/Service','Analytics.php',3022],['lib/google/src/Google/Service','Analytics.php',3216],['lib/google/src/Google/Service','Analytics.php',3323],['lib/google/src/Google/Service','Analytics.php',3421],['lib/google/src/Google/Service','Tasks.php',336],['lib/google/src/Google/Service','Tasks.php',456],['lib/grade','grade_category.php',318],['lib/google/src/Google/Service','Storage.php',980],['lib/google/src/Google/Service','Storage.php',1100],['lib/google/src/Google/Service','Storage.php',1262],['lib/google/src/Google/Service','Storage.php',1392],['lib/google/src/Google/Service','Storage.php',1619],['lib/grade','grade_scale.php',111],['lib/google/src/Google/Service','Admin.php',87],['lib/google/src/Google/Service','Replicapool.php',434],['lib/google/src/Google/Service','Resourceviews.php',471],['lib/adodb','adodb-active-record.inc.php',742],['lib/grade','grade_outcome.php',120]], 459],
'instance': ['instance', 'Retrieve sole instance of the registry. ', [['lib/htmlpurifier/HTMLPurifier','URISchemeRegistry.php',9],['lib/classes/update','checker.php',62],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',29],['lib/classes','useragent.php',101],['backup/cc','validator.php',35],['lib/portfolio','exporter.php',251],['lib/tests','update_deployer_test.php',69],['lib/tests','string_manager_standard_test.php',124],['lib','modinfolib.php',373],['','mdeploy.php',96],['cache','disabledlib.php',171],['cache','disabledlib.php',296],['admin/tool/installaddon/classes','validator.php',85],['cache/classes','config.php',87],['course/format','lib.php',156],['lib','accesslib.php',6184],['lib','accesslib.php',6436],['lib','accesslib.php',6614],['lib','accesslib.php',6868],['lib','accesslib.php',7129],['lib','accesslib.php',7341],['cache','locallib.php',52],['lib/htmlpurifier','HTMLPurifier.php',251],['cache/classes','factory.php',114],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',53],['cache/classes','helper.php',76],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',31],['lib/classes','plugin_manager.php',83],['lib','filterlib.php',81],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',80],['lib/classes/update','deployer.php',54],['admin/tool/installaddon/classes','pluginfo_client.php',37],['admin/tool/installaddon/classes','installer.php',40],['backup/cc/cc_lib','cc_utils.php',387],['backup/cc/cc_lib','cc_utils.php',443]], 3942],
'get_records_sql': ['get_records_sql', 'Get a number of records as an array of objects using a SQL statement. ', [['lib/dml','pgsql_native_moodle_database.php',732],['lib/dml','oci_native_moodle_database.php',1102],['lib/dml','sqlsrv_native_moodle_database.php',823],['lib/dml','mssql_native_moodle_database.php',741],['lib/dml','mysqli_native_moodle_database.php',1049],['lib/dml/tests','dml_test.php',5424],['lib/dml','pdo_moodle_database.php',308]], 678],
'get_in_or_equal': ['get_in_or_equal', 'Constructs \'IN()\' or \'=\' sql fragment ', [['lib/dml','oci_native_moodle_database.php',1583],['lib/dml','moodle_database.php',678]], 375],
'users_order_by_sql': ['users_order_by_sql', 'This function generates the standard ORDER BY clause for use when generating lists of users. If you don\'t have a reason to use a different order, then you should use this method to generate the order when displaying lists of users. ', [['lib','datalib.php',290]], 60],
'get_enrolled_sql': ['get_enrolled_sql', 'Returns array with sql code and parameters returning all ids of users enrolled into course. ', [['lib','accesslib.php',2246]], 48],
'delete_records': ['delete_records', 'Delete the records from a table where all the given conditions met. If conditions not specified, table is truncated. ', [['lib/dml','moodle_database.php',1815],['lib/dml','sqlite3_pdo_moodle_database.php',337]], 778],
'alist': ['alist', 'Shortcut for quick making of lists ', [['lib','outputcomponents.php',1430]], 14],
'import_cleanup': ['import_cleanup', 'removes entries from grade import buffer tables grade_import_value and grade_import_newitem after a successful import, or during an import abort ', [['grade/import','lib.php',213]], 6],
'explode': ['explode', '', [], 1599],
'time': ['time', '', [], 1768],
'array_merge': ['array_merge', '', [], 2320]};
CLASS_DATA={
'grade_item': ['grade_item', 'Class representing a grade item. ', [['lib/grade','grade_item.php',29]], 206],
'context_course': ['context_course', 'Course context class ', [['lib','accesslib.php',6766]], 1197],
'html_writer': ['html_writer', 'Simple html output class ', [['lib','outputcomponents.php',1052]], 4832]};
CONST_DATA={
'FORMAT_MOODLE': ['FORMAT_MOODLE', '', [['lib','weblib.php',42]], 378],
'SQL_PARAMS_NAMED': ['SQL_PARAMS_NAMED', '', [['lib/dml','moodle_database.php',32]], 271]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu May 28 19:17:31 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
