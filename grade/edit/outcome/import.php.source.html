<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /grade/edit/outcome/import.php source</title>
    <link rel="stylesheet" href="../../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu May 28 19:17:31 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../../';
subdir='grade/edit/outcome';
filename='import.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/grade/edit/outcome/</a> -> <a href="import.php.html">import.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="import.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="import.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * Import outcomes from a file</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * @package   core_grades</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @copyright 2008 Moodle Pty Ltd (http://moodle.com)</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> */</span>
<a name="l24"><span class="linenum">  24</span></a>  
<a name="l25"><span class="linenum">  25</span></a>  require_once(<a class="phpfunction" onClick="logFunction('dirname')" href="../../../_functions/dirname.html" onMouseOver="phpfuncPopup(event,'dirname')">dirname</a>(__FILE__).'/../../../config.php');
<a name="l26"><span class="linenum">  26</span></a>  require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../../lib/formslib.php.html">/lib/formslib.php</a>');
<a name="l27"><span class="linenum">  27</span></a>  require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../../grade/lib.php.html">/grade/lib.php</a>');
<a name="l28"><span class="linenum">  28</span></a>  require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../../_variables/libdir.html">libdir</a>.'/gradelib.php');
<a name="l29"><span class="linenum">  29</span></a>  <span class="keyword">require_once</span> <a class="filename" href="../../../grade/edit/outcome/import_outcomes_form.php.html" onMouseOver="reqPopup(event, 'import_outcomes_form.php', '../../../grade/edit/outcome/import_outcomes_form.php')">('import_outcomes_form.php')</a>;
<a name="l30"><span class="linenum">  30</span></a>  
<a name="l31"><span class="linenum">  31</span></a>  <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../../_variables/courseid.html">$courseid</a> = <a class="function" onClick="logFunction('optional_param')" href="../../../_functions/optional_param.html" onMouseOver="funcPopup(event,'optional_param')">optional_param</a>('courseid', 0, <a class="constant" onClick="logConstant('PARAM_INT')" href="../../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>);
<a name="l32"><span class="linenum">  32</span></a>  <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a>   = <a class="function" onClick="logFunction('optional_param')" href="../../../_functions/optional_param.html" onMouseOver="funcPopup(event,'optional_param')">optional_param</a>('action', '', <a class="constant" onClick="logConstant('PARAM_ALPHA')" href="../../../_constants/PARAM_ALPHA.html" onMouseOver="constPopup(event,'PARAM_ALPHA')">PARAM_ALPHA</a>);
<a name="l33"><span class="linenum">  33</span></a>  <a class="var it9362" onMouseOver="hilite(9362)" onMouseOut="lolite()" onClick="logVariable('scope')" href="../../../_variables/scope.html">$scope</a>    = <a class="function" onClick="logFunction('optional_param')" href="../../../_functions/optional_param.html" onMouseOver="funcPopup(event,'optional_param')">optional_param</a>('scope', 'custom', <a class="constant" onClick="logConstant('PARAM_ALPHA')" href="../../../_constants/PARAM_ALPHA.html" onMouseOver="constPopup(event,'PARAM_ALPHA')">PARAM_ALPHA</a>);
<a name="l34"><span class="linenum">  34</span></a>  
<a name="l35"><span class="linenum">  35</span></a>  <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('set_url')" href="../../../_functions/set_url.html" onMouseOver="funcPopup(event,'set_url')">set_url</a>('<a class="filename" href="../../../grade/edit/outcome/import.php.html">/grade/edit/outcome/import.php</a>', array('courseid' =&gt; <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../../_variables/courseid.html">$courseid</a>));
<a name="l36"><span class="linenum">  36</span></a>  <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../../../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('set_pagelayout')" href="../../../_functions/set_pagelayout.html" onMouseOver="funcPopup(event,'set_pagelayout')">set_pagelayout</a>('admin');
<a name="l37"><span class="linenum">  37</span></a>  
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment">/// Make sure they can even access this course</span>
<a name="l39"><span class="linenum">  39</span></a>  if (<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../../_variables/courseid.html">$courseid</a>) {
<a name="l40"><span class="linenum">  40</span></a>      if (!<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../../_variables/course.html">$course</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('course', array('id' =&gt; <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../../_variables/courseid.html">$courseid</a>))) {
<a name="l41"><span class="linenum">  41</span></a>          <a class="function" onClick="logFunction('print_error')" href="../../../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('nocourseid');
<a name="l42"><span class="linenum">  42</span></a>      }
<a name="l43"><span class="linenum">  43</span></a>      <a class="function" onClick="logFunction('require_login')" href="../../../_functions/require_login.html" onMouseOver="funcPopup(event,'require_login')">require_login</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../../_variables/course.html">$course</a>);
<a name="l44"><span class="linenum">  44</span></a>      <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_course')" href="../../../_classes/context_course.html" onMouseOver="classPopup(event,'context_course')">context_course</a>::<a class="function" onClick="logFunction('instance')" href="../../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it101" onMouseOver="hilite(101)" onMouseOut="lolite()" onClick="logVariable('course')" href="../../../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it39506" onMouseOver="hilite(39506)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>);
<a name="l45"><span class="linenum">  45</span></a>  
<a name="l46"><span class="linenum">  46</span></a>      if (empty(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('enableoutcomes')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../../_variables/enableoutcomes.html">enableoutcomes</a>)) {
<a name="l47"><span class="linenum">  47</span></a>          <a class="function" onClick="logFunction('redirect')" href="../../../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>('../../index.php?id='.<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../../_variables/courseid.html">$courseid</a>);
<a name="l48"><span class="linenum">  48</span></a>      }
<a name="l49"><span class="linenum">  49</span></a>  
<a name="l50"><span class="linenum">  50</span></a>  } else {
<a name="l51"><span class="linenum">  51</span></a>      require_once <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../../_variables/libdir.html">libdir</a>.'/adminlib.php';
<a name="l52"><span class="linenum">  52</span></a>      <a class="function" onClick="logFunction('admin_externalpage_setup')" href="../../../_functions/admin_externalpage_setup.html" onMouseOver="funcPopup(event,'admin_externalpage_setup')">admin_externalpage_setup</a>('outcomes');
<a name="l53"><span class="linenum">  53</span></a>      <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_system')" href="../../../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>();
<a name="l54"><span class="linenum">  54</span></a>  }
<a name="l55"><span class="linenum">  55</span></a>  
<a name="l56"><span class="linenum">  56</span></a>  <a class="function" onClick="logFunction('require_capability')" href="../../../_functions/require_capability.html" onMouseOver="funcPopup(event,'require_capability')">require_capability</a>('moodle/grade:manageoutcomes', <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../_variables/context.html">$context</a>);
<a name="l57"><span class="linenum">  57</span></a>  
<a name="l58"><span class="linenum">  58</span></a>  <a class="var it1513" onMouseOver="hilite(1513)" onMouseOut="lolite()" onClick="logVariable('navigation')" href="../../../_variables/navigation.html">$navigation</a> = <a class="function" onClick="logFunction('grade_build_nav')" href="../../../_functions/grade_build_nav.html" onMouseOver="funcPopup(event,'grade_build_nav')">grade_build_nav</a>(__FILE__, <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('outcomes', 'grades'), <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../../_variables/courseid.html">$courseid</a>);
<a name="l59"><span class="linenum">  59</span></a>  
<a name="l60"><span class="linenum">  60</span></a>  <a class="var it12843" onMouseOver="hilite(12843)" onMouseOut="lolite()" onClick="logVariable('upload_form')" href="../../../_variables/upload_form.html">$upload_form</a> = <span class="keyword">new </span><a class="class" onClick="logClass('import_outcomes_form')" href="../../../_classes/import_outcomes_form.html" onMouseOver="classPopup(event,'import_outcomes_form')">import_outcomes_form</a>();
<a name="l61"><span class="linenum">  61</span></a>  
<a name="l62"><span class="linenum">  62</span></a>  <span class="comment">// display import form</span>
<a name="l63"><span class="linenum">  63</span></a>  if (!<a class="var it12843" onMouseOver="hilite(12843)" onMouseOut="lolite()" onClick="logVariable('upload_form')" href="../../../_variables/upload_form.html">$upload_form</a>-&gt;<a class="function" onClick="logFunction('get_data')" href="../../../_functions/get_data.html" onMouseOver="funcPopup(event,'get_data')">get_data</a>()) {
<a name="l64"><span class="linenum">  64</span></a>      <a class="function" onClick="logFunction('print_grade_page_head')" href="../../../_functions/print_grade_page_head.html" onMouseOver="funcPopup(event,'print_grade_page_head')">print_grade_page_head</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../../_variables/courseid.html">$courseid</a>, 'outcome', 'import', <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('importoutcomes', 'grades'));
<a name="l65"><span class="linenum">  65</span></a>      <a class="var it12843" onMouseOver="hilite(12843)" onMouseOut="lolite()" onClick="logVariable('upload_form')" href="../../../_variables/upload_form.html">$upload_form</a>-&gt;<a class="function" onClick="logFunction('display')" href="../../../_functions/display.html" onMouseOver="funcPopup(event,'display')">display</a>();
<a name="l66"><span class="linenum">  66</span></a>      echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('footer')" href="../../../_functions/footer.html" onMouseOver="funcPopup(event,'footer')">footer</a>();
<a name="l67"><span class="linenum">  67</span></a>      die;
<a name="l68"><span class="linenum">  68</span></a>  }
<a name="l69"><span class="linenum">  69</span></a>  <a class="function" onClick="logFunction('print_grade_page_head')" href="../../../_functions/print_grade_page_head.html" onMouseOver="funcPopup(event,'print_grade_page_head')">print_grade_page_head</a>(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../../_variables/courseid.html">$courseid</a>, 'outcome', 'import', <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('importoutcomes', 'grades'));
<a name="l70"><span class="linenum">  70</span></a>  
<a name="l71"><span class="linenum">  71</span></a>  <a class="var it12844" onMouseOver="hilite(12844)" onMouseOut="lolite()" onClick="logVariable('imported_file')" href="../../../_variables/imported_file.html">$imported_file</a> = <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('tempdir')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../../_variables/tempdir.html">tempdir</a> . '/outcomeimport/importedfile_'.<a class="phpfunction" onClick="logFunction('time')" href="../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>().'.csv';
<a name="l72"><span class="linenum">  72</span></a>  <a class="function" onClick="logFunction('make_temp_directory')" href="../../../_functions/make_temp_directory.html" onMouseOver="funcPopup(event,'make_temp_directory')">make_temp_directory</a>('outcomeimport');
<a name="l73"><span class="linenum">  73</span></a>  
<a name="l74"><span class="linenum">  74</span></a>  <span class="comment">// copying imported file</span>
<a name="l75"><span class="linenum">  75</span></a>  if (!<a class="var it12843" onMouseOver="hilite(12843)" onMouseOut="lolite()" onClick="logVariable('upload_form')" href="../../../_variables/upload_form.html">$upload_form</a>-&gt;<a class="function" onClick="logFunction('save_file')" href="../../../_functions/save_file.html" onMouseOver="funcPopup(event,'save_file')">save_file</a>('userfile', <a class="var it12844" onMouseOver="hilite(12844)" onMouseOut="lolite()" onClick="logVariable('imported_file')" href="../../../_variables/imported_file.html">$imported_file</a>, true)) {
<a name="l76"><span class="linenum">  76</span></a>      <a class="function" onClick="logFunction('redirect')" href="../../../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>('import.php'. (<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../../_variables/courseid.html">$courseid</a> ? &quot;?courseid=<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../../_variables/courseid.html">$courseid</a>&quot; : ''), <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('importfilemissing', 'grades'));
<a name="l77"><span class="linenum">  77</span></a>  }
<a name="l78"><span class="linenum">  78</span></a>  
<a name="l79"><span class="linenum">  79</span></a>  <span class="comment">/// which scope are we importing the outcomes in?</span>
<a name="l80"><span class="linenum">  80</span></a>  if (isset(<a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../../_variables/courseid.html">$courseid</a>) &amp;&amp; (<a class="var it9362" onMouseOver="hilite(9362)" onMouseOut="lolite()" onClick="logVariable('scope')" href="../../../_variables/scope.html">$scope</a>  == 'custom')) {
<a name="l81"><span class="linenum">  81</span></a>  <span class="comment">    // custom scale</span>
<a name="l82"><span class="linenum">  82</span></a>      <a class="var it12845" onMouseOver="hilite(12845)" onMouseOut="lolite()" onClick="logVariable('local_scope')" href="../../../_variables/local_scope.html">$local_scope</a> = true;
<a name="l83"><span class="linenum">  83</span></a>  } elseif ((<a class="var it9362" onMouseOver="hilite(9362)" onMouseOut="lolite()" onClick="logVariable('scope')" href="../../../_variables/scope.html">$scope</a> == 'global') &amp;&amp; <a class="function" onClick="logFunction('has_capability')" href="../../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/grade:manage', <a class="class" onClick="logClass('context_system')" href="../../../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>())) {
<a name="l84"><span class="linenum">  84</span></a>  <span class="comment">    // global scale</span>
<a name="l85"><span class="linenum">  85</span></a>      <a class="var it12845" onMouseOver="hilite(12845)" onMouseOut="lolite()" onClick="logVariable('local_scope')" href="../../../_variables/local_scope.html">$local_scope</a> = false;
<a name="l86"><span class="linenum">  86</span></a>  } else {
<a name="l87"><span class="linenum">  87</span></a>  <span class="comment">    // shouldn't happen .. user might be trying to access this script without the right permissions.</span>
<a name="l88"><span class="linenum">  88</span></a>      <a class="function" onClick="logFunction('redirect')" href="../../../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>('<a class="filename" href="../../../index.php.html">index.php</a>', <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('importerror', 'grades'));
<a name="l89"><span class="linenum">  89</span></a>  }
<a name="l90"><span class="linenum">  90</span></a>  
<a name="l91"><span class="linenum">  91</span></a>  <span class="comment">// open the file, start importing data</span>
<a name="l92"><span class="linenum">  92</span></a>  if (<a class="var it1207" onMouseOver="hilite(1207)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../_variables/handle.html">$handle</a> = <a class="function" onClick="logFunction('fopen')" href="../../../_functions/fopen.html" onMouseOver="funcPopup(event,'fopen')">fopen</a>(<a class="var it12844" onMouseOver="hilite(12844)" onMouseOut="lolite()" onClick="logVariable('imported_file')" href="../../../_variables/imported_file.html">$imported_file</a>, 'r')) {
<a name="l93"><span class="linenum">  93</span></a>      <a class="var it3038" onMouseOver="hilite(3038)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../../_variables/line.html">$line</a> = 0; <span class="comment">// will keep track of current line, to give better error messages.</span>
<a name="l94"><span class="linenum">  94</span></a>      <a class="var it12846" onMouseOver="hilite(12846)" onMouseOut="lolite()" onClick="logVariable('file_headers')" href="../../../_variables/file_headers.html">$file_headers</a> = '';
<a name="l95"><span class="linenum">  95</span></a>  
<a name="l96"><span class="linenum">  96</span></a>  <span class="comment">    // $csv_data needs to have at least these columns, the value is the default position in the data file.</span>
<a name="l97"><span class="linenum">  97</span></a>      <a class="var it293" onMouseOver="hilite(293)" onMouseOut="lolite()" onClick="logVariable('headers')" href="../../../_variables/headers.html">$headers</a> = array('outcome_name' =&gt; 0, 'outcome_shortname' =&gt; 1, 'scale_name' =&gt; 3, 'scale_items' =&gt; 4);
<a name="l98"><span class="linenum">  98</span></a>      <a class="var it12847" onMouseOver="hilite(12847)" onMouseOut="lolite()" onClick="logVariable('optional_headers')" href="../../../_variables/optional_headers.html">$optional_headers</a> = array('outcome_description'=&gt;2, 'scale_description' =&gt; 5);
<a name="l99"><span class="linenum">  99</span></a>      <a class="var it12848" onMouseOver="hilite(12848)" onMouseOut="lolite()" onClick="logVariable('imported_headers')" href="../../../_variables/imported_headers.html">$imported_headers</a> = array(); <span class="comment">// will later be initialized with the values found in the file</span>
<a name="l100"><span class="linenum"> 100</span></a>  
<a name="l101"><span class="linenum"> 101</span></a>      <a class="var it12849" onMouseOver="hilite(12849)" onMouseOut="lolite()" onClick="logVariable('fatal_error')" href="../../../_variables/fatal_error.html">$fatal_error</a> = false;
<a name="l102"><span class="linenum"> 102</span></a>  
<a name="l103"><span class="linenum"> 103</span></a>  <span class="comment">    // data should be separated by a ';'.  *NOT* by a comma!  TODO: version 2.0</span>
<a name="l104"><span class="linenum"> 104</span></a>  <span class="comment">    // or whenever we can depend on PHP5, set the second parameter (8192) to 0 (unlimited line length) : the database can store over 128k per line.</span>
<a name="l105"><span class="linenum"> 105</span></a>      while ( <a class="var it12850" onMouseOver="hilite(12850)" onMouseOut="lolite()" onClick="logVariable('csv_data')" href="../../../_variables/csv_data.html">$csv_data</a> = <a class="phpfunction" onClick="logFunction('fgetcsv')" href="../../../_functions/fgetcsv.html" onMouseOver="phpfuncPopup(event,'fgetcsv')">fgetcsv</a>(<a class="var it1207" onMouseOver="hilite(1207)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../_variables/handle.html">$handle</a>, 8192, ';', '&quot;')) { // if the line is over 8k, it won't work...
<a name="l106"><span class="linenum"> 106</span></a>          <a class="var it3038" onMouseOver="hilite(3038)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../../_variables/line.html">$line</a>++;
<a name="l107"><span class="linenum"> 107</span></a>  
<a name="l108"><span class="linenum"> 108</span></a>  <span class="comment">        // be tolerant on input, as fgetcsv returns &quot;an array comprising a single null field&quot; on blank lines</span>
<a name="l109"><span class="linenum"> 109</span></a>          if (<a class="var it12850" onMouseOver="hilite(12850)" onMouseOut="lolite()" onClick="logVariable('csv_data')" href="../../../_variables/csv_data.html">$csv_data</a> == array(null)) {
<a name="l110"><span class="linenum"> 110</span></a>              continue;
<a name="l111"><span class="linenum"> 111</span></a>          }
<a name="l112"><span class="linenum"> 112</span></a>  
<a name="l113"><span class="linenum"> 113</span></a>  <span class="comment">        // on first run, grab and analyse the header</span>
<a name="l114"><span class="linenum"> 114</span></a>          if (<a class="var it12846" onMouseOver="hilite(12846)" onMouseOut="lolite()" onClick="logVariable('file_headers')" href="../../../_variables/file_headers.html">$file_headers</a> == '') {
<a name="l115"><span class="linenum"> 115</span></a>  
<a name="l116"><span class="linenum"> 116</span></a>              <a class="var it12846" onMouseOver="hilite(12846)" onMouseOut="lolite()" onClick="logVariable('file_headers')" href="../../../_variables/file_headers.html">$file_headers</a> = <a class="phpfunction" onClick="logFunction('array_flip')" href="../../../_functions/array_flip.html" onMouseOver="phpfuncPopup(event,'array_flip')">array_flip</a>(<a class="var it12850" onMouseOver="hilite(12850)" onMouseOut="lolite()" onClick="logVariable('csv_data')" href="../../../_variables/csv_data.html">$csv_data</a>); <span class="comment">// save the header line ... TODO: use the header line to let import work with columns in arbitrary order</span>
<a name="l117"><span class="linenum"> 117</span></a>  
<a name="l118"><span class="linenum"> 118</span></a>              <a class="var it111" onMouseOver="hilite(111)" onMouseOut="lolite()" onClick="logVariable('error')" href="../../../_variables/error.html">$error</a> = false;
<a name="l119"><span class="linenum"> 119</span></a>              foreach(<a class="var it293" onMouseOver="hilite(293)" onMouseOut="lolite()" onClick="logVariable('headers')" href="../../../_variables/headers.html">$headers</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> =&gt; <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../_variables/value.html">$value</a>) {
<a name="l120"><span class="linenum"> 120</span></a>  <span class="comment">                // sanity check #1: make sure the file contains all the mandatory headers</span>
<a name="l121"><span class="linenum"> 121</span></a>                  if (!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>, <a class="var it12846" onMouseOver="hilite(12846)" onMouseOut="lolite()" onClick="logVariable('file_headers')" href="../../../_variables/file_headers.html">$file_headers</a>)) {
<a name="l122"><span class="linenum"> 122</span></a>                      <a class="var it111" onMouseOver="hilite(111)" onMouseOut="lolite()" onClick="logVariable('error')" href="../../../_variables/error.html">$error</a> = true;
<a name="l123"><span class="linenum"> 123</span></a>                      break;
<a name="l124"><span class="linenum"> 124</span></a>                  }
<a name="l125"><span class="linenum"> 125</span></a>              }
<a name="l126"><span class="linenum"> 126</span></a>              if (<a class="var it111" onMouseOver="hilite(111)" onMouseOut="lolite()" onClick="logVariable('error')" href="../../../_variables/error.html">$error</a>) {
<a name="l127"><span class="linenum"> 127</span></a>                  echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box_start')" href="../../../_functions/box_start.html" onMouseOver="funcPopup(event,'box_start')">box_start</a>('generalbox importoutcomenofile buttons');
<a name="l128"><span class="linenum"> 128</span></a>                  echo <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('importoutcomenofile', 'grades', <a class="var it3038" onMouseOver="hilite(3038)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../../_variables/line.html">$line</a>);
<a name="l129"><span class="linenum"> 129</span></a>                  echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('single_button')" href="../../../_functions/single_button.html" onMouseOver="funcPopup(event,'single_button')">single_button</a>(<span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../../grade/edit/outcome/import.php.html">/grade/edit/outcome/import.php</a>', array('courseid'=&gt; <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../../_variables/courseid.html">$courseid</a>)), <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('back'), 'get');
<a name="l130"><span class="linenum"> 130</span></a>                  echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box_end')" href="../../../_functions/box_end.html" onMouseOver="funcPopup(event,'box_end')">box_end</a>();
<a name="l131"><span class="linenum"> 131</span></a>                  <a class="var it12849" onMouseOver="hilite(12849)" onMouseOut="lolite()" onClick="logVariable('fatal_error')" href="../../../_variables/fatal_error.html">$fatal_error</a> = true;
<a name="l132"><span class="linenum"> 132</span></a>                  break;
<a name="l133"><span class="linenum"> 133</span></a>              }
<a name="l134"><span class="linenum"> 134</span></a>  
<a name="l135"><span class="linenum"> 135</span></a>              foreach(<a class="phpfunction" onClick="logFunction('array_merge')" href="../../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it293" onMouseOver="hilite(293)" onMouseOut="lolite()" onClick="logVariable('headers')" href="../../../_variables/headers.html">$headers</a>, <a class="var it12847" onMouseOver="hilite(12847)" onMouseOut="lolite()" onClick="logVariable('optional_headers')" href="../../../_variables/optional_headers.html">$optional_headers</a>) as <a class="var it295" onMouseOver="hilite(295)" onMouseOut="lolite()" onClick="logVariable('header')" href="../../../_variables/header.html">$header</a> =&gt; <a class="var it1047" onMouseOver="hilite(1047)" onMouseOut="lolite()" onClick="logVariable('position')" href="../../../_variables/position.html">$position</a>) {
<a name="l136"><span class="linenum"> 136</span></a>  <span class="comment">                // match given columns to expected columns *into* $headers</span>
<a name="l137"><span class="linenum"> 137</span></a>                  <a class="var it12848" onMouseOver="hilite(12848)" onMouseOut="lolite()" onClick="logVariable('imported_headers')" href="../../../_variables/imported_headers.html">$imported_headers</a>[<a class="var it295" onMouseOver="hilite(295)" onMouseOut="lolite()" onClick="logVariable('header')" href="../../../_variables/header.html">$header</a>] = <a class="var it12846" onMouseOver="hilite(12846)" onMouseOut="lolite()" onClick="logVariable('file_headers')" href="../../../_variables/file_headers.html">$file_headers</a>[<a class="var it295" onMouseOver="hilite(295)" onMouseOut="lolite()" onClick="logVariable('header')" href="../../../_variables/header.html">$header</a>];
<a name="l138"><span class="linenum"> 138</span></a>              }
<a name="l139"><span class="linenum"> 139</span></a>  
<a name="l140"><span class="linenum"> 140</span></a>              continue; <span class="comment">// we don't import headers</span>
<a name="l141"><span class="linenum"> 141</span></a>          }
<a name="l142"><span class="linenum"> 142</span></a>  
<a name="l143"><span class="linenum"> 143</span></a>  <span class="comment">        // sanity check #2: every line must have the same number of columns as there are</span>
<a name="l144"><span class="linenum"> 144</span></a>  <span class="comment">        // headers.  If not, processing stops.</span>
<a name="l145"><span class="linenum"> 145</span></a>          if ( <a class="phpfunction" onClick="logFunction('count')" href="../../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it12850" onMouseOver="hilite(12850)" onMouseOut="lolite()" onClick="logVariable('csv_data')" href="../../../_variables/csv_data.html">$csv_data</a>) != <a class="phpfunction" onClick="logFunction('count')" href="../../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it12846" onMouseOver="hilite(12846)" onMouseOut="lolite()" onClick="logVariable('file_headers')" href="../../../_variables/file_headers.html">$file_headers</a>) ) {
<a name="l146"><span class="linenum"> 146</span></a>              echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box_start')" href="../../../_functions/box_start.html" onMouseOver="funcPopup(event,'box_start')">box_start</a>('generalbox importoutcomenofile');
<a name="l147"><span class="linenum"> 147</span></a>              echo <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('importoutcomenofile', 'grades', <a class="var it3038" onMouseOver="hilite(3038)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../../_variables/line.html">$line</a>);
<a name="l148"><span class="linenum"> 148</span></a>              echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('single_button')" href="../../../_functions/single_button.html" onMouseOver="funcPopup(event,'single_button')">single_button</a>(<span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../../grade/edit/outcome/import.php.html">/grade/edit/outcome/import.php</a>', array('courseid'=&gt; <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../../_variables/courseid.html">$courseid</a>)), <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('back'), 'get');
<a name="l149"><span class="linenum"> 149</span></a>              echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box_end')" href="../../../_functions/box_end.html" onMouseOver="funcPopup(event,'box_end')">box_end</a>();
<a name="l150"><span class="linenum"> 150</span></a>              <a class="var it12849" onMouseOver="hilite(12849)" onMouseOut="lolite()" onClick="logVariable('fatal_error')" href="../../../_variables/fatal_error.html">$fatal_error</a> = true;
<a name="l151"><span class="linenum"> 151</span></a>  <span class="comment">            //echo $OUTPUT-&gt;box(var_export($csv_data, true) .&quot;&lt;br /&gt;&quot;. var_export($header, true));</span>
<a name="l152"><span class="linenum"> 152</span></a>              break;
<a name="l153"><span class="linenum"> 153</span></a>          }
<a name="l154"><span class="linenum"> 154</span></a>  
<a name="l155"><span class="linenum"> 155</span></a>  <span class="comment">        // sanity check #3: all required fields must be present on the current line.</span>
<a name="l156"><span class="linenum"> 156</span></a>          foreach (<a class="var it293" onMouseOver="hilite(293)" onMouseOut="lolite()" onClick="logVariable('headers')" href="../../../_variables/headers.html">$headers</a> as <a class="var it295" onMouseOver="hilite(295)" onMouseOut="lolite()" onClick="logVariable('header')" href="../../../_variables/header.html">$header</a> =&gt; <a class="var it1047" onMouseOver="hilite(1047)" onMouseOut="lolite()" onClick="logVariable('position')" href="../../../_variables/position.html">$position</a>) {
<a name="l157"><span class="linenum"> 157</span></a>              if (<a class="var it12850" onMouseOver="hilite(12850)" onMouseOut="lolite()" onClick="logVariable('csv_data')" href="../../../_variables/csv_data.html">$csv_data</a>[<a class="var it12848" onMouseOver="hilite(12848)" onMouseOut="lolite()" onClick="logVariable('imported_headers')" href="../../../_variables/imported_headers.html">$imported_headers</a>[<a class="var it295" onMouseOver="hilite(295)" onMouseOut="lolite()" onClick="logVariable('header')" href="../../../_variables/header.html">$header</a>]] == '') {
<a name="l158"><span class="linenum"> 158</span></a>                  echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box_start')" href="../../../_functions/box_start.html" onMouseOver="funcPopup(event,'box_start')">box_start</a>('generalbox importoutcomenofile');
<a name="l159"><span class="linenum"> 159</span></a>                  echo <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('importoutcomenofile', 'grades', <a class="var it3038" onMouseOver="hilite(3038)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../../_variables/line.html">$line</a>);
<a name="l160"><span class="linenum"> 160</span></a>                  echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('single_button')" href="../../../_functions/single_button.html" onMouseOver="funcPopup(event,'single_button')">single_button</a>(<span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('<a class="filename" href="../../../grade/edit/outcome/import.php.html">/grade/edit/outcome/import.php</a>', array('courseid'=&gt; <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../../_variables/courseid.html">$courseid</a>)), <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('back'), 'get');
<a name="l161"><span class="linenum"> 161</span></a>                  echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box_end')" href="../../../_functions/box_end.html" onMouseOver="funcPopup(event,'box_end')">box_end</a>();
<a name="l162"><span class="linenum"> 162</span></a>                  <a class="var it12849" onMouseOver="hilite(12849)" onMouseOut="lolite()" onClick="logVariable('fatal_error')" href="../../../_variables/fatal_error.html">$fatal_error</a> = true;
<a name="l163"><span class="linenum"> 163</span></a>                  break;
<a name="l164"><span class="linenum"> 164</span></a>              }
<a name="l165"><span class="linenum"> 165</span></a>          }
<a name="l166"><span class="linenum"> 166</span></a>  
<a name="l167"><span class="linenum"> 167</span></a>  <span class="comment">        // MDL-17273 errors in csv are not preventing import from happening. We break from the while loop here</span>
<a name="l168"><span class="linenum"> 168</span></a>          if (<a class="var it12849" onMouseOver="hilite(12849)" onMouseOut="lolite()" onClick="logVariable('fatal_error')" href="../../../_variables/fatal_error.html">$fatal_error</a>) {
<a name="l169"><span class="linenum"> 169</span></a>              break;
<a name="l170"><span class="linenum"> 170</span></a>          }
<a name="l171"><span class="linenum"> 171</span></a>          <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a> = array(<a class="var it12850" onMouseOver="hilite(12850)" onMouseOut="lolite()" onClick="logVariable('csv_data')" href="../../../_variables/csv_data.html">$csv_data</a>[<a class="var it12848" onMouseOver="hilite(12848)" onMouseOut="lolite()" onClick="logVariable('imported_headers')" href="../../../_variables/imported_headers.html">$imported_headers</a>['outcome_shortname']]);
<a name="l172"><span class="linenum"> 172</span></a>          <a class="var it3051" onMouseOver="hilite(3051)" onMouseOut="lolite()" onClick="logVariable('wheresql')" href="../../../_variables/wheresql.html">$wheresql</a> = 'shortname = ? ';
<a name="l173"><span class="linenum"> 173</span></a>  
<a name="l174"><span class="linenum"> 174</span></a>          if (<a class="var it12845" onMouseOver="hilite(12845)" onMouseOut="lolite()" onClick="logVariable('local_scope')" href="../../../_variables/local_scope.html">$local_scope</a>) {
<a name="l175"><span class="linenum"> 175</span></a>              <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>[] = <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../../_variables/courseid.html">$courseid</a>;
<a name="l176"><span class="linenum"> 176</span></a>              <a class="var it3051" onMouseOver="hilite(3051)" onMouseOut="lolite()" onClick="logVariable('wheresql')" href="../../../_variables/wheresql.html">$wheresql</a> .= ' AND courseid = ?';
<a name="l177"><span class="linenum"> 177</span></a>          } else {
<a name="l178"><span class="linenum"> 178</span></a>              <a class="var it3051" onMouseOver="hilite(3051)" onMouseOut="lolite()" onClick="logVariable('wheresql')" href="../../../_variables/wheresql.html">$wheresql</a> .= ' AND courseid IS NULL';
<a name="l179"><span class="linenum"> 179</span></a>          }
<a name="l180"><span class="linenum"> 180</span></a>  
<a name="l181"><span class="linenum"> 181</span></a>          <a class="var it3926" onMouseOver="hilite(3926)" onMouseOut="lolite()" onClick="logVariable('outcome')" href="../../../_variables/outcome.html">$outcome</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_select')" href="../../../_functions/get_records_select.html" onMouseOver="funcPopup(event,'get_records_select')">get_records_select</a>('grade_outcomes', <a class="var it3051" onMouseOver="hilite(3051)" onMouseOut="lolite()" onClick="logVariable('wheresql')" href="../../../_variables/wheresql.html">$wheresql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>);
<a name="l182"><span class="linenum"> 182</span></a>  
<a name="l183"><span class="linenum"> 183</span></a>          if (<a class="var it3926" onMouseOver="hilite(3926)" onMouseOut="lolite()" onClick="logVariable('outcome')" href="../../../_variables/outcome.html">$outcome</a>) {
<a name="l184"><span class="linenum"> 184</span></a>  <span class="comment">            // already exists, print a message and skip.</span>
<a name="l185"><span class="linenum"> 185</span></a>              echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box')" href="../../../_functions/box.html" onMouseOver="funcPopup(event,'box')">box</a>(<a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('importskippedoutcome', 'grades', <a class="var it12850" onMouseOver="hilite(12850)" onMouseOut="lolite()" onClick="logVariable('csv_data')" href="../../../_variables/csv_data.html">$csv_data</a>[<a class="var it12848" onMouseOver="hilite(12848)" onMouseOut="lolite()" onClick="logVariable('imported_headers')" href="../../../_variables/imported_headers.html">$imported_headers</a>['outcome_shortname']]));
<a name="l186"><span class="linenum"> 186</span></a>              continue;
<a name="l187"><span class="linenum"> 187</span></a>          }
<a name="l188"><span class="linenum"> 188</span></a>  
<a name="l189"><span class="linenum"> 189</span></a>  <span class="comment">        // new outcome will be added, search for compatible existing scale...</span>
<a name="l190"><span class="linenum"> 190</span></a>          <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a> = array(<a class="var it12850" onMouseOver="hilite(12850)" onMouseOut="lolite()" onClick="logVariable('csv_data')" href="../../../_variables/csv_data.html">$csv_data</a>[<a class="var it12848" onMouseOver="hilite(12848)" onMouseOut="lolite()" onClick="logVariable('imported_headers')" href="../../../_variables/imported_headers.html">$imported_headers</a>['scale_name']], <a class="var it12850" onMouseOver="hilite(12850)" onMouseOut="lolite()" onClick="logVariable('csv_data')" href="../../../_variables/csv_data.html">$csv_data</a>[<a class="var it12848" onMouseOver="hilite(12848)" onMouseOut="lolite()" onClick="logVariable('imported_headers')" href="../../../_variables/imported_headers.html">$imported_headers</a>['scale_items']], <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../../_variables/courseid.html">$courseid</a>);
<a name="l191"><span class="linenum"> 191</span></a>          <a class="var it3051" onMouseOver="hilite(3051)" onMouseOut="lolite()" onClick="logVariable('wheresql')" href="../../../_variables/wheresql.html">$wheresql</a> = 'name = ? AND scale = ? AND (courseid = ? OR courseid = 0)';
<a name="l192"><span class="linenum"> 192</span></a>          <a class="var it1939" onMouseOver="hilite(1939)" onMouseOut="lolite()" onClick="logVariable('scale')" href="../../../_variables/scale.html">$scale</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records_select')" href="../../../_functions/get_records_select.html" onMouseOver="funcPopup(event,'get_records_select')">get_records_select</a>('scale', <a class="var it3051" onMouseOver="hilite(3051)" onMouseOut="lolite()" onClick="logVariable('wheresql')" href="../../../_variables/wheresql.html">$wheresql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a>);
<a name="l193"><span class="linenum"> 193</span></a>  
<a name="l194"><span class="linenum"> 194</span></a>          if (<a class="var it1939" onMouseOver="hilite(1939)" onMouseOut="lolite()" onClick="logVariable('scale')" href="../../../_variables/scale.html">$scale</a>) {
<a name="l195"><span class="linenum"> 195</span></a>  <span class="comment">            // already exists in the right scope: use it.</span>
<a name="l196"><span class="linenum"> 196</span></a>              <a class="var it12851" onMouseOver="hilite(12851)" onMouseOut="lolite()" onClick="logVariable('scale_id')" href="../../../_variables/scale_id.html">$scale_id</a> = <a class="phpfunction" onClick="logFunction('key')" href="../../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a>(<a class="var it1939" onMouseOver="hilite(1939)" onMouseOut="lolite()" onClick="logVariable('scale')" href="../../../_variables/scale.html">$scale</a>);
<a name="l197"><span class="linenum"> 197</span></a>          } else {
<a name="l198"><span class="linenum"> 198</span></a>              if (!<a class="function" onClick="logFunction('has_capability')" href="../../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/course:managescales', <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../_variables/context.html">$context</a>)) {
<a name="l199"><span class="linenum"> 199</span></a>                  echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box')" href="../../../_functions/box.html" onMouseOver="funcPopup(event,'box')">box</a>(<a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('importskippednomanagescale', 'grades', <a class="var it12850" onMouseOver="hilite(12850)" onMouseOut="lolite()" onClick="logVariable('csv_data')" href="../../../_variables/csv_data.html">$csv_data</a>[<a class="var it12848" onMouseOver="hilite(12848)" onMouseOut="lolite()" onClick="logVariable('imported_headers')" href="../../../_variables/imported_headers.html">$imported_headers</a>['outcome_shortname']]));
<a name="l200"><span class="linenum"> 200</span></a>                  continue;
<a name="l201"><span class="linenum"> 201</span></a>              } else {
<a name="l202"><span class="linenum"> 202</span></a>  <span class="comment">                // scale doesn't exists : create it.</span>
<a name="l203"><span class="linenum"> 203</span></a>                  <a class="var it12852" onMouseOver="hilite(12852)" onMouseOut="lolite()" onClick="logVariable('scale_data')" href="../../../_variables/scale_data.html">$scale_data</a> = array('name' =&gt; <a class="var it12850" onMouseOver="hilite(12850)" onMouseOut="lolite()" onClick="logVariable('csv_data')" href="../../../_variables/csv_data.html">$csv_data</a>[<a class="var it12848" onMouseOver="hilite(12848)" onMouseOut="lolite()" onClick="logVariable('imported_headers')" href="../../../_variables/imported_headers.html">$imported_headers</a>['scale_name']],
<a name="l204"><span class="linenum"> 204</span></a>                          'scale' =&gt; <a class="var it12850" onMouseOver="hilite(12850)" onMouseOut="lolite()" onClick="logVariable('csv_data')" href="../../../_variables/csv_data.html">$csv_data</a>[<a class="var it12848" onMouseOver="hilite(12848)" onMouseOut="lolite()" onClick="logVariable('imported_headers')" href="../../../_variables/imported_headers.html">$imported_headers</a>['scale_items']],
<a name="l205"><span class="linenum"> 205</span></a>                          'description' =&gt; <a class="var it12850" onMouseOver="hilite(12850)" onMouseOut="lolite()" onClick="logVariable('csv_data')" href="../../../_variables/csv_data.html">$csv_data</a>[<a class="var it12848" onMouseOver="hilite(12848)" onMouseOut="lolite()" onClick="logVariable('imported_headers')" href="../../../_variables/imported_headers.html">$imported_headers</a>['scale_description']],
<a name="l206"><span class="linenum"> 206</span></a>                          'userid' =&gt; <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>);
<a name="l207"><span class="linenum"> 207</span></a>  
<a name="l208"><span class="linenum"> 208</span></a>                  if (<a class="var it12845" onMouseOver="hilite(12845)" onMouseOut="lolite()" onClick="logVariable('local_scope')" href="../../../_variables/local_scope.html">$local_scope</a>) {
<a name="l209"><span class="linenum"> 209</span></a>                      <a class="var it12852" onMouseOver="hilite(12852)" onMouseOut="lolite()" onClick="logVariable('scale_data')" href="../../../_variables/scale_data.html">$scale_data</a>['courseid'] = <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../../_variables/courseid.html">$courseid</a>;
<a name="l210"><span class="linenum"> 210</span></a>                  } else {
<a name="l211"><span class="linenum"> 211</span></a>                      <a class="var it12852" onMouseOver="hilite(12852)" onMouseOut="lolite()" onClick="logVariable('scale_data')" href="../../../_variables/scale_data.html">$scale_data</a>['courseid'] = 0; <span class="comment">// 'global' : scale use '0', outcomes use null</span>
<a name="l212"><span class="linenum"> 212</span></a>                  }
<a name="l213"><span class="linenum"> 213</span></a>                  <a class="var it1939" onMouseOver="hilite(1939)" onMouseOut="lolite()" onClick="logVariable('scale')" href="../../../_variables/scale.html">$scale</a> = <span class="keyword">new </span><a class="class" onClick="logClass('grade_scale')" href="../../../_classes/grade_scale.html" onMouseOver="classPopup(event,'grade_scale')">grade_scale</a>(<a class="var it12852" onMouseOver="hilite(12852)" onMouseOut="lolite()" onClick="logVariable('scale_data')" href="../../../_variables/scale_data.html">$scale_data</a>);
<a name="l214"><span class="linenum"> 214</span></a>                  <a class="var it12851" onMouseOver="hilite(12851)" onMouseOut="lolite()" onClick="logVariable('scale_id')" href="../../../_variables/scale_id.html">$scale_id</a> = <a class="var it1939" onMouseOver="hilite(1939)" onMouseOut="lolite()" onClick="logVariable('scale')" href="../../../_variables/scale.html">$scale</a>-&gt;<a class="function" onClick="logFunction('insert')" href="../../../_functions/insert.html" onMouseOver="funcPopup(event,'insert')">insert</a>();
<a name="l215"><span class="linenum"> 215</span></a>              }
<a name="l216"><span class="linenum"> 216</span></a>          }
<a name="l217"><span class="linenum"> 217</span></a>  
<a name="l218"><span class="linenum"> 218</span></a>  <span class="comment">        // add outcome</span>
<a name="l219"><span class="linenum"> 219</span></a>          <a class="var it12853" onMouseOver="hilite(12853)" onMouseOut="lolite()" onClick="logVariable('outcome_data')" href="../../../_variables/outcome_data.html">$outcome_data</a> = array('shortname' =&gt; <a class="var it12850" onMouseOver="hilite(12850)" onMouseOut="lolite()" onClick="logVariable('csv_data')" href="../../../_variables/csv_data.html">$csv_data</a>[<a class="var it12848" onMouseOver="hilite(12848)" onMouseOut="lolite()" onClick="logVariable('imported_headers')" href="../../../_variables/imported_headers.html">$imported_headers</a>['outcome_shortname']],
<a name="l220"><span class="linenum"> 220</span></a>                  'fullname' =&gt; <a class="var it12850" onMouseOver="hilite(12850)" onMouseOut="lolite()" onClick="logVariable('csv_data')" href="../../../_variables/csv_data.html">$csv_data</a>[<a class="var it12848" onMouseOver="hilite(12848)" onMouseOut="lolite()" onClick="logVariable('imported_headers')" href="../../../_variables/imported_headers.html">$imported_headers</a>['outcome_name']],
<a name="l221"><span class="linenum"> 221</span></a>                  'scaleid' =&gt; <a class="var it12851" onMouseOver="hilite(12851)" onMouseOut="lolite()" onClick="logVariable('scale_id')" href="../../../_variables/scale_id.html">$scale_id</a>,
<a name="l222"><span class="linenum"> 222</span></a>                  'description' =&gt; <a class="var it12850" onMouseOver="hilite(12850)" onMouseOut="lolite()" onClick="logVariable('csv_data')" href="../../../_variables/csv_data.html">$csv_data</a>[<a class="var it12848" onMouseOver="hilite(12848)" onMouseOut="lolite()" onClick="logVariable('imported_headers')" href="../../../_variables/imported_headers.html">$imported_headers</a>['outcome_description']],
<a name="l223"><span class="linenum"> 223</span></a>                  'usermodified' =&gt; <a class="var it9" onMouseOver="hilite(9)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it39490" onMouseOver="hilite(39490)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>);
<a name="l224"><span class="linenum"> 224</span></a>  
<a name="l225"><span class="linenum"> 225</span></a>          if (<a class="var it12845" onMouseOver="hilite(12845)" onMouseOut="lolite()" onClick="logVariable('local_scope')" href="../../../_variables/local_scope.html">$local_scope</a>) {
<a name="l226"><span class="linenum"> 226</span></a>              <a class="var it12853" onMouseOver="hilite(12853)" onMouseOut="lolite()" onClick="logVariable('outcome_data')" href="../../../_variables/outcome_data.html">$outcome_data</a>['courseid'] = <a class="var it96" onMouseOver="hilite(96)" onMouseOut="lolite()" onClick="logVariable('courseid')" href="../../../_variables/courseid.html">$courseid</a>;
<a name="l227"><span class="linenum"> 227</span></a>          } else {
<a name="l228"><span class="linenum"> 228</span></a>              <a class="var it12853" onMouseOver="hilite(12853)" onMouseOut="lolite()" onClick="logVariable('outcome_data')" href="../../../_variables/outcome_data.html">$outcome_data</a>['courseid'] = null; <span class="comment">// 'global' : scale use '0', outcomes use null</span>
<a name="l229"><span class="linenum"> 229</span></a>          }
<a name="l230"><span class="linenum"> 230</span></a>          <a class="var it3926" onMouseOver="hilite(3926)" onMouseOut="lolite()" onClick="logVariable('outcome')" href="../../../_variables/outcome.html">$outcome</a> = <span class="keyword">new </span><a class="class" onClick="logClass('grade_outcome')" href="../../../_classes/grade_outcome.html" onMouseOver="classPopup(event,'grade_outcome')">grade_outcome</a>(<a class="var it12853" onMouseOver="hilite(12853)" onMouseOut="lolite()" onClick="logVariable('outcome_data')" href="../../../_variables/outcome_data.html">$outcome_data</a>);
<a name="l231"><span class="linenum"> 231</span></a>          <a class="var it12854" onMouseOver="hilite(12854)" onMouseOut="lolite()" onClick="logVariable('outcome_id')" href="../../../_variables/outcome_id.html">$outcome_id</a> = <a class="var it3926" onMouseOver="hilite(3926)" onMouseOut="lolite()" onClick="logVariable('outcome')" href="../../../_variables/outcome.html">$outcome</a>-&gt;<a class="function" onClick="logFunction('insert')" href="../../../_functions/insert.html" onMouseOver="funcPopup(event,'insert')">insert</a>();
<a name="l232"><span class="linenum"> 232</span></a>  
<a name="l233"><span class="linenum"> 233</span></a>          <a class="var it12855" onMouseOver="hilite(12855)" onMouseOut="lolite()" onClick="logVariable('outcome_success_strings')" href="../../../_variables/outcome_success_strings.html">$outcome_success_strings</a> = new StdClass();
<a name="l234"><span class="linenum"> 234</span></a>          <a class="var it12855" onMouseOver="hilite(12855)" onMouseOut="lolite()" onClick="logVariable('outcome_success_strings')" href="../../../_variables/outcome_success_strings.html">$outcome_success_strings</a>-&gt;<a onClick="logVariable('name')" class="var it41279" onMouseOver="hilite(41279)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a> = <a class="var it12853" onMouseOver="hilite(12853)" onMouseOut="lolite()" onClick="logVariable('outcome_data')" href="../../../_variables/outcome_data.html">$outcome_data</a>['fullname'];
<a name="l235"><span class="linenum"> 235</span></a>          <a class="var it12855" onMouseOver="hilite(12855)" onMouseOut="lolite()" onClick="logVariable('outcome_success_strings')" href="../../../_variables/outcome_success_strings.html">$outcome_success_strings</a>-&gt;<a onClick="logVariable('id')" class="var it41279" onMouseOver="hilite(41279)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a> = <a class="var it12854" onMouseOver="hilite(12854)" onMouseOut="lolite()" onClick="logVariable('outcome_id')" href="../../../_variables/outcome_id.html">$outcome_id</a>;
<a name="l236"><span class="linenum"> 236</span></a>          echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box')" href="../../../_functions/box.html" onMouseOver="funcPopup(event,'box')">box</a>(<a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('importoutcomesuccess', 'grades', <a class="var it12855" onMouseOver="hilite(12855)" onMouseOut="lolite()" onClick="logVariable('outcome_success_strings')" href="../../../_variables/outcome_success_strings.html">$outcome_success_strings</a>));
<a name="l237"><span class="linenum"> 237</span></a>      }
<a name="l238"><span class="linenum"> 238</span></a>  } else {
<a name="l239"><span class="linenum"> 239</span></a>      echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box')" href="../../../_functions/box.html" onMouseOver="funcPopup(event,'box')">box</a>(<a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('importoutcomenofile', 'grades', 0));
<a name="l240"><span class="linenum"> 240</span></a>  }
<a name="l241"><span class="linenum"> 241</span></a>  
<a name="l242"><span class="linenum"> 242</span></a>  <span class="comment">// finish</span>
<a name="l243"><span class="linenum"> 243</span></a>  <a class="phpfunction" onClick="logFunction('fclose')" href="../../../_functions/fclose.html" onMouseOver="phpfuncPopup(event,'fclose')">fclose</a>(<a class="var it1207" onMouseOver="hilite(1207)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../_variables/handle.html">$handle</a>);
<a name="l244"><span class="linenum"> 244</span></a>  <span class="comment">// delete temp file</span>
<a name="l245"><span class="linenum"> 245</span></a>  <a class="phpfunction" onClick="logFunction('unlink')" href="../../../_functions/unlink.html" onMouseOver="phpfuncPopup(event,'unlink')">unlink</a>(<a class="var it12844" onMouseOver="hilite(12844)" onMouseOut="lolite()" onClick="logVariable('imported_file')" href="../../../_variables/imported_file.html">$imported_file</a>);
<a name="l246"><span class="linenum"> 246</span></a>  
<a name="l247"><span class="linenum"> 247</span></a>  echo <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../../../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('footer')" href="../../../_functions/footer.html" onMouseOver="funcPopup(event,'footer')">footer</a>();
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'fopen': ['fopen', 'Return a stream handle to this string stream. ', [['lib/horde/framework/Horde/Support','StringStream.php',41],['lib/horde/framework/Horde/Support','CombineStream.php',41]], 231],
'grade_build_nav': ['grade_build_nav', 'Function central to gradebook for building and printing the navigation (breadcrumb trail). ', [['grade','lib.php',1134]], 3],
'box_start': ['box_start', 'Outputs the opening section of a box. ', [['lib','outputrenderers.php',2987]], 351],
'set_url': ['set_url', 'Set the url specifics ', [['backup/cc/cc_lib','cc_weblink.php',50],['backup/util/ui','restore_ui_components.php',141],['mod/wiki','pagelib.php',246],['mod/wiki','pagelib.php',334],['mod/wiki','pagelib.php',421],['mod/wiki','pagelib.php',701],['mod/wiki','pagelib.php',726],['mod/wiki','pagelib.php',840],['mod/wiki','pagelib.php',884],['mod/wiki','pagelib.php',1013],['mod/wiki','pagelib.php',1117],['mod/wiki','pagelib.php',1224],['mod/wiki','pagelib.php',1467],['mod/wiki','pagelib.php',1869],['mod/wiki','pagelib.php',1937],['mod/wiki','pagelib.php',2111],['mod/wiki','pagelib.php',2172],['mod/wiki','pagelib.php',2228],['mod/wiki','pagelib.php',2293],['mod/wiki','pagelib.php',2341],['mod/wiki','pagelib.php',2389],['mod/wiki','pagelib.php',2493],['lib','outputcomponents.php',2823],['lib','pagelib.php',1198]], 574],
'box_end': ['box_end', 'Outputs the closing section of a box. ', [['lib','outputrenderers.php',3002]], 351],
'make_temp_directory': ['make_temp_directory', 'Create a directory under tempdir and make sure it is writable. ', [['lib','setuplib.php',1578]], 58],
'set_pagelayout': ['set_pagelayout', 'Sets the layout to use for this page. ', [['lib','pagelib.php',1063]], 277],
'require_login': ['require_login', 'This function checks that the current user is logged in and has the required privileges ', [['lib','moodlelib.php',2444]], 635],
'has_capability': ['has_capability', 'Wrapper round the has_capability funciton that automatically passes in the quiz context. ', [['mod/quiz','attemptlib.php',299],['mod/quiz','attemptlib.php',884],['lib','accesslib.php',346]], 1929],
'get_string': ['get_string', 'Return a core get_string() call ', [['lib/external','externallib.php',112],['lib','moodlelib.php',6538],['lib','moodlelib.php',9417],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38],['lib/classes','string_manager_install.php',95],['question/behaviour','behaviourbase.php',756]], 19235],
'save_file': ['save_file', 'Save file to standard filesystem ', [['lib','formslib.php',696]], 9],
'get_records_select': ['get_records_select', 'Get a number of records as an array of objects which match a particular WHERE clause. ', [['lib/dml','moodle_database.php',1283]], 163],
'print_grade_page_head': ['print_grade_page_head', 'Prints the page headers, breadcrumb trail, page heading, (optional) dropdown navigation menu and (optional) navigation tabs for any gradebook page. All gradebook pages MUST use these functions in favour of the usual print_header(), print_header_simple(), print_heading() etc. !IMPORTANT! Use of tabs.php file in gradebook pages is forbidden unless tabs are switched off at the site level for the gradebook ($CFG->grade_navmethod = GRADE_NAVMETHOD_DROPDOWN). ', [['grade','lib.php',803]], 44],
'get_record': ['get_record', 'Get a single database record as an object where all the given conditions met. ', [['lib/dml','moodle_database.php',1413]], 2960],
'require_capability': ['require_capability', 'Adds a required capability which all results will be checked against ', [['backup/util/ui','restore_ui_components.php',157],['mod/quiz','attemptlib.php',306],['mod/quiz','attemptlib.php',891],['lib','accesslib.php',764]], 628],
'footer': ['footer', 'Returns the footer ', [['mod/lesson','renderer.php',78],['lib/tcpdf','tcpdf.php',3464],['lib','outputrenderers.php',1021],['lib','outputrenderers.php',4143],['lib','outputrenderers.php',4248]], 780],
'display': ['display', '', [['mod/lesson/pagetypes','matching.php',50],['mod/lesson/pagetypes','cluster.php',39],['lib/minify/lib/Minify/Cache','XCache.php',74],['mod/quiz/report/grading','report.php',51],['question/classes/bank','view.php',451],['mod/scorm/report/objectives/classes','report.php',37],['backup/util/ui','base_ui.class.php',169],['lib/minify/lib/Minify/Cache','Memcache.php',85],['lib/minify/lib/Minify/Cache','APC.php',79],['mod/lesson/pagetypes','numerical.php',50],['mod/scorm/report/interactions/classes','report.php',31],['lib/pear/HTML','Common.php',428],['backup/util/ui','import_extensions.php',154],['mod/quiz/report/responses','report.php',51],['mod/quiz/report/statistics','report.php',51],['question/classes/bank','column_base.php',164],['backup/util/ui','restore_ui.class.php',373],['course/format/singleactivity','renderer.php',36],['mod/lesson/pagetypes','endofcluster.php',39],['user/selector','lib.php',205],['backup/util/ui','base_moodleform.class.php',365],['admin/roles/classes','capability_table_with_risks.php',132],['lib','formslib.php',913],['backup/util/ui','restore_ui_stage.class.php',355],['backup/util/ui','restore_ui_stage.class.php',497],['backup/util/ui','restore_ui_stage.class.php',1025],['backup/util/ui','restore_ui_stage.class.php',1112],['mod/lesson/pagetypes','truefalse.php',50],['repository/flickr_public','image.php',149],['mod/scorm/report/basic/classes','report.php',30],['admin/roles/classes','capability_table_base.php',71],['mod/lesson/pagetypes','endofbranch.php',39],['mod/lesson/pagetypes','essay.php',67],['mod/scorm/classes','report.php',39],['mod/quiz/report/overview','report.php',42],['backup/util/ui','backup_ui_stage.class.php',545],['backup/util/ui','backup_ui_stage.class.php',588],['lib/minify/lib/Minify/Cache','ZendPlatform.php',84],['mod/lesson/pagetypes','shortanswer.php',50],['cohort','upload_form.php',316],['mod/scorm/report/graphs/classes','report.php',36],['backup/util/ui','base_ui_stage.class.php',126],['mod/lesson/pagetypes','multichoice.php',87],['lib/minify/lib/Minify/Cache','File.php',72],['admin/roles/classes','define_role_table_advanced.php',603],['mod/lesson/pagetypes','branchtable.php',105]], 297],
'optional_param': ['optional_param', 'Returns a particular value for the named variable, taken from POST or GET, otherwise returning a given default. ', [['lib','moodlelib.php',605]], 2167],
'admin_externalpage_setup': ['admin_externalpage_setup', 'Initialise admin page - this function does require login and permission checks specified in page definition. ', [['lib','adminlib.php',6627]], 144],
'insert': ['insert', 'Creates a customer resource if one does not already exist. (customers.insert) ', [['lib/google/src/Google/Service','Reseller.php',309],['lib/google/src/Google/Service','Reseller.php',473],['lib/adodb','adodb-active-recordx.inc.php',899],['lib/grade','grade_object.php',325],['lib/google/src/Google/Service','Replicapoolupdater.php',294],['lib/google/src/Google/Service','Fusiontables.php',674],['lib/google/src/Google/Service','Fusiontables.php',838],['lib/google/src/Google/Service','Fusiontables.php',1012],['lib/google/src/Google/Service','Fusiontables.php',1217],['lib/google/src/Google/Service','Blogger.php',1243],['lib/google/src/Google/Service','Blogger.php',1493],['lib/google/src/Google/Service','Doubleclicksearch.php',285],['lib/google/src/Google/Service','AdExchangeBuyer.php',476],['lib/google/src/Google/Service','AdExchangeBuyer.php',635],['lib/google/src/Google/Service','Manager.php',271],['lib/google/src/Google/Service','Manager.php',349],['lib/grade','grade_item.php',385],['lib/google/src/Google/Service','Gmail.php',993],['lib/google/src/Google/Service','Plus.php',475],['lib/google/src/Google/Service','Mirror.php',393],['lib/google/src/Google/Service','Mirror.php',451],['lib/google/src/Google/Service','Mirror.php',605],['lib/google/src/Google/Service','Mirror.php',687],['lib/google/src/Google/Service','Mirror.php',801],['lib/google/src/Google/Service','Urlshortener.php',124],['lib/google/src/Google/Service','Dfareporting.php',499],['lib/google/src/Google/Service','PlusDomains.php',481],['lib/google/src/Google/Service','PlusDomains.php',606],['lib/google/src/Google/Service','PlusDomains.php',732],['lib/google/src/Google/Service','PlusDomains.php',781],['lib/google/src/Google/Service','GroupsMigration.php',85],['lib/google/src/Google/Service','Licensing.php',253],['lib/google/src/Google/Service','Drive.php',1491],['lib/google/src/Google/Service','Drive.php',1568],['lib/google/src/Google/Service','Drive.php',1727],['lib/google/src/Google/Service','Drive.php',1961],['lib/google/src/Google/Service','Drive.php',2045],['lib/google/src/Google/Service','Drive.php',2164],['lib/google/src/Google/Service','Drive.php',2328],['completion','data_object.php',316],['lib/google/src/Google/Service','Books.php',1835],['lib/google/src/Google/Service','Bigquery.php',548],['lib/google/src/Google/Service','Bigquery.php',672],['lib/google/src/Google/Service','Bigquery.php',856],['lib/google/src/Google/Service','YouTube.php',1323],['lib/google/src/Google/Service','YouTube.php',1423],['lib/google/src/Google/Service','YouTube.php',1498],['lib/google/src/Google/Service','YouTube.php',2025],['lib/google/src/Google/Service','YouTube.php',2323],['lib/google/src/Google/Service','YouTube.php',2525],['lib/google/src/Google/Service','YouTube.php',2685],['lib/google/src/Google/Service','YouTube.php',3013],['lib/google/src/Google/Service','YouTube.php',3254],['lib/google/src/Google/Service','Coordinate.php',491],['lib/google/src/Google/Service','Autoscaler.php',346],['lib/google/src/Google/Service','ShoppingContent.php',582],['lib/google/src/Google/Service','ShoppingContent.php',764],['lib/google/src/Google/Service','ShoppingContent.php',1000],['lib/google/src/Google/Service','SQLAdmin.php',698],['lib/google/src/Google/Service','SQLAdmin.php',959],['lib/google/src/Google/Service','Directory.php',1504],['lib/google/src/Google/Service','Directory.php',1601],['lib/google/src/Google/Service','Directory.php',1671],['lib/google/src/Google/Service','Directory.php',1964],['lib/google/src/Google/Service','Directory.php',2071],['lib/google/src/Google/Service','Directory.php',2239],['lib/google/src/Google/Service','Directory.php',2419],['lib/google/src/Google/Service','Taskqueue.php',323],['lib/google/src/Google/Service','AndroidPublisher.php',1211],['lib/google/src/Google/Service','AndroidPublisher.php',2002],['lib/google/src/Google/Service','AdSenseHost.php',786],['lib/google/src/Google/Service','AdSenseHost.php',1041],['lib/google/src/Google/Service','AdSenseHost.php',1182],['lib/google/src/Google/Service','MapsEngine.php',2780],['lib/google/src/Google/Service','MapsEngine.php',3184],['lib/grade','grade_grade.php',928],['lib/google/src/Google/Service','SiteVerification.php',180],['lib/google/src/Google/Service','Prediction.php',290],['lib/google/src/Google/Service','Compute.php',2844],['lib/google/src/Google/Service','Compute.php',2944],['lib/google/src/Google/Service','Compute.php',3171],['lib/google/src/Google/Service','Compute.php',3255],['lib/google/src/Google/Service','Compute.php',3393],['lib/google/src/Google/Service','Compute.php',3493],['lib/google/src/Google/Service','Compute.php',3573],['lib/google/src/Google/Service','Compute.php',3757],['lib/google/src/Google/Service','Compute.php',3891],['lib/google/src/Google/Service','Compute.php',3973],['lib/google/src/Google/Service','Compute.php',4165],['lib/google/src/Google/Service','Compute.php',4436],['lib/google/src/Google/Service','Compute.php',4690],['lib/google/src/Google/Service','Compute.php',4838],['lib/google/src/Google/Service','Compute.php',4959],['lib/google/src/Google/Service','Compute.php',5120],['lib/google/src/Google/Service','Compute.php',5259],['lib/google/src/Google/Service','Calendar.php',915],['lib/google/src/Google/Service','Calendar.php',1067],['lib/google/src/Google/Service','Calendar.php',1255],['lib/google/src/Google/Service','Calendar.php',1422],['lib/google/src/Google/Service','Analytics.php',2082],['lib/google/src/Google/Service','Analytics.php',2326],['lib/google/src/Google/Service','Analytics.php',2444],['lib/google/src/Google/Service','Analytics.php',2539],['lib/google/src/Google/Service','Analytics.php',2666],['lib/google/src/Google/Service','Analytics.php',2776],['lib/google/src/Google/Service','Analytics.php',2883],['lib/google/src/Google/Service','Analytics.php',3022],['lib/google/src/Google/Service','Analytics.php',3216],['lib/google/src/Google/Service','Analytics.php',3323],['lib/google/src/Google/Service','Analytics.php',3421],['lib/google/src/Google/Service','Tasks.php',336],['lib/google/src/Google/Service','Tasks.php',456],['lib/grade','grade_category.php',318],['lib/google/src/Google/Service','Storage.php',980],['lib/google/src/Google/Service','Storage.php',1100],['lib/google/src/Google/Service','Storage.php',1262],['lib/google/src/Google/Service','Storage.php',1392],['lib/google/src/Google/Service','Storage.php',1619],['lib/grade','grade_scale.php',111],['lib/google/src/Google/Service','Admin.php',87],['lib/google/src/Google/Service','Replicapool.php',434],['lib/google/src/Google/Service','Resourceviews.php',471],['lib/adodb','adodb-active-record.inc.php',742],['lib/grade','grade_outcome.php',120]], 459],
'instance': ['instance', 'Retrieve sole instance of the registry. ', [['lib/htmlpurifier/HTMLPurifier','URISchemeRegistry.php',9],['lib/classes/update','checker.php',62],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',29],['lib/classes','useragent.php',101],['backup/cc','validator.php',35],['lib/portfolio','exporter.php',251],['lib/tests','update_deployer_test.php',69],['lib/tests','string_manager_standard_test.php',124],['lib','modinfolib.php',373],['','mdeploy.php',96],['cache','disabledlib.php',171],['cache','disabledlib.php',296],['admin/tool/installaddon/classes','validator.php',85],['cache/classes','config.php',87],['course/format','lib.php',156],['lib','accesslib.php',6184],['lib','accesslib.php',6436],['lib','accesslib.php',6614],['lib','accesslib.php',6868],['lib','accesslib.php',7129],['lib','accesslib.php',7341],['cache','locallib.php',52],['lib/htmlpurifier','HTMLPurifier.php',251],['cache/classes','factory.php',114],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',53],['cache/classes','helper.php',76],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',31],['lib/classes','plugin_manager.php',83],['lib','filterlib.php',81],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',80],['lib/classes/update','deployer.php',54],['admin/tool/installaddon/classes','pluginfo_client.php',37],['admin/tool/installaddon/classes','installer.php',40],['backup/cc/cc_lib','cc_utils.php',387],['backup/cc/cc_lib','cc_utils.php',443]], 3942],
'get_data': ['get_data', '', [['mod/feedback/item/captcha','lib.php',76],['grade/grading/form/guide','edit_form.php',142],['grade/grading/form','lib.php',841],['grade/grading/form/rubric','edit_form.php',136],['mod/feedback/item/multichoicerated','multichoicerated_form.php',93],['mod/scorm','mod_form.php',514],['lib/classes/event','base.php',564],['mod/feedback','mod_form.php',163],['mod/feedback/item/multichoice','multichoice_form.php',93],['grade/export','grade_export_form.php',206],['lib/simplepie/library/SimplePie','Parser.php',263],['lib','completionlib.php',882],['lib','formslib.php',584],['mod/workshop','locallib.php',3815],['mod/glossary','mod_form.php',203],['mod/feedback/item/textfield','textfield_form.php',57],['blocks/rss_client','editfeed.php',101],['admin/tool/filetypes','edit_form.php',97],['mod/lesson','mod_form.php',383],['admin/tool/uploaduser','user_form.php',394],['admin/webservice','forms.php',299],['mod/feedback/item/numeric','numeric_form.php',60],['mod/feedback/item/multichoice','lib.php',87],['mod/choice','mod_form.php',128],['mod/feedback/item/textarea','textarea_form.php',57],['mod/forum','mod_form.php',270],['mod/feedback/item/textfield','lib.php',89],['mod/feedback/item/multichoicerated','lib.php',92],['admin/tool/uploadcourse/classes','course.php',269],['mod/feedback/item/label','lib.php',99],['mod/feedback/item/textarea','lib.php',92],['backup/util/structure','restore_path_element.class.php',118],['mod/feedback/item/numeric','lib.php',105],['mod/feedback/item/info','lib.php',76],['mod/feedback/item','feedback_item_class.php',37],['mod/feedback/item','feedback_item_class.php',149],['lib/classes/message/inbound','address_manager.php',361],['course','editsection_form.php',96],['message/tests','inbound_test.php',632]], 364],
'box': ['box', 'Outputs a box. ', [['lib','outputrenderers.php',2974]], 295],
'redirect': ['redirect', 'Redirect the browser ', [['','mdeploy.php',1474],['lib','weblib.php',2514]], 948],
'print_error': ['print_error', 'Abort execution by throwing of a general exception, default exception handler displays the error message in most cases. ', [['lib','setuplib.php',449]], 1560],
'single_button': ['single_button', 'Returns a form with a single button. ', [['lib','outputrenderers.php',1735]], 298],
'key': ['key', '', [], 198],
'count': ['count', '', [], 3984],
'time': ['time', '', [], 1768],
'dirname': ['dirname', '', [], 1071],
'array_flip': ['array_flip', '', [], 118],
'array_key_exists': ['array_key_exists', '', [], 1539],
'unlink': ['unlink', '', [], 252],
'fclose': ['fclose', '', [], 280],
'array_merge': ['array_merge', '', [], 2320],
'fgetcsv': ['fgetcsv', '', [], 11]};
CLASS_DATA={
'import_outcomes_form': ['import_outcomes_form', '', [['grade/edit/outcome','import_outcomes_form.php',31]], 1],
'grade_outcome': ['grade_outcome', 'Class representing a grade outcome. ', [['lib/grade','grade_outcome.php',30]], 39],
'context_system': ['context_system', 'System context class ', [['lib','accesslib.php',6106]], 929],
'grade_scale': ['grade_scale', 'Class representing a grade scale. ', [['lib/grade','grade_scale.php',30]], 37],
'moodle_url': ['moodle_url', 'Class for creating and manipulating urls. ', [['lib','weblib.php',240]], 2887],
'context_course': ['context_course', 'Course context class ', [['lib','accesslib.php',6766]], 1197]};
CONST_DATA={
'PARAM_INT': ['PARAM_INT', '', [['lib','moodlelib.php',156]], 2948],
'PARAM_ALPHA': ['PARAM_ALPHA', '', [['lib','moodlelib.php',77]], 377]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu May 28 19:17:31 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
