<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /grade/grading/form/guide/lib.php source</title>
    <link rel="stylesheet" href="../../../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu May 28 19:17:31 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../../../';
subdir='grade/grading/form/guide';
filename='lib.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/grade/grading/form/guide/</a> -> <a href="lib.php.html">lib.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="lib.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="lib.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * Grading method controller for the guide plugin</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * @package    gradingform_guide</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @copyright  2012 Dan Marsden &lt;dan@danmarsden.com&gt;</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> */</span>
<a name="l24"><span class="linenum">  24</span></a>  
<a name="l25"><span class="linenum">  25</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../../../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../../../../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die();
<a name="l26"><span class="linenum">  26</span></a>  
<a name="l27"><span class="linenum">  27</span></a>  require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../../../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../../../../grade/grading/form/lib.php.html">/grade/grading/form/lib.php</a>');
<a name="l28"><span class="linenum">  28</span></a>  
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment">/**</span>
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment"> * This controller encapsulates the guide grading logic</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment"> *</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> * @package    gradingform_guide</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> * @copyright  2012 Dan Marsden &lt;dan@danmarsden.com&gt;</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> */</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('gradingform_guide_controller')" href="../../../../_classes/gradingform_guide_controller.html" onMouseOver="classPopup(event,'gradingform_guide_controller')">gradingform_guide_controller</a> extends gradingform_controller {
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment">    // Modes of displaying the guide (used in gradingform_guide_renderer).</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment">    /** guide display mode: For editing (moderator or teacher creates a guide) */</span>
<a name="l39"><span class="linenum">  39</span></a>      const DISPLAY_EDIT_FULL     = 1;
<a name="l40"><span class="linenum">  40</span></a>  <span class="comment">    /** guide display mode: Preview the guide design with hidden fields */</span>
<a name="l41"><span class="linenum">  41</span></a>      const DISPLAY_EDIT_FROZEN   = 2;
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment">    /** guide display mode: Preview the guide design (for person with manage permission) */</span>
<a name="l43"><span class="linenum">  43</span></a>      const DISPLAY_PREVIEW       = 3;
<a name="l44"><span class="linenum">  44</span></a>  <span class="comment">    /** guide display mode: Preview the guide (for people being graded) */</span>
<a name="l45"><span class="linenum">  45</span></a>      const DISPLAY_PREVIEW_GRADED= 8;
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment">    /** guide display mode: For evaluation, enabled (teacher grades a student) */</span>
<a name="l47"><span class="linenum">  47</span></a>      const DISPLAY_EVAL          = 4;
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment">    /** guide display mode: For evaluation, with hidden fields */</span>
<a name="l49"><span class="linenum">  49</span></a>      const DISPLAY_EVAL_FROZEN   = 5;
<a name="l50"><span class="linenum">  50</span></a>  <span class="comment">    /** guide display mode: Teacher reviews filled guide */</span>
<a name="l51"><span class="linenum">  51</span></a>      const DISPLAY_REVIEW        = 6;
<a name="l52"><span class="linenum">  52</span></a>  <span class="comment">    /** guide display mode: Dispaly filled guide (i.e. students see their grades) */</span>
<a name="l53"><span class="linenum">  53</span></a>      const DISPLAY_VIEW          = 7;
<a name="l54"><span class="linenum">  54</span></a>  
<a name="l55"><span class="linenum">  55</span></a>  <span class="comment">    /** @var stdClass|false the definition structure */</span>
<a name="l56"><span class="linenum">  56</span></a>      protected <a class="var it13449" onMouseOver="hilite(13449)" onMouseOut="lolite()" onClick="logVariable('moduleinstance')" href="../../../../_variables/moduleinstance.html">$moduleinstance</a> = false;
<a name="l57"><span class="linenum">  57</span></a>  
<a name="l58"><span class="linenum">  58</span></a>      <span class="comment">/**</span>
<a name="l59"><span class="linenum">  59</span></a>  <span class="comment">     * Extends the module settings navigation with the guide grading settings</span>
<a name="l60"><span class="linenum">  60</span></a>  <span class="comment">     *</span>
<a name="l61"><span class="linenum">  61</span></a>  <span class="comment">     * This function is called when the context for the page is an activity module with the</span>
<a name="l62"><span class="linenum">  62</span></a>  <span class="comment">     * FEATURE_ADVANCED_GRADING, the user has the permission moodle/grade:managegradingforms</span>
<a name="l63"><span class="linenum">  63</span></a>  <span class="comment">     * and there is an area with the active grading method set to 'guide'.</span>
<a name="l64"><span class="linenum">  64</span></a>  <span class="comment">     *</span>
<a name="l65"><span class="linenum">  65</span></a>  <span class="comment">     * @param settings_navigation $settingsnav {@link settings_navigation}</span>
<a name="l66"><span class="linenum">  66</span></a>  <span class="comment">     * @param navigation_node $node {@link navigation_node}</span>
<a name="l67"><span class="linenum">  67</span></a>  <span class="comment">     */</span>
<a name="l68"><span class="linenum">  68</span></a>      public function <a class="function" onClick="logFunction('extend_settings_navigation')" href="../../../../_functions/extend_settings_navigation.html" onMouseOver="funcPopup(event,'extend_settings_navigation')">extend_settings_navigation</a>(settings_navigation <a class="var it1522" onMouseOver="hilite(1522)" onMouseOut="lolite()" onClick="logVariable('settingsnav')" href="../../../../_variables/settingsnav.html">$settingsnav</a>, navigation_node <a class="var it52" onMouseOver="hilite(52)" onMouseOut="lolite()" onClick="logVariable('node')" href="../../../../_variables/node.html">$node</a>=null) {
<a name="l69"><span class="linenum">  69</span></a>          <a class="var it52" onMouseOver="hilite(52)" onMouseOut="lolite()" onClick="logVariable('node')" href="../../../../_variables/node.html">$node</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>(<a class="function" onClick="logFunction('get_string')" href="../../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('definemarkingguide', 'gradingform_guide'),
<a name="l70"><span class="linenum">  70</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_editor_url')" href="../../../../_functions/get_editor_url.html" onMouseOver="funcPopup(event,'get_editor_url')">get_editor_url</a>(), <a class="class" onClick="logClass('settings_navigation')" href="../../../../_classes/settings_navigation.html" onMouseOver="classPopup(event,'settings_navigation')">settings_navigation</a>::TYPE_CUSTOM,
<a name="l71"><span class="linenum">  71</span></a>              null, null, <span class="keyword">new </span><a class="class" onClick="logClass('pix_icon')" href="../../../../_classes/pix_icon.html" onMouseOver="classPopup(event,'pix_icon')">pix_icon</a>('icon', '', 'gradingform_guide'));
<a name="l72"><span class="linenum">  72</span></a>      }
<a name="l73"><span class="linenum">  73</span></a>  
<a name="l74"><span class="linenum">  74</span></a>      <span class="comment">/**</span>
<a name="l75"><span class="linenum">  75</span></a>  <span class="comment">     * Extends the module navigation</span>
<a name="l76"><span class="linenum">  76</span></a>  <span class="comment">     *</span>
<a name="l77"><span class="linenum">  77</span></a>  <span class="comment">     * This function is called when the context for the page is an activity module with the</span>
<a name="l78"><span class="linenum">  78</span></a>  <span class="comment">     * FEATURE_ADVANCED_GRADING and there is an area with the active grading method set to the given plugin.</span>
<a name="l79"><span class="linenum">  79</span></a>  <span class="comment">     *</span>
<a name="l80"><span class="linenum">  80</span></a>  <span class="comment">     * @param global_navigation $navigation {@link global_navigation}</span>
<a name="l81"><span class="linenum">  81</span></a>  <span class="comment">     * @param navigation_node $node {@link navigation_node}</span>
<a name="l82"><span class="linenum">  82</span></a>  <span class="comment">     * @return void</span>
<a name="l83"><span class="linenum">  83</span></a>  <span class="comment">     */</span>
<a name="l84"><span class="linenum">  84</span></a>      public function <a class="function" onClick="logFunction('extend_navigation')" href="../../../../_functions/extend_navigation.html" onMouseOver="funcPopup(event,'extend_navigation')">extend_navigation</a>(global_navigation <a class="var it1513" onMouseOver="hilite(1513)" onMouseOut="lolite()" onClick="logVariable('navigation')" href="../../../../_variables/navigation.html">$navigation</a>, navigation_node <a class="var it52" onMouseOver="hilite(52)" onMouseOut="lolite()" onClick="logVariable('node')" href="../../../../_variables/node.html">$node</a>=null) {
<a name="l85"><span class="linenum">  85</span></a>          if (<a class="function" onClick="logFunction('has_capability')" href="../../../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/grade:managegradingforms', <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_context')" href="../../../../_functions/get_context.html" onMouseOver="funcPopup(event,'get_context')">get_context</a>())) {
<a name="l86"><span class="linenum">  86</span></a>  <span class="comment">            // No need for preview if user can manage forms, he will have link to manage.php in settings instead.</span>
<a name="l87"><span class="linenum">  87</span></a>              return;
<a name="l88"><span class="linenum">  88</span></a>          }
<a name="l89"><span class="linenum">  89</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_form_defined')" href="../../../../_functions/is_form_defined.html" onMouseOver="funcPopup(event,'is_form_defined')">is_form_defined</a>() &amp;&amp; (<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../../_variables/options.html">$options</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_options')" href="../../../../_functions/get_options.html" onMouseOver="funcPopup(event,'get_options')">get_options</a>()) &amp;&amp; !empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../../_variables/options.html">$options</a>['alwaysshowdefinition'])) {
<a name="l90"><span class="linenum">  90</span></a>              <a class="var it52" onMouseOver="hilite(52)" onMouseOut="lolite()" onClick="logVariable('node')" href="../../../../_variables/node.html">$node</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>(<a class="function" onClick="logFunction('get_string')" href="../../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('gradingof', 'gradingform_guide', <a class="function" onClick="logFunction('get_grading_manager')" href="../../../../_functions/get_grading_manager.html" onMouseOver="funcPopup(event,'get_grading_manager')">get_grading_manager</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_areaid')" href="../../../../_functions/get_areaid.html" onMouseOver="funcPopup(event,'get_areaid')">get_areaid</a>())-&gt;<a class="function" onClick="logFunction('get_area_title')" href="../../../../_functions/get_area_title.html" onMouseOver="funcPopup(event,'get_area_title')">get_area_title</a>()),
<a name="l91"><span class="linenum">  91</span></a>                      <span class="keyword">new </span><a class="class" onClick="logClass('moodle_url')" href="../../../../_classes/moodle_url.html" onMouseOver="classPopup(event,'moodle_url')">moodle_url</a>('/grade/grading/form/'.<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_method_name')" href="../../../../_functions/get_method_name.html" onMouseOver="funcPopup(event,'get_method_name')">get_method_name</a>().'/preview.php',
<a name="l92"><span class="linenum">  92</span></a>                          array('areaid' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_areaid')" href="../../../../_functions/get_areaid.html" onMouseOver="funcPopup(event,'get_areaid')">get_areaid</a>())), <a class="class" onClick="logClass('settings_navigation')" href="../../../../_classes/settings_navigation.html" onMouseOver="classPopup(event,'settings_navigation')">settings_navigation</a>::TYPE_CUSTOM);
<a name="l93"><span class="linenum">  93</span></a>          }
<a name="l94"><span class="linenum">  94</span></a>      }
<a name="l95"><span class="linenum">  95</span></a>  
<a name="l96"><span class="linenum">  96</span></a>      <span class="comment">/**</span>
<a name="l97"><span class="linenum">  97</span></a>  <span class="comment">     * Saves the guide definition into the database</span>
<a name="l98"><span class="linenum">  98</span></a>  <span class="comment">     *</span>
<a name="l99"><span class="linenum">  99</span></a>  <span class="comment">     * @see parent::update_definition()</span>
<a name="l100"><span class="linenum"> 100</span></a>  <span class="comment">     * @param stdClass $newdefinition guide definition data as coming from gradingform_guide_editguide::get_data()</span>
<a name="l101"><span class="linenum"> 101</span></a>  <span class="comment">     * @param int $usermodified optional userid of the author of the definition, defaults to the current user</span>
<a name="l102"><span class="linenum"> 102</span></a>  <span class="comment">     */</span>
<a name="l103"><span class="linenum"> 103</span></a>      public function <a class="function" onClick="logFunction('update_definition')" href="../../../../_functions/update_definition.html" onMouseOver="funcPopup(event,'update_definition')">update_definition</a>(stdClass <a class="var it33635" onMouseOver="hilite(33635)" onMouseOut="lolite()" onClick="logVariable('newdefinition')" href="../../../../_variables/newdefinition.html">$newdefinition</a>, <a class="var it5799" onMouseOver="hilite(5799)" onMouseOut="lolite()" onClick="logVariable('usermodified')" href="../../../../_variables/usermodified.html">$usermodified</a> = null) {
<a name="l104"><span class="linenum"> 104</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('update_or_check_guide')" href="../../../../_functions/update_or_check_guide.html" onMouseOver="funcPopup(event,'update_or_check_guide')">update_or_check_guide</a>(<a class="var it33635" onMouseOver="hilite(33635)" onMouseOut="lolite()" onClick="logVariable('newdefinition')" href="../../../../_variables/newdefinition.html">$newdefinition</a>, <a class="var it5799" onMouseOver="hilite(5799)" onMouseOut="lolite()" onClick="logVariable('usermodified')" href="../../../../_variables/usermodified.html">$usermodified</a>, true);
<a name="l105"><span class="linenum"> 105</span></a>          if (isset(<a class="var it33635" onMouseOver="hilite(33635)" onMouseOut="lolite()" onClick="logVariable('newdefinition')" href="../../../../_variables/newdefinition.html">$newdefinition</a>-&gt;<a onClick="logVariable('guide')" class="var it40039" onMouseOver="hilite(40039)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a>['regrade']) &amp;&amp; <a class="var it33635" onMouseOver="hilite(33635)" onMouseOut="lolite()" onClick="logVariable('newdefinition')" href="../../../../_variables/newdefinition.html">$newdefinition</a>-&gt;<a onClick="logVariable('guide')" class="var it40039" onMouseOver="hilite(40039)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a>['regrade']) {
<a name="l106"><span class="linenum"> 106</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('mark_for_regrade')" href="../../../../_functions/mark_for_regrade.html" onMouseOver="funcPopup(event,'mark_for_regrade')">mark_for_regrade</a>();
<a name="l107"><span class="linenum"> 107</span></a>          }
<a name="l108"><span class="linenum"> 108</span></a>      }
<a name="l109"><span class="linenum"> 109</span></a>  
<a name="l110"><span class="linenum"> 110</span></a>      <span class="comment">/**</span>
<a name="l111"><span class="linenum"> 111</span></a>  <span class="comment">     * Either saves the guide definition into the database or check if it has been changed.</span>
<a name="l112"><span class="linenum"> 112</span></a>  <span class="comment">     *</span>
<a name="l113"><span class="linenum"> 113</span></a>  <span class="comment">     * Returns the level of changes:</span>
<a name="l114"><span class="linenum"> 114</span></a>  <span class="comment">     * 0 - no changes</span>
<a name="l115"><span class="linenum"> 115</span></a>  <span class="comment">     * 1 - only texts or criteria sortorders are changed, students probably do not require re-grading</span>
<a name="l116"><span class="linenum"> 116</span></a>  <span class="comment">     * 2 - added levels but maximum score on guide is the same, students still may not require re-grading</span>
<a name="l117"><span class="linenum"> 117</span></a>  <span class="comment">     * 3 - removed criteria or changed number of points, students require re-grading but may be re-graded automatically</span>
<a name="l118"><span class="linenum"> 118</span></a>  <span class="comment">     * 4 - removed levels - students require re-grading and not all students may be re-graded automatically</span>
<a name="l119"><span class="linenum"> 119</span></a>  <span class="comment">     * 5 - added criteria - all students require manual re-grading</span>
<a name="l120"><span class="linenum"> 120</span></a>  <span class="comment">     *</span>
<a name="l121"><span class="linenum"> 121</span></a>  <span class="comment">     * @param stdClass $newdefinition guide definition data as coming from gradingform_guide_editguide::get_data()</span>
<a name="l122"><span class="linenum"> 122</span></a>  <span class="comment">     * @param int|null $usermodified optional userid of the author of the definition, defaults to the current user</span>
<a name="l123"><span class="linenum"> 123</span></a>  <span class="comment">     * @param bool $doupdate if true actually updates DB, otherwise performs a check</span>
<a name="l124"><span class="linenum"> 124</span></a>  <span class="comment">     * @return int</span>
<a name="l125"><span class="linenum"> 125</span></a>  <span class="comment">     */</span>
<a name="l126"><span class="linenum"> 126</span></a>      public function <a class="function" onClick="logFunction('update_or_check_guide')" href="../../../../_functions/update_or_check_guide.html" onMouseOver="funcPopup(event,'update_or_check_guide')">update_or_check_guide</a>(stdClass <a class="var it33635" onMouseOver="hilite(33635)" onMouseOut="lolite()" onClick="logVariable('newdefinition')" href="../../../../_variables/newdefinition.html">$newdefinition</a>, <a class="var it5799" onMouseOver="hilite(5799)" onMouseOut="lolite()" onClick="logVariable('usermodified')" href="../../../../_variables/usermodified.html">$usermodified</a> = null, <a class="var it15515" onMouseOver="hilite(15515)" onMouseOut="lolite()" onClick="logVariable('doupdate')" href="../../../../_variables/doupdate.html">$doupdate</a> = false) {
<a name="l127"><span class="linenum"> 127</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>;
<a name="l128"><span class="linenum"> 128</span></a>  
<a name="l129"><span class="linenum"> 129</span></a>  <span class="comment">        // Firstly update the common definition data in the {grading_definition} table.</span>
<a name="l130"><span class="linenum"> 130</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a> === false) {
<a name="l131"><span class="linenum"> 131</span></a>              if (!<a class="var it15515" onMouseOver="hilite(15515)" onMouseOut="lolite()" onClick="logVariable('doupdate')" href="../../../../_variables/doupdate.html">$doupdate</a>) {
<a name="l132"><span class="linenum"> 132</span></a>  <span class="comment">                // If we create the new definition there is no such thing as re-grading anyway.</span>
<a name="l133"><span class="linenum"> 133</span></a>                  return 5;
<a name="l134"><span class="linenum"> 134</span></a>              }
<a name="l135"><span class="linenum"> 135</span></a>  <span class="comment">            // If definition does not exist yet, create a blank one</span>
<a name="l136"><span class="linenum"> 136</span></a>  <span class="comment">            // (we need id to save files embedded in description).</span>
<a name="l137"><span class="linenum"> 137</span></a>              parent::<a class="function" onClick="logFunction('update_definition')" href="../../../../_functions/update_definition.html" onMouseOver="funcPopup(event,'update_definition')">update_definition</a>(new stdClass(), <a class="var it5799" onMouseOver="hilite(5799)" onMouseOut="lolite()" onClick="logVariable('usermodified')" href="../../../../_variables/usermodified.html">$usermodified</a>);
<a name="l138"><span class="linenum"> 138</span></a>              parent::<a class="function" onClick="logFunction('load_definition')" href="../../../../_functions/load_definition.html" onMouseOver="funcPopup(event,'load_definition')">load_definition</a>();
<a name="l139"><span class="linenum"> 139</span></a>          }
<a name="l140"><span class="linenum"> 140</span></a>          if (!isset(<a class="var it33635" onMouseOver="hilite(33635)" onMouseOut="lolite()" onClick="logVariable('newdefinition')" href="../../../../_variables/newdefinition.html">$newdefinition</a>-&gt;<a onClick="logVariable('guide')" class="var it40039" onMouseOver="hilite(40039)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a>['options'])) {
<a name="l141"><span class="linenum"> 141</span></a>              <a class="var it33635" onMouseOver="hilite(33635)" onMouseOut="lolite()" onClick="logVariable('newdefinition')" href="../../../../_variables/newdefinition.html">$newdefinition</a>-&gt;<a onClick="logVariable('guide')" class="var it40039" onMouseOver="hilite(40039)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a>['options'] = self::<a class="function" onClick="logFunction('get_default_options')" href="../../../../_functions/get_default_options.html" onMouseOver="funcPopup(event,'get_default_options')">get_default_options</a>();
<a name="l142"><span class="linenum"> 142</span></a>          }
<a name="l143"><span class="linenum"> 143</span></a>          <a class="var it33635" onMouseOver="hilite(33635)" onMouseOut="lolite()" onClick="logVariable('newdefinition')" href="../../../../_variables/newdefinition.html">$newdefinition</a>-&gt;<a onClick="logVariable('options')" class="var it40039" onMouseOver="hilite(40039)" onMouseOut="lolite()" href="../../../../_variables/options.html">options</a> = <a class="function" onClick="logFunction('json_encode')" href="../../../../_functions/json_encode.html" onMouseOver="funcPopup(event,'json_encode')">json_encode</a>(<a class="var it33635" onMouseOver="hilite(33635)" onMouseOut="lolite()" onClick="logVariable('newdefinition')" href="../../../../_variables/newdefinition.html">$newdefinition</a>-&gt;<a onClick="logVariable('guide')" class="var it40039" onMouseOver="hilite(40039)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a>['options']);
<a name="l144"><span class="linenum"> 144</span></a>          <a class="var it2672" onMouseOver="hilite(2672)" onMouseOut="lolite()" onClick="logVariable('editoroptions')" href="../../../../_variables/editoroptions.html">$editoroptions</a> = self::<a class="function" onClick="logFunction('description_form_field_options')" href="../../../../_functions/description_form_field_options.html" onMouseOver="funcPopup(event,'description_form_field_options')">description_form_field_options</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_context')" href="../../../../_functions/get_context.html" onMouseOver="funcPopup(event,'get_context')">get_context</a>());
<a name="l145"><span class="linenum"> 145</span></a>          <a class="var it33635" onMouseOver="hilite(33635)" onMouseOut="lolite()" onClick="logVariable('newdefinition')" href="../../../../_variables/newdefinition.html">$newdefinition</a> = <a class="function" onClick="logFunction('file_postupdate_standard_editor')" href="../../../../_functions/file_postupdate_standard_editor.html" onMouseOver="funcPopup(event,'file_postupdate_standard_editor')">file_postupdate_standard_editor</a>(<a class="var it33635" onMouseOver="hilite(33635)" onMouseOut="lolite()" onClick="logVariable('newdefinition')" href="../../../../_variables/newdefinition.html">$newdefinition</a>, 'description', <a class="var it2672" onMouseOver="hilite(2672)" onMouseOut="lolite()" onClick="logVariable('editoroptions')" href="../../../../_variables/editoroptions.html">$editoroptions</a>, <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_context')" href="../../../../_functions/get_context.html" onMouseOver="funcPopup(event,'get_context')">get_context</a>(),
<a name="l146"><span class="linenum"> 146</span></a>              'grading', 'description', <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;id);
<a name="l147"><span class="linenum"> 147</span></a>  
<a name="l148"><span class="linenum"> 148</span></a>  <span class="comment">        // Reload the definition from the database.</span>
<a name="l149"><span class="linenum"> 149</span></a>          <a class="var it33636" onMouseOver="hilite(33636)" onMouseOut="lolite()" onClick="logVariable('currentdefinition')" href="../../../../_variables/currentdefinition.html">$currentdefinition</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_definition')" href="../../../../_functions/get_definition.html" onMouseOver="funcPopup(event,'get_definition')">get_definition</a>(true);
<a name="l150"><span class="linenum"> 150</span></a>  
<a name="l151"><span class="linenum"> 151</span></a>  <span class="comment">        // Update guide data.</span>
<a name="l152"><span class="linenum"> 152</span></a>          <a class="var it33637" onMouseOver="hilite(33637)" onMouseOut="lolite()" onClick="logVariable('haschanges')" href="../../../../_variables/haschanges.html">$haschanges</a> = array();
<a name="l153"><span class="linenum"> 153</span></a>          if (empty(<a class="var it33635" onMouseOver="hilite(33635)" onMouseOut="lolite()" onClick="logVariable('newdefinition')" href="../../../../_variables/newdefinition.html">$newdefinition</a>-&gt;<a onClick="logVariable('guide')" class="var it40039" onMouseOver="hilite(40039)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a>['criteria'])) {
<a name="l154"><span class="linenum"> 154</span></a>              <a class="var it1638" onMouseOver="hilite(1638)" onMouseOut="lolite()" onClick="logVariable('newcriteria')" href="../../../../_variables/newcriteria.html">$newcriteria</a> = array();
<a name="l155"><span class="linenum"> 155</span></a>          } else {
<a name="l156"><span class="linenum"> 156</span></a>              <a class="var it1638" onMouseOver="hilite(1638)" onMouseOut="lolite()" onClick="logVariable('newcriteria')" href="../../../../_variables/newcriteria.html">$newcriteria</a> = <a class="var it33635" onMouseOver="hilite(33635)" onMouseOut="lolite()" onClick="logVariable('newdefinition')" href="../../../../_variables/newdefinition.html">$newdefinition</a>-&gt;<a onClick="logVariable('guide')" class="var it40039" onMouseOver="hilite(40039)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a>['criteria']; <span class="comment">// New ones to be saved.</span>
<a name="l157"><span class="linenum"> 157</span></a>          }
<a name="l158"><span class="linenum"> 158</span></a>          <a class="var it33638" onMouseOver="hilite(33638)" onMouseOut="lolite()" onClick="logVariable('currentcriteria')" href="../../../../_variables/currentcriteria.html">$currentcriteria</a> = <a class="var it33636" onMouseOver="hilite(33636)" onMouseOut="lolite()" onClick="logVariable('currentdefinition')" href="../../../../_variables/currentdefinition.html">$currentdefinition</a>-&gt;<a onClick="logVariable('guide_criteria')" class="var it40040" onMouseOver="hilite(40040)" onMouseOut="lolite()" href="../../../../_variables/guide_criteria.html">guide_criteria</a>;
<a name="l159"><span class="linenum"> 159</span></a>          <a class="var it33640" onMouseOver="hilite(33640)" onMouseOut="lolite()" onClick="logVariable('criteriafields')" href="../../../../_variables/criteriafields.html">$criteriafields</a> = array('sortorder', 'description', 'descriptionformat', 'descriptionmarkers',
<a name="l160"><span class="linenum"> 160</span></a>              'descriptionmarkersformat', 'shortname', 'maxscore');
<a name="l161"><span class="linenum"> 161</span></a>          foreach (<a class="var it1638" onMouseOver="hilite(1638)" onMouseOut="lolite()" onClick="logVariable('newcriteria')" href="../../../../_variables/newcriteria.html">$newcriteria</a> as <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a> =&gt; <a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('criterion')" href="../../../../_variables/criterion.html">$criterion</a>) {
<a name="l162"><span class="linenum"> 162</span></a>              if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^NEWID\d+$/', <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>)) {
<a name="l163"><span class="linenum"> 163</span></a>  <span class="comment">                // Insert criterion into DB.</span>
<a name="l164"><span class="linenum"> 164</span></a>                  <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a> = array('definitionid' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;id, 'descriptionformat' =&gt; <a class="constant" onClick="logConstant('FORMAT_MOODLE')" href="../../../../_constants/FORMAT_MOODLE.html" onMouseOver="constPopup(event,'FORMAT_MOODLE')">FORMAT_MOODLE</a>,
<a name="l165"><span class="linenum"> 165</span></a>                      'descriptionmarkersformat' =&gt; <a class="constant" onClick="logConstant('FORMAT_MOODLE')" href="../../../../_constants/FORMAT_MOODLE.html" onMouseOver="constPopup(event,'FORMAT_MOODLE')">FORMAT_MOODLE</a>); <span class="comment">// TODO format is not supported yet.</span>
<a name="l166"><span class="linenum"> 166</span></a>                  foreach (<a class="var it33640" onMouseOver="hilite(33640)" onMouseOut="lolite()" onClick="logVariable('criteriafields')" href="../../../../_variables/criteriafields.html">$criteriafields</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>) {
<a name="l167"><span class="linenum"> 167</span></a>                      if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>, <a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('criterion')" href="../../../../_variables/criterion.html">$criterion</a>)) {
<a name="l168"><span class="linenum"> 168</span></a>                          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>] = <a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('criterion')" href="../../../../_variables/criterion.html">$criterion</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>];
<a name="l169"><span class="linenum"> 169</span></a>                      }
<a name="l170"><span class="linenum"> 170</span></a>                  }
<a name="l171"><span class="linenum"> 171</span></a>                  if (<a class="var it15515" onMouseOver="hilite(15515)" onMouseOut="lolite()" onClick="logVariable('doupdate')" href="../../../../_variables/doupdate.html">$doupdate</a>) {
<a name="l172"><span class="linenum"> 172</span></a>                      <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('gradingform_guide_criteria', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>);
<a name="l173"><span class="linenum"> 173</span></a>                  }
<a name="l174"><span class="linenum"> 174</span></a>                  <a class="var it33637" onMouseOver="hilite(33637)" onMouseOut="lolite()" onClick="logVariable('haschanges')" href="../../../../_variables/haschanges.html">$haschanges</a>[5] = true;
<a name="l175"><span class="linenum"> 175</span></a>              } else {
<a name="l176"><span class="linenum"> 176</span></a>  <span class="comment">                // Update criterion in DB.</span>
<a name="l177"><span class="linenum"> 177</span></a>                  <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a> = array();
<a name="l178"><span class="linenum"> 178</span></a>                  foreach (<a class="var it33640" onMouseOver="hilite(33640)" onMouseOut="lolite()" onClick="logVariable('criteriafields')" href="../../../../_variables/criteriafields.html">$criteriafields</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>) {
<a name="l179"><span class="linenum"> 179</span></a>                      if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>, <a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('criterion')" href="../../../../_variables/criterion.html">$criterion</a>) &amp;&amp; <a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('criterion')" href="../../../../_variables/criterion.html">$criterion</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>] != <a class="var it33638" onMouseOver="hilite(33638)" onMouseOut="lolite()" onClick="logVariable('currentcriteria')" href="../../../../_variables/currentcriteria.html">$currentcriteria</a>[<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>][<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>]) {
<a name="l180"><span class="linenum"> 180</span></a>                          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>] = <a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('criterion')" href="../../../../_variables/criterion.html">$criterion</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>];
<a name="l181"><span class="linenum"> 181</span></a>                      }
<a name="l182"><span class="linenum"> 182</span></a>                  }
<a name="l183"><span class="linenum"> 183</span></a>                  if (!empty(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>)) {
<a name="l184"><span class="linenum"> 184</span></a>  <span class="comment">                    // Update only if something is changed.</span>
<a name="l185"><span class="linenum"> 185</span></a>                      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>['id'] = <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>;
<a name="l186"><span class="linenum"> 186</span></a>                      if (<a class="var it15515" onMouseOver="hilite(15515)" onMouseOut="lolite()" onClick="logVariable('doupdate')" href="../../../../_variables/doupdate.html">$doupdate</a>) {
<a name="l187"><span class="linenum"> 187</span></a>                          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('gradingform_guide_criteria', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>);
<a name="l188"><span class="linenum"> 188</span></a>                      }
<a name="l189"><span class="linenum"> 189</span></a>                      <a class="var it33637" onMouseOver="hilite(33637)" onMouseOut="lolite()" onClick="logVariable('haschanges')" href="../../../../_variables/haschanges.html">$haschanges</a>[1] = true;
<a name="l190"><span class="linenum"> 190</span></a>                  }
<a name="l191"><span class="linenum"> 191</span></a>              }
<a name="l192"><span class="linenum"> 192</span></a>          }
<a name="l193"><span class="linenum"> 193</span></a>  <span class="comment">        // Remove deleted criteria from DB.</span>
<a name="l194"><span class="linenum"> 194</span></a>          foreach (<a class="phpfunction" onClick="logFunction('array_keys')" href="../../../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it33638" onMouseOver="hilite(33638)" onMouseOut="lolite()" onClick="logVariable('currentcriteria')" href="../../../../_variables/currentcriteria.html">$currentcriteria</a>) as <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>) {
<a name="l195"><span class="linenum"> 195</span></a>              if (!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>, <a class="var it1638" onMouseOver="hilite(1638)" onMouseOut="lolite()" onClick="logVariable('newcriteria')" href="../../../../_variables/newcriteria.html">$newcriteria</a>)) {
<a name="l196"><span class="linenum"> 196</span></a>                  if (<a class="var it15515" onMouseOver="hilite(15515)" onMouseOut="lolite()" onClick="logVariable('doupdate')" href="../../../../_variables/doupdate.html">$doupdate</a>) {
<a name="l197"><span class="linenum"> 197</span></a>                      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('gradingform_guide_criteria', array('id' =&gt; <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>));
<a name="l198"><span class="linenum"> 198</span></a>                  }
<a name="l199"><span class="linenum"> 199</span></a>                  <a class="var it33637" onMouseOver="hilite(33637)" onMouseOut="lolite()" onClick="logVariable('haschanges')" href="../../../../_variables/haschanges.html">$haschanges</a>[3] = true;
<a name="l200"><span class="linenum"> 200</span></a>              }
<a name="l201"><span class="linenum"> 201</span></a>          }
<a name="l202"><span class="linenum"> 202</span></a>  <span class="comment">        // Now handle comments.</span>
<a name="l203"><span class="linenum"> 203</span></a>          if (empty(<a class="var it33635" onMouseOver="hilite(33635)" onMouseOut="lolite()" onClick="logVariable('newdefinition')" href="../../../../_variables/newdefinition.html">$newdefinition</a>-&gt;<a onClick="logVariable('guide')" class="var it40039" onMouseOver="hilite(40039)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a>['comments'])) {
<a name="l204"><span class="linenum"> 204</span></a>              <a class="var it10232" onMouseOver="hilite(10232)" onMouseOut="lolite()" onClick="logVariable('newcomment')" href="../../../../_variables/newcomment.html">$newcomment</a> = array();
<a name="l205"><span class="linenum"> 205</span></a>          } else {
<a name="l206"><span class="linenum"> 206</span></a>              <a class="var it10232" onMouseOver="hilite(10232)" onMouseOut="lolite()" onClick="logVariable('newcomment')" href="../../../../_variables/newcomment.html">$newcomment</a> = <a class="var it33635" onMouseOver="hilite(33635)" onMouseOut="lolite()" onClick="logVariable('newdefinition')" href="../../../../_variables/newdefinition.html">$newdefinition</a>-&gt;<a onClick="logVariable('guide')" class="var it40039" onMouseOver="hilite(40039)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a>['comments']; <span class="comment">// New ones to be saved.</span>
<a name="l207"><span class="linenum"> 207</span></a>          }
<a name="l208"><span class="linenum"> 208</span></a>          <a class="var it33641" onMouseOver="hilite(33641)" onMouseOut="lolite()" onClick="logVariable('currentcomments')" href="../../../../_variables/currentcomments.html">$currentcomments</a> = <a class="var it33636" onMouseOver="hilite(33636)" onMouseOut="lolite()" onClick="logVariable('currentdefinition')" href="../../../../_variables/currentdefinition.html">$currentdefinition</a>-&gt;<a onClick="logVariable('guide_comments')" class="var it40040" onMouseOver="hilite(40040)" onMouseOut="lolite()" href="../../../../_variables/guide_comments.html">guide_comments</a>;
<a name="l209"><span class="linenum"> 209</span></a>          <a class="var it33643" onMouseOver="hilite(33643)" onMouseOut="lolite()" onClick="logVariable('commentfields')" href="../../../../_variables/commentfields.html">$commentfields</a> = array('sortorder', 'description');
<a name="l210"><span class="linenum"> 210</span></a>          foreach (<a class="var it10232" onMouseOver="hilite(10232)" onMouseOut="lolite()" onClick="logVariable('newcomment')" href="../../../../_variables/newcomment.html">$newcomment</a> as <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a> =&gt; <a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('comment')" href="../../../../_variables/comment.html">$comment</a>) {
<a name="l211"><span class="linenum"> 211</span></a>              if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^NEWID\d+$/', <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>)) {
<a name="l212"><span class="linenum"> 212</span></a>  <span class="comment">                // Insert criterion into DB.</span>
<a name="l213"><span class="linenum"> 213</span></a>                  <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a> = array('definitionid' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;id, 'descriptionformat' =&gt; <a class="constant" onClick="logConstant('FORMAT_MOODLE')" href="../../../../_constants/FORMAT_MOODLE.html" onMouseOver="constPopup(event,'FORMAT_MOODLE')">FORMAT_MOODLE</a>);
<a name="l214"><span class="linenum"> 214</span></a>                  foreach (<a class="var it33643" onMouseOver="hilite(33643)" onMouseOut="lolite()" onClick="logVariable('commentfields')" href="../../../../_variables/commentfields.html">$commentfields</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>) {
<a name="l215"><span class="linenum"> 215</span></a>                      if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>, <a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('comment')" href="../../../../_variables/comment.html">$comment</a>)) {
<a name="l216"><span class="linenum"> 216</span></a>                          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>] = <a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('comment')" href="../../../../_variables/comment.html">$comment</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>];
<a name="l217"><span class="linenum"> 217</span></a>                      }
<a name="l218"><span class="linenum"> 218</span></a>                  }
<a name="l219"><span class="linenum"> 219</span></a>                  if (<a class="var it15515" onMouseOver="hilite(15515)" onMouseOut="lolite()" onClick="logVariable('doupdate')" href="../../../../_variables/doupdate.html">$doupdate</a>) {
<a name="l220"><span class="linenum"> 220</span></a>                      <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('gradingform_guide_comments', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>);
<a name="l221"><span class="linenum"> 221</span></a>                  }
<a name="l222"><span class="linenum"> 222</span></a>              } else {
<a name="l223"><span class="linenum"> 223</span></a>  <span class="comment">                // Update criterion in DB.</span>
<a name="l224"><span class="linenum"> 224</span></a>                  <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a> = array();
<a name="l225"><span class="linenum"> 225</span></a>                  foreach (<a class="var it33643" onMouseOver="hilite(33643)" onMouseOut="lolite()" onClick="logVariable('commentfields')" href="../../../../_variables/commentfields.html">$commentfields</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>) {
<a name="l226"><span class="linenum"> 226</span></a>                      if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>, <a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('comment')" href="../../../../_variables/comment.html">$comment</a>) &amp;&amp; <a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('comment')" href="../../../../_variables/comment.html">$comment</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>] != <a class="var it33641" onMouseOver="hilite(33641)" onMouseOut="lolite()" onClick="logVariable('currentcomments')" href="../../../../_variables/currentcomments.html">$currentcomments</a>[<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>][<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>]) {
<a name="l227"><span class="linenum"> 227</span></a>                          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>] = <a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('comment')" href="../../../../_variables/comment.html">$comment</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>];
<a name="l228"><span class="linenum"> 228</span></a>                      }
<a name="l229"><span class="linenum"> 229</span></a>                  }
<a name="l230"><span class="linenum"> 230</span></a>                  if (!empty(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>)) {
<a name="l231"><span class="linenum"> 231</span></a>  <span class="comment">                    // Update only if something is changed.</span>
<a name="l232"><span class="linenum"> 232</span></a>                      <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>['id'] = <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>;
<a name="l233"><span class="linenum"> 233</span></a>                      if (<a class="var it15515" onMouseOver="hilite(15515)" onMouseOut="lolite()" onClick="logVariable('doupdate')" href="../../../../_variables/doupdate.html">$doupdate</a>) {
<a name="l234"><span class="linenum"> 234</span></a>                          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('gradingform_guide_comments', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>);
<a name="l235"><span class="linenum"> 235</span></a>                      }
<a name="l236"><span class="linenum"> 236</span></a>                  }
<a name="l237"><span class="linenum"> 237</span></a>              }
<a name="l238"><span class="linenum"> 238</span></a>          }
<a name="l239"><span class="linenum"> 239</span></a>  <span class="comment">        // Remove deleted criteria from DB.</span>
<a name="l240"><span class="linenum"> 240</span></a>          foreach (<a class="phpfunction" onClick="logFunction('array_keys')" href="../../../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it33641" onMouseOver="hilite(33641)" onMouseOut="lolite()" onClick="logVariable('currentcomments')" href="../../../../_variables/currentcomments.html">$currentcomments</a>) as <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>) {
<a name="l241"><span class="linenum"> 241</span></a>              if (!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>, <a class="var it10232" onMouseOver="hilite(10232)" onMouseOut="lolite()" onClick="logVariable('newcomment')" href="../../../../_variables/newcomment.html">$newcomment</a>)) {
<a name="l242"><span class="linenum"> 242</span></a>                  if (<a class="var it15515" onMouseOver="hilite(15515)" onMouseOut="lolite()" onClick="logVariable('doupdate')" href="../../../../_variables/doupdate.html">$doupdate</a>) {
<a name="l243"><span class="linenum"> 243</span></a>                      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('gradingform_guide_comments', array('id' =&gt; <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>));
<a name="l244"><span class="linenum"> 244</span></a>                  }
<a name="l245"><span class="linenum"> 245</span></a>              }
<a name="l246"><span class="linenum"> 246</span></a>          }
<a name="l247"><span class="linenum"> 247</span></a>  <span class="comment">        // End comments handle.</span>
<a name="l248"><span class="linenum"> 248</span></a>          foreach (array('status', 'description', 'descriptionformat', 'name', 'options') as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>) {
<a name="l249"><span class="linenum"> 249</span></a>              if (isset(<a class="var it33635" onMouseOver="hilite(33635)" onMouseOut="lolite()" onClick="logVariable('newdefinition')" href="../../../../_variables/newdefinition.html">$newdefinition</a>-&gt;<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>) &amp;&amp; <a class="var it33635" onMouseOver="hilite(33635)" onMouseOut="lolite()" onClick="logVariable('newdefinition')" href="../../../../_variables/newdefinition.html">$newdefinition</a>-&gt;<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a> != <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>) {
<a name="l250"><span class="linenum"> 250</span></a>                  <a class="var it33637" onMouseOver="hilite(33637)" onMouseOut="lolite()" onClick="logVariable('haschanges')" href="../../../../_variables/haschanges.html">$haschanges</a>[1] = true;
<a name="l251"><span class="linenum"> 251</span></a>              }
<a name="l252"><span class="linenum"> 252</span></a>          }
<a name="l253"><span class="linenum"> 253</span></a>          if (<a class="var it5799" onMouseOver="hilite(5799)" onMouseOut="lolite()" onClick="logVariable('usermodified')" href="../../../../_variables/usermodified.html">$usermodified</a> &amp;&amp; <a class="var it5799" onMouseOver="hilite(5799)" onMouseOut="lolite()" onClick="logVariable('usermodified')" href="../../../../_variables/usermodified.html">$usermodified</a> != <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;usermodified) {
<a name="l254"><span class="linenum"> 254</span></a>              <a class="var it33637" onMouseOver="hilite(33637)" onMouseOut="lolite()" onClick="logVariable('haschanges')" href="../../../../_variables/haschanges.html">$haschanges</a>[1] = true;
<a name="l255"><span class="linenum"> 255</span></a>          }
<a name="l256"><span class="linenum"> 256</span></a>          if (!<a class="phpfunction" onClick="logFunction('count')" href="../../../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it33637" onMouseOver="hilite(33637)" onMouseOut="lolite()" onClick="logVariable('haschanges')" href="../../../../_variables/haschanges.html">$haschanges</a>)) {
<a name="l257"><span class="linenum"> 257</span></a>              return 0;
<a name="l258"><span class="linenum"> 258</span></a>          }
<a name="l259"><span class="linenum"> 259</span></a>          if (<a class="var it15515" onMouseOver="hilite(15515)" onMouseOut="lolite()" onClick="logVariable('doupdate')" href="../../../../_variables/doupdate.html">$doupdate</a>) {
<a name="l260"><span class="linenum"> 260</span></a>              parent::<a class="function" onClick="logFunction('update_definition')" href="../../../../_functions/update_definition.html" onMouseOver="funcPopup(event,'update_definition')">update_definition</a>(<a class="var it33635" onMouseOver="hilite(33635)" onMouseOut="lolite()" onClick="logVariable('newdefinition')" href="../../../../_variables/newdefinition.html">$newdefinition</a>, <a class="var it5799" onMouseOver="hilite(5799)" onMouseOut="lolite()" onClick="logVariable('usermodified')" href="../../../../_variables/usermodified.html">$usermodified</a>);
<a name="l261"><span class="linenum"> 261</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('load_definition')" href="../../../../_functions/load_definition.html" onMouseOver="funcPopup(event,'load_definition')">load_definition</a>();
<a name="l262"><span class="linenum"> 262</span></a>          }
<a name="l263"><span class="linenum"> 263</span></a>  <span class="comment">        // Return the maximum level of changes.</span>
<a name="l264"><span class="linenum"> 264</span></a>          <a class="var it33644" onMouseOver="hilite(33644)" onMouseOut="lolite()" onClick="logVariable('changelevels')" href="../../../../_variables/changelevels.html">$changelevels</a> = <a class="phpfunction" onClick="logFunction('array_keys')" href="../../../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it33637" onMouseOver="hilite(33637)" onMouseOut="lolite()" onClick="logVariable('haschanges')" href="../../../../_variables/haschanges.html">$haschanges</a>);
<a name="l265"><span class="linenum"> 265</span></a>          <a class="phpfunction" onClick="logFunction('sort')" href="../../../../_functions/sort.html" onMouseOver="phpfuncPopup(event,'sort')">sort</a>(<a class="var it33644" onMouseOver="hilite(33644)" onMouseOut="lolite()" onClick="logVariable('changelevels')" href="../../../../_variables/changelevels.html">$changelevels</a>);
<a name="l266"><span class="linenum"> 266</span></a>          return <a class="phpfunction" onClick="logFunction('array_pop')" href="../../../../_functions/array_pop.html" onMouseOver="phpfuncPopup(event,'array_pop')">array_pop</a>(<a class="var it33644" onMouseOver="hilite(33644)" onMouseOut="lolite()" onClick="logVariable('changelevels')" href="../../../../_variables/changelevels.html">$changelevels</a>);
<a name="l267"><span class="linenum"> 267</span></a>      }
<a name="l268"><span class="linenum"> 268</span></a>  
<a name="l269"><span class="linenum"> 269</span></a>      <span class="comment">/**</span>
<a name="l270"><span class="linenum"> 270</span></a>  <span class="comment">     * Marks all instances filled with this guide with the status INSTANCE_STATUS_NEEDUPDATE</span>
<a name="l271"><span class="linenum"> 271</span></a>  <span class="comment">     */</span>
<a name="l272"><span class="linenum"> 272</span></a>      public function <a class="function" onClick="logFunction('mark_for_regrade')" href="../../../../_functions/mark_for_regrade.html" onMouseOver="funcPopup(event,'mark_for_regrade')">mark_for_regrade</a>() {
<a name="l273"><span class="linenum"> 273</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>;
<a name="l274"><span class="linenum"> 274</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('has_active_instances')" href="../../../../_functions/has_active_instances.html" onMouseOver="funcPopup(event,'has_active_instances')">has_active_instances</a>()) {
<a name="l275"><span class="linenum"> 275</span></a>              <a class="var it3183" onMouseOver="hilite(3183)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../../../_variables/conditions.html">$conditions</a> = array('definitionid'  =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;id,
<a name="l276"><span class="linenum"> 276</span></a>                          'status'  =&gt; gradingform_instance::INSTANCE_STATUS_ACTIVE);
<a name="l277"><span class="linenum"> 277</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('grading_instances', 'status', gradingform_instance::INSTANCE_STATUS_NEEDUPDATE, <a class="var it3183" onMouseOver="hilite(3183)" onMouseOut="lolite()" onClick="logVariable('conditions')" href="../../../../_variables/conditions.html">$conditions</a>);
<a name="l278"><span class="linenum"> 278</span></a>          }
<a name="l279"><span class="linenum"> 279</span></a>      }
<a name="l280"><span class="linenum"> 280</span></a>  
<a name="l281"><span class="linenum"> 281</span></a>      <span class="comment">/**</span>
<a name="l282"><span class="linenum"> 282</span></a>  <span class="comment">     * Loads the guide form definition if it exists</span>
<a name="l283"><span class="linenum"> 283</span></a>  <span class="comment">     *</span>
<a name="l284"><span class="linenum"> 284</span></a>  <span class="comment">     * There is a new array called 'guide_criteria' appended to the list of parent's definition properties.</span>
<a name="l285"><span class="linenum"> 285</span></a>  <span class="comment">     */</span>
<a name="l286"><span class="linenum"> 286</span></a>      protected function <a class="function" onClick="logFunction('load_definition')" href="../../../../_functions/load_definition.html" onMouseOver="funcPopup(event,'load_definition')">load_definition</a>() {
<a name="l287"><span class="linenum"> 287</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>;
<a name="l288"><span class="linenum"> 288</span></a>  
<a name="l289"><span class="linenum"> 289</span></a>  <span class="comment">        // Check to see if the user prefs have changed - putting here as this function is called on post even when</span>
<a name="l290"><span class="linenum"> 290</span></a>  <span class="comment">        // validation on the page fails. - hard to find a better place to locate this as it is specific to the guide.</span>
<a name="l291"><span class="linenum"> 291</span></a>          <a class="var it18024" onMouseOver="hilite(18024)" onMouseOut="lolite()" onClick="logVariable('showdesc')" href="../../../../_variables/showdesc.html">$showdesc</a> = <a class="function" onClick="logFunction('optional_param')" href="../../../../_functions/optional_param.html" onMouseOver="funcPopup(event,'optional_param')">optional_param</a>('showmarkerdesc', null, <a class="constant" onClick="logConstant('PARAM_BOOL')" href="../../../../_constants/PARAM_BOOL.html" onMouseOver="constPopup(event,'PARAM_BOOL')">PARAM_BOOL</a>); <span class="comment">// Check if we need to change pref.</span>
<a name="l292"><span class="linenum"> 292</span></a>          <a class="var it33645" onMouseOver="hilite(33645)" onMouseOut="lolite()" onClick="logVariable('showdescstudent')" href="../../../../_variables/showdescstudent.html">$showdescstudent</a> = <a class="function" onClick="logFunction('optional_param')" href="../../../../_functions/optional_param.html" onMouseOver="funcPopup(event,'optional_param')">optional_param</a>('showstudentdesc', null, <a class="constant" onClick="logConstant('PARAM_BOOL')" href="../../../../_constants/PARAM_BOOL.html" onMouseOver="constPopup(event,'PARAM_BOOL')">PARAM_BOOL</a>); <span class="comment">// Check if we need to change pref.</span>
<a name="l293"><span class="linenum"> 293</span></a>          if (<a class="var it18024" onMouseOver="hilite(18024)" onMouseOut="lolite()" onClick="logVariable('showdesc')" href="../../../../_variables/showdesc.html">$showdesc</a> !== null) {
<a name="l294"><span class="linenum"> 294</span></a>              <a class="function" onClick="logFunction('set_user_preference')" href="../../../../_functions/set_user_preference.html" onMouseOver="funcPopup(event,'set_user_preference')">set_user_preference</a>('gradingform_guide-showmarkerdesc', <a class="var it18024" onMouseOver="hilite(18024)" onMouseOut="lolite()" onClick="logVariable('showdesc')" href="../../../../_variables/showdesc.html">$showdesc</a>);
<a name="l295"><span class="linenum"> 295</span></a>          }
<a name="l296"><span class="linenum"> 296</span></a>          if (<a class="var it33645" onMouseOver="hilite(33645)" onMouseOut="lolite()" onClick="logVariable('showdescstudent')" href="../../../../_variables/showdescstudent.html">$showdescstudent</a> !== null) {
<a name="l297"><span class="linenum"> 297</span></a>              <a class="function" onClick="logFunction('set_user_preference')" href="../../../../_functions/set_user_preference.html" onMouseOver="funcPopup(event,'set_user_preference')">set_user_preference</a>('gradingform_guide-showstudentdesc', <a class="var it33645" onMouseOver="hilite(33645)" onMouseOut="lolite()" onClick="logVariable('showdescstudent')" href="../../../../_variables/showdescstudent.html">$showdescstudent</a>);
<a name="l298"><span class="linenum"> 298</span></a>          }
<a name="l299"><span class="linenum"> 299</span></a>  
<a name="l300"><span class="linenum"> 300</span></a>  <span class="comment">        // Get definition.</span>
<a name="l301"><span class="linenum"> 301</span></a>          <a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('definition')" href="../../../../_variables/definition.html">$definition</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('grading_definitions', array('areaid' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('areaid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/areaid.html">areaid</a>,
<a name="l302"><span class="linenum"> 302</span></a>              'method' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_method_name')" href="../../../../_functions/get_method_name.html" onMouseOver="funcPopup(event,'get_method_name')">get_method_name</a>()), '*');
<a name="l303"><span class="linenum"> 303</span></a>          if (!<a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('definition')" href="../../../../_variables/definition.html">$definition</a>) {
<a name="l304"><span class="linenum"> 304</span></a>  <span class="comment">            // The definition doesn't have to exist. It may be that we are only now creating it.</span>
<a name="l305"><span class="linenum"> 305</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a> = false;
<a name="l306"><span class="linenum"> 306</span></a>              return false;
<a name="l307"><span class="linenum"> 307</span></a>          }
<a name="l308"><span class="linenum"> 308</span></a>  
<a name="l309"><span class="linenum"> 309</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a> = <a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('definition')" href="../../../../_variables/definition.html">$definition</a>;
<a name="l310"><span class="linenum"> 310</span></a>  <span class="comment">        // Now get criteria.</span>
<a name="l311"><span class="linenum"> 311</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;guide_criteria = array();
<a name="l312"><span class="linenum"> 312</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;guide_comments = array();
<a name="l313"><span class="linenum"> 313</span></a>          <a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../../../_variables/criteria.html">$criteria</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset')" href="../../../../_functions/get_recordset.html" onMouseOver="funcPopup(event,'get_recordset')">get_recordset</a>('gradingform_guide_criteria', array('definitionid' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;id), 'sortorder');
<a name="l314"><span class="linenum"> 314</span></a>          foreach (<a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../../../_variables/criteria.html">$criteria</a> as <a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('criterion')" href="../../../../_variables/criterion.html">$criterion</a>) {
<a name="l315"><span class="linenum"> 315</span></a>              foreach (array('id', 'sortorder', 'description', 'descriptionformat',
<a name="l316"><span class="linenum"> 316</span></a>                             'maxscore', 'descriptionmarkers', 'descriptionmarkersformat', 'shortname') as <a class="var it1208" onMouseOver="hilite(1208)" onMouseOut="lolite()" onClick="logVariable('fieldname')" href="../../../../_variables/fieldname.html">$fieldname</a>) {
<a name="l317"><span class="linenum"> 317</span></a>                  if (<a class="var it1208" onMouseOver="hilite(1208)" onMouseOut="lolite()" onClick="logVariable('fieldname')" href="../../../../_variables/fieldname.html">$fieldname</a> == 'maxscore') {  // Strip any trailing 0.
<a name="l318"><span class="linenum"> 318</span></a>                      <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;guide_criteria[<a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('criterion')" href="../../../../_variables/criterion.html">$criterion</a>-&gt;<a onClick="logVariable('id')" class="var it40577" onMouseOver="hilite(40577)" onMouseOut="lolite()" href="../../../../_variables/id.html">id</a>][<a class="var it1208" onMouseOver="hilite(1208)" onMouseOut="lolite()" onClick="logVariable('fieldname')" href="../../../../_variables/fieldname.html">$fieldname</a>] = (float)<a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('criterion')" href="../../../../_variables/criterion.html">$criterion</a>-&gt;{<a class="var it1208" onMouseOver="hilite(1208)" onMouseOut="lolite()" onClick="logVariable('fieldname')" href="../../../../_variables/fieldname.html">$fieldname</a>};
<a name="l319"><span class="linenum"> 319</span></a>                  } else {
<a name="l320"><span class="linenum"> 320</span></a>                      <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;guide_criteria[<a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('criterion')" href="../../../../_variables/criterion.html">$criterion</a>-&gt;<a onClick="logVariable('id')" class="var it40577" onMouseOver="hilite(40577)" onMouseOut="lolite()" href="../../../../_variables/id.html">id</a>][<a class="var it1208" onMouseOver="hilite(1208)" onMouseOut="lolite()" onClick="logVariable('fieldname')" href="../../../../_variables/fieldname.html">$fieldname</a>] = <a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('criterion')" href="../../../../_variables/criterion.html">$criterion</a>-&gt;{<a class="var it1208" onMouseOver="hilite(1208)" onMouseOut="lolite()" onClick="logVariable('fieldname')" href="../../../../_variables/fieldname.html">$fieldname</a>};
<a name="l321"><span class="linenum"> 321</span></a>                  }
<a name="l322"><span class="linenum"> 322</span></a>              }
<a name="l323"><span class="linenum"> 323</span></a>          }
<a name="l324"><span class="linenum"> 324</span></a>          <a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../../../_variables/criteria.html">$criteria</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l325"><span class="linenum"> 325</span></a>  
<a name="l326"><span class="linenum"> 326</span></a>  <span class="comment">        // Now get comments.</span>
<a name="l327"><span class="linenum"> 327</span></a>          <a class="var it3670" onMouseOver="hilite(3670)" onMouseOut="lolite()" onClick="logVariable('comments')" href="../../../../_variables/comments.html">$comments</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_recordset')" href="../../../../_functions/get_recordset.html" onMouseOver="funcPopup(event,'get_recordset')">get_recordset</a>('gradingform_guide_comments', array('definitionid' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;id), 'sortorder');
<a name="l328"><span class="linenum"> 328</span></a>          foreach (<a class="var it3670" onMouseOver="hilite(3670)" onMouseOut="lolite()" onClick="logVariable('comments')" href="../../../../_variables/comments.html">$comments</a> as <a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('comment')" href="../../../../_variables/comment.html">$comment</a>) {
<a name="l329"><span class="linenum"> 329</span></a>              foreach (array('id', 'sortorder', 'description', 'descriptionformat') as <a class="var it1208" onMouseOver="hilite(1208)" onMouseOut="lolite()" onClick="logVariable('fieldname')" href="../../../../_variables/fieldname.html">$fieldname</a>) {
<a name="l330"><span class="linenum"> 330</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;guide_comments[<a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('comment')" href="../../../../_variables/comment.html">$comment</a>-&gt;<a onClick="logVariable('id')" class="var it39776" onMouseOver="hilite(39776)" onMouseOut="lolite()" href="../../../../_variables/id.html">id</a>][<a class="var it1208" onMouseOver="hilite(1208)" onMouseOut="lolite()" onClick="logVariable('fieldname')" href="../../../../_variables/fieldname.html">$fieldname</a>] = <a class="var it1145" onMouseOver="hilite(1145)" onMouseOut="lolite()" onClick="logVariable('comment')" href="../../../../_variables/comment.html">$comment</a>-&gt;{<a class="var it1208" onMouseOver="hilite(1208)" onMouseOut="lolite()" onClick="logVariable('fieldname')" href="../../../../_variables/fieldname.html">$fieldname</a>};
<a name="l331"><span class="linenum"> 331</span></a>              }
<a name="l332"><span class="linenum"> 332</span></a>          }
<a name="l333"><span class="linenum"> 333</span></a>          <a class="var it3670" onMouseOver="hilite(3670)" onMouseOut="lolite()" onClick="logVariable('comments')" href="../../../../_variables/comments.html">$comments</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l334"><span class="linenum"> 334</span></a>          if (empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('moduleinstance')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/moduleinstance.html">moduleinstance</a>)) { // Only set if empty.
<a name="l335"><span class="linenum"> 335</span></a>              <a class="var it557" onMouseOver="hilite(557)" onMouseOut="lolite()" onClick="logVariable('modulename')" href="../../../../_variables/modulename.html">$modulename</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_component')" href="../../../../_functions/get_component.html" onMouseOver="funcPopup(event,'get_component')">get_component</a>();
<a name="l336"><span class="linenum"> 336</span></a>              <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../../_variables/context.html">$context</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_context')" href="../../../../_functions/get_context.html" onMouseOver="funcPopup(event,'get_context')">get_context</a>();
<a name="l337"><span class="linenum"> 337</span></a>              if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it557" onMouseOver="hilite(557)" onMouseOut="lolite()" onClick="logVariable('modulename')" href="../../../../_variables/modulename.html">$modulename</a>, 'mod_') === 0) {
<a name="l338"><span class="linenum"> 338</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../../../_variables/dbman.html">$dbman</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_manager')" href="../../../../_functions/get_manager.html" onMouseOver="funcPopup(event,'get_manager')">get_manager</a>();
<a name="l339"><span class="linenum"> 339</span></a>                  <a class="var it557" onMouseOver="hilite(557)" onMouseOut="lolite()" onClick="logVariable('modulename')" href="../../../../_variables/modulename.html">$modulename</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../../../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it557" onMouseOver="hilite(557)" onMouseOut="lolite()" onClick="logVariable('modulename')" href="../../../../_variables/modulename.html">$modulename</a>, 4);
<a name="l340"><span class="linenum"> 340</span></a>                  if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('dbman')" href="../../../../_variables/dbman.html">$dbman</a>-&gt;<a class="function" onClick="logFunction('table_exists')" href="../../../../_functions/table_exists.html" onMouseOver="funcPopup(event,'table_exists')">table_exists</a>(<a class="var it557" onMouseOver="hilite(557)" onMouseOut="lolite()" onClick="logVariable('modulename')" href="../../../../_variables/modulename.html">$modulename</a>)) {
<a name="l341"><span class="linenum"> 341</span></a>                      <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../../../_variables/cm.html">$cm</a> = <a class="function" onClick="logFunction('get_coursemodule_from_id')" href="../../../../_functions/get_coursemodule_from_id.html" onMouseOver="funcPopup(event,'get_coursemodule_from_id')">get_coursemodule_from_id</a>(<a class="var it557" onMouseOver="hilite(557)" onMouseOut="lolite()" onClick="logVariable('modulename')" href="../../../../_variables/modulename.html">$modulename</a>, <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('instanceid')" class="var it39491" onMouseOver="hilite(39491)" onMouseOut="lolite()" href="../../../../_variables/instanceid.html">instanceid</a>);
<a name="l342"><span class="linenum"> 342</span></a>                      if (!empty(<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../../../_variables/cm.html">$cm</a>)) { // This should only occur when the course is being deleted.
<a name="l343"><span class="linenum"> 343</span></a>                          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('moduleinstance')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/moduleinstance.html">moduleinstance</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>(<a class="var it557" onMouseOver="hilite(557)" onMouseOut="lolite()" onClick="logVariable('modulename')" href="../../../../_variables/modulename.html">$modulename</a>, array(&quot;id&quot;=&gt;<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('cm')" href="../../../../_variables/cm.html">$cm</a>-&gt;<a onClick="logVariable('instance')" class="var it39492" onMouseOver="hilite(39492)" onMouseOut="lolite()" href="../../../../_variables/instance.html">instance</a>));
<a name="l344"><span class="linenum"> 344</span></a>                      }
<a name="l345"><span class="linenum"> 345</span></a>                  }
<a name="l346"><span class="linenum"> 346</span></a>              }
<a name="l347"><span class="linenum"> 347</span></a>          }
<a name="l348"><span class="linenum"> 348</span></a>      }
<a name="l349"><span class="linenum"> 349</span></a>  
<a name="l350"><span class="linenum"> 350</span></a>      <span class="comment">/**</span>
<a name="l351"><span class="linenum"> 351</span></a>  <span class="comment">     * Returns the default options for the guide display</span>
<a name="l352"><span class="linenum"> 352</span></a>  <span class="comment">     *</span>
<a name="l353"><span class="linenum"> 353</span></a>  <span class="comment">     * @return array</span>
<a name="l354"><span class="linenum"> 354</span></a>  <span class="comment">     */</span>
<a name="l355"><span class="linenum"> 355</span></a>      public static function <a class="function" onClick="logFunction('get_default_options')" href="../../../../_functions/get_default_options.html" onMouseOver="funcPopup(event,'get_default_options')">get_default_options</a>() {
<a name="l356"><span class="linenum"> 356</span></a>          <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../../_variables/options.html">$options</a> = array(
<a name="l357"><span class="linenum"> 357</span></a>              'alwaysshowdefinition' =&gt; 1,
<a name="l358"><span class="linenum"> 358</span></a>              'showmarkspercriterionstudents' =&gt; 1,
<a name="l359"><span class="linenum"> 359</span></a>          );
<a name="l360"><span class="linenum"> 360</span></a>          return <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../../_variables/options.html">$options</a>;
<a name="l361"><span class="linenum"> 361</span></a>      }
<a name="l362"><span class="linenum"> 362</span></a>  
<a name="l363"><span class="linenum"> 363</span></a>      <span class="comment">/**</span>
<a name="l364"><span class="linenum"> 364</span></a>  <span class="comment">     * Gets the options of this guide definition, fills the missing options with default values</span>
<a name="l365"><span class="linenum"> 365</span></a>  <span class="comment">     *</span>
<a name="l366"><span class="linenum"> 366</span></a>  <span class="comment">     * @return array</span>
<a name="l367"><span class="linenum"> 367</span></a>  <span class="comment">     */</span>
<a name="l368"><span class="linenum"> 368</span></a>      public function <a class="function" onClick="logFunction('get_options')" href="../../../../_functions/get_options.html" onMouseOver="funcPopup(event,'get_options')">get_options</a>() {
<a name="l369"><span class="linenum"> 369</span></a>          <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../../_variables/options.html">$options</a> = self::<a class="function" onClick="logFunction('get_default_options')" href="../../../../_functions/get_default_options.html" onMouseOver="funcPopup(event,'get_default_options')">get_default_options</a>();
<a name="l370"><span class="linenum"> 370</span></a>          if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;options)) {
<a name="l371"><span class="linenum"> 371</span></a>              <a class="var it33646" onMouseOver="hilite(33646)" onMouseOut="lolite()" onClick="logVariable('thisoptions')" href="../../../../_variables/thisoptions.html">$thisoptions</a> = json_decode(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;options);
<a name="l372"><span class="linenum"> 372</span></a>              foreach (<a class="var it33646" onMouseOver="hilite(33646)" onMouseOut="lolite()" onClick="logVariable('thisoptions')" href="../../../../_variables/thisoptions.html">$thisoptions</a> as <a class="var it38" onMouseOver="hilite(38)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../../../_variables/option.html">$option</a> =&gt; <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a>) {
<a name="l373"><span class="linenum"> 373</span></a>                  <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../../_variables/options.html">$options</a>[<a class="var it38" onMouseOver="hilite(38)" onMouseOut="lolite()" onClick="logVariable('option')" href="../../../../_variables/option.html">$option</a>] = <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a>;
<a name="l374"><span class="linenum"> 374</span></a>              }
<a name="l375"><span class="linenum"> 375</span></a>          }
<a name="l376"><span class="linenum"> 376</span></a>          return <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../../_variables/options.html">$options</a>;
<a name="l377"><span class="linenum"> 377</span></a>      }
<a name="l378"><span class="linenum"> 378</span></a>  
<a name="l379"><span class="linenum"> 379</span></a>      <span class="comment">/**</span>
<a name="l380"><span class="linenum"> 380</span></a>  <span class="comment">     * Converts the current definition into an object suitable for the editor form's set_data()</span>
<a name="l381"><span class="linenum"> 381</span></a>  <span class="comment">     *</span>
<a name="l382"><span class="linenum"> 382</span></a>  <span class="comment">     * @param bool $addemptycriterion whether to add an empty criterion if the guide is completely empty (just being created)</span>
<a name="l383"><span class="linenum"> 383</span></a>  <span class="comment">     * @return stdClass</span>
<a name="l384"><span class="linenum"> 384</span></a>  <span class="comment">     */</span>
<a name="l385"><span class="linenum"> 385</span></a>      public function <a class="function" onClick="logFunction('get_definition_for_editing')" href="../../../../_functions/get_definition_for_editing.html" onMouseOver="funcPopup(event,'get_definition_for_editing')">get_definition_for_editing</a>(<a class="var it33647" onMouseOver="hilite(33647)" onMouseOut="lolite()" onClick="logVariable('addemptycriterion')" href="../../../../_variables/addemptycriterion.html">$addemptycriterion</a> = false) {
<a name="l386"><span class="linenum"> 386</span></a>  
<a name="l387"><span class="linenum"> 387</span></a>          <a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('definition')" href="../../../../_variables/definition.html">$definition</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_definition')" href="../../../../_functions/get_definition.html" onMouseOver="funcPopup(event,'get_definition')">get_definition</a>();
<a name="l388"><span class="linenum"> 388</span></a>          <a class="var it515" onMouseOver="hilite(515)" onMouseOut="lolite()" onClick="logVariable('properties')" href="../../../../_variables/properties.html">$properties</a> = new stdClass();
<a name="l389"><span class="linenum"> 389</span></a>          <a class="var it515" onMouseOver="hilite(515)" onMouseOut="lolite()" onClick="logVariable('properties')" href="../../../../_variables/properties.html">$properties</a>-&gt;<a onClick="logVariable('areaid')" class="var it40041" onMouseOver="hilite(40041)" onMouseOut="lolite()" href="../../../../_variables/areaid.html">areaid</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('areaid')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/areaid.html">areaid</a>;
<a name="l390"><span class="linenum"> 390</span></a>          if (isset(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('moduleinstance')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/moduleinstance.html">moduleinstance</a>-&gt;grade)) {
<a name="l391"><span class="linenum"> 391</span></a>              <a class="var it515" onMouseOver="hilite(515)" onMouseOut="lolite()" onClick="logVariable('properties')" href="../../../../_variables/properties.html">$properties</a>-&gt;<a onClick="logVariable('modulegrade')" class="var it40041" onMouseOver="hilite(40041)" onMouseOut="lolite()" href="../../../../_variables/modulegrade.html">modulegrade</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('moduleinstance')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/moduleinstance.html">moduleinstance</a>-&gt;grade;
<a name="l392"><span class="linenum"> 392</span></a>          }
<a name="l393"><span class="linenum"> 393</span></a>          if (<a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('definition')" href="../../../../_variables/definition.html">$definition</a>) {
<a name="l394"><span class="linenum"> 394</span></a>              foreach (array('id', 'name', 'description', 'descriptionformat', 'status') as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>) {
<a name="l395"><span class="linenum"> 395</span></a>                  <a class="var it515" onMouseOver="hilite(515)" onMouseOut="lolite()" onClick="logVariable('properties')" href="../../../../_variables/properties.html">$properties</a>-&gt;<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a> = <a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('definition')" href="../../../../_variables/definition.html">$definition</a>-&gt;<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>;
<a name="l396"><span class="linenum"> 396</span></a>              }
<a name="l397"><span class="linenum"> 397</span></a>              <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../../_variables/options.html">$options</a> = self::<a class="function" onClick="logFunction('description_form_field_options')" href="../../../../_functions/description_form_field_options.html" onMouseOver="funcPopup(event,'description_form_field_options')">description_form_field_options</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_context')" href="../../../../_functions/get_context.html" onMouseOver="funcPopup(event,'get_context')">get_context</a>());
<a name="l398"><span class="linenum"> 398</span></a>              <a class="var it515" onMouseOver="hilite(515)" onMouseOut="lolite()" onClick="logVariable('properties')" href="../../../../_variables/properties.html">$properties</a> = <a class="function" onClick="logFunction('file_prepare_standard_editor')" href="../../../../_functions/file_prepare_standard_editor.html" onMouseOver="funcPopup(event,'file_prepare_standard_editor')">file_prepare_standard_editor</a>(<a class="var it515" onMouseOver="hilite(515)" onMouseOut="lolite()" onClick="logVariable('properties')" href="../../../../_variables/properties.html">$properties</a>, 'description', <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../../_variables/options.html">$options</a>, <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_context')" href="../../../../_functions/get_context.html" onMouseOver="funcPopup(event,'get_context')">get_context</a>(),
<a name="l399"><span class="linenum"> 399</span></a>                  'grading', 'description', <a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('definition')" href="../../../../_variables/definition.html">$definition</a>-&gt;<a onClick="logVariable('id')" class="var it39451" onMouseOver="hilite(39451)" onMouseOut="lolite()" href="../../../../_variables/id.html">id</a>);
<a name="l400"><span class="linenum"> 400</span></a>          }
<a name="l401"><span class="linenum"> 401</span></a>          <a class="var it515" onMouseOver="hilite(515)" onMouseOut="lolite()" onClick="logVariable('properties')" href="../../../../_variables/properties.html">$properties</a>-&gt;<a onClick="logVariable('guide')" class="var it40041" onMouseOver="hilite(40041)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a> = array('criteria' =&gt; array(), 'options' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_options')" href="../../../../_functions/get_options.html" onMouseOver="funcPopup(event,'get_options')">get_options</a>(), 'comments' =&gt; array());
<a name="l402"><span class="linenum"> 402</span></a>          if (!empty(<a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('definition')" href="../../../../_variables/definition.html">$definition</a>-&gt;<a onClick="logVariable('guide_criteria')" class="var it39451" onMouseOver="hilite(39451)" onMouseOut="lolite()" href="../../../../_variables/guide_criteria.html">guide_criteria</a>)) {
<a name="l403"><span class="linenum"> 403</span></a>              <a class="var it515" onMouseOver="hilite(515)" onMouseOut="lolite()" onClick="logVariable('properties')" href="../../../../_variables/properties.html">$properties</a>-&gt;<a onClick="logVariable('guide')" class="var it40041" onMouseOver="hilite(40041)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a>['criteria'] = <a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('definition')" href="../../../../_variables/definition.html">$definition</a>-&gt;<a onClick="logVariable('guide_criteria')" class="var it39451" onMouseOver="hilite(39451)" onMouseOut="lolite()" href="../../../../_variables/guide_criteria.html">guide_criteria</a>;
<a name="l404"><span class="linenum"> 404</span></a>          } else if (!<a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('definition')" href="../../../../_variables/definition.html">$definition</a> &amp;&amp; <a class="var it33647" onMouseOver="hilite(33647)" onMouseOut="lolite()" onClick="logVariable('addemptycriterion')" href="../../../../_variables/addemptycriterion.html">$addemptycriterion</a>) {
<a name="l405"><span class="linenum"> 405</span></a>              <a class="var it515" onMouseOver="hilite(515)" onMouseOut="lolite()" onClick="logVariable('properties')" href="../../../../_variables/properties.html">$properties</a>-&gt;<a onClick="logVariable('guide')" class="var it40041" onMouseOver="hilite(40041)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a>['criteria'] = array('addcriterion' =&gt; 1);
<a name="l406"><span class="linenum"> 406</span></a>          }
<a name="l407"><span class="linenum"> 407</span></a>          if (!empty(<a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('definition')" href="../../../../_variables/definition.html">$definition</a>-&gt;<a onClick="logVariable('guide_comments')" class="var it39451" onMouseOver="hilite(39451)" onMouseOut="lolite()" href="../../../../_variables/guide_comments.html">guide_comments</a>)) {
<a name="l408"><span class="linenum"> 408</span></a>              <a class="var it515" onMouseOver="hilite(515)" onMouseOut="lolite()" onClick="logVariable('properties')" href="../../../../_variables/properties.html">$properties</a>-&gt;<a onClick="logVariable('guide')" class="var it40041" onMouseOver="hilite(40041)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a>['comments'] = <a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('definition')" href="../../../../_variables/definition.html">$definition</a>-&gt;<a onClick="logVariable('guide_comments')" class="var it39451" onMouseOver="hilite(39451)" onMouseOut="lolite()" href="../../../../_variables/guide_comments.html">guide_comments</a>;
<a name="l409"><span class="linenum"> 409</span></a>          } else if (!<a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('definition')" href="../../../../_variables/definition.html">$definition</a> &amp;&amp; <a class="var it33647" onMouseOver="hilite(33647)" onMouseOut="lolite()" onClick="logVariable('addemptycriterion')" href="../../../../_variables/addemptycriterion.html">$addemptycriterion</a>) {
<a name="l410"><span class="linenum"> 410</span></a>              <a class="var it515" onMouseOver="hilite(515)" onMouseOut="lolite()" onClick="logVariable('properties')" href="../../../../_variables/properties.html">$properties</a>-&gt;<a onClick="logVariable('guide')" class="var it40041" onMouseOver="hilite(40041)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a>['comments'] = array('addcomment' =&gt; 1);
<a name="l411"><span class="linenum"> 411</span></a>          }
<a name="l412"><span class="linenum"> 412</span></a>          return <a class="var it515" onMouseOver="hilite(515)" onMouseOut="lolite()" onClick="logVariable('properties')" href="../../../../_variables/properties.html">$properties</a>;
<a name="l413"><span class="linenum"> 413</span></a>      }
<a name="l414"><span class="linenum"> 414</span></a>  
<a name="l415"><span class="linenum"> 415</span></a>      <span class="comment">/**</span>
<a name="l416"><span class="linenum"> 416</span></a>  <span class="comment">     * Returns the form definition suitable for cloning into another area</span>
<a name="l417"><span class="linenum"> 417</span></a>  <span class="comment">     *</span>
<a name="l418"><span class="linenum"> 418</span></a>  <span class="comment">     * @see parent::get_definition_copy()</span>
<a name="l419"><span class="linenum"> 419</span></a>  <span class="comment">     * @param gradingform_controller $target the controller of the new copy</span>
<a name="l420"><span class="linenum"> 420</span></a>  <span class="comment">     * @return stdClass definition structure to pass to the target's {@link update_definition()}</span>
<a name="l421"><span class="linenum"> 421</span></a>  <span class="comment">     */</span>
<a name="l422"><span class="linenum"> 422</span></a>      public function <a class="function" onClick="logFunction('get_definition_copy')" href="../../../../_functions/get_definition_copy.html" onMouseOver="funcPopup(event,'get_definition_copy')">get_definition_copy</a>(gradingform_controller <a class="var it1183" onMouseOver="hilite(1183)" onMouseOut="lolite()" onClick="logVariable('target')" href="../../../../_variables/target.html">$target</a>) {
<a name="l423"><span class="linenum"> 423</span></a>  
<a name="l424"><span class="linenum"> 424</span></a>          <a class="var it1821" onMouseOver="hilite(1821)" onMouseOut="lolite()" onClick="logVariable('new')" href="../../../../_variables/new.html">$new</a> = parent::<a class="function" onClick="logFunction('get_definition_copy')" href="../../../../_functions/get_definition_copy.html" onMouseOver="funcPopup(event,'get_definition_copy')">get_definition_copy</a>(<a class="var it1183" onMouseOver="hilite(1183)" onMouseOut="lolite()" onClick="logVariable('target')" href="../../../../_variables/target.html">$target</a>);
<a name="l425"><span class="linenum"> 425</span></a>          <a class="var it1276" onMouseOver="hilite(1276)" onMouseOut="lolite()" onClick="logVariable('old')" href="../../../../_variables/old.html">$old</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_definition_for_editing')" href="../../../../_functions/get_definition_for_editing.html" onMouseOver="funcPopup(event,'get_definition_for_editing')">get_definition_for_editing</a>();
<a name="l426"><span class="linenum"> 426</span></a>          <a class="var it1821" onMouseOver="hilite(1821)" onMouseOut="lolite()" onClick="logVariable('new')" href="../../../../_variables/new.html">$new</a>-&gt;<a onClick="logVariable('description_editor')" class="var it39639" onMouseOver="hilite(39639)" onMouseOut="lolite()" href="../../../../_variables/description_editor.html">description_editor</a> = <a class="var it1276" onMouseOver="hilite(1276)" onMouseOut="lolite()" onClick="logVariable('old')" href="../../../../_variables/old.html">$old</a>-&gt;<a onClick="logVariable('description_editor')" class="var it39640" onMouseOver="hilite(39640)" onMouseOut="lolite()" href="../../../../_variables/description_editor.html">description_editor</a>;
<a name="l427"><span class="linenum"> 427</span></a>          <a class="var it1821" onMouseOver="hilite(1821)" onMouseOut="lolite()" onClick="logVariable('new')" href="../../../../_variables/new.html">$new</a>-&gt;<a onClick="logVariable('guide')" class="var it39639" onMouseOver="hilite(39639)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a> = array('criteria' =&gt; array(), 'options' =&gt; <a class="var it1276" onMouseOver="hilite(1276)" onMouseOut="lolite()" onClick="logVariable('old')" href="../../../../_variables/old.html">$old</a>-&gt;<a onClick="logVariable('guide')" class="var it39640" onMouseOver="hilite(39640)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a>['options'], 'comments' =&gt; array());
<a name="l428"><span class="linenum"> 428</span></a>          <a class="var it33648" onMouseOver="hilite(33648)" onMouseOut="lolite()" onClick="logVariable('newcritid')" href="../../../../_variables/newcritid.html">$newcritid</a> = 1;
<a name="l429"><span class="linenum"> 429</span></a>          foreach (<a class="var it1276" onMouseOver="hilite(1276)" onMouseOut="lolite()" onClick="logVariable('old')" href="../../../../_variables/old.html">$old</a>-&gt;<a onClick="logVariable('guide')" class="var it39640" onMouseOver="hilite(39640)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a>['criteria'] as <a class="var it33649" onMouseOver="hilite(33649)" onMouseOut="lolite()" onClick="logVariable('oldcritid')" href="../../../../_variables/oldcritid.html">$oldcritid</a> =&gt; <a class="var it33650" onMouseOver="hilite(33650)" onMouseOut="lolite()" onClick="logVariable('oldcrit')" href="../../../../_variables/oldcrit.html">$oldcrit</a>) {
<a name="l430"><span class="linenum"> 430</span></a>              unset(<a class="var it33650" onMouseOver="hilite(33650)" onMouseOut="lolite()" onClick="logVariable('oldcrit')" href="../../../../_variables/oldcrit.html">$oldcrit</a>['id']);
<a name="l431"><span class="linenum"> 431</span></a>              <a class="var it1821" onMouseOver="hilite(1821)" onMouseOut="lolite()" onClick="logVariable('new')" href="../../../../_variables/new.html">$new</a>-&gt;<a onClick="logVariable('guide')" class="var it39639" onMouseOver="hilite(39639)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a>['criteria']['NEWID'.<a class="var it33648" onMouseOver="hilite(33648)" onMouseOut="lolite()" onClick="logVariable('newcritid')" href="../../../../_variables/newcritid.html">$newcritid</a>] = <a class="var it33650" onMouseOver="hilite(33650)" onMouseOut="lolite()" onClick="logVariable('oldcrit')" href="../../../../_variables/oldcrit.html">$oldcrit</a>;
<a name="l432"><span class="linenum"> 432</span></a>              <a class="var it33648" onMouseOver="hilite(33648)" onMouseOut="lolite()" onClick="logVariable('newcritid')" href="../../../../_variables/newcritid.html">$newcritid</a>++;
<a name="l433"><span class="linenum"> 433</span></a>          }
<a name="l434"><span class="linenum"> 434</span></a>          <a class="var it33651" onMouseOver="hilite(33651)" onMouseOut="lolite()" onClick="logVariable('newcomid')" href="../../../../_variables/newcomid.html">$newcomid</a> = 1;
<a name="l435"><span class="linenum"> 435</span></a>          foreach (<a class="var it1276" onMouseOver="hilite(1276)" onMouseOut="lolite()" onClick="logVariable('old')" href="../../../../_variables/old.html">$old</a>-&gt;<a onClick="logVariable('guide')" class="var it39640" onMouseOver="hilite(39640)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a>['comments'] as <a class="var it33649" onMouseOver="hilite(33649)" onMouseOut="lolite()" onClick="logVariable('oldcritid')" href="../../../../_variables/oldcritid.html">$oldcritid</a> =&gt; <a class="var it33652" onMouseOver="hilite(33652)" onMouseOut="lolite()" onClick="logVariable('oldcom')" href="../../../../_variables/oldcom.html">$oldcom</a>) {
<a name="l436"><span class="linenum"> 436</span></a>              unset(<a class="var it33652" onMouseOver="hilite(33652)" onMouseOut="lolite()" onClick="logVariable('oldcom')" href="../../../../_variables/oldcom.html">$oldcom</a>['id']);
<a name="l437"><span class="linenum"> 437</span></a>              <a class="var it1821" onMouseOver="hilite(1821)" onMouseOut="lolite()" onClick="logVariable('new')" href="../../../../_variables/new.html">$new</a>-&gt;<a onClick="logVariable('guide')" class="var it39639" onMouseOver="hilite(39639)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a>['comments']['NEWID'.<a class="var it33651" onMouseOver="hilite(33651)" onMouseOut="lolite()" onClick="logVariable('newcomid')" href="../../../../_variables/newcomid.html">$newcomid</a>] = <a class="var it33652" onMouseOver="hilite(33652)" onMouseOut="lolite()" onClick="logVariable('oldcom')" href="../../../../_variables/oldcom.html">$oldcom</a>;
<a name="l438"><span class="linenum"> 438</span></a>              <a class="var it33651" onMouseOver="hilite(33651)" onMouseOut="lolite()" onClick="logVariable('newcomid')" href="../../../../_variables/newcomid.html">$newcomid</a>++;
<a name="l439"><span class="linenum"> 439</span></a>          }
<a name="l440"><span class="linenum"> 440</span></a>          return <a class="var it1821" onMouseOver="hilite(1821)" onMouseOut="lolite()" onClick="logVariable('new')" href="../../../../_variables/new.html">$new</a>;
<a name="l441"><span class="linenum"> 441</span></a>      }
<a name="l442"><span class="linenum"> 442</span></a>  
<a name="l443"><span class="linenum"> 443</span></a>      <span class="comment">/**</span>
<a name="l444"><span class="linenum"> 444</span></a>  <span class="comment">     * Options for displaying the guide description field in the form</span>
<a name="l445"><span class="linenum"> 445</span></a>  <span class="comment">     *</span>
<a name="l446"><span class="linenum"> 446</span></a>  <span class="comment">     * @param context $context</span>
<a name="l447"><span class="linenum"> 447</span></a>  <span class="comment">     * @return array options for the form description field</span>
<a name="l448"><span class="linenum"> 448</span></a>  <span class="comment">     */</span>
<a name="l449"><span class="linenum"> 449</span></a>      public static function <a class="function" onClick="logFunction('description_form_field_options')" href="../../../../_functions/description_form_field_options.html" onMouseOver="funcPopup(event,'description_form_field_options')">description_form_field_options</a>(<a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../../_variables/context.html">$context</a>) {
<a name="l450"><span class="linenum"> 450</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../../_variables/CFG.html">$CFG</a>;
<a name="l451"><span class="linenum"> 451</span></a>          return array(
<a name="l452"><span class="linenum"> 452</span></a>              'maxfiles' =&gt; -1,
<a name="l453"><span class="linenum"> 453</span></a>              'maxbytes' =&gt; <a class="function" onClick="logFunction('get_max_upload_file_size')" href="../../../../_functions/get_max_upload_file_size.html" onMouseOver="funcPopup(event,'get_max_upload_file_size')">get_max_upload_file_size</a>(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('maxbytes')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../../../_variables/maxbytes.html">maxbytes</a>),
<a name="l454"><span class="linenum"> 454</span></a>              'context'  =&gt; <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../../_variables/context.html">$context</a>,
<a name="l455"><span class="linenum"> 455</span></a>          );
<a name="l456"><span class="linenum"> 456</span></a>      }
<a name="l457"><span class="linenum"> 457</span></a>  
<a name="l458"><span class="linenum"> 458</span></a>      <span class="comment">/**</span>
<a name="l459"><span class="linenum"> 459</span></a>  <span class="comment">     * Formats the definition description for display on page</span>
<a name="l460"><span class="linenum"> 460</span></a>  <span class="comment">     *</span>
<a name="l461"><span class="linenum"> 461</span></a>  <span class="comment">     * @return string</span>
<a name="l462"><span class="linenum"> 462</span></a>  <span class="comment">     */</span>
<a name="l463"><span class="linenum"> 463</span></a>      public function <a class="function" onClick="logFunction('get_formatted_description')" href="../../../../_functions/get_formatted_description.html" onMouseOver="funcPopup(event,'get_formatted_description')">get_formatted_description</a>() {
<a name="l464"><span class="linenum"> 464</span></a>          if (!isset(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;description)) {
<a name="l465"><span class="linenum"> 465</span></a>              return '';
<a name="l466"><span class="linenum"> 466</span></a>          }
<a name="l467"><span class="linenum"> 467</span></a>          <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../../_variables/context.html">$context</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_context')" href="../../../../_functions/get_context.html" onMouseOver="funcPopup(event,'get_context')">get_context</a>();
<a name="l468"><span class="linenum"> 468</span></a>  
<a name="l469"><span class="linenum"> 469</span></a>          <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../../_variables/options.html">$options</a> = self::<a class="function" onClick="logFunction('description_form_field_options')" href="../../../../_functions/description_form_field_options.html" onMouseOver="funcPopup(event,'description_form_field_options')">description_form_field_options</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_context')" href="../../../../_functions/get_context.html" onMouseOver="funcPopup(event,'get_context')">get_context</a>());
<a name="l470"><span class="linenum"> 470</span></a>          <a class="var it507" onMouseOver="hilite(507)" onMouseOut="lolite()" onClick="logVariable('description')" href="../../../../_variables/description.html">$description</a> = <a class="function" onClick="logFunction('file_rewrite_pluginfile_urls')" href="../../../../_functions/file_rewrite_pluginfile_urls.html" onMouseOver="funcPopup(event,'file_rewrite_pluginfile_urls')">file_rewrite_pluginfile_urls</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;description, '<a class="filename" href="../../../../pluginfile.php.html">pluginfile.php</a>', <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it39491" onMouseOver="hilite(39491)" onMouseOut="lolite()" href="../../../../_variables/id.html">id</a>,
<a name="l471"><span class="linenum"> 471</span></a>              'grading', 'description', <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;id, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../../_variables/options.html">$options</a>);
<a name="l472"><span class="linenum"> 472</span></a>  
<a name="l473"><span class="linenum"> 473</span></a>          <a class="var it6026" onMouseOver="hilite(6026)" onMouseOut="lolite()" onClick="logVariable('formatoptions')" href="../../../../_variables/formatoptions.html">$formatoptions</a> = array(
<a name="l474"><span class="linenum"> 474</span></a>              'noclean' =&gt; false,
<a name="l475"><span class="linenum"> 475</span></a>              'trusted' =&gt; false,
<a name="l476"><span class="linenum"> 476</span></a>              'filter' =&gt; true,
<a name="l477"><span class="linenum"> 477</span></a>              'context' =&gt; <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../../_variables/context.html">$context</a>
<a name="l478"><span class="linenum"> 478</span></a>          );
<a name="l479"><span class="linenum"> 479</span></a>          return <a class="function" onClick="logFunction('format_text')" href="../../../../_functions/format_text.html" onMouseOver="funcPopup(event,'format_text')">format_text</a>(<a class="var it507" onMouseOver="hilite(507)" onMouseOut="lolite()" onClick="logVariable('description')" href="../../../../_variables/description.html">$description</a>, <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;descriptionformat, <a class="var it6026" onMouseOver="hilite(6026)" onMouseOut="lolite()" onClick="logVariable('formatoptions')" href="../../../../_variables/formatoptions.html">$formatoptions</a>);
<a name="l480"><span class="linenum"> 480</span></a>      }
<a name="l481"><span class="linenum"> 481</span></a>  
<a name="l482"><span class="linenum"> 482</span></a>      <span class="comment">/**</span>
<a name="l483"><span class="linenum"> 483</span></a>  <span class="comment">     * Returns the guide plugin renderer</span>
<a name="l484"><span class="linenum"> 484</span></a>  <span class="comment">     *</span>
<a name="l485"><span class="linenum"> 485</span></a>  <span class="comment">     * @param moodle_page $page the target page</span>
<a name="l486"><span class="linenum"> 486</span></a>  <span class="comment">     * @return gradingform_guide_renderer</span>
<a name="l487"><span class="linenum"> 487</span></a>  <span class="comment">     */</span>
<a name="l488"><span class="linenum"> 488</span></a>      public function <a class="function" onClick="logFunction('get_renderer')" href="../../../../_functions/get_renderer.html" onMouseOver="funcPopup(event,'get_renderer')">get_renderer</a>(moodle_page <a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../../../_variables/page.html">$page</a>) {
<a name="l489"><span class="linenum"> 489</span></a>          return <a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../../../_variables/page.html">$page</a>-&gt;<a class="function" onClick="logFunction('get_renderer')" href="../../../../_functions/get_renderer.html" onMouseOver="funcPopup(event,'get_renderer')">get_renderer</a>('gradingform_'. <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_method_name')" href="../../../../_functions/get_method_name.html" onMouseOver="funcPopup(event,'get_method_name')">get_method_name</a>());
<a name="l490"><span class="linenum"> 490</span></a>      }
<a name="l491"><span class="linenum"> 491</span></a>  
<a name="l492"><span class="linenum"> 492</span></a>      <span class="comment">/**</span>
<a name="l493"><span class="linenum"> 493</span></a>  <span class="comment">     * Returns the HTML code displaying the preview of the grading form</span>
<a name="l494"><span class="linenum"> 494</span></a>  <span class="comment">     *</span>
<a name="l495"><span class="linenum"> 495</span></a>  <span class="comment">     * @param moodle_page $page the target page</span>
<a name="l496"><span class="linenum"> 496</span></a>  <span class="comment">     * @return string</span>
<a name="l497"><span class="linenum"> 497</span></a>  <span class="comment">     */</span>
<a name="l498"><span class="linenum"> 498</span></a>      public function <a class="function" onClick="logFunction('render_preview')" href="../../../../_functions/render_preview.html" onMouseOver="funcPopup(event,'render_preview')">render_preview</a>(moodle_page <a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../../../_variables/page.html">$page</a>) {
<a name="l499"><span class="linenum"> 499</span></a>  
<a name="l500"><span class="linenum"> 500</span></a>          if (!<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_form_defined')" href="../../../../_functions/is_form_defined.html" onMouseOver="funcPopup(event,'is_form_defined')">is_form_defined</a>()) {
<a name="l501"><span class="linenum"> 501</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../../../../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('It is the caller\'s responsibility to make sure that the form is actually defined');
<a name="l502"><span class="linenum"> 502</span></a>          }
<a name="l503"><span class="linenum"> 503</span></a>  
<a name="l504"><span class="linenum"> 504</span></a>  <span class="comment">        // Check if current user is able to see preview</span>
<a name="l505"><span class="linenum"> 505</span></a>          <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../../_variables/options.html">$options</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_options')" href="../../../../_functions/get_options.html" onMouseOver="funcPopup(event,'get_options')">get_options</a>();
<a name="l506"><span class="linenum"> 506</span></a>          if (empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../../_variables/options.html">$options</a>['alwaysshowdefinition']) &amp;&amp; !<a class="function" onClick="logFunction('has_capability')" href="../../../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/grade:managegradingforms', <a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../../../_variables/page.html">$page</a>-&gt;<a onClick="logVariable('context')" class="var it39576" onMouseOver="hilite(39576)" onMouseOut="lolite()" href="../../../../_variables/context.html">context</a>))  {
<a name="l507"><span class="linenum"> 507</span></a>              return '';
<a name="l508"><span class="linenum"> 508</span></a>          }
<a name="l509"><span class="linenum"> 509</span></a>  
<a name="l510"><span class="linenum"> 510</span></a>          <a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../../../_variables/criteria.html">$criteria</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;guide_criteria;
<a name="l511"><span class="linenum"> 511</span></a>          <a class="var it3670" onMouseOver="hilite(3670)" onMouseOut="lolite()" onClick="logVariable('comments')" href="../../../../_variables/comments.html">$comments</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;guide_comments;
<a name="l512"><span class="linenum"> 512</span></a>          <a class="var it71" onMouseOver="hilite(71)" onMouseOut="lolite()" onClick="logVariable('output')" href="../../../../_variables/output.html">$output</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_renderer')" href="../../../../_functions/get_renderer.html" onMouseOver="funcPopup(event,'get_renderer')">get_renderer</a>(<a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../../../_variables/page.html">$page</a>);
<a name="l513"><span class="linenum"> 513</span></a>  
<a name="l514"><span class="linenum"> 514</span></a>          <a class="var it5007" onMouseOver="hilite(5007)" onMouseOut="lolite()" onClick="logVariable('guide')" href="../../../../_variables/guide.html">$guide</a> = '';
<a name="l515"><span class="linenum"> 515</span></a>          <a class="var it5007" onMouseOver="hilite(5007)" onMouseOut="lolite()" onClick="logVariable('guide')" href="../../../../_variables/guide.html">$guide</a> .= <a class="var it71" onMouseOver="hilite(71)" onMouseOut="lolite()" onClick="logVariable('output')" href="../../../../_variables/output.html">$output</a>-&gt;<a class="function" onClick="logFunction('box')" href="../../../../_functions/box.html" onMouseOver="funcPopup(event,'box')">box</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_formatted_description')" href="../../../../_functions/get_formatted_description.html" onMouseOver="funcPopup(event,'get_formatted_description')">get_formatted_description</a>(), 'gradingform_guide-description');
<a name="l516"><span class="linenum"> 516</span></a>          if (<a class="function" onClick="logFunction('has_capability')" href="../../../../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/grade:managegradingforms', <a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../../../_variables/page.html">$page</a>-&gt;<a onClick="logVariable('context')" class="var it39576" onMouseOver="hilite(39576)" onMouseOut="lolite()" href="../../../../_variables/context.html">context</a>)) {
<a name="l517"><span class="linenum"> 517</span></a>              <a class="var it5007" onMouseOver="hilite(5007)" onMouseOut="lolite()" onClick="logVariable('guide')" href="../../../../_variables/guide.html">$guide</a> .= <a class="var it71" onMouseOver="hilite(71)" onMouseOut="lolite()" onClick="logVariable('output')" href="../../../../_variables/output.html">$output</a>-&gt;<a class="function" onClick="logFunction('display_guide_mapping_explained')" href="../../../../_functions/display_guide_mapping_explained.html" onMouseOver="funcPopup(event,'display_guide_mapping_explained')">display_guide_mapping_explained</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_min_max_score')" href="../../../../_functions/get_min_max_score.html" onMouseOver="funcPopup(event,'get_min_max_score')">get_min_max_score</a>());
<a name="l518"><span class="linenum"> 518</span></a>              <a class="var it5007" onMouseOver="hilite(5007)" onMouseOut="lolite()" onClick="logVariable('guide')" href="../../../../_variables/guide.html">$guide</a> .= <a class="var it71" onMouseOver="hilite(71)" onMouseOut="lolite()" onClick="logVariable('output')" href="../../../../_variables/output.html">$output</a>-&gt;<a class="function" onClick="logFunction('display_guide')" href="../../../../_functions/display_guide.html" onMouseOver="funcPopup(event,'display_guide')">display_guide</a>(<a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../../../_variables/criteria.html">$criteria</a>, <a class="var it3670" onMouseOver="hilite(3670)" onMouseOut="lolite()" onClick="logVariable('comments')" href="../../../../_variables/comments.html">$comments</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../../_variables/options.html">$options</a>, self::DISPLAY_PREVIEW, 'guide');
<a name="l519"><span class="linenum"> 519</span></a>          } else {
<a name="l520"><span class="linenum"> 520</span></a>              <a class="var it5007" onMouseOver="hilite(5007)" onMouseOut="lolite()" onClick="logVariable('guide')" href="../../../../_variables/guide.html">$guide</a> .= <a class="var it71" onMouseOver="hilite(71)" onMouseOut="lolite()" onClick="logVariable('output')" href="../../../../_variables/output.html">$output</a>-&gt;<a class="function" onClick="logFunction('display_guide')" href="../../../../_functions/display_guide.html" onMouseOver="funcPopup(event,'display_guide')">display_guide</a>(<a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../../../_variables/criteria.html">$criteria</a>, <a class="var it3670" onMouseOver="hilite(3670)" onMouseOut="lolite()" onClick="logVariable('comments')" href="../../../../_variables/comments.html">$comments</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../../_variables/options.html">$options</a>, self::DISPLAY_PREVIEW_GRADED, 'guide');
<a name="l521"><span class="linenum"> 521</span></a>          }
<a name="l522"><span class="linenum"> 522</span></a>  
<a name="l523"><span class="linenum"> 523</span></a>          return <a class="var it5007" onMouseOver="hilite(5007)" onMouseOut="lolite()" onClick="logVariable('guide')" href="../../../../_variables/guide.html">$guide</a>;
<a name="l524"><span class="linenum"> 524</span></a>      }
<a name="l525"><span class="linenum"> 525</span></a>  
<a name="l526"><span class="linenum"> 526</span></a>      <span class="comment">/**</span>
<a name="l527"><span class="linenum"> 527</span></a>  <span class="comment">     * Deletes the guide definition and all the associated information</span>
<a name="l528"><span class="linenum"> 528</span></a>  <span class="comment">     */</span>
<a name="l529"><span class="linenum"> 529</span></a>      protected function <a class="function" onClick="logFunction('delete_plugin_definition')" href="../../../../_functions/delete_plugin_definition.html" onMouseOver="funcPopup(event,'delete_plugin_definition')">delete_plugin_definition</a>() {
<a name="l530"><span class="linenum"> 530</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>;
<a name="l531"><span class="linenum"> 531</span></a>  
<a name="l532"><span class="linenum"> 532</span></a>  <span class="comment">        // Get the list of instances.</span>
<a name="l533"><span class="linenum"> 533</span></a>          <a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('instances')" href="../../../../_variables/instances.html">$instances</a> = <a class="phpfunction" onClick="logFunction('array_keys')" href="../../../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('grading_instances', array('definitionid' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;id), '', 'id'));
<a name="l534"><span class="linenum"> 534</span></a>  <span class="comment">        // Delete all fillings.</span>
<a name="l535"><span class="linenum"> 535</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records_list')" href="../../../../_functions/delete_records_list.html" onMouseOver="funcPopup(event,'delete_records_list')">delete_records_list</a>('gradingform_guide_fillings', 'instanceid', <a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('instances')" href="../../../../_variables/instances.html">$instances</a>);
<a name="l536"><span class="linenum"> 536</span></a>  <span class="comment">        // Delete instances.</span>
<a name="l537"><span class="linenum"> 537</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records_list')" href="../../../../_functions/delete_records_list.html" onMouseOver="funcPopup(event,'delete_records_list')">delete_records_list</a>('grading_instances', 'id', <a class="var it1238" onMouseOver="hilite(1238)" onMouseOut="lolite()" onClick="logVariable('instances')" href="../../../../_variables/instances.html">$instances</a>);
<a name="l538"><span class="linenum"> 538</span></a>  <span class="comment">        // Get the list of criteria records.</span>
<a name="l539"><span class="linenum"> 539</span></a>          <a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../../../_variables/criteria.html">$criteria</a> = <a class="phpfunction" onClick="logFunction('array_keys')" href="../../../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('gradingform_guide_criteria',
<a name="l540"><span class="linenum"> 540</span></a>              array('definitionid' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;id), '', 'id'));
<a name="l541"><span class="linenum"> 541</span></a>  <span class="comment">        // Delete critera.</span>
<a name="l542"><span class="linenum"> 542</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records_list')" href="../../../../_functions/delete_records_list.html" onMouseOver="funcPopup(event,'delete_records_list')">delete_records_list</a>('gradingform_guide_criteria', 'id', <a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../../../_variables/criteria.html">$criteria</a>);
<a name="l543"><span class="linenum"> 543</span></a>  <span class="comment">        // Delete comments.</span>
<a name="l544"><span class="linenum"> 544</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('gradingform_guide_comments', array('definitionid' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;id));
<a name="l545"><span class="linenum"> 545</span></a>      }
<a name="l546"><span class="linenum"> 546</span></a>  
<a name="l547"><span class="linenum"> 547</span></a>      <span class="comment">/**</span>
<a name="l548"><span class="linenum"> 548</span></a>  <span class="comment">     * If instanceid is specified and grading instance exists and it is created by this rater for</span>
<a name="l549"><span class="linenum"> 549</span></a>  <span class="comment">     * this item, this instance is returned.</span>
<a name="l550"><span class="linenum"> 550</span></a>  <span class="comment">     * If there exists a draft for this raterid+itemid, take this draft (this is the change from parent)</span>
<a name="l551"><span class="linenum"> 551</span></a>  <span class="comment">     * Otherwise new instance is created for the specified rater and itemid</span>
<a name="l552"><span class="linenum"> 552</span></a>  <span class="comment">     *</span>
<a name="l553"><span class="linenum"> 553</span></a>  <span class="comment">     * @param int $instanceid</span>
<a name="l554"><span class="linenum"> 554</span></a>  <span class="comment">     * @param int $raterid</span>
<a name="l555"><span class="linenum"> 555</span></a>  <span class="comment">     * @param int $itemid</span>
<a name="l556"><span class="linenum"> 556</span></a>  <span class="comment">     * @return gradingform_instance</span>
<a name="l557"><span class="linenum"> 557</span></a>  <span class="comment">     */</span>
<a name="l558"><span class="linenum"> 558</span></a>      public function <a class="function" onClick="logFunction('get_or_create_instance')" href="../../../../_functions/get_or_create_instance.html" onMouseOver="funcPopup(event,'get_or_create_instance')">get_or_create_instance</a>(<a class="var it1622" onMouseOver="hilite(1622)" onMouseOut="lolite()" onClick="logVariable('instanceid')" href="../../../../_variables/instanceid.html">$instanceid</a>, <a class="var it5801" onMouseOver="hilite(5801)" onMouseOut="lolite()" onClick="logVariable('raterid')" href="../../../../_variables/raterid.html">$raterid</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../../../_variables/itemid.html">$itemid</a>) {
<a name="l559"><span class="linenum"> 559</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>;
<a name="l560"><span class="linenum"> 560</span></a>          if (<a class="var it1622" onMouseOver="hilite(1622)" onMouseOut="lolite()" onClick="logVariable('instanceid')" href="../../../../_variables/instanceid.html">$instanceid</a> &amp;&amp;
<a name="l561"><span class="linenum"> 561</span></a>                  <a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../../../_variables/instance.html">$instance</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('grading_instances',
<a name="l562"><span class="linenum"> 562</span></a>                      array('id'  =&gt; <a class="var it1622" onMouseOver="hilite(1622)" onMouseOut="lolite()" onClick="logVariable('instanceid')" href="../../../../_variables/instanceid.html">$instanceid</a>, 'raterid' =&gt; <a class="var it5801" onMouseOver="hilite(5801)" onMouseOut="lolite()" onClick="logVariable('raterid')" href="../../../../_variables/raterid.html">$raterid</a>, 'itemid' =&gt; <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../../../_variables/itemid.html">$itemid</a>), '*', <a class="constant" onClick="logConstant('IGNORE_MISSING')" href="../../../../_constants/IGNORE_MISSING.html" onMouseOver="constPopup(event,'IGNORE_MISSING')">IGNORE_MISSING</a>)) {
<a name="l563"><span class="linenum"> 563</span></a>              return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_instance')" href="../../../../_functions/get_instance.html" onMouseOver="funcPopup(event,'get_instance')">get_instance</a>(<a class="var it528" onMouseOver="hilite(528)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../../../_variables/instance.html">$instance</a>);
<a name="l564"><span class="linenum"> 564</span></a>          }
<a name="l565"><span class="linenum"> 565</span></a>          if (<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../../../_variables/itemid.html">$itemid</a> &amp;&amp; <a class="var it5801" onMouseOver="hilite(5801)" onMouseOut="lolite()" onClick="logVariable('raterid')" href="../../../../_variables/raterid.html">$raterid</a>) {
<a name="l566"><span class="linenum"> 566</span></a>              <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../../_variables/params.html">$params</a> = array('definitionid' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('definition')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/definition.html">definition</a>-&gt;id, 'raterid' =&gt; <a class="var it5801" onMouseOver="hilite(5801)" onMouseOut="lolite()" onClick="logVariable('raterid')" href="../../../../_variables/raterid.html">$raterid</a>, 'itemid' =&gt; <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../../../_variables/itemid.html">$itemid</a>);
<a name="l567"><span class="linenum"> 567</span></a>              if (<a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../../_variables/rs.html">$rs</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('grading_instances', <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../../_variables/params.html">$params</a>, 'timemodified DESC', '*', 0, 1)) {
<a name="l568"><span class="linenum"> 568</span></a>                  <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../../../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it519" onMouseOver="hilite(519)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../../../_variables/rs.html">$rs</a>);
<a name="l569"><span class="linenum"> 569</span></a>                  <a class="var it33653" onMouseOver="hilite(33653)" onMouseOut="lolite()" onClick="logVariable('currentinstance')" href="../../../../_variables/currentinstance.html">$currentinstance</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_current_instance')" href="../../../../_functions/get_current_instance.html" onMouseOver="funcPopup(event,'get_current_instance')">get_current_instance</a>(<a class="var it5801" onMouseOver="hilite(5801)" onMouseOut="lolite()" onClick="logVariable('raterid')" href="../../../../_variables/raterid.html">$raterid</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../../../_variables/itemid.html">$itemid</a>);
<a name="l570"><span class="linenum"> 570</span></a>                  if (<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('status')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../../_variables/status.html">status</a> == <a class="class" onClick="logClass('gradingform_guide_instance')" href="../../../../_classes/gradingform_guide_instance.html" onMouseOver="classPopup(event,'gradingform_guide_instance')">gradingform_guide_instance</a>::INSTANCE_STATUS_INCOMPLETE &amp;&amp;
<a name="l571"><span class="linenum"> 571</span></a>                          (!<a class="var it33653" onMouseOver="hilite(33653)" onMouseOut="lolite()" onClick="logVariable('currentinstance')" href="../../../../_variables/currentinstance.html">$currentinstance</a> || <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('timemodified')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../../_variables/timemodified.html">timemodified</a> &gt; <a class="var it33653" onMouseOver="hilite(33653)" onMouseOut="lolite()" onClick="logVariable('currentinstance')" href="../../../../_variables/currentinstance.html">$currentinstance</a>-&gt;<a class="function" onClick="logFunction('get_data')" href="../../../../_functions/get_data.html" onMouseOver="funcPopup(event,'get_data')">get_data</a>('timemodified'))) {
<a name="l572"><span class="linenum"> 572</span></a>                      <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('isrestored')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../../_variables/isrestored.html">isrestored</a> = true;
<a name="l573"><span class="linenum"> 573</span></a>                      return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_instance')" href="../../../../_functions/get_instance.html" onMouseOver="funcPopup(event,'get_instance')">get_instance</a>(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>);
<a name="l574"><span class="linenum"> 574</span></a>                  }
<a name="l575"><span class="linenum"> 575</span></a>              }
<a name="l576"><span class="linenum"> 576</span></a>          }
<a name="l577"><span class="linenum"> 577</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('create_instance')" href="../../../../_functions/create_instance.html" onMouseOver="funcPopup(event,'create_instance')">create_instance</a>(<a class="var it5801" onMouseOver="hilite(5801)" onMouseOut="lolite()" onClick="logVariable('raterid')" href="../../../../_variables/raterid.html">$raterid</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../../../_variables/itemid.html">$itemid</a>);
<a name="l578"><span class="linenum"> 578</span></a>      }
<a name="l579"><span class="linenum"> 579</span></a>  
<a name="l580"><span class="linenum"> 580</span></a>      <span class="comment">/**</span>
<a name="l581"><span class="linenum"> 581</span></a>  <span class="comment">     * Returns html code to be included in student's feedback.</span>
<a name="l582"><span class="linenum"> 582</span></a>  <span class="comment">     *</span>
<a name="l583"><span class="linenum"> 583</span></a>  <span class="comment">     * @param moodle_page $page</span>
<a name="l584"><span class="linenum"> 584</span></a>  <span class="comment">     * @param int $itemid</span>
<a name="l585"><span class="linenum"> 585</span></a>  <span class="comment">     * @param array $gradinginfo result of function grade_get_grades</span>
<a name="l586"><span class="linenum"> 586</span></a>  <span class="comment">     * @param string $defaultcontent default string to be returned if no active grading is found</span>
<a name="l587"><span class="linenum"> 587</span></a>  <span class="comment">     * @param bool $cangrade whether current user has capability to grade in this context</span>
<a name="l588"><span class="linenum"> 588</span></a>  <span class="comment">     * @return string</span>
<a name="l589"><span class="linenum"> 589</span></a>  <span class="comment">     */</span>
<a name="l590"><span class="linenum"> 590</span></a>      public function <a class="function" onClick="logFunction('render_grade')" href="../../../../_functions/render_grade.html" onMouseOver="funcPopup(event,'render_grade')">render_grade</a>(<a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../../../_variables/page.html">$page</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../../../_variables/itemid.html">$itemid</a>, <a class="var it5807" onMouseOver="hilite(5807)" onMouseOut="lolite()" onClick="logVariable('gradinginfo')" href="../../../../_variables/gradinginfo.html">$gradinginfo</a>, <a class="var it5808" onMouseOver="hilite(5808)" onMouseOut="lolite()" onClick="logVariable('defaultcontent')" href="../../../../_variables/defaultcontent.html">$defaultcontent</a>, <a class="var it5809" onMouseOver="hilite(5809)" onMouseOut="lolite()" onClick="logVariable('cangrade')" href="../../../../_variables/cangrade.html">$cangrade</a>) {
<a name="l591"><span class="linenum"> 591</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_renderer')" href="../../../../_functions/get_renderer.html" onMouseOver="funcPopup(event,'get_renderer')">get_renderer</a>(<a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../../../_variables/page.html">$page</a>)-&gt;<a class="function" onClick="logFunction('display_instances')" href="../../../../_functions/display_instances.html" onMouseOver="funcPopup(event,'display_instances')">display_instances</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_active_instances')" href="../../../../_functions/get_active_instances.html" onMouseOver="funcPopup(event,'get_active_instances')">get_active_instances</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../../../_variables/itemid.html">$itemid</a>), <a class="var it5808" onMouseOver="hilite(5808)" onMouseOut="lolite()" onClick="logVariable('defaultcontent')" href="../../../../_variables/defaultcontent.html">$defaultcontent</a>, <a class="var it5809" onMouseOver="hilite(5809)" onMouseOut="lolite()" onClick="logVariable('cangrade')" href="../../../../_variables/cangrade.html">$cangrade</a>);
<a name="l592"><span class="linenum"> 592</span></a>      }
<a name="l593"><span class="linenum"> 593</span></a>  
<a name="l594"><span class="linenum"> 594</span></a>  <span class="comment">    // Full-text search support.</span>
<a name="l595"><span class="linenum"> 595</span></a>  
<a name="l596"><span class="linenum"> 596</span></a>      <span class="comment">/**</span>
<a name="l597"><span class="linenum"> 597</span></a>  <span class="comment">     * Prepare the part of the search query to append to the FROM statement</span>
<a name="l598"><span class="linenum"> 598</span></a>  <span class="comment">     *</span>
<a name="l599"><span class="linenum"> 599</span></a>  <span class="comment">     * @param string $gdid the alias of grading_definitions.id column used by the caller</span>
<a name="l600"><span class="linenum"> 600</span></a>  <span class="comment">     * @return string</span>
<a name="l601"><span class="linenum"> 601</span></a>  <span class="comment">     */</span>
<a name="l602"><span class="linenum"> 602</span></a>      public static function <a class="function" onClick="logFunction('sql_search_from_tables')" href="../../../../_functions/sql_search_from_tables.html" onMouseOver="funcPopup(event,'sql_search_from_tables')">sql_search_from_tables</a>(<a class="var it5805" onMouseOver="hilite(5805)" onMouseOut="lolite()" onClick="logVariable('gdid')" href="../../../../_variables/gdid.html">$gdid</a>) {
<a name="l603"><span class="linenum"> 603</span></a>          return &quot; LEFT JOIN {gradingform_guide_criteria} gc <a class="function" onClick="logFunction('ON')" href="../../../../_functions/on.html" onMouseOver="funcPopup(event,'on')">ON</a> (gc.definitionid = <a class="var it5805" onMouseOver="hilite(5805)" onMouseOut="lolite()" onClick="logVariable('gdid')" href="../../../../_variables/gdid.html">$gdid</a>)&quot;;
<a name="l604"><span class="linenum"> 604</span></a>      }
<a name="l605"><span class="linenum"> 605</span></a>  
<a name="l606"><span class="linenum"> 606</span></a>      <span class="comment">/**</span>
<a name="l607"><span class="linenum"> 607</span></a>  <span class="comment">     * Prepare the parts of the SQL WHERE statement to search for the given token</span>
<a name="l608"><span class="linenum"> 608</span></a>  <span class="comment">     *</span>
<a name="l609"><span class="linenum"> 609</span></a>  <span class="comment">     * The returned array cosists of the list of SQL comparions and the list of</span>
<a name="l610"><span class="linenum"> 610</span></a>  <span class="comment">     * respective parameters for the comparisons. The returned chunks will be joined</span>
<a name="l611"><span class="linenum"> 611</span></a>  <span class="comment">     * with other conditions using the OR operator.</span>
<a name="l612"><span class="linenum"> 612</span></a>  <span class="comment">     *</span>
<a name="l613"><span class="linenum"> 613</span></a>  <span class="comment">     * @param string $token token to search for</span>
<a name="l614"><span class="linenum"> 614</span></a>  <span class="comment">     * @return array An array containing two more arrays</span>
<a name="l615"><span class="linenum"> 615</span></a>  <span class="comment">     *     Array of search SQL fragments</span>
<a name="l616"><span class="linenum"> 616</span></a>  <span class="comment">     *     Array of params for the search fragments</span>
<a name="l617"><span class="linenum"> 617</span></a>  <span class="comment">     */</span>
<a name="l618"><span class="linenum"> 618</span></a>      public static function <a class="function" onClick="logFunction('sql_search_where')" href="../../../../_functions/sql_search_where.html" onMouseOver="funcPopup(event,'sql_search_where')">sql_search_where</a>(<a class="var it464" onMouseOver="hilite(464)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../../../_variables/token.html">$token</a>) {
<a name="l619"><span class="linenum"> 619</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>;
<a name="l620"><span class="linenum"> 620</span></a>  
<a name="l621"><span class="linenum"> 621</span></a>          <a class="var it5806" onMouseOver="hilite(5806)" onMouseOut="lolite()" onClick="logVariable('subsql')" href="../../../../_variables/subsql.html">$subsql</a> = array();
<a name="l622"><span class="linenum"> 622</span></a>          <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../../_variables/params.html">$params</a> = array();
<a name="l623"><span class="linenum"> 623</span></a>  
<a name="l624"><span class="linenum"> 624</span></a>  <span class="comment">        // Search in guide criteria description.</span>
<a name="l625"><span class="linenum"> 625</span></a>          <a class="var it5806" onMouseOver="hilite(5806)" onMouseOut="lolite()" onClick="logVariable('subsql')" href="../../../../_variables/subsql.html">$subsql</a>[] = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_like')" href="../../../../_functions/sql_like.html" onMouseOver="funcPopup(event,'sql_like')">sql_like</a>('gc.description', '?', false, false);
<a name="l626"><span class="linenum"> 626</span></a>          <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../../_variables/params.html">$params</a>[] = '%'.<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_like_escape')" href="../../../../_functions/sql_like_escape.html" onMouseOver="funcPopup(event,'sql_like_escape')">sql_like_escape</a>(<a class="var it464" onMouseOver="hilite(464)" onMouseOut="lolite()" onClick="logVariable('token')" href="../../../../_variables/token.html">$token</a>).'%';
<a name="l627"><span class="linenum"> 627</span></a>  
<a name="l628"><span class="linenum"> 628</span></a>          return array(<a class="var it5806" onMouseOver="hilite(5806)" onMouseOut="lolite()" onClick="logVariable('subsql')" href="../../../../_variables/subsql.html">$subsql</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../../_variables/params.html">$params</a>);
<a name="l629"><span class="linenum"> 629</span></a>      }
<a name="l630"><span class="linenum"> 630</span></a>  
<a name="l631"><span class="linenum"> 631</span></a>      <span class="comment">/**</span>
<a name="l632"><span class="linenum"> 632</span></a>  <span class="comment">     * Calculates and returns the possible minimum and maximum score (in points) for this guide</span>
<a name="l633"><span class="linenum"> 633</span></a>  <span class="comment">     *</span>
<a name="l634"><span class="linenum"> 634</span></a>  <span class="comment">     * @return array</span>
<a name="l635"><span class="linenum"> 635</span></a>  <span class="comment">     */</span>
<a name="l636"><span class="linenum"> 636</span></a>      public function <a class="function" onClick="logFunction('get_min_max_score')" href="../../../../_functions/get_min_max_score.html" onMouseOver="funcPopup(event,'get_min_max_score')">get_min_max_score</a>() {
<a name="l637"><span class="linenum"> 637</span></a>          if (!<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_form_available')" href="../../../../_functions/is_form_available.html" onMouseOver="funcPopup(event,'is_form_available')">is_form_available</a>()) {
<a name="l638"><span class="linenum"> 638</span></a>              return null;
<a name="l639"><span class="linenum"> 639</span></a>          }
<a name="l640"><span class="linenum"> 640</span></a>          <a class="var it33655" onMouseOver="hilite(33655)" onMouseOut="lolite()" onClick="logVariable('returnvalue')" href="../../../../_variables/returnvalue.html">$returnvalue</a> = array('minscore' =&gt; 0, 'maxscore' =&gt; 0);
<a name="l641"><span class="linenum"> 641</span></a>          <a class="var it9763" onMouseOver="hilite(9763)" onMouseOut="lolite()" onClick="logVariable('maxscore')" href="../../../../_variables/maxscore.html">$maxscore</a> = 0;
<a name="l642"><span class="linenum"> 642</span></a>          foreach (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_definition')" href="../../../../_functions/get_definition.html" onMouseOver="funcPopup(event,'get_definition')">get_definition</a>()-&gt;guide_criteria as <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a> =&gt; <a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('criterion')" href="../../../../_variables/criterion.html">$criterion</a>) {
<a name="l643"><span class="linenum"> 643</span></a>              <a class="var it9763" onMouseOver="hilite(9763)" onMouseOut="lolite()" onClick="logVariable('maxscore')" href="../../../../_variables/maxscore.html">$maxscore</a> += <a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('criterion')" href="../../../../_variables/criterion.html">$criterion</a>['maxscore'];
<a name="l644"><span class="linenum"> 644</span></a>          }
<a name="l645"><span class="linenum"> 645</span></a>          <a class="var it33655" onMouseOver="hilite(33655)" onMouseOut="lolite()" onClick="logVariable('returnvalue')" href="../../../../_variables/returnvalue.html">$returnvalue</a>['maxscore'] = <a class="var it9763" onMouseOver="hilite(9763)" onMouseOut="lolite()" onClick="logVariable('maxscore')" href="../../../../_variables/maxscore.html">$maxscore</a>;
<a name="l646"><span class="linenum"> 646</span></a>          <a class="var it33655" onMouseOver="hilite(33655)" onMouseOut="lolite()" onClick="logVariable('returnvalue')" href="../../../../_variables/returnvalue.html">$returnvalue</a>['minscore'] = 0;
<a name="l647"><span class="linenum"> 647</span></a>          if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('moduleinstance')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/moduleinstance.html">moduleinstance</a>-&gt;grade)) {
<a name="l648"><span class="linenum"> 648</span></a>              <a class="var it5794" onMouseOver="hilite(5794)" onMouseOut="lolite()" onClick="logVariable('graderange')" href="../../../../_variables/graderange.html">$graderange</a> = <a class="function" onClick="logFunction('make_grades_menu')" href="../../../../_functions/make_grades_menu.html" onMouseOver="funcPopup(event,'make_grades_menu')">make_grades_menu</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('moduleinstance')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/moduleinstance.html">moduleinstance</a>-&gt;grade);
<a name="l649"><span class="linenum"> 649</span></a>              <a class="var it33655" onMouseOver="hilite(33655)" onMouseOut="lolite()" onClick="logVariable('returnvalue')" href="../../../../_variables/returnvalue.html">$returnvalue</a>['modulegrade'] = <a class="phpfunction" onClick="logFunction('count')" href="../../../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it5794" onMouseOver="hilite(5794)" onMouseOut="lolite()" onClick="logVariable('graderange')" href="../../../../_variables/graderange.html">$graderange</a>) - 1;
<a name="l650"><span class="linenum"> 650</span></a>          }
<a name="l651"><span class="linenum"> 651</span></a>          return <a class="var it33655" onMouseOver="hilite(33655)" onMouseOut="lolite()" onClick="logVariable('returnvalue')" href="../../../../_variables/returnvalue.html">$returnvalue</a>;
<a name="l652"><span class="linenum"> 652</span></a>      }
<a name="l653"><span class="linenum"> 653</span></a>  
<a name="l654"><span class="linenum"> 654</span></a>      <span class="comment">/**</span>
<a name="l655"><span class="linenum"> 655</span></a>  <span class="comment">     * @return array An array containing 2 key/value pairs which hold the external_multiple_structure</span>
<a name="l656"><span class="linenum"> 656</span></a>  <span class="comment">     * for the 'guide_criteria' and the 'guide_comments'.</span>
<a name="l657"><span class="linenum"> 657</span></a>  <span class="comment">     * @see gradingform_controller::get_external_definition_details()</span>
<a name="l658"><span class="linenum"> 658</span></a>  <span class="comment">     * @since Moodle 2.5</span>
<a name="l659"><span class="linenum"> 659</span></a>  <span class="comment">     */</span>
<a name="l660"><span class="linenum"> 660</span></a>      public static function <a class="function" onClick="logFunction('get_external_definition_details')" href="../../../../_functions/get_external_definition_details.html" onMouseOver="funcPopup(event,'get_external_definition_details')">get_external_definition_details</a>() {
<a name="l661"><span class="linenum"> 661</span></a>          <a class="var it33639" onMouseOver="hilite(33639)" onMouseOut="lolite()" onClick="logVariable('guide_criteria')" href="../../../../_variables/guide_criteria.html">$guide_criteria</a> = <span class="keyword">new </span><a class="class" onClick="logClass('external_multiple_structure')" href="../../../../_classes/external_multiple_structure.html" onMouseOver="classPopup(event,'external_multiple_structure')">external_multiple_structure</a>(
<a name="l662"><span class="linenum"> 662</span></a>                                <span class="keyword">new </span><a class="class" onClick="logClass('external_single_structure')" href="../../../../_classes/external_single_structure.html" onMouseOver="classPopup(event,'external_single_structure')">external_single_structure</a>(
<a name="l663"><span class="linenum"> 663</span></a>                                    array(
<a name="l664"><span class="linenum"> 664</span></a>                                        'id'   =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../../../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'criterion id', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../../../../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l665"><span class="linenum"> 665</span></a>                                        'sortorder' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../../../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'sortorder', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../../../../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l666"><span class="linenum"> 666</span></a>                                        'description' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_RAW')" href="../../../../_constants/PARAM_RAW.html" onMouseOver="constPopup(event,'PARAM_RAW')">PARAM_RAW</a>, 'description', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../../../../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l667"><span class="linenum"> 667</span></a>                                        'descriptionformat' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_format_value')" href="../../../../_classes/external_format_value.html" onMouseOver="classPopup(event,'external_format_value')">external_format_value</a>('description', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../../../../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l668"><span class="linenum"> 668</span></a>                                        'shortname' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_TEXT')" href="../../../../_constants/PARAM_TEXT.html" onMouseOver="constPopup(event,'PARAM_TEXT')">PARAM_TEXT</a>, 'description'),
<a name="l669"><span class="linenum"> 669</span></a>                                        'descriptionmarkers' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_RAW')" href="../../../../_constants/PARAM_RAW.html" onMouseOver="constPopup(event,'PARAM_RAW')">PARAM_RAW</a>, 'markers description', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../../../../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l670"><span class="linenum"> 670</span></a>                                        'descriptionmarkersformat' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_format_value')" href="../../../../_classes/external_format_value.html" onMouseOver="classPopup(event,'external_format_value')">external_format_value</a>('descriptionmarkers', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../../../../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l671"><span class="linenum"> 671</span></a>                                        'maxscore' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_FLOAT')" href="../../../../_constants/PARAM_FLOAT.html" onMouseOver="constPopup(event,'PARAM_FLOAT')">PARAM_FLOAT</a>, 'maximum score')
<a name="l672"><span class="linenum"> 672</span></a>                                        )
<a name="l673"><span class="linenum"> 673</span></a>                                    )
<a name="l674"><span class="linenum"> 674</span></a>          );
<a name="l675"><span class="linenum"> 675</span></a>          <a class="var it33642" onMouseOver="hilite(33642)" onMouseOut="lolite()" onClick="logVariable('guide_comments')" href="../../../../_variables/guide_comments.html">$guide_comments</a> = <span class="keyword">new </span><a class="class" onClick="logClass('external_multiple_structure')" href="../../../../_classes/external_multiple_structure.html" onMouseOver="classPopup(event,'external_multiple_structure')">external_multiple_structure</a>(
<a name="l676"><span class="linenum"> 676</span></a>                                <span class="keyword">new </span><a class="class" onClick="logClass('external_single_structure')" href="../../../../_classes/external_single_structure.html" onMouseOver="classPopup(event,'external_single_structure')">external_single_structure</a>(
<a name="l677"><span class="linenum"> 677</span></a>                                    array(
<a name="l678"><span class="linenum"> 678</span></a>                                        'id'   =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../../../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'criterion id', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../../../../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l679"><span class="linenum"> 679</span></a>                                        'sortorder' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../../../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'sortorder', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../../../../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l680"><span class="linenum"> 680</span></a>                                        'description' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_RAW')" href="../../../../_constants/PARAM_RAW.html" onMouseOver="constPopup(event,'PARAM_RAW')">PARAM_RAW</a>, 'description', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../../../../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l681"><span class="linenum"> 681</span></a>                                        'descriptionformat' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_format_value')" href="../../../../_classes/external_format_value.html" onMouseOver="classPopup(event,'external_format_value')">external_format_value</a>('description', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../../../../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>)
<a name="l682"><span class="linenum"> 682</span></a>                                     )
<a name="l683"><span class="linenum"> 683</span></a>                                ), 'comments', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../../../../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>
<a name="l684"><span class="linenum"> 684</span></a>          );
<a name="l685"><span class="linenum"> 685</span></a>          return array('guide_criteria' =&gt; <a class="var it33639" onMouseOver="hilite(33639)" onMouseOut="lolite()" onClick="logVariable('guide_criteria')" href="../../../../_variables/guide_criteria.html">$guide_criteria</a>, 'guide_comments' =&gt; <a class="var it33642" onMouseOver="hilite(33642)" onMouseOut="lolite()" onClick="logVariable('guide_comments')" href="../../../../_variables/guide_comments.html">$guide_comments</a>);
<a name="l686"><span class="linenum"> 686</span></a>      }
<a name="l687"><span class="linenum"> 687</span></a>  
<a name="l688"><span class="linenum"> 688</span></a>      <span class="comment">/**</span>
<a name="l689"><span class="linenum"> 689</span></a>  <span class="comment">     * Returns an array that defines the structure of the guide's filling. This function is used by</span>
<a name="l690"><span class="linenum"> 690</span></a>  <span class="comment">     * the web service function core_grading_external::get_gradingform_instances().</span>
<a name="l691"><span class="linenum"> 691</span></a>  <span class="comment">     *</span>
<a name="l692"><span class="linenum"> 692</span></a>  <span class="comment">     * @return An array containing a single key/value pair with the 'criteria' external_multiple_structure</span>
<a name="l693"><span class="linenum"> 693</span></a>  <span class="comment">     * @see gradingform_controller::get_external_instance_filling_details()</span>
<a name="l694"><span class="linenum"> 694</span></a>  <span class="comment">     * @since Moodle 2.6</span>
<a name="l695"><span class="linenum"> 695</span></a>  <span class="comment">     */</span>
<a name="l696"><span class="linenum"> 696</span></a>      public static function <a class="function" onClick="logFunction('get_external_instance_filling_details')" href="../../../../_functions/get_external_instance_filling_details.html" onMouseOver="funcPopup(event,'get_external_instance_filling_details')">get_external_instance_filling_details</a>() {
<a name="l697"><span class="linenum"> 697</span></a>          <a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../../../_variables/criteria.html">$criteria</a> = <span class="keyword">new </span><a class="class" onClick="logClass('external_multiple_structure')" href="../../../../_classes/external_multiple_structure.html" onMouseOver="classPopup(event,'external_multiple_structure')">external_multiple_structure</a>(
<a name="l698"><span class="linenum"> 698</span></a>              <span class="keyword">new </span><a class="class" onClick="logClass('external_single_structure')" href="../../../../_classes/external_single_structure.html" onMouseOver="classPopup(event,'external_single_structure')">external_single_structure</a>(
<a name="l699"><span class="linenum"> 699</span></a>                  array(
<a name="l700"><span class="linenum"> 700</span></a>                      'id' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../../../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'filling id'),
<a name="l701"><span class="linenum"> 701</span></a>                      'criterionid' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../../../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'criterion id'),
<a name="l702"><span class="linenum"> 702</span></a>                      'levelid' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../../../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'level id', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../../../../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l703"><span class="linenum"> 703</span></a>                      'remark' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_RAW')" href="../../../../_constants/PARAM_RAW.html" onMouseOver="constPopup(event,'PARAM_RAW')">PARAM_RAW</a>, 'remark', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../../../../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l704"><span class="linenum"> 704</span></a>                      'remarkformat' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_format_value')" href="../../../../_classes/external_format_value.html" onMouseOver="classPopup(event,'external_format_value')">external_format_value</a>('remark', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../../../../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l705"><span class="linenum"> 705</span></a>                      'score' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_FLOAT')" href="../../../../_constants/PARAM_FLOAT.html" onMouseOver="constPopup(event,'PARAM_FLOAT')">PARAM_FLOAT</a>, 'maximum score')
<a name="l706"><span class="linenum"> 706</span></a>                  )
<a name="l707"><span class="linenum"> 707</span></a>              ), 'filling', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../../../../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>
<a name="l708"><span class="linenum"> 708</span></a>          );
<a name="l709"><span class="linenum"> 709</span></a>          return array ('criteria' =&gt; <a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../../../_variables/criteria.html">$criteria</a>);
<a name="l710"><span class="linenum"> 710</span></a>      }
<a name="l711"><span class="linenum"> 711</span></a>  
<a name="l712"><span class="linenum"> 712</span></a>  }
<a name="l713"><span class="linenum"> 713</span></a>  
<a name="l714"><span class="linenum"> 714</span></a>  <span class="comment">/**</span>
<a name="l715"><span class="linenum"> 715</span></a>  <span class="comment"> * Class to manage one guide grading instance. Stores information and performs actions like</span>
<a name="l716"><span class="linenum"> 716</span></a>  <span class="comment"> * update, copy, validate, submit, etc.</span>
<a name="l717"><span class="linenum"> 717</span></a>  <span class="comment"> *</span>
<a name="l718"><span class="linenum"> 718</span></a>  <span class="comment"> * @package    gradingform_guide</span>
<a name="l719"><span class="linenum"> 719</span></a>  <span class="comment"> * @copyright  2012 Dan Marsden &lt;dan@danmarsden.com&gt;</span>
<a name="l720"><span class="linenum"> 720</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l721"><span class="linenum"> 721</span></a>  <span class="comment"> */</span>
<a name="l722"><span class="linenum"> 722</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('gradingform_guide_instance')" href="../../../../_classes/gradingform_guide_instance.html" onMouseOver="classPopup(event,'gradingform_guide_instance')">gradingform_guide_instance</a> extends gradingform_instance {
<a name="l723"><span class="linenum"> 723</span></a>  
<a name="l724"><span class="linenum"> 724</span></a>  <span class="comment">    /** @var array */</span>
<a name="l725"><span class="linenum"> 725</span></a>      protected <a class="var it5007" onMouseOver="hilite(5007)" onMouseOut="lolite()" onClick="logVariable('guide')" href="../../../../_variables/guide.html">$guide</a>;
<a name="l726"><span class="linenum"> 726</span></a>  
<a name="l727"><span class="linenum"> 727</span></a>  <span class="comment">    /** @var array An array of validation errors */</span>
<a name="l728"><span class="linenum"> 728</span></a>      protected <a class="var it8498" onMouseOver="hilite(8498)" onMouseOut="lolite()" onClick="logVariable('validationerrors')" href="../../../../_variables/validationerrors.html">$validationerrors</a> = array();
<a name="l729"><span class="linenum"> 729</span></a>  
<a name="l730"><span class="linenum"> 730</span></a>      <span class="comment">/**</span>
<a name="l731"><span class="linenum"> 731</span></a>  <span class="comment">     * Deletes this (INCOMPLETE) instance from database.</span>
<a name="l732"><span class="linenum"> 732</span></a>  <span class="comment">     */</span>
<a name="l733"><span class="linenum"> 733</span></a>      public function <a class="function" onClick="logFunction('cancel')" href="../../../../_functions/cancel.html" onMouseOver="funcPopup(event,'cancel')">cancel</a>() {
<a name="l734"><span class="linenum"> 734</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>;
<a name="l735"><span class="linenum"> 735</span></a>          parent::<a class="function" onClick="logFunction('cancel')" href="../../../../_functions/cancel.html" onMouseOver="funcPopup(event,'cancel')">cancel</a>();
<a name="l736"><span class="linenum"> 736</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('gradingform_guide_fillings', array('instanceid' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_id')" href="../../../../_functions/get_id.html" onMouseOver="funcPopup(event,'get_id')">get_id</a>()));
<a name="l737"><span class="linenum"> 737</span></a>      }
<a name="l738"><span class="linenum"> 738</span></a>  
<a name="l739"><span class="linenum"> 739</span></a>      <span class="comment">/**</span>
<a name="l740"><span class="linenum"> 740</span></a>  <span class="comment">     * Duplicates the instance before editing (optionally substitutes raterid and/or itemid with</span>
<a name="l741"><span class="linenum"> 741</span></a>  <span class="comment">     * the specified values)</span>
<a name="l742"><span class="linenum"> 742</span></a>  <span class="comment">     *</span>
<a name="l743"><span class="linenum"> 743</span></a>  <span class="comment">     * @param int $raterid value for raterid in the duplicate</span>
<a name="l744"><span class="linenum"> 744</span></a>  <span class="comment">     * @param int $itemid value for itemid in the duplicate</span>
<a name="l745"><span class="linenum"> 745</span></a>  <span class="comment">     * @return int id of the new instance</span>
<a name="l746"><span class="linenum"> 746</span></a>  <span class="comment">     */</span>
<a name="l747"><span class="linenum"> 747</span></a>      public function <a class="function" onClick="logFunction('copy')" href="../../../../_functions/copy.html" onMouseOver="funcPopup(event,'copy')">copy</a>(<a class="var it5801" onMouseOver="hilite(5801)" onMouseOut="lolite()" onClick="logVariable('raterid')" href="../../../../_variables/raterid.html">$raterid</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../../../_variables/itemid.html">$itemid</a>) {
<a name="l748"><span class="linenum"> 748</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>;
<a name="l749"><span class="linenum"> 749</span></a>          <a class="var it1622" onMouseOver="hilite(1622)" onMouseOut="lolite()" onClick="logVariable('instanceid')" href="../../../../_variables/instanceid.html">$instanceid</a> = parent::<a class="phpfunction" onClick="logFunction('copy')" href="../../../../_functions/copy.html" onMouseOver="phpfuncPopup(event,'copy')">copy</a>(<a class="var it5801" onMouseOver="hilite(5801)" onMouseOut="lolite()" onClick="logVariable('raterid')" href="../../../../_variables/raterid.html">$raterid</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../../../_variables/itemid.html">$itemid</a>);
<a name="l750"><span class="linenum"> 750</span></a>          <a class="var it24088" onMouseOver="hilite(24088)" onMouseOut="lolite()" onClick="logVariable('currentgrade')" href="../../../../_variables/currentgrade.html">$currentgrade</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_guide_filling')" href="../../../../_functions/get_guide_filling.html" onMouseOver="funcPopup(event,'get_guide_filling')">get_guide_filling</a>();
<a name="l751"><span class="linenum"> 751</span></a>          foreach (<a class="var it24088" onMouseOver="hilite(24088)" onMouseOut="lolite()" onClick="logVariable('currentgrade')" href="../../../../_variables/currentgrade.html">$currentgrade</a>['criteria'] as <a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('criterionid')" href="../../../../_variables/criterionid.html">$criterionid</a> =&gt; <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>) {
<a name="l752"><span class="linenum"> 752</span></a>              <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../../_variables/params.html">$params</a> = array('instanceid' =&gt; <a class="var it1622" onMouseOver="hilite(1622)" onMouseOut="lolite()" onClick="logVariable('instanceid')" href="../../../../_variables/instanceid.html">$instanceid</a>, 'criterionid' =&gt; <a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('criterionid')" href="../../../../_variables/criterionid.html">$criterionid</a>,
<a name="l753"><span class="linenum"> 753</span></a>                  'score' =&gt; <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>['score'], 'remark' =&gt; <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>['remark'], 'remarkformat' =&gt; <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>['remarkformat']);
<a name="l754"><span class="linenum"> 754</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('gradingform_guide_fillings', <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../../_variables/params.html">$params</a>);
<a name="l755"><span class="linenum"> 755</span></a>          }
<a name="l756"><span class="linenum"> 756</span></a>          return <a class="var it1622" onMouseOver="hilite(1622)" onMouseOut="lolite()" onClick="logVariable('instanceid')" href="../../../../_variables/instanceid.html">$instanceid</a>;
<a name="l757"><span class="linenum"> 757</span></a>      }
<a name="l758"><span class="linenum"> 758</span></a>  
<a name="l759"><span class="linenum"> 759</span></a>      <span class="comment">/**</span>
<a name="l760"><span class="linenum"> 760</span></a>  <span class="comment">     * Determines whether the submitted form was empty.</span>
<a name="l761"><span class="linenum"> 761</span></a>  <span class="comment">     *</span>
<a name="l762"><span class="linenum"> 762</span></a>  <span class="comment">     * @param array $elementvalue value of element submitted from the form</span>
<a name="l763"><span class="linenum"> 763</span></a>  <span class="comment">     * @return boolean true if the form is empty</span>
<a name="l764"><span class="linenum"> 764</span></a>  <span class="comment">     */</span>
<a name="l765"><span class="linenum"> 765</span></a>      public function <a class="function" onClick="logFunction('is_empty_form')" href="../../../../_functions/is_empty_form.html" onMouseOver="funcPopup(event,'is_empty_form')">is_empty_form</a>(<a class="var it5811" onMouseOver="hilite(5811)" onMouseOut="lolite()" onClick="logVariable('elementvalue')" href="../../../../_variables/elementvalue.html">$elementvalue</a>) {
<a name="l766"><span class="linenum"> 766</span></a>          <a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../../../_variables/criteria.html">$criteria</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_controller')" href="../../../../_functions/get_controller.html" onMouseOver="funcPopup(event,'get_controller')">get_controller</a>()-&gt;<a class="function" onClick="logFunction('get_definition')" href="../../../../_functions/get_definition.html" onMouseOver="funcPopup(event,'get_definition')">get_definition</a>()-&gt;guide_criteria;
<a name="l767"><span class="linenum"> 767</span></a>          foreach (<a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../../../_variables/criteria.html">$criteria</a> as <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a> =&gt; <a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('criterion')" href="../../../../_variables/criterion.html">$criterion</a>) {
<a name="l768"><span class="linenum"> 768</span></a>              <a class="var it1634" onMouseOver="hilite(1634)" onMouseOut="lolite()" onClick="logVariable('score')" href="../../../../_variables/score.html">$score</a> = <a class="var it5811" onMouseOver="hilite(5811)" onMouseOut="lolite()" onClick="logVariable('elementvalue')" href="../../../../_variables/elementvalue.html">$elementvalue</a>['criteria'][<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>]['score'];
<a name="l769"><span class="linenum"> 769</span></a>              <a class="var it33656" onMouseOver="hilite(33656)" onMouseOut="lolite()" onClick="logVariable('remark')" href="../../../../_variables/remark.html">$remark</a> = <a class="var it5811" onMouseOver="hilite(5811)" onMouseOut="lolite()" onClick="logVariable('elementvalue')" href="../../../../_variables/elementvalue.html">$elementvalue</a>['criteria'][<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>]['remark'];
<a name="l770"><span class="linenum"> 770</span></a>  
<a name="l771"><span class="linenum"> 771</span></a>              if ((isset(<a class="var it1634" onMouseOver="hilite(1634)" onMouseOut="lolite()" onClick="logVariable('score')" href="../../../../_variables/score.html">$score</a>) &amp;&amp; <a class="var it1634" onMouseOver="hilite(1634)" onMouseOut="lolite()" onClick="logVariable('score')" href="../../../../_variables/score.html">$score</a> !== '')
<a name="l772"><span class="linenum"> 772</span></a>                      || ((isset(<a class="var it33656" onMouseOver="hilite(33656)" onMouseOut="lolite()" onClick="logVariable('remark')" href="../../../../_variables/remark.html">$remark</a>) &amp;&amp; <a class="var it33656" onMouseOver="hilite(33656)" onMouseOut="lolite()" onClick="logVariable('remark')" href="../../../../_variables/remark.html">$remark</a> !== ''))) {
<a name="l773"><span class="linenum"> 773</span></a>                  return false;
<a name="l774"><span class="linenum"> 774</span></a>              }
<a name="l775"><span class="linenum"> 775</span></a>          }
<a name="l776"><span class="linenum"> 776</span></a>          return true;
<a name="l777"><span class="linenum"> 777</span></a>      }
<a name="l778"><span class="linenum"> 778</span></a>  
<a name="l779"><span class="linenum"> 779</span></a>      <span class="comment">/**</span>
<a name="l780"><span class="linenum"> 780</span></a>  <span class="comment">     * Validates that guide is fully completed and contains valid grade on each criterion</span>
<a name="l781"><span class="linenum"> 781</span></a>  <span class="comment">     *</span>
<a name="l782"><span class="linenum"> 782</span></a>  <span class="comment">     * @param array $elementvalue value of element as came in form submit</span>
<a name="l783"><span class="linenum"> 783</span></a>  <span class="comment">     * @return boolean true if the form data is validated and contains no errors</span>
<a name="l784"><span class="linenum"> 784</span></a>  <span class="comment">     */</span>
<a name="l785"><span class="linenum"> 785</span></a>      public function <a class="function" onClick="logFunction('validate_grading_element')" href="../../../../_functions/validate_grading_element.html" onMouseOver="funcPopup(event,'validate_grading_element')">validate_grading_element</a>(<a class="var it5811" onMouseOver="hilite(5811)" onMouseOut="lolite()" onClick="logVariable('elementvalue')" href="../../../../_variables/elementvalue.html">$elementvalue</a>) {
<a name="l786"><span class="linenum"> 786</span></a>          <a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../../../_variables/criteria.html">$criteria</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_controller')" href="../../../../_functions/get_controller.html" onMouseOver="funcPopup(event,'get_controller')">get_controller</a>()-&gt;<a class="function" onClick="logFunction('get_definition')" href="../../../../_functions/get_definition.html" onMouseOver="funcPopup(event,'get_definition')">get_definition</a>()-&gt;guide_criteria;
<a name="l787"><span class="linenum"> 787</span></a>          if (!isset(<a class="var it5811" onMouseOver="hilite(5811)" onMouseOut="lolite()" onClick="logVariable('elementvalue')" href="../../../../_variables/elementvalue.html">$elementvalue</a>['criteria']) || !<a class="phpfunction" onClick="logFunction('is_array')" href="../../../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it5811" onMouseOver="hilite(5811)" onMouseOut="lolite()" onClick="logVariable('elementvalue')" href="../../../../_variables/elementvalue.html">$elementvalue</a>['criteria']) ||
<a name="l788"><span class="linenum"> 788</span></a>              <a class="phpfunction" onClick="logFunction('count')" href="../../../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it5811" onMouseOver="hilite(5811)" onMouseOut="lolite()" onClick="logVariable('elementvalue')" href="../../../../_variables/elementvalue.html">$elementvalue</a>['criteria']) &lt; <a class="phpfunction" onClick="logFunction('count')" href="../../../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../../../_variables/criteria.html">$criteria</a>)) {
<a name="l789"><span class="linenum"> 789</span></a>              return false;
<a name="l790"><span class="linenum"> 790</span></a>          }
<a name="l791"><span class="linenum"> 791</span></a>  <span class="comment">        // Reset validation errors.</span>
<a name="l792"><span class="linenum"> 792</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('validationerrors')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/validationerrors.html">validationerrors</a> = null;
<a name="l793"><span class="linenum"> 793</span></a>          foreach (<a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../../../_variables/criteria.html">$criteria</a> as <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a> =&gt; <a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('criterion')" href="../../../../_variables/criterion.html">$criterion</a>) {
<a name="l794"><span class="linenum"> 794</span></a>              if (!isset(<a class="var it5811" onMouseOver="hilite(5811)" onMouseOut="lolite()" onClick="logVariable('elementvalue')" href="../../../../_variables/elementvalue.html">$elementvalue</a>['criteria'][<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>]['score'])
<a name="l795"><span class="linenum"> 795</span></a>                      || <a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('criterion')" href="../../../../_variables/criterion.html">$criterion</a>['maxscore'] &lt; <a class="var it5811" onMouseOver="hilite(5811)" onMouseOut="lolite()" onClick="logVariable('elementvalue')" href="../../../../_variables/elementvalue.html">$elementvalue</a>['criteria'][<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>]['score']
<a name="l796"><span class="linenum"> 796</span></a>                      || !<a class="phpfunction" onClick="logFunction('is_numeric')" href="../../../../_functions/is_numeric.html" onMouseOver="phpfuncPopup(event,'is_numeric')">is_numeric</a>(<a class="var it5811" onMouseOver="hilite(5811)" onMouseOut="lolite()" onClick="logVariable('elementvalue')" href="../../../../_variables/elementvalue.html">$elementvalue</a>['criteria'][<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>]['score'])
<a name="l797"><span class="linenum"> 797</span></a>                      || <a class="var it5811" onMouseOver="hilite(5811)" onMouseOut="lolite()" onClick="logVariable('elementvalue')" href="../../../../_variables/elementvalue.html">$elementvalue</a>['criteria'][<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>]['score'] &lt; 0) {
<a name="l798"><span class="linenum"> 798</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('validationerrors')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/validationerrors.html">validationerrors</a>[<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>]['score'] =  <a class="var it5811" onMouseOver="hilite(5811)" onMouseOut="lolite()" onClick="logVariable('elementvalue')" href="../../../../_variables/elementvalue.html">$elementvalue</a>['criteria'][<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>]['score'];
<a name="l799"><span class="linenum"> 799</span></a>              }
<a name="l800"><span class="linenum"> 800</span></a>          }
<a name="l801"><span class="linenum"> 801</span></a>          if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('validationerrors')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/validationerrors.html">validationerrors</a>)) {
<a name="l802"><span class="linenum"> 802</span></a>              return false;
<a name="l803"><span class="linenum"> 803</span></a>          }
<a name="l804"><span class="linenum"> 804</span></a>          return true;
<a name="l805"><span class="linenum"> 805</span></a>      }
<a name="l806"><span class="linenum"> 806</span></a>  
<a name="l807"><span class="linenum"> 807</span></a>      <span class="comment">/**</span>
<a name="l808"><span class="linenum"> 808</span></a>  <span class="comment">     * Retrieves from DB and returns the data how this guide was filled</span>
<a name="l809"><span class="linenum"> 809</span></a>  <span class="comment">     *</span>
<a name="l810"><span class="linenum"> 810</span></a>  <span class="comment">     * @param bool $force whether to force DB query even if the data is cached</span>
<a name="l811"><span class="linenum"> 811</span></a>  <span class="comment">     * @return array</span>
<a name="l812"><span class="linenum"> 812</span></a>  <span class="comment">     */</span>
<a name="l813"><span class="linenum"> 813</span></a>      public function <a class="function" onClick="logFunction('get_guide_filling')" href="../../../../_functions/get_guide_filling.html" onMouseOver="funcPopup(event,'get_guide_filling')">get_guide_filling</a>(<a class="var it5797" onMouseOver="hilite(5797)" onMouseOut="lolite()" onClick="logVariable('force')" href="../../../../_variables/force.html">$force</a> = false) {
<a name="l814"><span class="linenum"> 814</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>;
<a name="l815"><span class="linenum"> 815</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('guide')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a> === null || <a class="var it5797" onMouseOver="hilite(5797)" onMouseOut="lolite()" onClick="logVariable('force')" href="../../../../_variables/force.html">$force</a>) {
<a name="l816"><span class="linenum"> 816</span></a>              <a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../../_variables/records.html">$records</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('gradingform_guide_fillings', array('instanceid' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_id')" href="../../../../_functions/get_id.html" onMouseOver="funcPopup(event,'get_id')">get_id</a>()));
<a name="l817"><span class="linenum"> 817</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('guide')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a> = array('criteria' =&gt; array());
<a name="l818"><span class="linenum"> 818</span></a>              foreach (<a class="var it2579" onMouseOver="hilite(2579)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../../../_variables/records.html">$records</a> as <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>) {
<a name="l819"><span class="linenum"> 819</span></a>                  <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('score')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../../_variables/score.html">score</a> = (float)<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('score')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../../_variables/score.html">score</a>; <span class="comment">// Strip trailing 0.</span>
<a name="l820"><span class="linenum"> 820</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('guide')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a>['criteria'][<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('criterionid')" class="var it39518" onMouseOver="hilite(39518)" onMouseOut="lolite()" href="../../../../_variables/criterionid.html">criterionid</a>] = (array)<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>;
<a name="l821"><span class="linenum"> 821</span></a>              }
<a name="l822"><span class="linenum"> 822</span></a>          }
<a name="l823"><span class="linenum"> 823</span></a>          return <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('guide')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/guide.html">guide</a>;
<a name="l824"><span class="linenum"> 824</span></a>      }
<a name="l825"><span class="linenum"> 825</span></a>  
<a name="l826"><span class="linenum"> 826</span></a>      <span class="comment">/**</span>
<a name="l827"><span class="linenum"> 827</span></a>  <span class="comment">     * Updates the instance with the data received from grading form. This function may be</span>
<a name="l828"><span class="linenum"> 828</span></a>  <span class="comment">     * called via AJAX when grading is not yet completed, so it does not change the</span>
<a name="l829"><span class="linenum"> 829</span></a>  <span class="comment">     * status of the instance.</span>
<a name="l830"><span class="linenum"> 830</span></a>  <span class="comment">     *</span>
<a name="l831"><span class="linenum"> 831</span></a>  <span class="comment">     * @param array $data</span>
<a name="l832"><span class="linenum"> 832</span></a>  <span class="comment">     */</span>
<a name="l833"><span class="linenum"> 833</span></a>      public function <a class="function" onClick="logFunction('update')" href="../../../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>) {
<a name="l834"><span class="linenum"> 834</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>;
<a name="l835"><span class="linenum"> 835</span></a>          <a class="var it24088" onMouseOver="hilite(24088)" onMouseOut="lolite()" onClick="logVariable('currentgrade')" href="../../../../_variables/currentgrade.html">$currentgrade</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_guide_filling')" href="../../../../_functions/get_guide_filling.html" onMouseOver="funcPopup(event,'get_guide_filling')">get_guide_filling</a>();
<a name="l836"><span class="linenum"> 836</span></a>          parent::<a class="function" onClick="logFunction('update')" href="../../../../_functions/update.html" onMouseOver="funcPopup(event,'update')">update</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>);
<a name="l837"><span class="linenum"> 837</span></a>  
<a name="l838"><span class="linenum"> 838</span></a>          foreach (<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>['criteria'] as <a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('criterionid')" href="../../../../_variables/criterionid.html">$criterionid</a> =&gt; <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>) {
<a name="l839"><span class="linenum"> 839</span></a>              if (!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('criterionid')" href="../../../../_variables/criterionid.html">$criterionid</a>, <a class="var it24088" onMouseOver="hilite(24088)" onMouseOut="lolite()" onClick="logVariable('currentgrade')" href="../../../../_variables/currentgrade.html">$currentgrade</a>['criteria'])) {
<a name="l840"><span class="linenum"> 840</span></a>                  <a class="var it5035" onMouseOver="hilite(5035)" onMouseOut="lolite()" onClick="logVariable('newrecord')" href="../../../../_variables/newrecord.html">$newrecord</a> = array('instanceid' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_id')" href="../../../../_functions/get_id.html" onMouseOver="funcPopup(event,'get_id')">get_id</a>(), 'criterionid' =&gt; <a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('criterionid')" href="../../../../_variables/criterionid.html">$criterionid</a>,
<a name="l841"><span class="linenum"> 841</span></a>                      'score' =&gt; <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>['score'], 'remarkformat' =&gt; <a class="constant" onClick="logConstant('FORMAT_MOODLE')" href="../../../../_constants/FORMAT_MOODLE.html" onMouseOver="constPopup(event,'FORMAT_MOODLE')">FORMAT_MOODLE</a>);
<a name="l842"><span class="linenum"> 842</span></a>                  if (isset(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>['remark'])) {
<a name="l843"><span class="linenum"> 843</span></a>                      <a class="var it5035" onMouseOver="hilite(5035)" onMouseOut="lolite()" onClick="logVariable('newrecord')" href="../../../../_variables/newrecord.html">$newrecord</a>['remark'] = <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>['remark'];
<a name="l844"><span class="linenum"> 844</span></a>                  }
<a name="l845"><span class="linenum"> 845</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('gradingform_guide_fillings', <a class="var it5035" onMouseOver="hilite(5035)" onMouseOut="lolite()" onClick="logVariable('newrecord')" href="../../../../_variables/newrecord.html">$newrecord</a>);
<a name="l846"><span class="linenum"> 846</span></a>              } else {
<a name="l847"><span class="linenum"> 847</span></a>                  <a class="var it5035" onMouseOver="hilite(5035)" onMouseOut="lolite()" onClick="logVariable('newrecord')" href="../../../../_variables/newrecord.html">$newrecord</a> = array('id' =&gt; <a class="var it24088" onMouseOver="hilite(24088)" onMouseOut="lolite()" onClick="logVariable('currentgrade')" href="../../../../_variables/currentgrade.html">$currentgrade</a>['criteria'][<a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('criterionid')" href="../../../../_variables/criterionid.html">$criterionid</a>]['id']);
<a name="l848"><span class="linenum"> 848</span></a>                  foreach (array('score', 'remark'<span class="comment">/*, 'remarkformat' TODO */</span>) as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>) {
<a name="l849"><span class="linenum"> 849</span></a>                      if (isset(<a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>]) &amp;&amp; <a class="var it24088" onMouseOver="hilite(24088)" onMouseOut="lolite()" onClick="logVariable('currentgrade')" href="../../../../_variables/currentgrade.html">$currentgrade</a>['criteria'][<a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('criterionid')" href="../../../../_variables/criterionid.html">$criterionid</a>][<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>] != <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>]) {
<a name="l850"><span class="linenum"> 850</span></a>                          <a class="var it5035" onMouseOver="hilite(5035)" onMouseOut="lolite()" onClick="logVariable('newrecord')" href="../../../../_variables/newrecord.html">$newrecord</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>] = <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>];
<a name="l851"><span class="linenum"> 851</span></a>                      }
<a name="l852"><span class="linenum"> 852</span></a>                  }
<a name="l853"><span class="linenum"> 853</span></a>                  if (<a class="phpfunction" onClick="logFunction('count')" href="../../../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it5035" onMouseOver="hilite(5035)" onMouseOut="lolite()" onClick="logVariable('newrecord')" href="../../../../_variables/newrecord.html">$newrecord</a>) &gt; 1) {
<a name="l854"><span class="linenum"> 854</span></a>                      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('gradingform_guide_fillings', <a class="var it5035" onMouseOver="hilite(5035)" onMouseOut="lolite()" onClick="logVariable('newrecord')" href="../../../../_variables/newrecord.html">$newrecord</a>);
<a name="l855"><span class="linenum"> 855</span></a>                  }
<a name="l856"><span class="linenum"> 856</span></a>              }
<a name="l857"><span class="linenum"> 857</span></a>          }
<a name="l858"><span class="linenum"> 858</span></a>          foreach (<a class="var it24088" onMouseOver="hilite(24088)" onMouseOut="lolite()" onClick="logVariable('currentgrade')" href="../../../../_variables/currentgrade.html">$currentgrade</a>['criteria'] as <a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('criterionid')" href="../../../../_variables/criterionid.html">$criterionid</a> =&gt; <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>) {
<a name="l859"><span class="linenum"> 859</span></a>              if (!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('criterionid')" href="../../../../_variables/criterionid.html">$criterionid</a>, <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>['criteria'])) {
<a name="l860"><span class="linenum"> 860</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('gradingform_guide_fillings', array('id' =&gt; <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>['id']));
<a name="l861"><span class="linenum"> 861</span></a>              }
<a name="l862"><span class="linenum"> 862</span></a>          }
<a name="l863"><span class="linenum"> 863</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_guide_filling')" href="../../../../_functions/get_guide_filling.html" onMouseOver="funcPopup(event,'get_guide_filling')">get_guide_filling</a>(true);
<a name="l864"><span class="linenum"> 864</span></a>      }
<a name="l865"><span class="linenum"> 865</span></a>  
<a name="l866"><span class="linenum"> 866</span></a>      <span class="comment">/**</span>
<a name="l867"><span class="linenum"> 867</span></a>  <span class="comment">     * Removes the attempt from the gradingform_guide_fillings table</span>
<a name="l868"><span class="linenum"> 868</span></a>  <span class="comment">     * @param array $data the attempt data</span>
<a name="l869"><span class="linenum"> 869</span></a>  <span class="comment">     */</span>
<a name="l870"><span class="linenum"> 870</span></a>      public function <a class="function" onClick="logFunction('clear_attempt')" href="../../../../_functions/clear_attempt.html" onMouseOver="funcPopup(event,'clear_attempt')">clear_attempt</a>(<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>) {
<a name="l871"><span class="linenum"> 871</span></a>          global <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>;
<a name="l872"><span class="linenum"> 872</span></a>  
<a name="l873"><span class="linenum"> 873</span></a>          foreach (<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../../../_variables/data.html">$data</a>['criteria'] as <a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('criterionid')" href="../../../../_variables/criterionid.html">$criterionid</a> =&gt; <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>) {
<a name="l874"><span class="linenum"> 874</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('gradingform_guide_fillings',
<a name="l875"><span class="linenum"> 875</span></a>                  array('criterionid' =&gt; <a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('criterionid')" href="../../../../_variables/criterionid.html">$criterionid</a>, 'instanceid' =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_id')" href="../../../../_functions/get_id.html" onMouseOver="funcPopup(event,'get_id')">get_id</a>()));
<a name="l876"><span class="linenum"> 876</span></a>          }
<a name="l877"><span class="linenum"> 877</span></a>      }
<a name="l878"><span class="linenum"> 878</span></a>  
<a name="l879"><span class="linenum"> 879</span></a>      <span class="comment">/**</span>
<a name="l880"><span class="linenum"> 880</span></a>  <span class="comment">     * Calculates the grade to be pushed to the gradebook</span>
<a name="l881"><span class="linenum"> 881</span></a>  <span class="comment">     *</span>
<a name="l882"><span class="linenum"> 882</span></a>  <span class="comment">     * @return float|int the valid grade from $this-&gt;get_controller()-&gt;get_grade_range()</span>
<a name="l883"><span class="linenum"> 883</span></a>  <span class="comment">     */</span>
<a name="l884"><span class="linenum"> 884</span></a>      public function <a class="function" onClick="logFunction('get_grade')" href="../../../../_functions/get_grade.html" onMouseOver="funcPopup(event,'get_grade')">get_grade</a>() {
<a name="l885"><span class="linenum"> 885</span></a>          <a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../../../_variables/grade.html">$grade</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_guide_filling')" href="../../../../_functions/get_guide_filling.html" onMouseOver="funcPopup(event,'get_guide_filling')">get_guide_filling</a>();
<a name="l886"><span class="linenum"> 886</span></a>  
<a name="l887"><span class="linenum"> 887</span></a>          if (!(<a class="var it18032" onMouseOver="hilite(18032)" onMouseOut="lolite()" onClick="logVariable('scores')" href="../../../../_variables/scores.html">$scores</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_controller')" href="../../../../_functions/get_controller.html" onMouseOver="funcPopup(event,'get_controller')">get_controller</a>()-&gt;<a class="function" onClick="logFunction('get_min_max_score')" href="../../../../_functions/get_min_max_score.html" onMouseOver="funcPopup(event,'get_min_max_score')">get_min_max_score</a>()) || <a class="var it18032" onMouseOver="hilite(18032)" onMouseOut="lolite()" onClick="logVariable('scores')" href="../../../../_variables/scores.html">$scores</a>['maxscore'] &lt;= <a class="var it18032" onMouseOver="hilite(18032)" onMouseOut="lolite()" onClick="logVariable('scores')" href="../../../../_variables/scores.html">$scores</a>['minscore']) {
<a name="l888"><span class="linenum"> 888</span></a>              return -1;
<a name="l889"><span class="linenum"> 889</span></a>          }
<a name="l890"><span class="linenum"> 890</span></a>  
<a name="l891"><span class="linenum"> 891</span></a>          <a class="var it5794" onMouseOver="hilite(5794)" onMouseOut="lolite()" onClick="logVariable('graderange')" href="../../../../_variables/graderange.html">$graderange</a> = <a class="phpfunction" onClick="logFunction('array_keys')" href="../../../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_controller')" href="../../../../_functions/get_controller.html" onMouseOver="funcPopup(event,'get_controller')">get_controller</a>()-&gt;<a class="function" onClick="logFunction('get_grade_range')" href="../../../../_functions/get_grade_range.html" onMouseOver="funcPopup(event,'get_grade_range')">get_grade_range</a>());
<a name="l892"><span class="linenum"> 892</span></a>          if (empty(<a class="var it5794" onMouseOver="hilite(5794)" onMouseOut="lolite()" onClick="logVariable('graderange')" href="../../../../_variables/graderange.html">$graderange</a>)) {
<a name="l893"><span class="linenum"> 893</span></a>              return -1;
<a name="l894"><span class="linenum"> 894</span></a>          }
<a name="l895"><span class="linenum"> 895</span></a>          <a class="phpfunction" onClick="logFunction('sort')" href="../../../../_functions/sort.html" onMouseOver="phpfuncPopup(event,'sort')">sort</a>(<a class="var it5794" onMouseOver="hilite(5794)" onMouseOut="lolite()" onClick="logVariable('graderange')" href="../../../../_variables/graderange.html">$graderange</a>);
<a name="l896"><span class="linenum"> 896</span></a>          <a class="var it16174" onMouseOver="hilite(16174)" onMouseOut="lolite()" onClick="logVariable('mingrade')" href="../../../../_variables/mingrade.html">$mingrade</a> = <a class="var it5794" onMouseOver="hilite(5794)" onMouseOut="lolite()" onClick="logVariable('graderange')" href="../../../../_variables/graderange.html">$graderange</a>[0];
<a name="l897"><span class="linenum"> 897</span></a>          <a class="var it5553" onMouseOver="hilite(5553)" onMouseOut="lolite()" onClick="logVariable('maxgrade')" href="../../../../_variables/maxgrade.html">$maxgrade</a> = <a class="var it5794" onMouseOver="hilite(5794)" onMouseOut="lolite()" onClick="logVariable('graderange')" href="../../../../_variables/graderange.html">$graderange</a>[<a class="phpfunction" onClick="logFunction('count')" href="../../../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it5794" onMouseOver="hilite(5794)" onMouseOut="lolite()" onClick="logVariable('graderange')" href="../../../../_variables/graderange.html">$graderange</a>) - 1];
<a name="l898"><span class="linenum"> 898</span></a>  
<a name="l899"><span class="linenum"> 899</span></a>          <a class="var it33657" onMouseOver="hilite(33657)" onMouseOut="lolite()" onClick="logVariable('curscore')" href="../../../../_variables/curscore.html">$curscore</a> = 0;
<a name="l900"><span class="linenum"> 900</span></a>          foreach (<a class="var it607" onMouseOver="hilite(607)" onMouseOut="lolite()" onClick="logVariable('grade')" href="../../../../_variables/grade.html">$grade</a>['criteria'] as <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>) {
<a name="l901"><span class="linenum"> 901</span></a>              <a class="var it33657" onMouseOver="hilite(33657)" onMouseOut="lolite()" onClick="logVariable('curscore')" href="../../../../_variables/curscore.html">$curscore</a> += <a class="var it534" onMouseOver="hilite(534)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../../../_variables/record.html">$record</a>['score'];
<a name="l902"><span class="linenum"> 902</span></a>          }
<a name="l903"><span class="linenum"> 903</span></a>          <a class="var it33658" onMouseOver="hilite(33658)" onMouseOut="lolite()" onClick="logVariable('gradeoffset')" href="../../../../_variables/gradeoffset.html">$gradeoffset</a> = (<a class="var it33657" onMouseOver="hilite(33657)" onMouseOut="lolite()" onClick="logVariable('curscore')" href="../../../../_variables/curscore.html">$curscore</a>-<a class="var it18032" onMouseOver="hilite(18032)" onMouseOut="lolite()" onClick="logVariable('scores')" href="../../../../_variables/scores.html">$scores</a>['minscore'])/(<a class="var it18032" onMouseOver="hilite(18032)" onMouseOut="lolite()" onClick="logVariable('scores')" href="../../../../_variables/scores.html">$scores</a>['maxscore']-<a class="var it18032" onMouseOver="hilite(18032)" onMouseOut="lolite()" onClick="logVariable('scores')" href="../../../../_variables/scores.html">$scores</a>['minscore'])*
<a name="l904"><span class="linenum"> 904</span></a>              (<a class="var it5553" onMouseOver="hilite(5553)" onMouseOut="lolite()" onClick="logVariable('maxgrade')" href="../../../../_variables/maxgrade.html">$maxgrade</a>-<a class="var it16174" onMouseOver="hilite(16174)" onMouseOut="lolite()" onClick="logVariable('mingrade')" href="../../../../_variables/mingrade.html">$mingrade</a>);
<a name="l905"><span class="linenum"> 905</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_controller')" href="../../../../_functions/get_controller.html" onMouseOver="funcPopup(event,'get_controller')">get_controller</a>()-&gt;<a class="function" onClick="logFunction('get_allow_grade_decimals')" href="../../../../_functions/get_allow_grade_decimals.html" onMouseOver="funcPopup(event,'get_allow_grade_decimals')">get_allow_grade_decimals</a>()) {
<a name="l906"><span class="linenum"> 906</span></a>              return <a class="var it33658" onMouseOver="hilite(33658)" onMouseOut="lolite()" onClick="logVariable('gradeoffset')" href="../../../../_variables/gradeoffset.html">$gradeoffset</a> + <a class="var it16174" onMouseOver="hilite(16174)" onMouseOut="lolite()" onClick="logVariable('mingrade')" href="../../../../_variables/mingrade.html">$mingrade</a>;
<a name="l907"><span class="linenum"> 907</span></a>          }
<a name="l908"><span class="linenum"> 908</span></a>          return <a class="phpfunction" onClick="logFunction('round')" href="../../../../_functions/round.html" onMouseOver="phpfuncPopup(event,'round')">round</a>(<a class="var it33658" onMouseOver="hilite(33658)" onMouseOut="lolite()" onClick="logVariable('gradeoffset')" href="../../../../_variables/gradeoffset.html">$gradeoffset</a>, 0) + <a class="var it16174" onMouseOver="hilite(16174)" onMouseOut="lolite()" onClick="logVariable('mingrade')" href="../../../../_variables/mingrade.html">$mingrade</a>;
<a name="l909"><span class="linenum"> 909</span></a>      }
<a name="l910"><span class="linenum"> 910</span></a>  
<a name="l911"><span class="linenum"> 911</span></a>      <span class="comment">/**</span>
<a name="l912"><span class="linenum"> 912</span></a>  <span class="comment">     * Returns html for form element of type 'grading'.</span>
<a name="l913"><span class="linenum"> 913</span></a>  <span class="comment">     *</span>
<a name="l914"><span class="linenum"> 914</span></a>  <span class="comment">     * @param moodle_page $page</span>
<a name="l915"><span class="linenum"> 915</span></a>  <span class="comment">     * @param MoodleQuickForm_grading $gradingformelement</span>
<a name="l916"><span class="linenum"> 916</span></a>  <span class="comment">     * @return string</span>
<a name="l917"><span class="linenum"> 917</span></a>  <span class="comment">     */</span>
<a name="l918"><span class="linenum"> 918</span></a>      public function <a class="function" onClick="logFunction('render_grading_element')" href="../../../../_functions/render_grading_element.html" onMouseOver="funcPopup(event,'render_grading_element')">render_grading_element</a>(<a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../../../_variables/page.html">$page</a>, <a class="var it5813" onMouseOver="hilite(5813)" onMouseOut="lolite()" onClick="logVariable('gradingformelement')" href="../../../../_variables/gradingformelement.html">$gradingformelement</a>) {
<a name="l919"><span class="linenum"> 919</span></a>          if (!<a class="var it5813" onMouseOver="hilite(5813)" onMouseOut="lolite()" onClick="logVariable('gradingformelement')" href="../../../../_variables/gradingformelement.html">$gradingformelement</a>-&gt;<a onClick="logVariable('_flagFrozen')" class="var it40042" onMouseOver="hilite(40042)" onMouseOut="lolite()" href="../../../../_variables/_flagFrozen.html">_flagFrozen</a>) {
<a name="l920"><span class="linenum"> 920</span></a>              <a class="var it611" onMouseOver="hilite(611)" onMouseOut="lolite()" onClick="logVariable('module')" href="../../../../_variables/module.html">$module</a> = array('name'=&gt;'gradingform_guide', 'fullpath'=&gt;'<a class="filename" href="../../../../grade/grading/form/guide/js/guide.js.html">/grade/grading/form/guide/js/guide.js</a>');
<a name="l921"><span class="linenum"> 921</span></a>              <a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../../../_variables/page.html">$page</a>-&gt;<a onClick="logVariable('requires')" class="var it39576" onMouseOver="hilite(39576)" onMouseOut="lolite()" href="../../../../_variables/requires.html">requires</a>-&gt;<a class="function" onClick="logFunction('js_init_call')" href="../../../../_functions/js_init_call.html" onMouseOver="funcPopup(event,'js_init_call')">js_init_call</a>('M.gradingform_guide.init', array(
<a name="l922"><span class="linenum"> 922</span></a>                  array('name' =&gt; <a class="var it5813" onMouseOver="hilite(5813)" onMouseOut="lolite()" onClick="logVariable('gradingformelement')" href="../../../../_variables/gradingformelement.html">$gradingformelement</a>-&gt;<a class="function" onClick="logFunction('getName')" href="../../../../_functions/getname.html" onMouseOver="funcPopup(event,'getname')">getName</a>())), true, <a class="var it611" onMouseOver="hilite(611)" onMouseOut="lolite()" onClick="logVariable('module')" href="../../../../_variables/module.html">$module</a>);
<a name="l923"><span class="linenum"> 923</span></a>              <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../../../_variables/mode.html">$mode</a> = <a class="class" onClick="logClass('gradingform_guide_controller')" href="../../../../_classes/gradingform_guide_controller.html" onMouseOver="classPopup(event,'gradingform_guide_controller')">gradingform_guide_controller</a>::DISPLAY_EVAL;
<a name="l924"><span class="linenum"> 924</span></a>          } else {
<a name="l925"><span class="linenum"> 925</span></a>              if (<a class="var it5813" onMouseOver="hilite(5813)" onMouseOut="lolite()" onClick="logVariable('gradingformelement')" href="../../../../_variables/gradingformelement.html">$gradingformelement</a>-&gt;<a onClick="logVariable('_persistantFreeze')" class="var it40042" onMouseOver="hilite(40042)" onMouseOut="lolite()" href="../../../../_variables/_persistantFreeze.html">_persistantFreeze</a>) {
<a name="l926"><span class="linenum"> 926</span></a>                  <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../../../_variables/mode.html">$mode</a> = <a class="class" onClick="logClass('gradingform_guide_controller')" href="../../../../_classes/gradingform_guide_controller.html" onMouseOver="classPopup(event,'gradingform_guide_controller')">gradingform_guide_controller</a>::DISPLAY_EVAL_FROZEN;
<a name="l927"><span class="linenum"> 927</span></a>              } else {
<a name="l928"><span class="linenum"> 928</span></a>                  <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../../../_variables/mode.html">$mode</a> = <a class="class" onClick="logClass('gradingform_guide_controller')" href="../../../../_classes/gradingform_guide_controller.html" onMouseOver="classPopup(event,'gradingform_guide_controller')">gradingform_guide_controller</a>::DISPLAY_REVIEW;
<a name="l929"><span class="linenum"> 929</span></a>              }
<a name="l930"><span class="linenum"> 930</span></a>          }
<a name="l931"><span class="linenum"> 931</span></a>          <a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../../../_variables/criteria.html">$criteria</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_controller')" href="../../../../_functions/get_controller.html" onMouseOver="funcPopup(event,'get_controller')">get_controller</a>()-&gt;<a class="function" onClick="logFunction('get_definition')" href="../../../../_functions/get_definition.html" onMouseOver="funcPopup(event,'get_definition')">get_definition</a>()-&gt;guide_criteria;
<a name="l932"><span class="linenum"> 932</span></a>          <a class="var it3670" onMouseOver="hilite(3670)" onMouseOut="lolite()" onClick="logVariable('comments')" href="../../../../_variables/comments.html">$comments</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_controller')" href="../../../../_functions/get_controller.html" onMouseOver="funcPopup(event,'get_controller')">get_controller</a>()-&gt;<a class="function" onClick="logFunction('get_definition')" href="../../../../_functions/get_definition.html" onMouseOver="funcPopup(event,'get_definition')">get_definition</a>()-&gt;guide_comments;
<a name="l933"><span class="linenum"> 933</span></a>          <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../../_variables/options.html">$options</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_controller')" href="../../../../_functions/get_controller.html" onMouseOver="funcPopup(event,'get_controller')">get_controller</a>()-&gt;<a class="function" onClick="logFunction('get_options')" href="../../../../_functions/get_options.html" onMouseOver="funcPopup(event,'get_options')">get_options</a>();
<a name="l934"><span class="linenum"> 934</span></a>          <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a> = <a class="var it5813" onMouseOver="hilite(5813)" onMouseOut="lolite()" onClick="logVariable('gradingformelement')" href="../../../../_variables/gradingformelement.html">$gradingformelement</a>-&gt;<a class="function" onClick="logFunction('getValue')" href="../../../../_functions/getvalue.html" onMouseOver="funcPopup(event,'getvalue')">getValue</a>();
<a name="l935"><span class="linenum"> 935</span></a>          <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../../../_variables/html.html">$html</a> = '';
<a name="l936"><span class="linenum"> 936</span></a>          if (<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a> === null) {
<a name="l937"><span class="linenum"> 937</span></a>              <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_guide_filling')" href="../../../../_functions/get_guide_filling.html" onMouseOver="funcPopup(event,'get_guide_filling')">get_guide_filling</a>();
<a name="l938"><span class="linenum"> 938</span></a>          } else if (!<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('validate_grading_element')" href="../../../../_functions/validate_grading_element.html" onMouseOver="funcPopup(event,'validate_grading_element')">validate_grading_element</a>(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a>)) {
<a name="l939"><span class="linenum"> 939</span></a>              <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../../../_variables/html.html">$html</a> .= <a class="class" onClick="logClass('html_writer')" href="../../../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('tag')" href="../../../../_functions/tag.html" onMouseOver="funcPopup(event,'tag')">tag</a>('div', <a class="function" onClick="logFunction('get_string')" href="../../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('guidenotcompleted', 'gradingform_guide'),
<a name="l940"><span class="linenum"> 940</span></a>                  array('class' =&gt; 'gradingform_guide-error'));
<a name="l941"><span class="linenum"> 941</span></a>              if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('validationerrors')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/validationerrors.html">validationerrors</a>)) {
<a name="l942"><span class="linenum"> 942</span></a>                  foreach (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('validationerrors')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/validationerrors.html">validationerrors</a> as <a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a> =&gt; <a class="var it1340" onMouseOver="hilite(1340)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a>) {
<a name="l943"><span class="linenum"> 943</span></a>                      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../../../_variables/a.html">$a</a> = new stdClass();
<a name="l944"><span class="linenum"> 944</span></a>                      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('criterianame')" class="var it39489" onMouseOver="hilite(39489)" onMouseOut="lolite()" href="../../../../_variables/criterianame.html">criterianame</a> = <a class="function" onClick="logFunction('s')" href="../../../../_functions/s.html" onMouseOver="funcPopup(event,'s')">s</a>(<a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../../../_variables/criteria.html">$criteria</a>[<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>]['shortname']);
<a name="l945"><span class="linenum"> 945</span></a>                      <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../../../_variables/a.html">$a</a>-&gt;<a onClick="logVariable('maxscore')" class="var it39489" onMouseOver="hilite(39489)" onMouseOut="lolite()" href="../../../../_variables/maxscore.html">maxscore</a> = <a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../../../_variables/criteria.html">$criteria</a>[<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../../../_variables/id.html">$id</a>]['maxscore'];
<a name="l946"><span class="linenum"> 946</span></a>                      <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../../../_variables/html.html">$html</a> .= <a class="class" onClick="logClass('html_writer')" href="../../../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('tag')" href="../../../../_functions/tag.html" onMouseOver="funcPopup(event,'tag')">tag</a>('div', <a class="function" onClick="logFunction('get_string')" href="../../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('err_scoreinvalid', 'gradingform_guide', <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../../../_variables/a.html">$a</a>),
<a name="l947"><span class="linenum"> 947</span></a>                          array('class' =&gt; 'gradingform_guide-error'));
<a name="l948"><span class="linenum"> 948</span></a>                  }
<a name="l949"><span class="linenum"> 949</span></a>              }
<a name="l950"><span class="linenum"> 950</span></a>          }
<a name="l951"><span class="linenum"> 951</span></a>          <a class="var it33653" onMouseOver="hilite(33653)" onMouseOut="lolite()" onClick="logVariable('currentinstance')" href="../../../../_variables/currentinstance.html">$currentinstance</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_current_instance')" href="../../../../_functions/get_current_instance.html" onMouseOver="funcPopup(event,'get_current_instance')">get_current_instance</a>();
<a name="l952"><span class="linenum"> 952</span></a>          if (<a class="var it33653" onMouseOver="hilite(33653)" onMouseOut="lolite()" onClick="logVariable('currentinstance')" href="../../../../_variables/currentinstance.html">$currentinstance</a> &amp;&amp; <a class="var it33653" onMouseOver="hilite(33653)" onMouseOut="lolite()" onClick="logVariable('currentinstance')" href="../../../../_variables/currentinstance.html">$currentinstance</a>-&gt;<a class="function" onClick="logFunction('get_status')" href="../../../../_functions/get_status.html" onMouseOver="funcPopup(event,'get_status')">get_status</a>() == gradingform_instance::INSTANCE_STATUS_NEEDUPDATE) {
<a name="l953"><span class="linenum"> 953</span></a>              <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../../../_variables/html.html">$html</a> .= <a class="class" onClick="logClass('html_writer')" href="../../../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('tag')" href="../../../../_functions/tag.html" onMouseOver="funcPopup(event,'tag')">tag</a>('div', <a class="function" onClick="logFunction('get_string')" href="../../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('needregrademessage', 'gradingform_guide'),
<a name="l954"><span class="linenum"> 954</span></a>                  array('class' =&gt; 'gradingform_guide-regrade'));
<a name="l955"><span class="linenum"> 955</span></a>          }
<a name="l956"><span class="linenum"> 956</span></a>          <a class="var it33637" onMouseOver="hilite(33637)" onMouseOut="lolite()" onClick="logVariable('haschanges')" href="../../../../_variables/haschanges.html">$haschanges</a> = false;
<a name="l957"><span class="linenum"> 957</span></a>          if (<a class="var it33653" onMouseOver="hilite(33653)" onMouseOut="lolite()" onClick="logVariable('currentinstance')" href="../../../../_variables/currentinstance.html">$currentinstance</a>) {
<a name="l958"><span class="linenum"> 958</span></a>              <a class="var it33659" onMouseOver="hilite(33659)" onMouseOut="lolite()" onClick="logVariable('curfilling')" href="../../../../_variables/curfilling.html">$curfilling</a> = <a class="var it33653" onMouseOver="hilite(33653)" onMouseOut="lolite()" onClick="logVariable('currentinstance')" href="../../../../_variables/currentinstance.html">$currentinstance</a>-&gt;<a class="function" onClick="logFunction('get_guide_filling')" href="../../../../_functions/get_guide_filling.html" onMouseOver="funcPopup(event,'get_guide_filling')">get_guide_filling</a>();
<a name="l959"><span class="linenum"> 959</span></a>              foreach (<a class="var it33659" onMouseOver="hilite(33659)" onMouseOut="lolite()" onClick="logVariable('curfilling')" href="../../../../_variables/curfilling.html">$curfilling</a>['criteria'] as <a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('criterionid')" href="../../../../_variables/criterionid.html">$criterionid</a> =&gt; <a class="var it33660" onMouseOver="hilite(33660)" onMouseOut="lolite()" onClick="logVariable('curvalues')" href="../../../../_variables/curvalues.html">$curvalues</a>) {
<a name="l960"><span class="linenum"> 960</span></a>                  <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a>['criteria'][<a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('criterionid')" href="../../../../_variables/criterionid.html">$criterionid</a>]['score'] = <a class="var it33660" onMouseOver="hilite(33660)" onMouseOut="lolite()" onClick="logVariable('curvalues')" href="../../../../_variables/curvalues.html">$curvalues</a>['score'];
<a name="l961"><span class="linenum"> 961</span></a>                  <a class="var it33661" onMouseOver="hilite(33661)" onMouseOut="lolite()" onClick="logVariable('newremark')" href="../../../../_variables/newremark.html">$newremark</a> = null;
<a name="l962"><span class="linenum"> 962</span></a>                  <a class="var it33662" onMouseOver="hilite(33662)" onMouseOut="lolite()" onClick="logVariable('newscore')" href="../../../../_variables/newscore.html">$newscore</a> = null;
<a name="l963"><span class="linenum"> 963</span></a>                  if (isset(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a>['criteria'][<a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('criterionid')" href="../../../../_variables/criterionid.html">$criterionid</a>]['remark'])) {
<a name="l964"><span class="linenum"> 964</span></a>                      <a class="var it33661" onMouseOver="hilite(33661)" onMouseOut="lolite()" onClick="logVariable('newremark')" href="../../../../_variables/newremark.html">$newremark</a> = <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a>['criteria'][<a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('criterionid')" href="../../../../_variables/criterionid.html">$criterionid</a>]['remark'];
<a name="l965"><span class="linenum"> 965</span></a>                  }
<a name="l966"><span class="linenum"> 966</span></a>                  if (isset(<a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a>['criteria'][<a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('criterionid')" href="../../../../_variables/criterionid.html">$criterionid</a>]['score'])) {
<a name="l967"><span class="linenum"> 967</span></a>                      <a class="var it33662" onMouseOver="hilite(33662)" onMouseOut="lolite()" onClick="logVariable('newscore')" href="../../../../_variables/newscore.html">$newscore</a> = <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a>['criteria'][<a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('criterionid')" href="../../../../_variables/criterionid.html">$criterionid</a>]['score'];
<a name="l968"><span class="linenum"> 968</span></a>                  }
<a name="l969"><span class="linenum"> 969</span></a>                  if (<a class="var it33662" onMouseOver="hilite(33662)" onMouseOut="lolite()" onClick="logVariable('newscore')" href="../../../../_variables/newscore.html">$newscore</a> != <a class="var it33660" onMouseOver="hilite(33660)" onMouseOut="lolite()" onClick="logVariable('curvalues')" href="../../../../_variables/curvalues.html">$curvalues</a>['score'] || <a class="var it33661" onMouseOver="hilite(33661)" onMouseOut="lolite()" onClick="logVariable('newremark')" href="../../../../_variables/newremark.html">$newremark</a> != <a class="var it33660" onMouseOver="hilite(33660)" onMouseOut="lolite()" onClick="logVariable('curvalues')" href="../../../../_variables/curvalues.html">$curvalues</a>['remark']) {
<a name="l970"><span class="linenum"> 970</span></a>                      <a class="var it33637" onMouseOver="hilite(33637)" onMouseOut="lolite()" onClick="logVariable('haschanges')" href="../../../../_variables/haschanges.html">$haschanges</a> = true;
<a name="l971"><span class="linenum"> 971</span></a>                  }
<a name="l972"><span class="linenum"> 972</span></a>              }
<a name="l973"><span class="linenum"> 973</span></a>          }
<a name="l974"><span class="linenum"> 974</span></a>          if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_data')" href="../../../../_functions/get_data.html" onMouseOver="funcPopup(event,'get_data')">get_data</a>('isrestored') &amp;&amp; <a class="var it33637" onMouseOver="hilite(33637)" onMouseOut="lolite()" onClick="logVariable('haschanges')" href="../../../../_variables/haschanges.html">$haschanges</a>) {
<a name="l975"><span class="linenum"> 975</span></a>              <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../../../_variables/html.html">$html</a> .= <a class="class" onClick="logClass('html_writer')" href="../../../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('tag')" href="../../../../_functions/tag.html" onMouseOver="funcPopup(event,'tag')">tag</a>('div', <a class="function" onClick="logFunction('get_string')" href="../../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('restoredfromdraft', 'gradingform_guide'),
<a name="l976"><span class="linenum"> 976</span></a>                  array('class' =&gt; 'gradingform_guide-restored'));
<a name="l977"><span class="linenum"> 977</span></a>          }
<a name="l978"><span class="linenum"> 978</span></a>          <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../../../_variables/html.html">$html</a> .= <a class="class" onClick="logClass('html_writer')" href="../../../../_classes/html_writer.html" onMouseOver="classPopup(event,'html_writer')">html_writer</a>::<a class="function" onClick="logFunction('tag')" href="../../../../_functions/tag.html" onMouseOver="funcPopup(event,'tag')">tag</a>('div', <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_controller')" href="../../../../_functions/get_controller.html" onMouseOver="funcPopup(event,'get_controller')">get_controller</a>()-&gt;<a class="function" onClick="logFunction('get_formatted_description')" href="../../../../_functions/get_formatted_description.html" onMouseOver="funcPopup(event,'get_formatted_description')">get_formatted_description</a>(),
<a name="l979"><span class="linenum"> 979</span></a>              array('class' =&gt; 'gradingform_guide-description'));
<a name="l980"><span class="linenum"> 980</span></a>          <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../../../_variables/html.html">$html</a> .= <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_controller')" href="../../../../_functions/get_controller.html" onMouseOver="funcPopup(event,'get_controller')">get_controller</a>()-&gt;<a class="function" onClick="logFunction('get_renderer')" href="../../../../_functions/get_renderer.html" onMouseOver="funcPopup(event,'get_renderer')">get_renderer</a>(<a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('page')" href="../../../../_variables/page.html">$page</a>)-&gt;<a class="function" onClick="logFunction('display_guide')" href="../../../../_functions/display_guide.html" onMouseOver="funcPopup(event,'display_guide')">display_guide</a>(<a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('criteria')" href="../../../../_variables/criteria.html">$criteria</a>, <a class="var it3670" onMouseOver="hilite(3670)" onMouseOut="lolite()" onClick="logVariable('comments')" href="../../../../_variables/comments.html">$comments</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../../_variables/options.html">$options</a>, <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../../../_variables/mode.html">$mode</a>,
<a name="l981"><span class="linenum"> 981</span></a>              <a class="var it5813" onMouseOver="hilite(5813)" onMouseOut="lolite()" onClick="logVariable('gradingformelement')" href="../../../../_variables/gradingformelement.html">$gradingformelement</a>-&gt;<a class="function" onClick="logFunction('getName')" href="../../../../_functions/getname.html" onMouseOver="funcPopup(event,'getname')">getName</a>(), <a class="var it35" onMouseOver="hilite(35)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a>, <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('validationerrors')" class="var it39456" onMouseOver="hilite(39456)" onMouseOut="lolite()" href="../../../../_variables/validationerrors.html">validationerrors</a>);
<a name="l982"><span class="linenum"> 982</span></a>          return <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../../../_variables/html.html">$html</a>;
<a name="l983"><span class="linenum"> 983</span></a>      }
<a name="l984"><span class="linenum"> 984</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'get_guide_filling': ['get_guide_filling', 'Retrieves from DB and returns the data how this guide was filled ', [['grade/grading/form/guide','lib.php',807]], 7],
'get_renderer': ['get_renderer', 'Get the renderer for a part of Moodle for this theme. ', [['lib','outputlib.php',1790],['mod/assign','locallib.php',2734],['lib','outputfactories.php',70],['lib','outputfactories.php',292],['lib','outputfactories.php',377],['course/format','lib.php',889],['question/type/multichoice','question.php',137],['question/type/multichoice','question.php',259],['question/type','questionbase.php',275],['grade/grading/form/guide','lib.php',482],['question/behaviour','behaviourbase.php',135],['lib','pagelib.php',797],['grade/grading/form/rubric','lib.php',486],['lib/tests/fixtures','test_renderer_factory.php',49]], 339],
'getvalue': ['getvalue', 'Return the value of this object, convert the XML-RPC native nill value into a PHP NULL ', [['lib/zend/Zend/XmlRpc/Value','Nil.php',50],['lib/phpexcel/PHPExcel/Worksheet/AutoFilter/Column','Rule.php',306],['backup/cc','entity11.lti.class.php',75],['lib/zend/Zend/XmlRpc/Value','Base64.php',58],['lib/pear/HTML/QuickForm','input.php',120],['lib/form','filemanager.php',127],['lib/horde/framework/Horde/Mime','Headers.php',433],['lib/zend/Zend/Gdata/Calendar/Extension','QuickAdd.php',101],['lib/zend/Zend/Http','Cookie.php',143],['lib/zend/Zend/XmlRpc/Value','BigInteger.php',56],['lib/google/src/Google/Service','DoubleClickBidManager.php',366],['lib/google/src/Google/Service','Doubleclicksearch.php',800],['lib/google/src/Google/Service','Doubleclicksearch.php',826],['lib/google/src/Google/Service','Manager.php',745],['lib/google/src/Google/Service','Manager.php',1102],['lib/google/src/Google/Service','Manager.php',1472],['lib/pear/HTML/QuickForm','link.php',122],['lib/google/src/Google/Service','Reports.php',699],['lib/google/src/Google/Service','Reports.php',1131],['lib/zend/Zend/Gdata/YouTube/Extension','Position.php',56],['lib/google/src/Google/Service','Gmail.php',1776],['lib/google/src/Google/Service','Plus.php',3123],['lib/google/src/Google/Service','Plus.php',3326],['lib/google/src/Google/Service','Plus.php',3361],['lib/google/src/Google/Service','Mirror.php',1470],['lib/google/src/Google/Service','Mirror.php',1927],['lib/form','editor.php',151],['lib/google/src/Google/Service','Genomics.php',2647],['lib/form','selectgroups.php',148],['lib/zend/Zend/XmlRpc/Value','String.php',51],['lib/zend/Zend/Gdata/Calendar/Extension','AccessLevel.php',93],['lib/google/src/Google/Service','Dfareporting.php',1121],['lib/google/src/Google/Service','Dfareporting.php',1183],['lib/google/src/Google/Service','PlusDomains.php',3293],['lib/google/src/Google/Service','PlusDomains.php',3496],['lib/google/src/Google/Service','PlusDomains.php',3531],['lib/pear/HTML/QuickForm','checkbox.php',197],['lib/zend/Zend/XmlRpc/Value','DateTime.php',82],['lib/zend/Zend/Gdata/Books/Extension','Viewability.php',95],['lib/google/src/Google/Service','Drive.php',3741],['lib/google/src/Google/Service','Drive.php',5074],['lib/google/src/Google/Service','Drive.php',5208],['backup/cc','entity11.basiclti.class.php',80],['lib/google/src/Google/Service','Books.php',3697],['lib','searchlib.php',65],['lib/pear/HTML/QuickForm','select.php',201],['lib/google/src/Google/Service','YouTube.php',7381],['lib/google/src/Google/Service','YouTube.php',8160],['lib/zend/Zend/Gdata/Calendar/Extension','Timezone.php',93],['lib/zend/Zend/XmlRpc/Value','Collection.php',59],['lib/google/src/Google/Service','Coordinate.php',761],['lib/zend/Zend/Gdata/Extension','Transparency.php',91],['lib/google/src/Google/Service','Autoscaler.php',1196],['lib/google/src/Google/Service','Audit.php',368],['lib/google/src/Google/Service','Datastore.php',587],['lib/google/src/Google/Service','Datastore.php',1052],['lib/google/src/Google/Service','Pagespeedonline.php',384],['lib/google/src/Google/Service','Pagespeedonline.php',467],['lib/google/src/Google/Service','Pagespeedonline.php',521],['lib/pear/HTML/QuickForm','textarea.php',115],['lib/google/src/Google/Service','ShoppingContent.php',2131],['lib/google/src/Google/Service','ShoppingContent.php',2877],['lib/google/src/Google/Service','ShoppingContent.php',3483],['lib/google/src/Google/Service','ShoppingContent.php',3662],['lib/google/src/Google/Service','ShoppingContent.php',3921],['lib/google/src/Google/Service','ShoppingContent.php',3947],['lib/google/src/Google/Utils','URITemplate.php',322],['lib/zend/Zend/XmlRpc/Value','Integer.php',56],['lib/zend/Zend/Gdata/Extension','AttendeeStatus.php',91],['lib/google/src/Google/Service','SQLAdmin.php',1307],['lib/pear/HTML/QuickForm','advcheckbox.php',170],['lib/google/src/Google/Service','Fitness.php',751],['lib/google/src/Google/Service','TagManager.php',2690],['lib/google/src/Google/Service','Directory.php',4910],['lib/google/src/Google/Service','Directory.php',5175],['lib/google/src/Google/Service','Directory.php',5290],['lib/zend/Zend/Gdata/Books/Extension','Embeddability.php',95],['lib/pear/HTML/QuickForm','element.php',174],['lib/zend/Zend/XmlRpc/Value','Double.php',53],['lib/zend/Zend/Gdata/Calendar/Extension','Color.php',94],['lib/zend/Zend/Server/Reflection','Node.php',145],['lib/zend/Zend/Gdata/Extension','EventStatus.php',70],['lib/zend/Zend/XmlRpc/Value','Boolean.php',54],['mod/scorm/datamodels','scorm_13.js',376],['lib/google/src/Google/Service','Games.php',5489],['lib/phpexcel/PHPExcel','Cell.php',183],['lib/phpexcel/PHPExcel/Calculation','FormulaToken.php',123],['lib/google/src/Google/Service','MapsEngine.php',3862],['lib/zend/Zend/Gdata/Calendar/Extension','Hidden.php',102],['lib/editor/tinymce/plugins/spellchecker/classes/utils','JSON.php',85],['lib/zend/Zend/Gdata/Extension','Visibility.php',91],['lib/google/src/Google/Service','Prediction.php',547],['lib/google/src/Google/Service','Prediction.php',689],['lib/google/src/Google/Service','Compute.php',5811],['lib/google/src/Google/Service','Compute.php',6868],['lib/google/src/Google/Service','Compute.php',6960],['lib/google/src/Google/Service','Compute.php',7466],['lib/google/src/Google/Service','Compute.php',8592],['lib/google/src/Google/Service','Compute.php',8995],['lib/google/src/Google/Service','Compute.php',9058],['lib/google/src/Google/Service','Compute.php',9679],['lib/google/src/Google/Service','Compute.php',9771],['lib/google/src/Google/Service','Compute.php',10408],['lib/google/src/Google/Service','Compute.php',11124],['lib/google/src/Google/Service','Compute.php',11550],['lib/zend/Zend/Gdata/Calendar/Extension','Selected.php',102],['lib/google/src/Google/Service','CloudMonitoring.php',945],['lib/google/src/Google/Service','Calendar.php',1980],['lib/google/src/Google/Service','Calendar.php',3666],['lib/google/src/Google/Service','Analytics.php',6683],['lib/pear/HTML/QuickForm','file.php',138],['mod/wiki/editors','wikifiletable.php',74],['lib/zend/Zend/Gdata/Calendar/Extension','SendEventNotifications.php',100],['lib/zend/Zend/Gdata/Extension','AttendeeType.php',91],['lib/zend/Zend/Service/DeveloperGarden/ConferenceCall','ParticipantStatus.php',82],['lib/pear/HTML/QuickForm','group.php',179],['lib/pear/HTML/QuickForm','xbutton.php',96],['lib/google/src/Google/Service','Replicapool.php',1269],['lib/google/src/Google/Service','Resourceviews.php',597],['lib/google/src/Google/Service','Resourceviews.php',1008],['lib/zend/Zend/Gdata/Extension','Rating.php',218],['lib/zend/Zend/Gdata/Extension','ExtendedProperty.php',95]], 265],
'get_max_upload_file_size': ['get_max_upload_file_size', 'Returns the maximum size for uploading files. ', [['lib','moodlelib.php',6060]], 16],
'delete_records_list': ['delete_records_list', 'Delete the records from a table where one field match one list of values. ', [['lib/dml','moodle_database.php',1834]], 36],
'get_definition_copy': ['get_definition_copy', 'Returns the form definition suitable for cloning into another area ', [['grade/grading/form','lib.php',259],['grade/grading/form/guide','lib.php',415],['grade/grading/form/rubric','lib.php',413]], 4],
'sql_search_from_tables': ['sql_search_from_tables', 'Prepare the part of the search query to append to the FROM statement ', [['grade/grading/form','lib.php',568],['grade/grading/form/guide','lib.php',596],['grade/grading/form/rubric','lib.php',602]], 1],
'on': ['on', '', [['lib/requirejs','require.js',506]], 3494],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required. ', [['lib/dml','pgsql_native_moodle_database.php',883],['lib/dml','oci_native_moodle_database.php',1249],['lib/dml','sqlsrv_native_moodle_database.php',978],['lib/dml','mssql_native_moodle_database.php',898],['lib/dml','mysqli_native_moodle_database.php',1177],['lib/dml/tests','dml_test.php',5427],['lib/dml','pdo_moodle_database.php',386],['question/engine/upgrade','upgradelib.php',121]], 1512],
'load_definition': ['load_definition', 'Loads the form definition if it exists ', [['grade/grading/form','lib.php',598],['grade/grading/form/guide','lib.php',281],['grade/grading/form/rubric','lib.php',293]], 6],
'sql_like': ['sql_like', 'Returns \'LIKE\' part of a query. ', [['lib/dml','pgsql_native_moodle_database.php',1273],['lib/dml','oci_native_moodle_database.php',1523],['lib/dml','sqlsrv_native_moodle_database.php',1224],['lib/dml','moodle_database.php',2004],['lib/dml','mssql_native_moodle_database.php',1160],['lib/dml','mysqli_native_moodle_database.php',1502]], 158],
'has_capability': ['has_capability', 'Wrapper round the has_capability funciton that automatically passes in the quiz context. ', [['mod/quiz','attemptlib.php',299],['mod/quiz','attemptlib.php',884],['lib','accesslib.php',346]], 1929],
'get_recordset': ['get_recordset', 'Get a number of records as a moodle_recordset where all the given conditions met. ', [['lib/dml','moodle_database.php',1113]], 95],
'get_editor_url': ['get_editor_url', 'Returns URL of a page where the grading form can be defined and edited. ', [['grade/grading/form','lib.php',202]], 4],
'description_form_field_options': ['description_form_field_options', 'Options for displaying the guide description field in the form ', [['grade/grading/form/guide','lib.php',443],['grade/grading/form/rubric','lib.php',447]], 8],
'get_definition_for_editing': ['get_definition_for_editing', 'Converts the current definition into an object suitable for the editor form\'s set_data() ', [['grade/grading/form/guide','lib.php',379],['grade/grading/form/rubric','lib.php',384]], 4],
'get_string': ['get_string', 'Return a core get_string() call ', [['lib/external','externallib.php',112],['lib','moodlelib.php',6538],['lib','moodlelib.php',9417],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38],['lib/classes','string_manager_install.php',95],['question/behaviour','behaviourbase.php',756]], 19235],
'get_records': ['get_records', 'Get a number of records as an array of objects where all the given conditions met. ', [['lib/dml','moodle_database.php',1236],['lib','coursecatlib.php',654],['question','category_class.php',63]], 860],
'update': ['update', 'Update a customer resource if one it exists and is owned by the reseller. (customers.update) ', [['lib/google/src/Google/Service','Reseller.php',343],['mod/lesson/pagetypes','matching.php',308],['lib/adodb','adodb-active-recordx.inc.php',1047],['lib/grade','grade_object.php',238],['lib/google/src/Google/Service','Fusiontables.php',726],['lib/google/src/Google/Service','Fusiontables.php',889],['lib/google/src/Google/Service','Fusiontables.php',1095],['lib/google/src/Google/Service','Fusiontables.php',1269],['grade/grading/form','lib.php',905],['lib/google/src/Google/Service','Blogger.php',1332],['lib/google/src/Google/Service','Blogger.php',1630],['lib/google/src/Google/Service','Doubleclicksearch.php',325],['lib/google/src/Google/Service','AdExchangeBuyer.php',392],['lib/google/src/Google/Service','AdExchangeBuyer.php',684],['lib/grade','grade_item.php',260],['lib/google/src/Google/Service','Gmail.php',756],['lib/google/src/Google/Service','Gmail.php',908],['lib/google/src/Google/Service','Mirror.php',495],['lib/google/src/Google/Service','Mirror.php',633],['lib/google/src/Google/Service','Mirror.php',744],['lib/google/src/Google/Service','Genomics.php',690],['lib/google/src/Google/Service','Genomics.php',811],['lib/google/src/Google/Service','Genomics.php',1064],['lib/google/src/Google/Service','Genomics.php',1370],['lib/google/src/Google/Service','Genomics.php',1521],['lib/google/src/Google/Service','Dfareporting.php',570],['lib/google/src/Google/Service','PlusDomains.php',691],['lib/google/src/Google/Service','Licensing.php',332],['lib/google/src/Google/Service','Drive.php',1624],['lib/google/src/Google/Service','Drive.php',1859],['lib/google/src/Google/Service','Drive.php',2100],['lib/google/src/Google/Service','Drive.php',2211],['lib/google/src/Google/Service','Drive.php',2261],['lib/google/src/Google/Service','Drive.php',2385],['lib/google/src/Google/Service','Drive.php',2473],['completion','data_object.php',251],['lib/google/src/Google/Service','Books.php',1901],['lib/google/src/Google/Service','Bigquery.php',603],['lib/google/src/Google/Service','Bigquery.php',911],['lib/google/src/Google/Service','Groupssettings.php',137],['lib/google/src/Google/Service','YouTube.php',1596],['lib/google/src/Google/Service','YouTube.php',1697],['lib/google/src/Google/Service','YouTube.php',2201],['lib/google/src/Google/Service','YouTube.php',2439],['lib/google/src/Google/Service','YouTube.php',2613],['lib/google/src/Google/Service','YouTube.php',2809],['lib/google/src/Google/Service','YouTube.php',3419],['lib/google/src/Google/Service','Coordinate.php',568],['lib/google/src/Google/Service','Coordinate.php',680],['lib/google/src/Google/Service','Autoscaler.php',399],['calendar','lib.php',2171],['lib/google/src/Google/Service','ShoppingContent.php',633],['lib/google/src/Google/Service','ShoppingContent.php',815],['lib','weblib.php',3154],['mod/lesson','locallib.php',2682],['lib/google/src/Google/Service','SQLAdmin.php',843],['lib/google/src/Google/Service','Fitness.php',424],['lib/google/src/Google/Service','Fitness.php',607],['lib/google/src/Google/Service','TagManager.php',1004],['lib/google/src/Google/Service','TagManager.php',1093],['lib/google/src/Google/Service','TagManager.php',1186],['lib/google/src/Google/Service','TagManager.php',1279],['lib/google/src/Google/Service','TagManager.php',1372],['lib/google/src/Google/Service','TagManager.php',1466],['lib/google/src/Google/Service','TagManager.php',1560],['lib/google/src/Google/Service','TagManager.php',1711],['lib/google/src/Google/Service','TagManager.php',1804],['mod/lesson/pagetypes','truefalse.php',163],['lib/google/src/Google/Service','Directory.php',1446],['lib/google/src/Google/Service','Directory.php',1559],['lib/google/src/Google/Service','Directory.php',1724],['lib/google/src/Google/Service','Directory.php',1907],['lib/google/src/Google/Service','Directory.php',2014],['lib/google/src/Google/Service','Directory.php',2116],['lib/google/src/Google/Service','Directory.php',2337],['lib/google/src/Google/Service','Directory.php',2523],['lib/xhprof/xhprof_html/jquery','jquery.tooltip.js',200],['lib/google/src/Google/Service','AppState.php',201],['lib/google/src/Google/Service','Taskqueue.php',397],['lib/google/src/Google/Service','AndroidPublisher.php',1360],['lib/google/src/Google/Service','AndroidPublisher.php',1472],['lib/google/src/Google/Service','AndroidPublisher.php',1542],['lib/google/src/Google/Service','AndroidPublisher.php',1780],['lib/google/src/Google/Service','AndroidPublisher.php',1846],['lib/google/src/Google/Service','AndroidPublisher.php',1928],['lib/google/src/Google/Service','AndroidPublisher.php',2066],['mod/lesson/pagetypes','essay.php',158],['lib/google/src/Google/Service','AdSenseHost.php',845],['lib/google/src/Google/Service','AdSenseHost.php',1096],['lib/google/src/Google/Service','Games.php',1507],['lib/grade','grade_grade.php',940],['lib/google/src/Google/Service','SiteVerification.php',226],['lib/horde/framework/Horde/Support','Array.php',70],['lib/google/src/Google/Service','Prediction.php',338],['lib/google/src/Google/Service','Compute.php',2999],['lib/google/src/Google/Service','Compute.php',3310],['lib/google/src/Google/Service','Compute.php',3814],['lib/google/src/Google/Service','Compute.php',5314],['lib/google/src/Google/Service','Calendar.php',979],['lib/google/src/Google/Service','Calendar.php',1144],['lib/google/src/Google/Service','Calendar.php',1285],['lib/google/src/Google/Service','Calendar.php',1633],['lib/google/src/Google/Service','Analytics.php',2118],['lib/google/src/Google/Service','Analytics.php',2385],['lib/google/src/Google/Service','Analytics.php',2495],['lib/google/src/Google/Service','Analytics.php',2602],['lib/google/src/Google/Service','Analytics.php',2730],['lib/google/src/Google/Service','Analytics.php',2821],['lib/google/src/Google/Service','Analytics.php',2944],['lib/google/src/Google/Service','Analytics.php',3277],['lib/google/src/Google/Service','Analytics.php',3379],['lib/google/src/Google/Service','Analytics.php',3461],['lib/google/src/Google/Service','Tasks.php',385],['lib/google/src/Google/Service','Tasks.php',555],['lib/horde/framework/Horde/Imap/Client/Ids','Map.php',72],['grade/grading/form/guide','lib.php',826],['lib/grade','grade_category.php',204],['lib/google/src/Google/Service','Storage.php',1030],['lib/google/src/Google/Service','Storage.php',1165],['lib/google/src/Google/Service','Storage.php',1318],['lib/google/src/Google/Service','Storage.php',1454],['lib/google/src/Google/Service','Storage.php',1718],['lib/filestorage','stored_file.php',103],['grade/grading/form/rubric','lib.php',828],['lib/grade','grade_scale.php',125],['lib','coursecatlib.php',441],['lib/adodb','adodb-active-record.inc.php',878],['lib/grade','grade_outcome.php',144],['mod/lesson/pagetypes','branchtable.php',262]], 290],
'get_id': ['get_id', 'Returns instance id ', [['grade/grading/form','lib.php',854],['cache/classes','definition.php',596],['lib/classes/task','adhoc_task.php',51],['question/engine','questionusage.php',120],['mod/lti/classes/local/ltiservice','service_base.php',76],['lib/simplepie/library/SimplePie','Item.php',199],['question/engine','questionattemptstep.php',136],['mod/lti/classes/local/ltiservice','resource_base.php',81],['backup/converter','convertlib.php',100],['admin/tool/uploadcourse/classes','course.php',335],['backup/controller','backup_controller.class.php',261],['lib','adminlib.php',1716],['lib/filestorage','stored_file.php',786],['lib/filebrowser','virtual_root_file.php',290]], 169],
'make_grades_menu': ['make_grades_menu', 'Creates an array that represents all the current grades that can be chosen using the given grading type. ', [['lib','moodlelib.php',7866]], 10],
'delete_plugin_definition': ['delete_plugin_definition', 'Deletes the guide definition and all the associated information ', [['grade/grading/form/guide','lib.php',526],['grade/grading/form/rubric','lib.php',534]], 2],
'set_field': ['set_field', 'Sets the custom profile field used for testing. ', [['availability/condition/profile/tests','condition_test.php',349],['lib/dml','moodle_database.php',1688]], 462],
'validate_grading_element': ['validate_grading_element', 'Server-side validation of the data received from grading form. ', [['grade/grading/form','lib.php',1020],['grade/grading/form/guide','lib.php',779],['grade/grading/form/rubric','lib.php',790]], 3],
'get_external_instance_filling_details': ['get_external_instance_filling_details', 'Overridden by sub classes that wish to make instance filling details available to web services. When not overridden, only instance filling data common to all grading methods is made available. When overriding, the return value should be an array containing one or more key/value pairs. These key/value pairs should match the filling data returned by the get_<method>_filling() function in the gradingform_instance subclass. For examples, look at: $gradingform_rubric_controller->get_external_instance_filling_details() $gradingform_guide_controller->get_external_instance_filling_details() ', [['grade/grading/form','lib.php',705],['grade/grading/form/guide','lib.php',688],['grade/grading/form/rubric','lib.php',691]], 1],
'table_exists': ['table_exists', 'Given one xmldb_table, check if it exists in DB (true/false). ', [['lib/ddl','database_manager.php',89],['lib/ddl','sql_generator.php',215]], 156],
'get_record': ['get_record', 'Get a single database record as an object where all the given conditions met. ', [['lib/dml','moodle_database.php',1413]], 2960],
'update_definition': ['update_definition', 'Saves the defintion data into the database ', [['grade/grading/form','lib.php',290],['grade/grading/form/guide','lib.php',96],['grade/grading/form/rubric','lib.php',92]], 9],
'get_active_instances': ['get_active_instances', 'Returns list of ACTIVE instances for the specified $itemid (intentionally does not return instances with status NEEDUPDATE) ', [['grade/grading/form','lib.php',414]], 2],
'get_options': ['get_options', 'Add appropriate criteria elements to the form ', [['badges/criteria','award_criteria_overall.php',160],['admin/webservice','lib.php',112],['mod/forum/classes','potential_subscriber_selector.php',59],['mod/data/field/textarea','field.class.php',31],['admin/roles/classes','assign_user_selector_base.php',53],['cohort','locallib.php',86],['cohort','locallib.php',150],['user/selector','lib.php',356],['user/selector','lib.php',689],['badges/criteria','award_criteria_activity.php',104],['admin/roles/classes','admins_potential_selector.php',85],['admin/roles/classes','check_users_selector.php',147],['mod/workshop','locallib.php',3822],['repository','lib.php',179],['grade','lib.php',963],['mnet/service/enrol','locallib.php',519],['mnet/service/enrol','locallib.php',607],['mod/forum/classes','subscriber_selector_base.php',72],['enrol/manual','locallib.php',87],['enrol/manual','locallib.php',151],['badges/criteria','award_criteria_manual.php',58],['admin/roles/classes','admins_existing_selector.php',92],['grade/grading/form/guide','lib.php',363],['badges/criteria','award_criteria_courseset.php',145],['lib','adminlib.php',8599],['grade/grading/form/rubric','lib.php',368],['badges/criteria','award_criteria_profile.php',42],['badges/lib','awardlib.php',82],['badges/criteria','award_criteria_course.php',117]], 40],
'file_prepare_standard_editor': ['file_prepare_standard_editor', 'Prepares \'editor\' formslib element from data in database ', [['lib','filelib.php',108]], 41],
'js_init_call': ['js_init_call', 'Ensure that the specified JavaScript function is called from an inline script from page footer. ', [['lib','outputrequirementslib.php',1050]], 95],
'cancel': ['cancel', 'Called on the particular Update endpoint. Cancels the update in state PAUSED. No-op if invoked in state CANCELLED. (updates.cancel) ', [['lib/google/src/Google/Service','Replicapoolupdater.php',257],['grade/grading/form','lib.php',892],['lib/google/src/Google/Service','Genomics.php',877],['lib/google/src/Google/Service','AndroidPublisher.php',2142],['lib/google/src/Google/Service','Games.php',1999],['grade/grading/form/guide','lib.php',730],['grade/grading/form/rubric','lib.php',730],['lib/lessphp/Tree','Unit.php',104]], 264],
'mark_for_regrade': ['mark_for_regrade', 'Marks all instances filled with this guide with the status INSTANCE_STATUS_NEEDUPDATE ', [['grade/grading/form/guide','lib.php',269],['grade/grading/form/rubric','lib.php',281]], 2],
'is_form_available': ['is_form_available', 'Is the grading form defined and ready for usage? ', [['grade/grading/form','lib.php',150]], 6],
'get_method_name': ['get_method_name', 'Returns the name of the grading method plugin, eg \'rubric\' ', [['grade/grading/form','lib.php',619]], 11],
'get_definition': ['get_definition', 'Returns the grading form definition structure ', [['grade/grading/form','lib.php',246],['cache/classes','loaders.php',874]], 32],
'display_guide': ['display_guide', 'This function returns html code for displaying guide. Depending on $mode it may be the code to edit guide, to preview the guide, to evaluate somebody or to review the evaluation. ', [['grade/grading/form/guide','renderer.php',447]], 5],
'get_instance': ['get_instance', 'Returns the object of type gradingform_XXX_instance (where XXX is the plugin method name) ', [['grade/grading/form','lib.php',474],['blog','locallib.php',859],['question/engine','bank.php',445],['mod/assign','locallib.php',1164],['backup/util/helper','restore_logs_processor.class.php',69],['repository','lib.php',1135],['mnet/service/enrol','locallib.php',57],['lib','externallib.php',794],['backup/util/output','output_controller.class.php',53]], 393],
'render_grade': ['render_grade', 'Returns html code to be included in student\'s feedback. ', [['grade/grading/form','lib.php',633],['grade/grading/form/guide','lib.php',580],['grade/grading/form/rubric','lib.php',586]], 2],
'get_areaid': ['get_areaid', 'Returns gradable area id ', [['grade/grading/form','lib.php',129]], 5],
'get_controller': ['get_controller', 'Returns the controller ', [['grade/grading/form','lib.php',832],['backup/util/ui','base_ui.class.php',302],['grade/grading','lib.php',488]], 72],
'sql_like_escape': ['sql_like_escape', 'Escape sql LIKE special characters like \'_\' or \'%\'. ', [['lib/dml','moodle_database.php',2024]], 16],
'copy': ['copy', 'Copies a table. (table.copy) ', [['lib/google/src/Google/Service','Fusiontables.php',917],['grade/grading/form','lib.php',798],['lib/horde/framework/Horde/Imap/Client','Base.php',2848],['lib/google/src/Google/Service','Drive.php',1652],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Template.php.in',16],['lib/phpexcel/PHPExcel','Worksheet.php',2806],['lib/yuilib/3.17.2/timers','timers-debug.js',115],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Memory.php',23],['lib/phpexcel','PHPExcel.php',843],['lib/yuilib/3.17.2/timers','timers.js',115],['grade/grading/form/guide','lib.php',739],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Decorator.php',36],['lib/google/src/Google/Service','Storage.php',1513],['grade/grading/form/rubric','lib.php',739],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Cleanup.php',17]], 48],
'tag': ['tag', 'Outputs a tag with attributes and contents ', [['lib','outputcomponents.php',1063],['lib/zend/Zend/Service','Technorati.php',228]], 1254],
'add': ['add', '', [['lib/phpexcel/PHPExcel/Shared/PCLZip','pclzip.lib.php',454],['blog','locallib.php',242],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Serializer.php',11],['lib/htmlpurifier/HTMLPurifier','IDAccumulator.php',31],['lib/xhprof/xhprof_html/jquery','jquery.autocomplete.js',428],['backup/cc','validator.php',51],['lib/google/src/Google/Http','Batch.php',47],['lib/horde/framework/Horde/Imap/Client/Data/Format','List.php',37],['lib/horde/framework/Horde/Support','ConsistentHash.php',148],['lib/horde/framework/Horde/Imap/Client','Ids.php',155],['lib/zend/Zend/Service/Simpy','WatchlistFilterSet.php',47],['lib/horde/framework/Horde/Imap/Client','Tokenize.php',109],['lib/lessphp/Output','Mapped.php',50],['lib/horde/framework/Horde/Stream','TempString.php',118],['lib','licenselib.php',32],['lib/htmlpurifier/HTMLPurifier','UnitConverter.php',207],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Template.php.in',29],['lib/horde/framework/Horde/Mail/Rfc822','List.php',116],['lib/xhprof/xhprof_html/jquery','jquery-1.2.6.js',3450],['lib/google/src/Google/Service','Webmasters.php',375],['lib/horde/framework/Horde','Variables.php',297],['lib','outputcomponents.php',2700],['lib','outputcomponents.php',3375],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Null.php',14],['lib/zend/Zend','Date.php',1081],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Memory.php',33],['comment','lib.php',675],['lib/phpexcel/PHPExcel/Reader/Excel5','MD5.php',86],['lib/horde/framework/Horde','Stream.php',116],['backup/cc/cc_lib/gral_lib','cssparser.php',111],['lib/lessphp','Output.php',18],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Decorator.php',50],['lib','adminlib.php',736],['lib','adminlib.php',895],['lib','adminlib.php',1447],['lib','csslib.php',1508],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',95],['lib','navigationlib.php',302],['lib','navigationlib.php',758],['lib','navigationlib.php',3288],['lib','navigationlib.php',3542],['lib/phpexcel/PHPExcel','HashTable.php',85],['lib/mustache/src/Mustache','HelperCollection.php',56],['lib/horde/framework/Horde/Mail/Rfc822','GroupList.php',25],['lib/htmlpurifier/HTMLPurifier/DefinitionCache/Decorator','Cleanup.php',27],['lib/horde/framework/Horde/Imap/Client/Interaction','Pipeline.php',80],['backup/cc/cc_lib','cc_utils.php',395],['backup/cc/cc_lib','cc_utils.php',454]], 5988],
'is_form_defined': ['is_form_defined', 'Is the form definition record available? ', [['grade/grading/form','lib.php',138]], 16],
'get_grade_range': ['get_grade_range', 'Returns the range of grades used in this area ', [['grade/grading/form','lib.php',668]], 2],
'set_user_preference': ['set_user_preference', 'Sets a preference for the specified user. ', [['lib','moodlelib.php',1822]], 163],
'extend_navigation': ['extend_navigation', 'Extends the module navigation ', [['grade/grading/form','lib.php',233],['grade/grading/form/guide','lib.php',74],['grade/grading','lib.php',467],['grade/grading/form/rubric','lib.php',71]], 2],
'getname': ['getname', '', [['lib/google/src/Google/Service','Fusiontables.php',1439],['lib/google/src/Google/Service','Fusiontables.php',2031],['lib/google/src/Google/Service','Fusiontables.php',2204],['lib/google/src/Google/Service','Fusiontables.php',2419],['lib/pear/HTML/QuickForm','input.php',89],['lib/form','filemanager.php',109],['lib/xmldb','xmldb_object.php',118],['lib/zend/Zend/Http','Cookie.php',133],['lib/google/src/Google/Service','QPXExpress.php',127],['lib/google/src/Google/Service','QPXExpress.php',171],['lib/google/src/Google/Service','QPXExpress.php',260],['lib/google/src/Google/Service','QPXExpress.php',304],['lib/google/src/Google/Service','QPXExpress.php',1223],['lib/google/src/Google/Service','Blogger.php',1753],['lib/google/src/Google/Service','Blogger.php',2957],['lib/google/src/Google/Service','Doubleclicksearch.php',792],['lib/google/src/Google/Service','Doubleclicksearch.php',818],['lib/google/src/Google/Service','AdExchangeBuyer.php',1339],['lib/phpexcel/PHPExcel/Worksheet','HeaderFooterDrawing.php',102],['lib/google/src/Google/Service','Manager.php',401],['lib/google/src/Google/Service','Manager.php',637],['lib/google/src/Google/Service','Manager.php',1296],['lib/google/src/Google/Service','Manager.php',1817],['lib/pear/HTML/QuickForm','link.php',89],['lib/google/src/Google/Service','Reports.php',620],['lib/google/src/Google/Service','Reports.php',691],['lib/google/src/Google/Service','Reports.php',1000],['lib/google/src/Google/Service','Customsearch.php',1076],['lib/google/src/Google/Service','Gmail.php',1376],['lib/google/src/Google/Service','Gmail.php',1768],['lib/google/src/Google/Service','Plus.php',912],['lib/google/src/Google/Service','Plus.php',2321],['lib/google/src/Google/Service','Plus.php',2877],['lib/google/src/Google/Service','Plus.php',3268],['lib/google/src/Google/Service','Spectrum.php',245],['lib/zend/Zend/Service/Simpy','Watchlist.php',132],['lib/zend/Zend/Server/Method','Parameter.php',145],['lib/form','editor.php',128],['lib/google/src/Google/Service','Genomics.php',1708],['lib/google/src/Google/Service','Genomics.php',1826],['lib/google/src/Google/Service','Genomics.php',2991],['lib/google/src/Google/Service','Genomics.php',3108],['lib/google/src/Google/Service','Genomics.php',3172],['lib/google/src/Google/Service','Genomics.php',3240],['lib/google/src/Google/Service','Genomics.php',3392],['lib/google/src/Google/Service','Genomics.php',3564],['lib/form','selectgroups.php',114],['lib/zend/Zend/Gdata/Gapps/Extension','EmailList.php',108],['lib/zend/Zend/Gdata/Gapps','UserEntry.php',204],['lib/google/src/Google/Service','Dfareporting.php',1086],['lib/google/src/Google/Service','Dfareporting.php',1404],['lib/google/src/Google/Service','Dfareporting.php',1704],['lib/google/src/Google/Service','Dfareporting.php',2569],['lib/google/src/Google/Service','PlusDomains.php',1180],['lib/google/src/Google/Service','PlusDomains.php',3073],['lib/google/src/Google/Service','PlusDomains.php',3438],['lib/zend/Zend/Server/Method','Definition.php',106],['lib/google/src/Google/Service','Drive.php',2622],['lib/google/src/Google/Service','Drive.php',3011],['lib/google/src/Google/Service','Drive.php',5034],['lib/zend/Zend/Gdata/Gapps/Extension','Nickname.php',107],['lib/phpexcel/PHPExcel/Worksheet','BaseDrawing.php',161],['lib/google/src/Google/Service','AdExchangeSeller.php',860],['lib/google/src/Google/Service','AdExchangeSeller.php',1132],['lib/google/src/Google/Service','AdExchangeSeller.php',1466],['lib/google/src/Google/Service','AdExchangeSeller.php',1581],['lib/google/src/Google/Service','Bigquery.php',2992],['lib/pear/HTML/QuickForm','select.php',151],['lib/google/src/Google/Service','Freebase.php',304],['lib/google/src/Google/Service','Freebase.php',338],['lib/zend/Zend/Gdata/Gbase/Extension','BaseAttribute.php',68],['lib/google/src/Google/Service','Groupssettings.php',314],['lib/google/src/Google/Service','YouTube.php',6163],['lib/google/src/Google/Service','YouTube.php',6289],['lib/google/src/Google/Service','Coordinate.php',807],['lib/google/src/Google/Service','Autoscaler.php',574],['lib/google/src/Google/Service','Autoscaler.php',928],['lib/google/src/Google/Service','Autoscaler.php',1273],['lib/google/src/Google/Service','Autoscaler.php',1396],['lib/google/src/Google/Service','Audit.php',334],['lib/google/src/Google/Service','Audit.php',360],['lib/pear/HTML/QuickForm','static.php',78],['lib/google/src/Google/Service','Datastore.php',579],['lib/google/src/Google/Service','Datastore.php',651],['lib/google/src/Google/Service','Datastore.php',668],['lib/google/src/Google/Service','Datastore.php',1096],['lib/google/src/Google/Service','YouTubeAnalytics.php',344],['lib/google/src/Google/Service','YouTubeAnalytics.php',604],['lib/pear/HTML/QuickForm','textarea.php',84],['lib/google/src/Google/Service','ShoppingContent.php',1155],['lib/google/src/Google/Service','ShoppingContent.php',1862],['lib/google/src/Google/Service','ShoppingContent.php',2835],['lib/google/src/Google/Service','ShoppingContent.php',3459],['lib/google/src/Google/Service','ShoppingContent.php',3511],['lib/google/src/Google/Service','Appsactivity.php',388],['lib/google/src/Google/Service','Appsactivity.php',535],['lib/google/src/Google/Service','Appsactivity.php',554],['lib/phpexcel/PHPExcel','NamedRange.php',99],['lib/google/src/Google/Service','SQLAdmin.php',1299],['lib/google/src/Google/Service','SQLAdmin.php',1572],['lib/google/src/Google/Service','Fitness.php',653],['lib/google/src/Google/Service','Fitness.php',817],['lib/google/src/Google/Service','Fitness.php',853],['lib/google/src/Google/Service','Fitness.php',879],['lib/google/src/Google/Service','Fitness.php',1117],['lib/google/src/Google/Service','TagManager.php',1854],['lib/google/src/Google/Service','TagManager.php',1976],['lib/google/src/Google/Service','TagManager.php',2135],['lib/google/src/Google/Service','TagManager.php',2233],['lib/google/src/Google/Service','TagManager.php',2292],['lib/google/src/Google/Service','TagManager.php',2594],['lib/google/src/Google/Service','TagManager.php',2774],['lib/google/src/Google/Service','TagManager.php',2889],['lib/google/src/Google/Service','TagManager.php',3080],['lib/google/src/Google/Service','TagManager.php',3254],['lib/google/src/Google/Service','Directory.php',2745],['lib/google/src/Google/Service','Directory.php',3308],['lib/google/src/Google/Service','Directory.php',3650],['lib/google/src/Google/Service','Directory.php',4021],['lib/google/src/Google/Service','Directory.php',4618],['lib/google/src/Google/Service','Directory.php',5099],['lib/zend/Zend/Gdata/YouTube/Extension','State.php',116],['lib/pear/HTML/QuickForm','element.php',143],['lib/zend/Zend/Service/Simpy','WatchlistFilter.php',62],['lib/google/src/Google/Service','CivicInfo.php',354],['lib/google/src/Google/Service','CivicInfo.php',468],['lib/google/src/Google/Service','CivicInfo.php',542],['lib/google/src/Google/Service','CivicInfo.php',821],['lib/google/src/Google/Service','CivicInfo.php',864],['lib/google/src/Google/Service','CivicInfo.php',901],['lib/google/src/Google/Service','CivicInfo.php',972],['lib/google/src/Google/Service','CivicInfo.php',1008],['lib/google/src/Google/Service','CivicInfo.php',1056],['lib/google/src/Google/Service','CivicInfo.php',1131],['lib/google/src/Google/Service','CivicInfo.php',1215],['lib/google/src/Google/Service','CivicInfo.php',1449],['lib/google/src/Google/Service','Container.php',526],['lib/google/src/Google/Service','Container.php',758],['lib/phpexcel/PHPExcel/Style','Font.php',226],['lib/google/src/Google/Service','AdSenseHost.php',1253],['lib/google/src/Google/Service','AdSenseHost.php',1623],['lib/google/src/Google/Service','AdSenseHost.php',1926],['lib/google/src/Google/Service','AdSenseHost.php',2072],['lib/google/src/Google/Service','Games.php',2357],['lib/google/src/Google/Service','Games.php',2924],['lib/google/src/Google/Service','Games.php',3555],['lib/google/src/Google/Service','Games.php',3631],['lib/google/src/Google/Service','Games.php',3867],['lib/google/src/Google/Service','Games.php',4512],['lib/google/src/Google/Service','Games.php',5430],['lib/google/src/Google/Service','MapsEngine.php',3420],['lib/google/src/Google/Service','MapsEngine.php',3610],['lib/google/src/Google/Service','MapsEngine.php',4066],['lib/google/src/Google/Service','MapsEngine.php',4096],['lib/google/src/Google/Service','MapsEngine.php',4347],['lib/google/src/Google/Service','MapsEngine.php',4639],['lib/google/src/Google/Service','MapsEngine.php',4754],['lib/google/src/Google/Service','MapsEngine.php',4819],['lib/google/src/Google/Service','MapsEngine.php',4876],['lib/google/src/Google/Service','MapsEngine.php',5196],['lib/google/src/Google/Service','MapsEngine.php',5264],['lib/google/src/Google/Service','MapsEngine.php',5355],['lib/google/src/Google/Service','MapsEngine.php',5533],['lib/google/src/Google/Service','MapsEngine.php',5695],['lib/google/src/Google/Service','MapsEngine.php',5829],['lib/google/src/Google/Service','MapsEngine.php',6216],['lib/google/src/Google/Service','MapsEngine.php',6290],['lib/horde/framework/Horde/Mime','Part.php',374],['lib/google/src/Google/Service','Compute.php',5491],['lib/google/src/Google/Service','Compute.php',5574],['lib/google/src/Google/Service','Compute.php',6122],['lib/google/src/Google/Service','Compute.php',6371],['lib/google/src/Google/Service','Compute.php',6639],['lib/google/src/Google/Service','Compute.php',7029],['lib/google/src/Google/Service','Compute.php',7229],['lib/google/src/Google/Service','Compute.php',7648],['lib/google/src/Google/Service','Compute.php',7841],['lib/google/src/Google/Service','Compute.php',8083],['lib/google/src/Google/Service','Compute.php',8429],['lib/google/src/Google/Service','Compute.php',8628],['lib/google/src/Google/Service','Compute.php',8749],['lib/google/src/Google/Service','Compute.php',9131],['lib/google/src/Google/Service','Compute.php',9169],['lib/google/src/Google/Service','Compute.php',9353],['lib/google/src/Google/Service','Compute.php',9809],['lib/google/src/Google/Service','Compute.php',9913],['lib/google/src/Google/Service','Compute.php',10041],['lib/google/src/Google/Service','Compute.php',10218],['lib/google/src/Google/Service','Compute.php',10574],['lib/google/src/Google/Service','Compute.php',10759],['lib/google/src/Google/Service','Compute.php',10895],['lib/google/src/Google/Service','Compute.php',11217],['lib/google/src/Google/Service','Compute.php',11698],['lib/google/src/Google/Service','Compute.php',12023],['lib/google/src/Google/Service','Compute.php',12146],['lib/google/src/Google/Service','CloudMonitoring.php',589],['lib/google/src/Google/Service','Analytics.php',3601],['lib/google/src/Google/Service','Analytics.php',3713],['lib/google/src/Google/Service','Analytics.php',3833],['lib/google/src/Google/Service','Analytics.php',4225],['lib/google/src/Google/Service','Analytics.php',4788],['lib/google/src/Google/Service','Analytics.php',5225],['lib/google/src/Google/Service','Analytics.php',5408],['lib/google/src/Google/Service','Analytics.php',5624],['lib/google/src/Google/Service','Analytics.php',5919],['lib/google/src/Google/Service','Analytics.php',6254],['lib/google/src/Google/Service','Analytics.php',6627],['lib/google/src/Google/Service','Analytics.php',6888],['lib/google/src/Google/Service','Analytics.php',7221],['lib/google/src/Google/Service','Analytics.php',7584],['lib/google/src/Google/Service','Analytics.php',7959],['lib/google/src/Google/Service','Analytics.php',8003],['lib/google/src/Google/Service','Analytics.php',8221],['lib/google/src/Google/Service','Analytics.php',8408],['lib/google/src/Google/Service','Analytics.php',9063],['lib/google/src/Google/Service','Analytics.php',9120],['lib/google/src/Google/Service','Analytics.php',9325],['lib/zend/Zend/Service/DeveloperGarden/ConferenceCall','ConferenceDetail.php',125],['lib/google/src/Google/Service','GamesManagement.php',1219],['lib/google/src/Google/Service','Oauth2.php',370],['lib/google/src/Google/Service','Storage.php',1900],['lib/google/src/Google/Service','Storage.php',2571],['lib/google/src/Google/Service','Storage.php',3000],['mod/wiki/editors','wikifiletable.php',66],['lib/google/src/Google/Service','AdSense.php',2151],['lib/google/src/Google/Service','AdSense.php',2566],['lib/google/src/Google/Service','AdSense.php',2905],['lib/google/src/Google/Service','AdSense.php',3049],['lib/google/src/Google/Service','AdSense.php',3373],['lib/google/src/Google/Service','AdSense.php',3454],['lib/google/src/Google/Service','Pubsub.php',943],['lib/google/src/Google/Service','Pubsub.php',976],['lib/zend/Zend/Gdata/App/Extension','Person.php',112],['lib/alfresco/Service','ChildAssociation.php',55],['lib/zend/Zend/Service/Technorati','Weblog.php',212],['lib/zend/Zend/Service/DeveloperGarden/ConferenceCall','ParticipantStatus.php',60],['lib/google/src/Google/Service','Translate.php',319],['lib/pear/HTML/QuickForm','group.php',129],['lib/google/src/Google/Service','Dns.php',651],['lib/google/src/Google/Service','Dns.php',842],['lib/pear/HTML/QuickForm','xbutton.php',82],['lib/phpexcel/PHPExcel','Chart.php',165],['lib/google/src/Google/Service','Replicapool.php',711],['lib/google/src/Google/Service','Replicapool.php',1001],['lib/google/src/Google/Service','Resourceviews.php',740],['lib/google/src/Google/Service','Resourceviews.php',1095],['lib/google/src/Google/Service','Resourceviews.php',1145],['lib/zend/Zend/Gdata/Extension','ExtendedProperty.php',84]], 882],
'get_manager': ['get_manager', 'Returns the sql generator used for db manipulation. Used mostly in upgrade.php scripts. ', [['lib/dml','moodle_database.php',1030]], 273],
'optional_param': ['optional_param', 'Returns a particular value for the named variable, taken from POST or GET, otherwise returning a given default. ', [['lib','moodlelib.php',605]], 2167],
'create_instance': ['create_instance', 'Create new block instance ', [['blocks/online_users/tests/generator','lib.php',39],['grade/grading/form','lib.php',493],['mod/book/tests/generator','lib.php',53],['mod/imscp/tests/generator','lib.php',38],['mod/feedback/tests/generator','lib.php',38],['lib/portfolio','plugin.php',412],['lib/testing/generator','repository_generator.php',106],['mod/scorm/tests/generator','lib.php',38],['mod/survey/tests/generator','lib.php',49],['mod/page/tests/generator','lib.php',39],['mod/assignment/tests/generator','lib.php',39],['mod/quiz/tests/generator','lib.php',28],['mod/workshop/tests/generator','lib.php',38],['mod/assign/tests','base_test.php',200],['mod/url/tests/generator','lib.php',38],['lib/testing/generator','module_generator.php',210],['notes/tests/generator','lib.php',52],['mod/forum/tests/generator','lib.php',67],['mod/glossary/tests/generator','lib.php',59],['mod/chat/tests/generator','lib.php',53],['mod/lesson/tests/generator','lib.php',53],['mod/wiki/tests/generator','lib.php',53],['mod/data/tests/generator','lib.php',39],['mod/choice/tests/generator','lib.php',38],['mod/folder/tests/generator','lib.php',38],['mod/lti/tests/generator','lib.php',40],['mod/assign/tests/generator','lib.php',29],['mod/resource/tests/generator','lib.php',37]], 290],
'is_empty_form': ['is_empty_form', 'Determines whether the submitted form was empty. ', [['grade/grading/form','lib.php',938],['grade/grading/form/guide','lib.php',759],['grade/grading/form/rubric','lib.php',759]], 2],
'get_grade': ['get_grade', 'Get user\'s course grade in this course ', [['completion/criteria','completion_criteria_grade.php',94],['lib/grade','grade_item.php',1155],['mod/assign','locallib.php',2935],['lib/classes/event','grade_deleted.php',81],['grade/grading/form/guide','lib.php',879],['lib/classes/event','user_graded.php',72],['grade/grading/form/rubric','lib.php',868]], 17],
'render_grading_element': ['render_grading_element', 'Returns html for form element of type \'grading\'. ', [['grade/grading/form/guide','lib.php',911],['grade/grading/form/rubric','lib.php',899]], 2],
'clear_attempt': ['clear_attempt', 'Removes the attempt from the gradingform_*_fillings table. This function is not abstract as to not break plugins that might use advanced grading. ', [['grade/grading/form','lib.php',948],['grade/grading/form/guide','lib.php',866],['grade/grading/form/rubric','lib.php',777]], 1],
'get_min_max_score': ['get_min_max_score', 'Calculates and returns the possible minimum and maximum score (in points) for this guide ', [['grade/grading/form/guide','lib.php',631],['grade/grading/form/rubric','lib.php',640]], 4],
'get_allow_grade_decimals': ['get_allow_grade_decimals', 'Returns if decimal values are allowed as grades ', [['grade/grading/form','lib.php',680]], 3],
'get_data': ['get_data', '', [['mod/feedback/item/captcha','lib.php',76],['grade/grading/form/guide','edit_form.php',142],['grade/grading/form','lib.php',841],['grade/grading/form/rubric','edit_form.php',136],['mod/feedback/item/multichoicerated','multichoicerated_form.php',93],['mod/scorm','mod_form.php',514],['lib/classes/event','base.php',564],['mod/feedback','mod_form.php',163],['mod/feedback/item/multichoice','multichoice_form.php',93],['grade/export','grade_export_form.php',206],['lib/simplepie/library/SimplePie','Parser.php',263],['lib','completionlib.php',882],['lib','formslib.php',584],['mod/workshop','locallib.php',3815],['mod/glossary','mod_form.php',203],['mod/feedback/item/textfield','textfield_form.php',57],['blocks/rss_client','editfeed.php',101],['admin/tool/filetypes','edit_form.php',97],['mod/lesson','mod_form.php',383],['admin/tool/uploaduser','user_form.php',394],['admin/webservice','forms.php',299],['mod/feedback/item/numeric','numeric_form.php',60],['mod/feedback/item/multichoice','lib.php',87],['mod/choice','mod_form.php',128],['mod/feedback/item/textarea','textarea_form.php',57],['mod/forum','mod_form.php',270],['mod/feedback/item/textfield','lib.php',89],['mod/feedback/item/multichoicerated','lib.php',92],['admin/tool/uploadcourse/classes','course.php',269],['mod/feedback/item/label','lib.php',99],['mod/feedback/item/textarea','lib.php',92],['backup/util/structure','restore_path_element.class.php',118],['mod/feedback/item/numeric','lib.php',105],['mod/feedback/item/info','lib.php',76],['mod/feedback/item','feedback_item_class.php',37],['mod/feedback/item','feedback_item_class.php',149],['lib/classes/message/inbound','address_manager.php',361],['course','editsection_form.php',96],['message/tests','inbound_test.php',632]], 364],
'get_or_create_instance': ['get_or_create_instance', 'If instanceid is specified and grading instance exists and it is created by this rater for this item, this instance is returned. Otherwise new instance is created for the specified rater and itemid ', [['grade/grading/form','lib.php',514],['grade/grading/form/guide','lib.php',547],['grade/grading/form/rubric','lib.php',554]], 3],
'box': ['box', 'Outputs a box. ', [['lib','outputrenderers.php',2974]], 295],
'file_postupdate_standard_editor': ['file_postupdate_standard_editor', 'Prepares the content of the \'editor\' form element with embedded media files to be saved in database ', [['lib','filelib.php',202]], 44],
's': ['s', 'Count of attempts selected by $this->whichattempts ', [['mod/quiz/report/statistics/classes','calculated.php',91],['lib','weblib.php',84]], 988],
'update_record': ['update_record', 'Update a record in a table ', [['lib/dml','pgsql_native_moodle_database.php',1137],['lib/dml','oci_native_moodle_database.php',1355],['lib/dml','sqlsrv_native_moodle_database.php',1081],['lib/dml','mssql_native_moodle_database.php',1003],['lib/dml','mysqli_native_moodle_database.php',1397],['lib/dml/tests','dml_test.php',5430],['lib/dml','pdo_moodle_database.php',460]], 565],
'display_instances': ['display_instances', 'Displays for the student the list of instances or default content if no instances found ', [['grade/grading/form/guide','renderer.php',557],['grade/grading/form/rubric','renderer.php',409]], 2],
'get_current_instance': ['get_current_instance', 'Returns the current instance (either with status ACTIVE or NEEDUPDATE) for this definition for the specified $raterid and $itemid (if multiple raters are allowed, or only for $itemid otherwise). ', [['grade/grading/form','lib.php',380],['grade/grading/form','lib.php',819]], 8],
'close': ['close', 'Close the connection to the server ', [['lib/zend/Zend/Http/Client/Adapter','Socket.php',486],['lib/tests','completionlib_test.php',888],['lib/adodb','adodb.inc.php',2164],['lib/adodb','adodb.inc.php',2844],['lib/adodb','adodb.inc.php',3536],['lib','webdavlib.php',176],['admin/tool/uploaduser','locallib.php',149],['lib/dml','oci_native_moodle_recordset.php',80],['lib/tcpdf','tcpdf.php',2943],['lib/horde/framework/Horde/Imap/Client','Base.php',1846],['lib','excellib.class.php',93],['lib/zend/Zend/Http/Client/Adapter','Test.php',187],['lib/classes/dml','recordset_walk.php',153],['mod/assign/feedback/offline','importgradeslib.php',178],['lib/pear/Net','GeoIP.php',556],['backup/util/helper','backup_array_iterator.class.php',63],['lib/zend/Zend/Gdata/App','LoggingHttpClientAdapterSocket.php',109],['lib/zend/Zend/Http/Client/Adapter','Proxy.php',266],['lib/dml','mssql_native_moodle_recordset.php',87],['lib/pear/Auth','RADIUS.php',542],['lib/pear/Auth','RADIUS.php',703],['lib/pear/Auth','RADIUS.php',824],['lib/phpmailer','class.smtp.php',507],['lib/phpexcel/PHPExcel/Shared','ZipArchive.php',80],['lib/phpunit/classes','event_sink.php',39],['lib/zend/Zend/Http/Client/Adapter','Interface.php',73],['lib/dml','pgsql_native_moodle_recordset.php',104],['auth/fc','fcFPP.php',72],['lib/filestorage','zip_archive.php',183],['lib','odslib.class.php',71],['lib/horde/framework/Horde/Socket','Client.php',135],['question/engine/tests','helpers.php',1225],['grade','lib.php',323],['lib/dml','mysqli_native_moodle_recordset.php',86],['lib','csvlib.class.php',256],['lib/google/src/Google/Logger','File.php',130],['lib/horde/framework/Horde','Stream.php',585],['lib/phpunit/classes','phpmailer_sink.php',41],['lib/phpunit/classes','message_sink.php',39],['lib/zend/Zend/Http/Client/Adapter','Curl.php',460],['lib/dml','sqlsrv_native_moodle_recordset.php',133],['lib/zend/Zend/Service/WindowsAzure','SessionHandler.php',109],['backup/util/helper','backup_null_iterator.class.php',53],['grade/export','lib.php',662],['lib/dml','pdo_moodle_recordset.php',79]], 1036],
'sql_search_where': ['sql_search_where', 'Prepare the parts of the SQL WHERE statement to search for the given token ', [['grade/grading/form','lib.php',578],['grade/grading/form/guide','lib.php',606],['grade/grading/form/rubric','lib.php',613]], 1],
'get_status': ['get_status', 'Returns instance status ', [['grade/grading/form','lib.php',863],['completion/criteria','completion_criteria_grade.php',157],['backup/util/settings','base_setting.class.php',157],['completion/criteria','completion_criteria.php',235],['lib/classes/plugininfo','base.php',334],['completion','completion_criteria_completion.php',158],['completion/criteria','completion_criteria_date.php',134],['backup/controller','restore_controller.class.php',295],['backup/controller','backup_controller.class.php',285],['lib/filestorage','stored_file.php',777],['lib/filebrowser','virtual_root_file.php',281],['mod/workshop/allocation','lib.php',128],['lib/filebrowser','file_info.php',348],['lib/filebrowser','file_info_stored.php',321],['completion/criteria','completion_criteria_duration.php',180]], 89],
'get_coursemodule_from_id': ['get_coursemodule_from_id', 'Given an id of a course module, finds the coursemodule description ', [['lib','datalib.php',1269]], 212],
'json_encode': ['json_encode', 'encodes an arbitrary variable into JSON format ', [['lib/minify/lib','FirePHP.php',1124]], 247],
'get_default_options': ['get_default_options', 'Returns the default options for the guide display ', [['grade/grading/form/guide','lib.php',350],['grade/grading/form/rubric','lib.php',349]], 6],
'get_component': ['get_component', 'Returns gradable component name ', [['grade/grading/form','lib.php',111],['cache/classes','definition.php',633],['lib/classes/task','task_base.php',125],['comment','lib.php',971],['lib/filestorage','stored_file.php',661],['grade/grading','lib.php',126],['lib/filebrowser','virtual_root_file.php',191],['availability/classes','frontend.php',86]], 66],
'has_active_instances': ['has_active_instances', 'Returns true if there are already people who has been graded on this definition. In this case plugins may restrict changes of the grading definition ', [['grade/grading/form','lib.php',455]], 6],
'get_external_definition_details': ['get_external_definition_details', 'Overridden by sub classes that wish to make definition details available to web services. When not overridden, only definition data common to all grading methods is made available. When overriding, the return value should be an array containing one or more key/value pairs. These key/value pairs should match the definition returned by the get_definition() function. For examples, look at: $gradingform_rubric_controller->get_external_definition_details() $gradingform_guide_controller->get_external_definition_details() ', [['grade/grading/form','lib.php',689],['grade/grading/form/guide','lib.php',660],['grade/grading/form/rubric','lib.php',667]], 1],
'render_preview': ['render_preview', 'Returns the HTML code displaying the preview of the grading form ', [['grade/grading/form/guide','lib.php',492],['grade/grading/form/rubric','lib.php',496]], 8],
'get_grading_manager': ['get_grading_manager', 'Factory method returning an instance of the grading manager ', [['grade/grading','lib.php',27]], 37],
'get_area_title': ['get_area_title', 'Returns the localized title of the currently set area ', [['grade/grading','lib.php',202]], 8],
'delete_records': ['delete_records', 'Delete the records from a table where all the given conditions met. If conditions not specified, table is truncated. ', [['lib/dml','moodle_database.php',1815],['lib/dml','sqlite3_pdo_moodle_database.php',337]], 778],
'extend_settings_navigation': ['extend_settings_navigation', 'Extends the module settings navigation ', [['grade/grading/form','lib.php',219],['grade/grading/form/guide','lib.php',58],['grade/grading','lib.php',418],['grade/grading/form/rubric','lib.php',55]], 3],
'display_guide_mapping_explained': ['display_guide_mapping_explained', 'Generates and returns HTML code to display information box about how guide score is converted to the grade ', [['grade/grading/form/guide','renderer.php',625]], 1],
'file_rewrite_pluginfile_urls': ['file_rewrite_pluginfile_urls', 'Convert encoded URLs in $text from the @@PLUGINFILE@@/... form to an actual URL. ', [['lib','filelib.php',446]], 85],
'update_or_check_guide': ['update_or_check_guide', 'Either saves the guide definition into the database or check if it has been changed. ', [['grade/grading/form/guide','lib.php',110]], 2],
'get_context': ['get_context', '', [['availability/classes','info_module.php',72],['grade/grading/form','lib.php',102],['availability/tests/fixtures','mock_info.php',59],['lib/classes/event','base.php',544],['lib','modinfolib.php',1501],['mod/assign','locallib.php',1247],['enrol','locallib.php',906],['lib/tests/behat','behat_data_generators.php',718],['mod/quiz','attemptlib.php',220],['comment','lib.php',990],['availability/classes','info_section.php',55],['grade/grading','lib.php',107],['lib','badgeslib.php',157],['lib','coursecatlib.php',2255],['lib','coursecatlib.php',2951]], 676],
'get_formatted_description': ['get_formatted_description', 'Formats the definition description for display on page ', [['grade/grading/form','lib.php',368],['grade/grading/form/guide','lib.php',458],['grade/grading/form/rubric','lib.php',462]], 7],
'format_text': ['format_text', 'Given text in a variety of format codings, this function returns the text as safe HTML. ', [['lib','weblib.php',1115],['lib','tablelib.php',846],['lib','tablelib.php',1583],['lib','tablelib.php',1900],['question/type','questionbase.php',345],['lib/classes','grading_external.php',182]], 325],
'is_array': ['is_array', '', [], 1820],
'count': ['count', '', [], 3984],
'round': ['round', '', [], 903],
'array_pop': ['array_pop', '', [], 438],
'sort': ['sort', '', [], 224],
'array_key_exists': ['array_key_exists', '', [], 1539],
'substr': ['substr', '', [], 2883],
'copy': ['copy', '', [], 48],
'array_keys': ['array_keys', '', [], 1152],
'is_numeric': ['is_numeric', '', [], 723],
'strpos': ['strpos', '', [], 1623],
'defined': ['defined', '', [], 4098],
'preg_match': ['preg_match', '', [], 1317],
'reset': ['reset', '', [], 1070]};
CLASS_DATA={
'external_single_structure': ['external_single_structure', 'Associative array description class ', [['lib','externallib.php',475]], 238],
'external_value': ['external_value', 'Scalar value description class ', [['lib','externallib.php',441]], 1255],
'coding_exception': ['coding_exception', 'Exception indicating programming error, must be fixed by a programer. For example a core API might throw this type of exception if a plugin calls it incorrectly. ', [['lib','setuplib.php',214]], 867],
'external_format_value': ['external_format_value', 'A pre-filled external_value class for text format. ', [['lib','externallib.php',670]], 52],
'moodle_url': ['moodle_url', 'Class for creating and manipulating urls. ', [['lib','weblib.php',240]], 2887],
'external_multiple_structure': ['external_multiple_structure', 'Bulk array description class. ', [['lib','externallib.php',504]], 212],
'gradingform_guide_instance': ['gradingform_guide_instance', 'Class to manage one guide grading instance. Stores information and performs actions like update, copy, validate, submit, etc. ', [['grade/grading/form/guide','lib.php',714]], 1],
'html_writer': ['html_writer', 'Simple html output class ', [['lib','outputcomponents.php',1052]], 4832],
'gradingform_guide_controller': ['gradingform_guide_controller', 'This controller encapsulates the guide grading logic ', [['grade/grading/form/guide','lib.php',29]], 50],
'pix_icon': ['pix_icon', 'Data structure representing an icon. ', [['lib','outputcomponents.php',497]], 247],
'settings_navigation': ['settings_navigation', 'Class used to manage the settings option for the current page ', [['lib','navigationlib.php',3384]], 17]};
CONST_DATA={
'PARAM_INT': ['PARAM_INT', '', [['lib','moodlelib.php',156]], 2948],
'VALUE_OPTIONAL': ['VALUE_OPTIONAL', '', [['lib','moodlelib.php',337]], 409],
'PARAM_FLOAT': ['PARAM_FLOAT', '', [['lib','moodlelib.php',146]], 93],
'FORMAT_MOODLE': ['FORMAT_MOODLE', '', [['lib','weblib.php',42]], 378],
'IGNORE_MISSING': ['IGNORE_MISSING', '', [['lib','dmllib.php',48]], 204],
'PARAM_TEXT': ['PARAM_TEXT', '', [['lib','moodlelib.php',228]], 476],
'PARAM_RAW': ['PARAM_RAW', '', [['lib','moodlelib.php',193]], 692],
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',138],['','install.php',93],['lib','setup.php',386]], 3532],
'PARAM_BOOL': ['PARAM_BOOL', '', [['lib','moodlelib.php',108]], 502]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu May 28 19:17:31 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
