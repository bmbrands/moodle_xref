<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /enrol/manual/externallib.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Aug 11 10:00:09 2016 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='enrol/manual';
filename='externallib.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/enrol/manual/</a> -> <a href="externallib.php.html">externallib.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="externallib.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="externallib.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * External course participation api.</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * This api is mostly read only, the actual enrol and unenrol</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * support is in each enrol plugin.</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> *</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * @package    enrol_manual</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> * @category   external</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment"> * @copyright  2011 Jerome Mouneyrac</span>
<a name="l26"><span class="linenum">  26</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment"> */</span>
<a name="l28"><span class="linenum">  28</span></a>  
<a name="l29"><span class="linenum">  29</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die();
<a name="l30"><span class="linenum">  30</span></a>  
<a name="l31"><span class="linenum">  31</span></a>  require_once(&quot;<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a>/externallib.php&quot;);
<a name="l32"><span class="linenum">  32</span></a>  
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment">/**</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> * Manual enrolment external functions.</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> *</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment"> * @package    enrol_manual</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment"> * @category   external</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment"> * @copyright  2011 Jerome Mouneyrac</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l40"><span class="linenum">  40</span></a>  <span class="comment"> * @since Moodle 2.2</span>
<a name="l41"><span class="linenum">  41</span></a>  <span class="comment"> */</span>
<a name="l42"><span class="linenum">  42</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('enrol_manual_external')" href="../../_classes/enrol_manual_external.html" onMouseOver="classPopup(event,'enrol_manual_external')">enrol_manual_external</a> <span class="keyword">extends</span> <a class="class" onClick="logClass('external_api')" href="../../_classes/external_api.html" onMouseOver="classPopup(event,'external_api')">external_api</a> {
<a name="l43"><span class="linenum">  43</span></a>  
<a name="l44"><span class="linenum">  44</span></a>      <span class="comment">/**</span>
<a name="l45"><span class="linenum">  45</span></a>  <span class="comment">     * Returns description of method parameters.</span>
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment">     *</span>
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment">     * @return external_function_parameters</span>
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment">     * @since Moodle 2.2</span>
<a name="l49"><span class="linenum">  49</span></a>  <span class="comment">     */</span>
<a name="l50"><span class="linenum">  50</span></a>      public static function <a class="function" onClick="logFunction('enrol_users_parameters')" href="../../_functions/enrol_users_parameters.html" onMouseOver="funcPopup(event,'enrol_users_parameters')">enrol_users_parameters</a>() {
<a name="l51"><span class="linenum">  51</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_function_parameters')" href="../../_classes/external_function_parameters.html" onMouseOver="classPopup(event,'external_function_parameters')">external_function_parameters</a>(
<a name="l52"><span class="linenum">  52</span></a>                  array(
<a name="l53"><span class="linenum">  53</span></a>                      'enrolments' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_multiple_structure')" href="../../_classes/external_multiple_structure.html" onMouseOver="classPopup(event,'external_multiple_structure')">external_multiple_structure</a>(
<a name="l54"><span class="linenum">  54</span></a>                              <span class="keyword">new </span><a class="class" onClick="logClass('external_single_structure')" href="../../_classes/external_single_structure.html" onMouseOver="classPopup(event,'external_single_structure')">external_single_structure</a>(
<a name="l55"><span class="linenum">  55</span></a>                                      array(
<a name="l56"><span class="linenum">  56</span></a>                                          'roleid' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'Role to assign to the user'),
<a name="l57"><span class="linenum">  57</span></a>                                          'userid' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'The user that is going to be enrolled'),
<a name="l58"><span class="linenum">  58</span></a>                                          'courseid' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'The course to enrol the user role in'),
<a name="l59"><span class="linenum">  59</span></a>                                          'timestart' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'Timestamp when the enrolment start', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l60"><span class="linenum">  60</span></a>                                          'timeend' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'Timestamp when the enrolment end', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l61"><span class="linenum">  61</span></a>                                          'suspend' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'set to 1 to suspend the enrolment', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>)
<a name="l62"><span class="linenum">  62</span></a>                                      )
<a name="l63"><span class="linenum">  63</span></a>                              )
<a name="l64"><span class="linenum">  64</span></a>                      )
<a name="l65"><span class="linenum">  65</span></a>                  )
<a name="l66"><span class="linenum">  66</span></a>          );
<a name="l67"><span class="linenum">  67</span></a>      }
<a name="l68"><span class="linenum">  68</span></a>  
<a name="l69"><span class="linenum">  69</span></a>      <span class="comment">/**</span>
<a name="l70"><span class="linenum">  70</span></a>  <span class="comment">     * Enrolment of users.</span>
<a name="l71"><span class="linenum">  71</span></a>  <span class="comment">     *</span>
<a name="l72"><span class="linenum">  72</span></a>  <span class="comment">     * Function throw an exception at the first error encountered.</span>
<a name="l73"><span class="linenum">  73</span></a>  <span class="comment">     * @param array $enrolments  An array of user enrolment</span>
<a name="l74"><span class="linenum">  74</span></a>  <span class="comment">     * @since Moodle 2.2</span>
<a name="l75"><span class="linenum">  75</span></a>  <span class="comment">     */</span>
<a name="l76"><span class="linenum">  76</span></a>      public static function <a class="function" onClick="logFunction('enrol_users')" href="../../_functions/enrol_users.html" onMouseOver="funcPopup(event,'enrol_users')">enrol_users</a>(<a class="var it18211" onMouseOver="hilite(18211)" onMouseOut="lolite()" onClick="logVariable('enrolments')" href="../../_variables/enrolments.html">$enrolments</a>) {
<a name="l77"><span class="linenum">  77</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>;
<a name="l78"><span class="linenum">  78</span></a>  
<a name="l79"><span class="linenum">  79</span></a>          require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a> . '/enrollib.php');
<a name="l80"><span class="linenum">  80</span></a>  
<a name="l81"><span class="linenum">  81</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = self::<a class="function" onClick="logFunction('validate_parameters')" href="../../_functions/validate_parameters.html" onMouseOver="funcPopup(event,'validate_parameters')">validate_parameters</a>(self::<a class="function" onClick="logFunction('enrol_users_parameters')" href="../../_functions/enrol_users_parameters.html" onMouseOver="funcPopup(event,'enrol_users_parameters')">enrol_users_parameters</a>(),
<a name="l82"><span class="linenum">  82</span></a>                  array('enrolments' =&gt; <a class="var it18211" onMouseOver="hilite(18211)" onMouseOut="lolite()" onClick="logVariable('enrolments')" href="../../_variables/enrolments.html">$enrolments</a>));
<a name="l83"><span class="linenum">  83</span></a>  
<a name="l84"><span class="linenum">  84</span></a>          <a class="var it4224" onMouseOver="hilite(4224)" onMouseOut="lolite()" onClick="logVariable('transaction')" href="../../_variables/transaction.html">$transaction</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('start_delegated_transaction')" href="../../_functions/start_delegated_transaction.html" onMouseOver="funcPopup(event,'start_delegated_transaction')">start_delegated_transaction</a>(); <span class="comment">// Rollback all enrolment if an error occurs</span>
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment">                                                           // (except if the DB doesn't support it).</span>
<a name="l86"><span class="linenum">  86</span></a>  
<a name="l87"><span class="linenum">  87</span></a>  <span class="comment">        // Retrieve the manual enrolment plugin.</span>
<a name="l88"><span class="linenum">  88</span></a>          <a class="var it747" onMouseOver="hilite(747)" onMouseOut="lolite()" onClick="logVariable('enrol')" href="../../_variables/enrol.html">$enrol</a> = <a class="function" onClick="logFunction('enrol_get_plugin')" href="../../_functions/enrol_get_plugin.html" onMouseOver="funcPopup(event,'enrol_get_plugin')">enrol_get_plugin</a>('manual');
<a name="l89"><span class="linenum">  89</span></a>          if (empty(<a class="var it747" onMouseOver="hilite(747)" onMouseOut="lolite()" onClick="logVariable('enrol')" href="../../_variables/enrol.html">$enrol</a>)) {
<a name="l90"><span class="linenum">  90</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('manualpluginnotinstalled', 'enrol_manual');
<a name="l91"><span class="linenum">  91</span></a>          }
<a name="l92"><span class="linenum">  92</span></a>  
<a name="l93"><span class="linenum">  93</span></a>          foreach (<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['enrolments'] as <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>) {
<a name="l94"><span class="linenum">  94</span></a>  <span class="comment">            // Ensure the current user is allowed to run this function in the enrolment context.</span>
<a name="l95"><span class="linenum">  95</span></a>              <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_course')" href="../../_classes/context_course.html" onMouseOver="classPopup(event,'context_course')">context_course</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['courseid'], <a class="constant" onClick="logConstant('IGNORE_MISSING')" href="../../_constants/IGNORE_MISSING.html" onMouseOver="constPopup(event,'IGNORE_MISSING')">IGNORE_MISSING</a>);
<a name="l96"><span class="linenum">  96</span></a>              self::<a class="function" onClick="logFunction('validate_context')" href="../../_functions/validate_context.html" onMouseOver="funcPopup(event,'validate_context')">validate_context</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l97"><span class="linenum">  97</span></a>  
<a name="l98"><span class="linenum">  98</span></a>  <span class="comment">            // Check that the user has the permission to manual enrol.</span>
<a name="l99"><span class="linenum">  99</span></a>              <a class="function" onClick="logFunction('require_capability')" href="../../_functions/require_capability.html" onMouseOver="funcPopup(event,'require_capability')">require_capability</a>('enrol/manual:enrol', <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l100"><span class="linenum"> 100</span></a>  
<a name="l101"><span class="linenum"> 101</span></a>  <span class="comment">            // Throw an exception if user is not able to assign the role.</span>
<a name="l102"><span class="linenum"> 102</span></a>              <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('roles')" href="../../_variables/roles.html">$roles</a> = <a class="function" onClick="logFunction('get_assignable_roles')" href="../../_functions/get_assignable_roles.html" onMouseOver="funcPopup(event,'get_assignable_roles')">get_assignable_roles</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l103"><span class="linenum"> 103</span></a>              if (!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['roleid'], <a class="var it572" onMouseOver="hilite(572)" onMouseOut="lolite()" onClick="logVariable('roles')" href="../../_variables/roles.html">$roles</a>)) {
<a name="l104"><span class="linenum"> 104</span></a>                  <a class="var it25452" onMouseOver="hilite(25452)" onMouseOut="lolite()" onClick="logVariable('errorparams')" href="../../_variables/errorparams.html">$errorparams</a> = new stdClass();
<a name="l105"><span class="linenum"> 105</span></a>                  <a class="var it25452" onMouseOver="hilite(25452)" onMouseOut="lolite()" onClick="logVariable('errorparams')" href="../../_variables/errorparams.html">$errorparams</a>-&gt;<a onClick="logVariable('roleid')" class="var it44918" onMouseOver="hilite(44918)" onMouseOut="lolite()" href="../../_variables/roleid.html">roleid</a> = <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['roleid'];
<a name="l106"><span class="linenum"> 106</span></a>                  <a class="var it25452" onMouseOver="hilite(25452)" onMouseOut="lolite()" onClick="logVariable('errorparams')" href="../../_variables/errorparams.html">$errorparams</a>-&gt;<a onClick="logVariable('courseid')" class="var it44918" onMouseOver="hilite(44918)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a> = <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['courseid'];
<a name="l107"><span class="linenum"> 107</span></a>                  <a class="var it25452" onMouseOver="hilite(25452)" onMouseOut="lolite()" onClick="logVariable('errorparams')" href="../../_variables/errorparams.html">$errorparams</a>-&gt;<a onClick="logVariable('userid')" class="var it44918" onMouseOver="hilite(44918)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> = <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['userid'];
<a name="l108"><span class="linenum"> 108</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('wsusercannotassign', 'enrol_manual', '', <a class="var it25452" onMouseOver="hilite(25452)" onMouseOut="lolite()" onClick="logVariable('errorparams')" href="../../_variables/errorparams.html">$errorparams</a>);
<a name="l109"><span class="linenum"> 109</span></a>              }
<a name="l110"><span class="linenum"> 110</span></a>  
<a name="l111"><span class="linenum"> 111</span></a>  <span class="comment">            // Check manual enrolment plugin instance is enabled/exist.</span>
<a name="l112"><span class="linenum"> 112</span></a>              <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a> = null;
<a name="l113"><span class="linenum"> 113</span></a>              <a class="var it8379" onMouseOver="hilite(8379)" onMouseOut="lolite()" onClick="logVariable('enrolinstances')" href="../../_variables/enrolinstances.html">$enrolinstances</a> = <a class="function" onClick="logFunction('enrol_get_instances')" href="../../_functions/enrol_get_instances.html" onMouseOver="funcPopup(event,'enrol_get_instances')">enrol_get_instances</a>(<a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['courseid'], true);
<a name="l114"><span class="linenum"> 114</span></a>              foreach (<a class="var it8379" onMouseOver="hilite(8379)" onMouseOut="lolite()" onClick="logVariable('enrolinstances')" href="../../_variables/enrolinstances.html">$enrolinstances</a> as <a class="var it8380" onMouseOver="hilite(8380)" onMouseOut="lolite()" onClick="logVariable('courseenrolinstance')" href="../../_variables/courseenrolinstance.html">$courseenrolinstance</a>) {
<a name="l115"><span class="linenum"> 115</span></a>                if (<a class="var it8380" onMouseOver="hilite(8380)" onMouseOut="lolite()" onClick="logVariable('courseenrolinstance')" href="../../_variables/courseenrolinstance.html">$courseenrolinstance</a>-&gt;<a onClick="logVariable('enrol')" class="var it43564" onMouseOver="hilite(43564)" onMouseOut="lolite()" href="../../_variables/enrol.html">enrol</a> == &quot;manual&quot;) {
<a name="l116"><span class="linenum"> 116</span></a>                    <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a> = <a class="var it8380" onMouseOver="hilite(8380)" onMouseOut="lolite()" onClick="logVariable('courseenrolinstance')" href="../../_variables/courseenrolinstance.html">$courseenrolinstance</a>;
<a name="l117"><span class="linenum"> 117</span></a>                    break;
<a name="l118"><span class="linenum"> 118</span></a>                }
<a name="l119"><span class="linenum"> 119</span></a>              }
<a name="l120"><span class="linenum"> 120</span></a>              if (empty(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>)) {
<a name="l121"><span class="linenum"> 121</span></a>                <a class="var it25452" onMouseOver="hilite(25452)" onMouseOut="lolite()" onClick="logVariable('errorparams')" href="../../_variables/errorparams.html">$errorparams</a> = new stdClass();
<a name="l122"><span class="linenum"> 122</span></a>                <a class="var it25452" onMouseOver="hilite(25452)" onMouseOut="lolite()" onClick="logVariable('errorparams')" href="../../_variables/errorparams.html">$errorparams</a>-&gt;<a onClick="logVariable('courseid')" class="var it44918" onMouseOver="hilite(44918)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a> = <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['courseid'];
<a name="l123"><span class="linenum"> 123</span></a>                throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('wsnoinstance', 'enrol_manual', <a class="var it25452" onMouseOver="hilite(25452)" onMouseOut="lolite()" onClick="logVariable('errorparams')" href="../../_variables/errorparams.html">$errorparams</a>);
<a name="l124"><span class="linenum"> 124</span></a>              }
<a name="l125"><span class="linenum"> 125</span></a>  
<a name="l126"><span class="linenum"> 126</span></a>  <span class="comment">            // Check that the plugin accept enrolment (it should always the case, it's hard coded in the plugin).</span>
<a name="l127"><span class="linenum"> 127</span></a>              if (!<a class="var it747" onMouseOver="hilite(747)" onMouseOut="lolite()" onClick="logVariable('enrol')" href="../../_variables/enrol.html">$enrol</a>-&gt;<a class="function" onClick="logFunction('allow_enrol')" href="../../_functions/allow_enrol.html" onMouseOver="funcPopup(event,'allow_enrol')">allow_enrol</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>)) {
<a name="l128"><span class="linenum"> 128</span></a>                  <a class="var it25452" onMouseOver="hilite(25452)" onMouseOut="lolite()" onClick="logVariable('errorparams')" href="../../_variables/errorparams.html">$errorparams</a> = new stdClass();
<a name="l129"><span class="linenum"> 129</span></a>                  <a class="var it25452" onMouseOver="hilite(25452)" onMouseOut="lolite()" onClick="logVariable('errorparams')" href="../../_variables/errorparams.html">$errorparams</a>-&gt;<a onClick="logVariable('roleid')" class="var it44918" onMouseOver="hilite(44918)" onMouseOut="lolite()" href="../../_variables/roleid.html">roleid</a> = <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['roleid'];
<a name="l130"><span class="linenum"> 130</span></a>                  <a class="var it25452" onMouseOver="hilite(25452)" onMouseOut="lolite()" onClick="logVariable('errorparams')" href="../../_variables/errorparams.html">$errorparams</a>-&gt;<a onClick="logVariable('courseid')" class="var it44918" onMouseOver="hilite(44918)" onMouseOut="lolite()" href="../../_variables/courseid.html">courseid</a> = <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['courseid'];
<a name="l131"><span class="linenum"> 131</span></a>                  <a class="var it25452" onMouseOver="hilite(25452)" onMouseOut="lolite()" onClick="logVariable('errorparams')" href="../../_variables/errorparams.html">$errorparams</a>-&gt;<a onClick="logVariable('userid')" class="var it44918" onMouseOver="hilite(44918)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> = <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['userid'];
<a name="l132"><span class="linenum"> 132</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('wscannotenrol', 'enrol_manual', '', <a class="var it25452" onMouseOver="hilite(25452)" onMouseOut="lolite()" onClick="logVariable('errorparams')" href="../../_variables/errorparams.html">$errorparams</a>);
<a name="l133"><span class="linenum"> 133</span></a>              }
<a name="l134"><span class="linenum"> 134</span></a>  
<a name="l135"><span class="linenum"> 135</span></a>  <span class="comment">            // Finally proceed the enrolment.</span>
<a name="l136"><span class="linenum"> 136</span></a>              <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['timestart'] = isset(<a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['timestart']) ? <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['timestart'] : 0;
<a name="l137"><span class="linenum"> 137</span></a>              <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['timeend'] = isset(<a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['timeend']) ? <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['timeend'] : 0;
<a name="l138"><span class="linenum"> 138</span></a>              <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['status'] = (isset(<a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['suspend']) &amp;&amp; !empty(<a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['suspend'])) ?
<a name="l139"><span class="linenum"> 139</span></a>                      <a class="constant" onClick="logConstant('ENROL_USER_SUSPENDED')" href="../../_constants/ENROL_USER_SUSPENDED.html" onMouseOver="constPopup(event,'ENROL_USER_SUSPENDED')">ENROL_USER_SUSPENDED</a> : <a class="constant" onClick="logConstant('ENROL_USER_ACTIVE')" href="../../_constants/ENROL_USER_ACTIVE.html" onMouseOver="constPopup(event,'ENROL_USER_ACTIVE')">ENROL_USER_ACTIVE</a>;
<a name="l140"><span class="linenum"> 140</span></a>  
<a name="l141"><span class="linenum"> 141</span></a>              <a class="var it747" onMouseOver="hilite(747)" onMouseOut="lolite()" onClick="logVariable('enrol')" href="../../_variables/enrol.html">$enrol</a>-&gt;<a class="function" onClick="logFunction('enrol_user')" href="../../_functions/enrol_user.html" onMouseOver="funcPopup(event,'enrol_user')">enrol_user</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>, <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['userid'], <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['roleid'],
<a name="l142"><span class="linenum"> 142</span></a>                      <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['timestart'], <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['timeend'], <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['status']);
<a name="l143"><span class="linenum"> 143</span></a>  
<a name="l144"><span class="linenum"> 144</span></a>          }
<a name="l145"><span class="linenum"> 145</span></a>  
<a name="l146"><span class="linenum"> 146</span></a>          <a class="var it4224" onMouseOver="hilite(4224)" onMouseOut="lolite()" onClick="logVariable('transaction')" href="../../_variables/transaction.html">$transaction</a>-&gt;<a class="function" onClick="logFunction('allow_commit')" href="../../_functions/allow_commit.html" onMouseOver="funcPopup(event,'allow_commit')">allow_commit</a>();
<a name="l147"><span class="linenum"> 147</span></a>      }
<a name="l148"><span class="linenum"> 148</span></a>  
<a name="l149"><span class="linenum"> 149</span></a>      <span class="comment">/**</span>
<a name="l150"><span class="linenum"> 150</span></a>  <span class="comment">     * Returns description of method result value.</span>
<a name="l151"><span class="linenum"> 151</span></a>  <span class="comment">     *</span>
<a name="l152"><span class="linenum"> 152</span></a>  <span class="comment">     * @return null</span>
<a name="l153"><span class="linenum"> 153</span></a>  <span class="comment">     * @since Moodle 2.2</span>
<a name="l154"><span class="linenum"> 154</span></a>  <span class="comment">     */</span>
<a name="l155"><span class="linenum"> 155</span></a>      public static function <a class="function" onClick="logFunction('enrol_users_returns')" href="../../_functions/enrol_users_returns.html" onMouseOver="funcPopup(event,'enrol_users_returns')">enrol_users_returns</a>() {
<a name="l156"><span class="linenum"> 156</span></a>          return null;
<a name="l157"><span class="linenum"> 157</span></a>      }
<a name="l158"><span class="linenum"> 158</span></a>  
<a name="l159"><span class="linenum"> 159</span></a>      <span class="comment">/**</span>
<a name="l160"><span class="linenum"> 160</span></a>  <span class="comment">     * Returns description of method parameters.</span>
<a name="l161"><span class="linenum"> 161</span></a>  <span class="comment">     *</span>
<a name="l162"><span class="linenum"> 162</span></a>  <span class="comment">     * @return external_function_parameters</span>
<a name="l163"><span class="linenum"> 163</span></a>  <span class="comment">     */</span>
<a name="l164"><span class="linenum"> 164</span></a>      public static function <a class="function" onClick="logFunction('unenrol_users_parameters')" href="../../_functions/unenrol_users_parameters.html" onMouseOver="funcPopup(event,'unenrol_users_parameters')">unenrol_users_parameters</a>() {
<a name="l165"><span class="linenum"> 165</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('external_function_parameters')" href="../../_classes/external_function_parameters.html" onMouseOver="classPopup(event,'external_function_parameters')">external_function_parameters</a>(array(
<a name="l166"><span class="linenum"> 166</span></a>              'enrolments' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_multiple_structure')" href="../../_classes/external_multiple_structure.html" onMouseOver="classPopup(event,'external_multiple_structure')">external_multiple_structure</a>(
<a name="l167"><span class="linenum"> 167</span></a>                  <span class="keyword">new </span><a class="class" onClick="logClass('external_single_structure')" href="../../_classes/external_single_structure.html" onMouseOver="classPopup(event,'external_single_structure')">external_single_structure</a>(
<a name="l168"><span class="linenum"> 168</span></a>                      array(
<a name="l169"><span class="linenum"> 169</span></a>                          'userid' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'The user that is going to be unenrolled'),
<a name="l170"><span class="linenum"> 170</span></a>                          'courseid' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'The course to unenrol the user from'),
<a name="l171"><span class="linenum"> 171</span></a>                          'roleid' =&gt; <span class="keyword">new </span><a class="class" onClick="logClass('external_value')" href="../../_classes/external_value.html" onMouseOver="classPopup(event,'external_value')">external_value</a>(<a class="constant" onClick="logConstant('PARAM_INT')" href="../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>, 'The user role', <a class="constant" onClick="logConstant('VALUE_OPTIONAL')" href="../../_constants/VALUE_OPTIONAL.html" onMouseOver="constPopup(event,'VALUE_OPTIONAL')">VALUE_OPTIONAL</a>),
<a name="l172"><span class="linenum"> 172</span></a>                      )
<a name="l173"><span class="linenum"> 173</span></a>                  )
<a name="l174"><span class="linenum"> 174</span></a>              )
<a name="l175"><span class="linenum"> 175</span></a>          ));
<a name="l176"><span class="linenum"> 176</span></a>      }
<a name="l177"><span class="linenum"> 177</span></a>  
<a name="l178"><span class="linenum"> 178</span></a>      <span class="comment">/**</span>
<a name="l179"><span class="linenum"> 179</span></a>  <span class="comment">     * Unenrolment of users.</span>
<a name="l180"><span class="linenum"> 180</span></a>  <span class="comment">     *</span>
<a name="l181"><span class="linenum"> 181</span></a>  <span class="comment">     * @param array $enrolments an array of course user and role ids</span>
<a name="l182"><span class="linenum"> 182</span></a>  <span class="comment">     * @throws coding_exception</span>
<a name="l183"><span class="linenum"> 183</span></a>  <span class="comment">     * @throws dml_transaction_exception</span>
<a name="l184"><span class="linenum"> 184</span></a>  <span class="comment">     * @throws invalid_parameter_exception</span>
<a name="l185"><span class="linenum"> 185</span></a>  <span class="comment">     * @throws moodle_exception</span>
<a name="l186"><span class="linenum"> 186</span></a>  <span class="comment">     * @throws required_capability_exception</span>
<a name="l187"><span class="linenum"> 187</span></a>  <span class="comment">     * @throws restricted_context_exception</span>
<a name="l188"><span class="linenum"> 188</span></a>  <span class="comment">     */</span>
<a name="l189"><span class="linenum"> 189</span></a>      public static function <a class="function" onClick="logFunction('unenrol_users')" href="../../_functions/unenrol_users.html" onMouseOver="funcPopup(event,'unenrol_users')">unenrol_users</a>(<a class="var it18211" onMouseOver="hilite(18211)" onMouseOut="lolite()" onClick="logVariable('enrolments')" href="../../_variables/enrolments.html">$enrolments</a>) {
<a name="l190"><span class="linenum"> 190</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l191"><span class="linenum"> 191</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = self::<a class="function" onClick="logFunction('validate_parameters')" href="../../_functions/validate_parameters.html" onMouseOver="funcPopup(event,'validate_parameters')">validate_parameters</a>(self::<a class="function" onClick="logFunction('unenrol_users_parameters')" href="../../_functions/unenrol_users_parameters.html" onMouseOver="funcPopup(event,'unenrol_users_parameters')">unenrol_users_parameters</a>(), array('enrolments' =&gt; <a class="var it18211" onMouseOver="hilite(18211)" onMouseOut="lolite()" onClick="logVariable('enrolments')" href="../../_variables/enrolments.html">$enrolments</a>));
<a name="l192"><span class="linenum"> 192</span></a>          require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('libdir')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../../_variables/libdir.html">libdir</a> . '/enrollib.php');
<a name="l193"><span class="linenum"> 193</span></a>          <a class="var it4224" onMouseOver="hilite(4224)" onMouseOut="lolite()" onClick="logVariable('transaction')" href="../../_variables/transaction.html">$transaction</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('start_delegated_transaction')" href="../../_functions/start_delegated_transaction.html" onMouseOver="funcPopup(event,'start_delegated_transaction')">start_delegated_transaction</a>(); <span class="comment">// Rollback all enrolment if an error occurs.</span>
<a name="l194"><span class="linenum"> 194</span></a>          <a class="var it747" onMouseOver="hilite(747)" onMouseOut="lolite()" onClick="logVariable('enrol')" href="../../_variables/enrol.html">$enrol</a> = <a class="function" onClick="logFunction('enrol_get_plugin')" href="../../_functions/enrol_get_plugin.html" onMouseOver="funcPopup(event,'enrol_get_plugin')">enrol_get_plugin</a>('manual');
<a name="l195"><span class="linenum"> 195</span></a>          if (empty(<a class="var it747" onMouseOver="hilite(747)" onMouseOut="lolite()" onClick="logVariable('enrol')" href="../../_variables/enrol.html">$enrol</a>)) {
<a name="l196"><span class="linenum"> 196</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('manualpluginnotinstalled', 'enrol_manual');
<a name="l197"><span class="linenum"> 197</span></a>          }
<a name="l198"><span class="linenum"> 198</span></a>  
<a name="l199"><span class="linenum"> 199</span></a>          foreach (<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['enrolments'] as <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>) {
<a name="l200"><span class="linenum"> 200</span></a>              <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a> = <a class="class" onClick="logClass('context_course')" href="../../_classes/context_course.html" onMouseOver="classPopup(event,'context_course')">context_course</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['courseid']);
<a name="l201"><span class="linenum"> 201</span></a>              self::<a class="function" onClick="logFunction('validate_context')" href="../../_functions/validate_context.html" onMouseOver="funcPopup(event,'validate_context')">validate_context</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l202"><span class="linenum"> 202</span></a>              <a class="function" onClick="logFunction('require_capability')" href="../../_functions/require_capability.html" onMouseOver="funcPopup(event,'require_capability')">require_capability</a>('enrol/manual:unenrol', <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l203"><span class="linenum"> 203</span></a>              <a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('enrol', array('courseid' =&gt; <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['courseid'], 'enrol' =&gt; 'manual'));
<a name="l204"><span class="linenum"> 204</span></a>              if (!<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>) {
<a name="l205"><span class="linenum"> 205</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('wsnoinstance', 'enrol_manual', <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>);
<a name="l206"><span class="linenum"> 206</span></a>              }
<a name="l207"><span class="linenum"> 207</span></a>              <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user', array('id' =&gt; <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['userid']));
<a name="l208"><span class="linenum"> 208</span></a>              if (!<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../../_variables/user.html">$user</a>) {
<a name="l209"><span class="linenum"> 209</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('invalid_parameter_exception')" href="../../_classes/invalid_parameter_exception.html" onMouseOver="classPopup(event,'invalid_parameter_exception')">invalid_parameter_exception</a>('User id not exist: '.<a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['userid']);
<a name="l210"><span class="linenum"> 210</span></a>              }
<a name="l211"><span class="linenum"> 211</span></a>              if (!<a class="var it747" onMouseOver="hilite(747)" onMouseOut="lolite()" onClick="logVariable('enrol')" href="../../_variables/enrol.html">$enrol</a>-&gt;<a class="function" onClick="logFunction('allow_unenrol')" href="../../_functions/allow_unenrol.html" onMouseOver="funcPopup(event,'allow_unenrol')">allow_unenrol</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>)) {
<a name="l212"><span class="linenum"> 212</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('wscannotunenrol', 'enrol_manual', '', <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>);
<a name="l213"><span class="linenum"> 213</span></a>              }
<a name="l214"><span class="linenum"> 214</span></a>              <a class="var it747" onMouseOver="hilite(747)" onMouseOut="lolite()" onClick="logVariable('enrol')" href="../../_variables/enrol.html">$enrol</a>-&gt;<a class="function" onClick="logFunction('unenrol_user')" href="../../_functions/unenrol_user.html" onMouseOver="funcPopup(event,'unenrol_user')">unenrol_user</a>(<a class="var it427" onMouseOver="hilite(427)" onMouseOut="lolite()" onClick="logVariable('instance')" href="../../_variables/instance.html">$instance</a>, <a class="var it15413" onMouseOver="hilite(15413)" onMouseOut="lolite()" onClick="logVariable('enrolment')" href="../../_variables/enrolment.html">$enrolment</a>['userid']);
<a name="l215"><span class="linenum"> 215</span></a>          }
<a name="l216"><span class="linenum"> 216</span></a>          <a class="var it4224" onMouseOver="hilite(4224)" onMouseOut="lolite()" onClick="logVariable('transaction')" href="../../_variables/transaction.html">$transaction</a>-&gt;<a class="function" onClick="logFunction('allow_commit')" href="../../_functions/allow_commit.html" onMouseOver="funcPopup(event,'allow_commit')">allow_commit</a>();
<a name="l217"><span class="linenum"> 217</span></a>      }
<a name="l218"><span class="linenum"> 218</span></a>  
<a name="l219"><span class="linenum"> 219</span></a>      <span class="comment">/**</span>
<a name="l220"><span class="linenum"> 220</span></a>  <span class="comment">     * Returns description of method result value.</span>
<a name="l221"><span class="linenum"> 221</span></a>  <span class="comment">     *</span>
<a name="l222"><span class="linenum"> 222</span></a>  <span class="comment">     * @return null</span>
<a name="l223"><span class="linenum"> 223</span></a>  <span class="comment">     */</span>
<a name="l224"><span class="linenum"> 224</span></a>      public static function <a class="function" onClick="logFunction('unenrol_users_returns')" href="../../_functions/unenrol_users_returns.html" onMouseOver="funcPopup(event,'unenrol_users_returns')">unenrol_users_returns</a>() {
<a name="l225"><span class="linenum"> 225</span></a>          return null;
<a name="l226"><span class="linenum"> 226</span></a>      }
<a name="l227"><span class="linenum"> 227</span></a>  
<a name="l228"><span class="linenum"> 228</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'unenrol_user': ['unenrol_user', 'Unenrol user from course, the last unenrolment removes all remaining roles. ', [['lib','enrollib.php',1434],['enrol','locallib.php',641],['enrol/lti','lib.php',167],['enrol/mnet','enrol.php',198],['enrol/guest','lib.php',76]], 59],
'validate_parameters': ['validate_parameters', 'Validates submitted function parameters, if anything is incorrect invalid_parameter_exception is thrown. This is a simple recursive method which is intended to be called from each implementation method of external API. ', [['lib','externallib.php',279]], 340],
'validate_context': ['validate_context', 'Makes sure user may execute functions in this context. ', [['lib','externallib.php',448]], 256],
'enrol_user': ['enrol_user', 'Enrol user into course via enrol instance. ', [['enrol/flatfile','lib.php',144],['lib','enrollib.php',1270],['lib/testing/generator','data_generator.php',891],['enrol/lti/classes','helper.php',233],['enrol/self','externallib.php',122],['enrol/mnet','enrol.php',115],['enrol/guest','lib.php',60]], 745],
'allow_commit': ['allow_commit', 'Commit delegated transaction. The real database commit SQL is executed only after committing all delegated transactions. ', [['lib/dml','moodle_transaction.php',78]], 135],
'start_delegated_transaction': ['start_delegated_transaction', 'On DBs that support it, switch to transaction mode and begin a transaction you\'ll need to ensure you call allow_commit() on the returned object or your changes *will* be lost. ', [['lib/dml','moodle_database.php',2393]], 145],
'allow_unenrol': ['allow_unenrol', '', [['enrol/manual','lib.php',42],['enrol/flatfile','lib.php',59],['lib','enrollib.php',1190],['enrol/self','lib.php',101],['enrol/lti','lib.php',69],['enrol/paypal','lib.php',85]], 5],
'allow_enrol': ['allow_enrol', '', [['enrol/manual','lib.php',37],['lib','enrollib.php',1178]], 2],
'enrol_get_plugin': ['enrol_get_plugin', 'Returns instance of enrol plugin ', [['lib','enrollib.php',111]], 156],
'unenrol_users': ['unenrol_users', 'Unenrolment of users. ', [['enrol/manual','externallib.php',178]], 7],
'instance': ['instance', 'Returns an instance of the cache_factor method. ', [['cache','disabledlib.php',171],['cache','disabledlib.php',296],['lib/classes','useragent.php',101],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',80],['lib/htmlpurifier/HTMLPurifier','URISchemeRegistry.php',9],['search/classes','manager.php',109],['cache','locallib.php',52],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',53],['lib/classes','plugin_manager.php',103],['lib/htmlpurifier','HTMLPurifier.php',251],['course/format','lib.php',156],['lib/classes/update','checker.php',62],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',31],['admin/tool/installaddon/classes','installer.php',40],['lib','modinfolib.php',373],['cache/classes','helper.php',76],['lib/tests','string_manager_standard_test.php',124],['lib/portfolio','exporter.php',251],['lib/classes/update','validator.php',88],['search/classes','document_factory.php',49],['lib','accesslib.php',6235],['lib','accesslib.php',6487],['lib','accesslib.php',6665],['lib','accesslib.php',6919],['lib','accesslib.php',7180],['lib','accesslib.php',7392],['backup/cc/cc_lib','cc_utils.php',387],['backup/cc/cc_lib','cc_utils.php',443],['lib','filterlib.php',80],['search/tests/fixtures','testable_core_search.php',43],['lib/tests/fixtures','testable_update_checker.php',45],['backup/cc','validator.php',35],['cache/classes','config.php',87],['cache/classes','factory.php',114],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',29]], 4647],
'require_capability': ['require_capability', 'Wrapper round the require_capability funciton that automatically passes in the quiz context. ', [['mod/quiz','attemptlib.php',306],['mod/quiz','attemptlib.php',929],['lib','accesslib.php',762],['backup/util/ui','restore_ui_components.php',157]], 690],
'enrol_users_returns': ['enrol_users_returns', 'Returns description of method result value. ', [['enrol/manual','externallib.php',149]], 0],
'enrol_users': ['enrol_users', 'Enrolment of users. ', [['enrol/manual','externallib.php',69]], 4],
'unenrol_users_parameters': ['unenrol_users_parameters', 'Returns description of method parameters. ', [['enrol/manual','externallib.php',159]], 1],
'unenrol_users_returns': ['unenrol_users_returns', 'Returns description of method result value. ', [['enrol/manual','externallib.php',219]], 0],
'enrol_get_instances': ['enrol_get_instances', 'Returns enrolment instances in given course. ', [['lib','enrollib.php',140]], 33],
'enrol_users_parameters': ['enrol_users_parameters', 'Returns description of method parameters. ', [['enrol/manual','externallib.php',44]], 1],
'get_record': ['get_record', 'Load a single record. ', [['competency/classes','persistent.php',738],['lib/dml','moodle_database.php',1462]], 3224],
'get_assignable_roles': ['get_assignable_roles', 'Gets a list of roles that this user can assign in this context ', [['lib','accesslib.php',3415],['enrol','locallib.php',600]], 48],
'array_key_exists': ['array_key_exists', '', [], 1445],
'defined': ['defined', '', [], 4731]};
CLASS_DATA={
'external_function_parameters': ['external_function_parameters', 'Description of top level - PHP function parameters. ', [['lib','externallib.php',638]], 344],
'external_value': ['external_value', 'Scalar value description class ', [['lib','externallib.php',546]], 2505],
'invalid_parameter_exception': ['invalid_parameter_exception', 'Exception indicating malformed parameter problem. This exception is not supposed to be thrown when processing user submitted data in forms. It is more suitable for WS and other low level stuff. ', [['lib','setuplib.php',259]], 88],
'external_single_structure': ['external_single_structure', 'Associative array description class ', [['lib','externallib.php',580]], 460],
'external_api': ['external_api', 'Base class for external api methods. ', [['lib','externallib.php',47]], 808],
'moodle_exception': ['moodle_exception', 'Base Moodle Exception class ', [['lib','setuplib.php',75]], 606],
'context_course': ['context_course', 'Course context class ', [['lib','accesslib.php',6817]], 1323],
'external_multiple_structure': ['external_multiple_structure', 'Bulk array description class. ', [['lib','externallib.php',609]], 350],
'enrol_manual_external': ['enrol_manual_external', 'Manual enrolment external functions. ', [['enrol/manual','externallib.php',33]], 11]};
CONST_DATA={
'ENROL_USER_SUSPENDED': ['ENROL_USER_SUSPENDED', '', [['lib','enrollib.php',40]], 105],
'ENROL_USER_ACTIVE': ['ENROL_USER_ACTIVE', '', [['lib','enrollib.php',37]], 210],
'IGNORE_MISSING': ['IGNORE_MISSING', '', [['lib','dmllib.php',48]], 215],
'VALUE_OPTIONAL': ['VALUE_OPTIONAL', '', [['lib','moodlelib.php',337]], 761],
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',140],['','install.php',93],['lib','setup.php',391]], 4153],
'PARAM_INT': ['PARAM_INT', '', [['lib','moodlelib.php',156]], 3812]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Aug 11 10:00:09 2016</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
