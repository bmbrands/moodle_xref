<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /question/format.php source</title>
    <link rel="stylesheet" href="../sample.css" type="text/css">
    <link rel="stylesheet" href="../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Aug 11 10:00:09 2016 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../';
subdir='question';
filename='format.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/question/</a> -> <a href="format.php.html">format.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="format.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="format.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * Defines the base class for question import and export formats.</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * @package    moodlecore</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @subpackage questionbank</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @copyright  1999 onwards Martin Dougiamas {@link http://moodle.com}</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> */</span>
<a name="l25"><span class="linenum">  25</span></a>  
<a name="l26"><span class="linenum">  26</span></a>  
<a name="l27"><span class="linenum">  27</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die();
<a name="l28"><span class="linenum">  28</span></a>  
<a name="l29"><span class="linenum">  29</span></a>  
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment">/**</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment"> * Base class for question import and export formats.</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> *</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> * @copyright  1999 onwards Martin Dougiamas {@link http://moodle.com}</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> */</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('qformat_default')" href="../_classes/qformat_default.html" onMouseOver="classPopup(event,'qformat_default')">qformat_default</a> {
<a name="l37"><span class="linenum">  37</span></a>  
<a name="l38"><span class="linenum">  38</span></a>      public <a class="var it5858" onMouseOver="hilite(5858)" onMouseOut="lolite()" onClick="logVariable('displayerrors')" href="../_variables/displayerrors.html">$displayerrors</a> = true;
<a name="l39"><span class="linenum">  39</span></a>      public <a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a> = null;
<a name="l40"><span class="linenum">  40</span></a>      public <a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../_variables/questions.html">$questions</a> = array();
<a name="l41"><span class="linenum">  41</span></a>      public <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a> = null;
<a name="l42"><span class="linenum">  42</span></a>      public <a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../_variables/filename.html">$filename</a> = '';
<a name="l43"><span class="linenum">  43</span></a>      public <a class="var it5859" onMouseOver="hilite(5859)" onMouseOut="lolite()" onClick="logVariable('realfilename')" href="../_variables/realfilename.html">$realfilename</a> = '';
<a name="l44"><span class="linenum">  44</span></a>      public <a class="var it5860" onMouseOver="hilite(5860)" onMouseOut="lolite()" onClick="logVariable('matchgrades')" href="../_variables/matchgrades.html">$matchgrades</a> = 'error';
<a name="l45"><span class="linenum">  45</span></a>      public <a class="var it5861" onMouseOver="hilite(5861)" onMouseOut="lolite()" onClick="logVariable('catfromfile')" href="../_variables/catfromfile.html">$catfromfile</a> = 0;
<a name="l46"><span class="linenum">  46</span></a>      public <a class="var it5862" onMouseOver="hilite(5862)" onMouseOut="lolite()" onClick="logVariable('contextfromfile')" href="../_variables/contextfromfile.html">$contextfromfile</a> = 0;
<a name="l47"><span class="linenum">  47</span></a>      public <a class="var it5863" onMouseOver="hilite(5863)" onMouseOut="lolite()" onClick="logVariable('cattofile')" href="../_variables/cattofile.html">$cattofile</a> = 0;
<a name="l48"><span class="linenum">  48</span></a>      public <a class="var it5864" onMouseOver="hilite(5864)" onMouseOut="lolite()" onClick="logVariable('contexttofile')" href="../_variables/contexttofile.html">$contexttofile</a> = 0;
<a name="l49"><span class="linenum">  49</span></a>      public <a class="var it5865" onMouseOver="hilite(5865)" onMouseOut="lolite()" onClick="logVariable('questionids')" href="../_variables/questionids.html">$questionids</a> = array();
<a name="l50"><span class="linenum">  50</span></a>      public <a class="var it5866" onMouseOver="hilite(5866)" onMouseOut="lolite()" onClick="logVariable('importerrors')" href="../_variables/importerrors.html">$importerrors</a> = 0;
<a name="l51"><span class="linenum">  51</span></a>      public <a class="var it5867" onMouseOver="hilite(5867)" onMouseOut="lolite()" onClick="logVariable('stoponerror')" href="../_variables/stoponerror.html">$stoponerror</a> = true;
<a name="l52"><span class="linenum">  52</span></a>      public <a class="var it5868" onMouseOver="hilite(5868)" onMouseOut="lolite()" onClick="logVariable('translator')" href="../_variables/translator.html">$translator</a> = null;
<a name="l53"><span class="linenum">  53</span></a>      public <a class="var it5869" onMouseOver="hilite(5869)" onMouseOut="lolite()" onClick="logVariable('canaccessbackupdata')" href="../_variables/canaccessbackupdata.html">$canaccessbackupdata</a> = true;
<a name="l54"><span class="linenum">  54</span></a>  
<a name="l55"><span class="linenum">  55</span></a>      protected <a class="var it3494" onMouseOver="hilite(3494)" onMouseOut="lolite()" onClick="logVariable('importcontext')" href="../_variables/importcontext.html">$importcontext</a> = null;
<a name="l56"><span class="linenum">  56</span></a>  
<a name="l57"><span class="linenum">  57</span></a>  <span class="comment">    // functions to indicate import/export functionality</span>
<a name="l58"><span class="linenum">  58</span></a>  <span class="comment">    // override to return true if implemented</span>
<a name="l59"><span class="linenum">  59</span></a>  
<a name="l60"><span class="linenum">  60</span></a>  <span class="comment">    /** @return bool whether this plugin provides import functionality. */</span>
<a name="l61"><span class="linenum">  61</span></a>      public function <a class="function" onClick="logFunction('provide_import')" href="../_functions/provide_import.html" onMouseOver="funcPopup(event,'provide_import')">provide_import</a>() {
<a name="l62"><span class="linenum">  62</span></a>          return false;
<a name="l63"><span class="linenum">  63</span></a>      }
<a name="l64"><span class="linenum">  64</span></a>  
<a name="l65"><span class="linenum">  65</span></a>  <span class="comment">    /** @return bool whether this plugin provides export functionality. */</span>
<a name="l66"><span class="linenum">  66</span></a>      public function <a class="function" onClick="logFunction('provide_export')" href="../_functions/provide_export.html" onMouseOver="funcPopup(event,'provide_export')">provide_export</a>() {
<a name="l67"><span class="linenum">  67</span></a>          return false;
<a name="l68"><span class="linenum">  68</span></a>      }
<a name="l69"><span class="linenum">  69</span></a>  
<a name="l70"><span class="linenum">  70</span></a>  <span class="comment">    /** The string mime-type of the files that this plugin reads or writes. */</span>
<a name="l71"><span class="linenum">  71</span></a>      public function <a class="function" onClick="logFunction('mime_type')" href="../_functions/mime_type.html" onMouseOver="funcPopup(event,'mime_type')">mime_type</a>() {
<a name="l72"><span class="linenum">  72</span></a>          return <a class="function" onClick="logFunction('mimeinfo')" href="../_functions/mimeinfo.html" onMouseOver="funcPopup(event,'mimeinfo')">mimeinfo</a>('type', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('export_file_extension')" href="../_functions/export_file_extension.html" onMouseOver="funcPopup(event,'export_file_extension')">export_file_extension</a>());
<a name="l73"><span class="linenum">  73</span></a>      }
<a name="l74"><span class="linenum">  74</span></a>  
<a name="l75"><span class="linenum">  75</span></a>      <span class="comment">/**</span>
<a name="l76"><span class="linenum">  76</span></a>  <span class="comment">     * @return string the file extension (including .) that is normally used for</span>
<a name="l77"><span class="linenum">  77</span></a>  <span class="comment">     * files handled by this plugin.</span>
<a name="l78"><span class="linenum">  78</span></a>  <span class="comment">     */</span>
<a name="l79"><span class="linenum">  79</span></a>      public function <a class="function" onClick="logFunction('export_file_extension')" href="../_functions/export_file_extension.html" onMouseOver="funcPopup(event,'export_file_extension')">export_file_extension</a>() {
<a name="l80"><span class="linenum">  80</span></a>          return '.txt';
<a name="l81"><span class="linenum">  81</span></a>      }
<a name="l82"><span class="linenum">  82</span></a>  
<a name="l83"><span class="linenum">  83</span></a>      <span class="comment">/**</span>
<a name="l84"><span class="linenum">  84</span></a>  <span class="comment">     * Check if the given file is capable of being imported by this plugin.</span>
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment">     *</span>
<a name="l86"><span class="linenum">  86</span></a>  <span class="comment">     * Note that expensive or detailed integrity checks on the file should</span>
<a name="l87"><span class="linenum">  87</span></a>  <span class="comment">     * not be performed by this method. Simple file type or magic-number tests</span>
<a name="l88"><span class="linenum">  88</span></a>  <span class="comment">     * would be suitable.</span>
<a name="l89"><span class="linenum">  89</span></a>  <span class="comment">     *</span>
<a name="l90"><span class="linenum">  90</span></a>  <span class="comment">     * @param stored_file $file the file to check</span>
<a name="l91"><span class="linenum">  91</span></a>  <span class="comment">     * @return bool whether this plugin can import the file</span>
<a name="l92"><span class="linenum">  92</span></a>  <span class="comment">     */</span>
<a name="l93"><span class="linenum">  93</span></a>      public function <a class="function" onClick="logFunction('can_import_file')" href="../_functions/can_import_file.html" onMouseOver="funcPopup(event,'can_import_file')">can_import_file</a>(<a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a>) {
<a name="l94"><span class="linenum">  94</span></a>          return (<a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a>-&gt;<a class="function" onClick="logFunction('get_mimetype')" href="../_functions/get_mimetype.html" onMouseOver="funcPopup(event,'get_mimetype')">get_mimetype</a>() == <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('mime_type')" href="../_functions/mime_type.html" onMouseOver="funcPopup(event,'mime_type')">mime_type</a>());
<a name="l95"><span class="linenum">  95</span></a>      }
<a name="l96"><span class="linenum">  96</span></a>  
<a name="l97"><span class="linenum">  97</span></a>  <span class="comment">    // Accessor methods</span>
<a name="l98"><span class="linenum">  98</span></a>  
<a name="l99"><span class="linenum">  99</span></a>      <span class="comment">/**</span>
<a name="l100"><span class="linenum"> 100</span></a>  <span class="comment">     * set the category</span>
<a name="l101"><span class="linenum"> 101</span></a>  <span class="comment">     * @param object category the category object</span>
<a name="l102"><span class="linenum"> 102</span></a>  <span class="comment">     */</span>
<a name="l103"><span class="linenum"> 103</span></a>      public function <a class="function" onClick="logFunction('setCategory')" href="../_functions/setcategory.html" onMouseOver="funcPopup(event,'setcategory')">setCategory</a>(<a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a>) {
<a name="l104"><span class="linenum"> 104</span></a>          if (<a class="phpfunction" onClick="logFunction('count')" href="../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('questions')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/questions.html">questions</a>)) {
<a name="l105"><span class="linenum"> 105</span></a>              <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('You shouldn\'t call setCategory after setQuestions');
<a name="l106"><span class="linenum"> 106</span></a>          }
<a name="l107"><span class="linenum"> 107</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('category')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/category.html">category</a> = <a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a>;
<a name="l108"><span class="linenum"> 108</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('importcontext')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/importcontext.html">importcontext</a> = context::<a class="function" onClick="logFunction('instance_by_id')" href="../_functions/instance_by_id.html" onMouseOver="funcPopup(event,'instance_by_id')">instance_by_id</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('category')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/category.html">category</a>-&gt;contextid);
<a name="l109"><span class="linenum"> 109</span></a>      }
<a name="l110"><span class="linenum"> 110</span></a>  
<a name="l111"><span class="linenum"> 111</span></a>      <span class="comment">/**</span>
<a name="l112"><span class="linenum"> 112</span></a>  <span class="comment">     * Set the specific questions to export. Should not include questions with</span>
<a name="l113"><span class="linenum"> 113</span></a>  <span class="comment">     * parents (sub questions of cloze question type).</span>
<a name="l114"><span class="linenum"> 114</span></a>  <span class="comment">     * Only used for question export.</span>
<a name="l115"><span class="linenum"> 115</span></a>  <span class="comment">     * @param array of question objects</span>
<a name="l116"><span class="linenum"> 116</span></a>  <span class="comment">     */</span>
<a name="l117"><span class="linenum"> 117</span></a>      public function <a class="function" onClick="logFunction('setQuestions')" href="../_functions/setquestions.html" onMouseOver="funcPopup(event,'setquestions')">setQuestions</a>(<a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../_variables/questions.html">$questions</a>) {
<a name="l118"><span class="linenum"> 118</span></a>          if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('category')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/category.html">category</a> !== null) {
<a name="l119"><span class="linenum"> 119</span></a>              <a class="function" onClick="logFunction('debugging')" href="../_functions/debugging.html" onMouseOver="funcPopup(event,'debugging')">debugging</a>('You shouldn\'t call setQuestions after setCategory');
<a name="l120"><span class="linenum"> 120</span></a>          }
<a name="l121"><span class="linenum"> 121</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('questions')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/questions.html">questions</a> = <a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../_variables/questions.html">$questions</a>;
<a name="l122"><span class="linenum"> 122</span></a>      }
<a name="l123"><span class="linenum"> 123</span></a>  
<a name="l124"><span class="linenum"> 124</span></a>      <span class="comment">/**</span>
<a name="l125"><span class="linenum"> 125</span></a>  <span class="comment">     * set the course class variable</span>
<a name="l126"><span class="linenum"> 126</span></a>  <span class="comment">     * @param course object Moodle course variable</span>
<a name="l127"><span class="linenum"> 127</span></a>  <span class="comment">     */</span>
<a name="l128"><span class="linenum"> 128</span></a>      public function <a class="function" onClick="logFunction('setCourse')" href="../_functions/setcourse.html" onMouseOver="funcPopup(event,'setcourse')">setCourse</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>) {
<a name="l129"><span class="linenum"> 129</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('course')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/course.html">course</a> = <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>;
<a name="l130"><span class="linenum"> 130</span></a>      }
<a name="l131"><span class="linenum"> 131</span></a>  
<a name="l132"><span class="linenum"> 132</span></a>      <span class="comment">/**</span>
<a name="l133"><span class="linenum"> 133</span></a>  <span class="comment">     * set an array of contexts.</span>
<a name="l134"><span class="linenum"> 134</span></a>  <span class="comment">     * @param array $contexts Moodle course variable</span>
<a name="l135"><span class="linenum"> 135</span></a>  <span class="comment">     */</span>
<a name="l136"><span class="linenum"> 136</span></a>      public function <a class="function" onClick="logFunction('setContexts')" href="../_functions/setcontexts.html" onMouseOver="funcPopup(event,'setcontexts')">setContexts</a>(<a class="var it2537" onMouseOver="hilite(2537)" onMouseOut="lolite()" onClick="logVariable('contexts')" href="../_variables/contexts.html">$contexts</a>) {
<a name="l137"><span class="linenum"> 137</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('contexts')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/contexts.html">contexts</a> = <a class="var it2537" onMouseOver="hilite(2537)" onMouseOut="lolite()" onClick="logVariable('contexts')" href="../_variables/contexts.html">$contexts</a>;
<a name="l138"><span class="linenum"> 138</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('translator')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/translator.html">translator</a> = <span class="keyword">new </span><a class="class" onClick="logClass('context_to_string_translator')" href="../_classes/context_to_string_translator.html" onMouseOver="classPopup(event,'context_to_string_translator')">context_to_string_translator</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('contexts')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/contexts.html">contexts</a>);
<a name="l139"><span class="linenum"> 139</span></a>      }
<a name="l140"><span class="linenum"> 140</span></a>  
<a name="l141"><span class="linenum"> 141</span></a>      <span class="comment">/**</span>
<a name="l142"><span class="linenum"> 142</span></a>  <span class="comment">     * set the filename</span>
<a name="l143"><span class="linenum"> 143</span></a>  <span class="comment">     * @param string filename name of file to import/export</span>
<a name="l144"><span class="linenum"> 144</span></a>  <span class="comment">     */</span>
<a name="l145"><span class="linenum"> 145</span></a>      public function <a class="function" onClick="logFunction('setFilename')" href="../_functions/setfilename.html" onMouseOver="funcPopup(event,'setfilename')">setFilename</a>(<a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../_variables/filename.html">$filename</a>) {
<a name="l146"><span class="linenum"> 146</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('filename')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/filename.html">filename</a> = <a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../_variables/filename.html">$filename</a>;
<a name="l147"><span class="linenum"> 147</span></a>      }
<a name="l148"><span class="linenum"> 148</span></a>  
<a name="l149"><span class="linenum"> 149</span></a>      <span class="comment">/**</span>
<a name="l150"><span class="linenum"> 150</span></a>  <span class="comment">     * set the &quot;real&quot; filename</span>
<a name="l151"><span class="linenum"> 151</span></a>  <span class="comment">     * (this is what the user typed, regardless of wha happened next)</span>
<a name="l152"><span class="linenum"> 152</span></a>  <span class="comment">     * @param string realfilename name of file as typed by user</span>
<a name="l153"><span class="linenum"> 153</span></a>  <span class="comment">     */</span>
<a name="l154"><span class="linenum"> 154</span></a>      public function <a class="function" onClick="logFunction('setRealfilename')" href="../_functions/setrealfilename.html" onMouseOver="funcPopup(event,'setrealfilename')">setRealfilename</a>(<a class="var it5859" onMouseOver="hilite(5859)" onMouseOut="lolite()" onClick="logVariable('realfilename')" href="../_variables/realfilename.html">$realfilename</a>) {
<a name="l155"><span class="linenum"> 155</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('realfilename')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/realfilename.html">realfilename</a> = <a class="var it5859" onMouseOver="hilite(5859)" onMouseOut="lolite()" onClick="logVariable('realfilename')" href="../_variables/realfilename.html">$realfilename</a>;
<a name="l156"><span class="linenum"> 156</span></a>      }
<a name="l157"><span class="linenum"> 157</span></a>  
<a name="l158"><span class="linenum"> 158</span></a>      <span class="comment">/**</span>
<a name="l159"><span class="linenum"> 159</span></a>  <span class="comment">     * set matchgrades</span>
<a name="l160"><span class="linenum"> 160</span></a>  <span class="comment">     * @param string matchgrades error or nearest for grades</span>
<a name="l161"><span class="linenum"> 161</span></a>  <span class="comment">     */</span>
<a name="l162"><span class="linenum"> 162</span></a>      public function <a class="function" onClick="logFunction('setMatchgrades')" href="../_functions/setmatchgrades.html" onMouseOver="funcPopup(event,'setmatchgrades')">setMatchgrades</a>(<a class="var it5860" onMouseOver="hilite(5860)" onMouseOut="lolite()" onClick="logVariable('matchgrades')" href="../_variables/matchgrades.html">$matchgrades</a>) {
<a name="l163"><span class="linenum"> 163</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('matchgrades')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/matchgrades.html">matchgrades</a> = <a class="var it5860" onMouseOver="hilite(5860)" onMouseOut="lolite()" onClick="logVariable('matchgrades')" href="../_variables/matchgrades.html">$matchgrades</a>;
<a name="l164"><span class="linenum"> 164</span></a>      }
<a name="l165"><span class="linenum"> 165</span></a>  
<a name="l166"><span class="linenum"> 166</span></a>      <span class="comment">/**</span>
<a name="l167"><span class="linenum"> 167</span></a>  <span class="comment">     * set catfromfile</span>
<a name="l168"><span class="linenum"> 168</span></a>  <span class="comment">     * @param bool catfromfile allow categories embedded in import file</span>
<a name="l169"><span class="linenum"> 169</span></a>  <span class="comment">     */</span>
<a name="l170"><span class="linenum"> 170</span></a>      public function <a class="function" onClick="logFunction('setCatfromfile')" href="../_functions/setcatfromfile.html" onMouseOver="funcPopup(event,'setcatfromfile')">setCatfromfile</a>(<a class="var it5861" onMouseOver="hilite(5861)" onMouseOut="lolite()" onClick="logVariable('catfromfile')" href="../_variables/catfromfile.html">$catfromfile</a>) {
<a name="l171"><span class="linenum"> 171</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('catfromfile')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/catfromfile.html">catfromfile</a> = <a class="var it5861" onMouseOver="hilite(5861)" onMouseOut="lolite()" onClick="logVariable('catfromfile')" href="../_variables/catfromfile.html">$catfromfile</a>;
<a name="l172"><span class="linenum"> 172</span></a>      }
<a name="l173"><span class="linenum"> 173</span></a>  
<a name="l174"><span class="linenum"> 174</span></a>      <span class="comment">/**</span>
<a name="l175"><span class="linenum"> 175</span></a>  <span class="comment">     * set contextfromfile</span>
<a name="l176"><span class="linenum"> 176</span></a>  <span class="comment">     * @param bool $contextfromfile allow contexts embedded in import file</span>
<a name="l177"><span class="linenum"> 177</span></a>  <span class="comment">     */</span>
<a name="l178"><span class="linenum"> 178</span></a>      public function <a class="function" onClick="logFunction('setContextfromfile')" href="../_functions/setcontextfromfile.html" onMouseOver="funcPopup(event,'setcontextfromfile')">setContextfromfile</a>(<a class="var it5862" onMouseOver="hilite(5862)" onMouseOut="lolite()" onClick="logVariable('contextfromfile')" href="../_variables/contextfromfile.html">$contextfromfile</a>) {
<a name="l179"><span class="linenum"> 179</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('contextfromfile')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/contextfromfile.html">contextfromfile</a> = <a class="var it5862" onMouseOver="hilite(5862)" onMouseOut="lolite()" onClick="logVariable('contextfromfile')" href="../_variables/contextfromfile.html">$contextfromfile</a>;
<a name="l180"><span class="linenum"> 180</span></a>      }
<a name="l181"><span class="linenum"> 181</span></a>  
<a name="l182"><span class="linenum"> 182</span></a>      <span class="comment">/**</span>
<a name="l183"><span class="linenum"> 183</span></a>  <span class="comment">     * set cattofile</span>
<a name="l184"><span class="linenum"> 184</span></a>  <span class="comment">     * @param bool cattofile exports categories within export file</span>
<a name="l185"><span class="linenum"> 185</span></a>  <span class="comment">     */</span>
<a name="l186"><span class="linenum"> 186</span></a>      public function <a class="function" onClick="logFunction('setCattofile')" href="../_functions/setcattofile.html" onMouseOver="funcPopup(event,'setcattofile')">setCattofile</a>(<a class="var it5863" onMouseOver="hilite(5863)" onMouseOut="lolite()" onClick="logVariable('cattofile')" href="../_variables/cattofile.html">$cattofile</a>) {
<a name="l187"><span class="linenum"> 187</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('cattofile')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/cattofile.html">cattofile</a> = <a class="var it5863" onMouseOver="hilite(5863)" onMouseOut="lolite()" onClick="logVariable('cattofile')" href="../_variables/cattofile.html">$cattofile</a>;
<a name="l188"><span class="linenum"> 188</span></a>      }
<a name="l189"><span class="linenum"> 189</span></a>  
<a name="l190"><span class="linenum"> 190</span></a>      <span class="comment">/**</span>
<a name="l191"><span class="linenum"> 191</span></a>  <span class="comment">     * set contexttofile</span>
<a name="l192"><span class="linenum"> 192</span></a>  <span class="comment">     * @param bool cattofile exports categories within export file</span>
<a name="l193"><span class="linenum"> 193</span></a>  <span class="comment">     */</span>
<a name="l194"><span class="linenum"> 194</span></a>      public function <a class="function" onClick="logFunction('setContexttofile')" href="../_functions/setcontexttofile.html" onMouseOver="funcPopup(event,'setcontexttofile')">setContexttofile</a>(<a class="var it5864" onMouseOver="hilite(5864)" onMouseOut="lolite()" onClick="logVariable('contexttofile')" href="../_variables/contexttofile.html">$contexttofile</a>) {
<a name="l195"><span class="linenum"> 195</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('contexttofile')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/contexttofile.html">contexttofile</a> = <a class="var it5864" onMouseOver="hilite(5864)" onMouseOut="lolite()" onClick="logVariable('contexttofile')" href="../_variables/contexttofile.html">$contexttofile</a>;
<a name="l196"><span class="linenum"> 196</span></a>      }
<a name="l197"><span class="linenum"> 197</span></a>  
<a name="l198"><span class="linenum"> 198</span></a>      <span class="comment">/**</span>
<a name="l199"><span class="linenum"> 199</span></a>  <span class="comment">     * set stoponerror</span>
<a name="l200"><span class="linenum"> 200</span></a>  <span class="comment">     * @param bool stoponerror stops database write if any errors reported</span>
<a name="l201"><span class="linenum"> 201</span></a>  <span class="comment">     */</span>
<a name="l202"><span class="linenum"> 202</span></a>      public function <a class="function" onClick="logFunction('setStoponerror')" href="../_functions/setstoponerror.html" onMouseOver="funcPopup(event,'setstoponerror')">setStoponerror</a>(<a class="var it5867" onMouseOver="hilite(5867)" onMouseOut="lolite()" onClick="logVariable('stoponerror')" href="../_variables/stoponerror.html">$stoponerror</a>) {
<a name="l203"><span class="linenum"> 203</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stoponerror')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/stoponerror.html">stoponerror</a> = <a class="var it5867" onMouseOver="hilite(5867)" onMouseOut="lolite()" onClick="logVariable('stoponerror')" href="../_variables/stoponerror.html">$stoponerror</a>;
<a name="l204"><span class="linenum"> 204</span></a>      }
<a name="l205"><span class="linenum"> 205</span></a>  
<a name="l206"><span class="linenum"> 206</span></a>      <span class="comment">/**</span>
<a name="l207"><span class="linenum"> 207</span></a>  <span class="comment">     * @param bool $canaccess Whether the current use can access the backup data folder. Determines</span>
<a name="l208"><span class="linenum"> 208</span></a>  <span class="comment">     * where export files are saved.</span>
<a name="l209"><span class="linenum"> 209</span></a>  <span class="comment">     */</span>
<a name="l210"><span class="linenum"> 210</span></a>      public function <a class="function" onClick="logFunction('set_can_access_backupdata')" href="../_functions/set_can_access_backupdata.html" onMouseOver="funcPopup(event,'set_can_access_backupdata')">set_can_access_backupdata</a>(<a class="var it5870" onMouseOver="hilite(5870)" onMouseOut="lolite()" onClick="logVariable('canaccess')" href="../_variables/canaccess.html">$canaccess</a>) {
<a name="l211"><span class="linenum"> 211</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('canaccessbackupdata')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/canaccessbackupdata.html">canaccessbackupdata</a> = <a class="var it5870" onMouseOver="hilite(5870)" onMouseOut="lolite()" onClick="logVariable('canaccess')" href="../_variables/canaccess.html">$canaccess</a>;
<a name="l212"><span class="linenum"> 212</span></a>      }
<a name="l213"><span class="linenum"> 213</span></a>  
<a name="l214"><span class="linenum"> 214</span></a>      <span class="comment">/***********************</span>
<a name="l215"><span class="linenum"> 215</span></a>  <span class="comment">     * IMPORTING FUNCTIONS</span>
<a name="l216"><span class="linenum"> 216</span></a>  <span class="comment">     ***********************/</span>
<a name="l217"><span class="linenum"> 217</span></a>  
<a name="l218"><span class="linenum"> 218</span></a>      <span class="comment">/**</span>
<a name="l219"><span class="linenum"> 219</span></a>  <span class="comment">     * Handle parsing error</span>
<a name="l220"><span class="linenum"> 220</span></a>  <span class="comment">     */</span>
<a name="l221"><span class="linenum"> 221</span></a>      protected function <a class="function" onClick="logFunction('error')" href="../_functions/error.html" onMouseOver="funcPopup(event,'error')">error</a>(<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>, <a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../_variables/text.html">$text</a>='', <a class="var it546" onMouseOver="hilite(546)" onMouseOut="lolite()" onClick="logVariable('questionname')" href="../_variables/questionname.html">$questionname</a>='') {
<a name="l222"><span class="linenum"> 222</span></a>          <a class="var it5871" onMouseOver="hilite(5871)" onMouseOut="lolite()" onClick="logVariable('importerrorquestion')" href="../_variables/importerrorquestion.html">$importerrorquestion</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('importerrorquestion', 'question');
<a name="l223"><span class="linenum"> 223</span></a>  
<a name="l224"><span class="linenum"> 224</span></a>          echo &quot;&lt;div class=\&quot;importerror\&quot;&gt;\n&quot;;
<a name="l225"><span class="linenum"> 225</span></a>          echo &quot;&lt;strong&gt;{<a class="var it5871" onMouseOver="hilite(5871)" onMouseOut="lolite()" onClick="logVariable('importerrorquestion')" href="../_variables/importerrorquestion.html">$importerrorquestion</a>} {<a class="var it546" onMouseOver="hilite(546)" onMouseOut="lolite()" onClick="logVariable('questionname')" href="../_variables/questionname.html">$questionname</a>}&lt;/strong&gt;&quot;;
<a name="l226"><span class="linenum"> 226</span></a>          if (!empty(<a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../_variables/text.html">$text</a>)) {
<a name="l227"><span class="linenum"> 227</span></a>              <a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../_variables/text.html">$text</a> = <a class="function" onClick="logFunction('s')" href="../_functions/s.html" onMouseOver="funcPopup(event,'s')">s</a>(<a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../_variables/text.html">$text</a>);
<a name="l228"><span class="linenum"> 228</span></a>              echo &quot;&lt;blockquote&gt;{<a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../_variables/text.html">$text</a>}&lt;/blockquote&gt;\n&quot;;
<a name="l229"><span class="linenum"> 229</span></a>          }
<a name="l230"><span class="linenum"> 230</span></a>          echo &quot;&lt;strong&gt;{<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('message')" href="../_variables/message.html">$message</a>}&lt;/strong&gt;\n&quot;;
<a name="l231"><span class="linenum"> 231</span></a>          echo &quot;&lt;/div&gt;&quot;;
<a name="l232"><span class="linenum"> 232</span></a>  
<a name="l233"><span class="linenum"> 233</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('importerrors')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/importerrors.html">importerrors</a>++;
<a name="l234"><span class="linenum"> 234</span></a>      }
<a name="l235"><span class="linenum"> 235</span></a>  
<a name="l236"><span class="linenum"> 236</span></a>      <span class="comment">/**</span>
<a name="l237"><span class="linenum"> 237</span></a>  <span class="comment">     * Import for questiontype plugins</span>
<a name="l238"><span class="linenum"> 238</span></a>  <span class="comment">     * Do not override.</span>
<a name="l239"><span class="linenum"> 239</span></a>  <span class="comment">     * @param data mixed The segment of data containing the question</span>
<a name="l240"><span class="linenum"> 240</span></a>  <span class="comment">     * @param question object processed (so far) by standard import code if appropriate</span>
<a name="l241"><span class="linenum"> 241</span></a>  <span class="comment">     * @param extra mixed any additional format specific data that may be passed by the format</span>
<a name="l242"><span class="linenum"> 242</span></a>  <span class="comment">     * @param qtypehint hint about a question type from format</span>
<a name="l243"><span class="linenum"> 243</span></a>  <span class="comment">     * @return object question object suitable for save_options() or false if cannot handle</span>
<a name="l244"><span class="linenum"> 244</span></a>  <span class="comment">     */</span>
<a name="l245"><span class="linenum"> 245</span></a>      public function <a class="function" onClick="logFunction('try_importing_using_qtypes')" href="../_functions/try_importing_using_qtypes.html" onMouseOver="funcPopup(event,'try_importing_using_qtypes')">try_importing_using_qtypes</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>, <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a> = null, <a class="var it812" onMouseOver="hilite(812)" onMouseOut="lolite()" onClick="logVariable('extra')" href="../_variables/extra.html">$extra</a> = null,
<a name="l246"><span class="linenum"> 246</span></a>              <a class="var it5872" onMouseOver="hilite(5872)" onMouseOut="lolite()" onClick="logVariable('qtypehint')" href="../_variables/qtypehint.html">$qtypehint</a> = '') {
<a name="l247"><span class="linenum"> 247</span></a>  
<a name="l248"><span class="linenum"> 248</span></a>  <span class="comment">        // work out what format we are using</span>
<a name="l249"><span class="linenum"> 249</span></a>          <a class="var it5873" onMouseOver="hilite(5873)" onMouseOut="lolite()" onClick="logVariable('formatname')" href="../_variables/formatname.html">$formatname</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="phpfunction" onClick="logFunction('get_class')" href="../_functions/get_class.html" onMouseOver="phpfuncPopup(event,'get_class')">get_class</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>), <a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>('qformat_'));
<a name="l250"><span class="linenum"> 250</span></a>          <a class="var it559" onMouseOver="hilite(559)" onMouseOut="lolite()" onClick="logVariable('methodname')" href="../_variables/methodname.html">$methodname</a> = &quot;import_from_{<a class="var it5873" onMouseOver="hilite(5873)" onMouseOut="lolite()" onClick="logVariable('formatname')" href="../_variables/formatname.html">$formatname</a>}&quot;;
<a name="l251"><span class="linenum"> 251</span></a>  
<a name="l252"><span class="linenum"> 252</span></a>  <span class="comment">        //first try importing using a hint from format</span>
<a name="l253"><span class="linenum"> 253</span></a>          if (!empty(<a class="var it5872" onMouseOver="hilite(5872)" onMouseOut="lolite()" onClick="logVariable('qtypehint')" href="../_variables/qtypehint.html">$qtypehint</a>)) {
<a name="l254"><span class="linenum"> 254</span></a>              <a class="var it260" onMouseOver="hilite(260)" onMouseOut="lolite()" onClick="logVariable('qtype')" href="../_variables/qtype.html">$qtype</a> = question_bank::<a class="function" onClick="logFunction('get_qtype')" href="../_functions/get_qtype.html" onMouseOver="funcPopup(event,'get_qtype')">get_qtype</a>(<a class="var it5872" onMouseOver="hilite(5872)" onMouseOut="lolite()" onClick="logVariable('qtypehint')" href="../_variables/qtypehint.html">$qtypehint</a>, false);
<a name="l255"><span class="linenum"> 255</span></a>              if (<a class="phpfunction" onClick="logFunction('is_object')" href="../_functions/is_object.html" onMouseOver="phpfuncPopup(event,'is_object')">is_object</a>(<a class="var it260" onMouseOver="hilite(260)" onMouseOut="lolite()" onClick="logVariable('qtype')" href="../_variables/qtype.html">$qtype</a>) &amp;&amp; <a class="phpfunction" onClick="logFunction('method_exists')" href="../_functions/method_exists.html" onMouseOver="phpfuncPopup(event,'method_exists')">method_exists</a>(<a class="var it260" onMouseOver="hilite(260)" onMouseOut="lolite()" onClick="logVariable('qtype')" href="../_variables/qtype.html">$qtype</a>, <a class="var it559" onMouseOver="hilite(559)" onMouseOut="lolite()" onClick="logVariable('methodname')" href="../_variables/methodname.html">$methodname</a>)) {
<a name="l256"><span class="linenum"> 256</span></a>                  <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a> = <a class="var it260" onMouseOver="hilite(260)" onMouseOut="lolite()" onClick="logVariable('qtype')" href="../_variables/qtype.html">$qtype</a>-&gt;<a class="var it559" onMouseOver="hilite(559)" onMouseOut="lolite()" onClick="logVariable('methodname')" href="../_variables/methodname.html">$methodname</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>, <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>, <a class="var it812" onMouseOver="hilite(812)" onMouseOut="lolite()" onClick="logVariable('extra')" href="../_variables/extra.html">$extra</a>);
<a name="l257"><span class="linenum"> 257</span></a>                  if (<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>) {
<a name="l258"><span class="linenum"> 258</span></a>                      return <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>;
<a name="l259"><span class="linenum"> 259</span></a>                  }
<a name="l260"><span class="linenum"> 260</span></a>              }
<a name="l261"><span class="linenum"> 261</span></a>          }
<a name="l262"><span class="linenum"> 262</span></a>  
<a name="l263"><span class="linenum"> 263</span></a>  <span class="comment">        // loop through installed questiontypes checking for</span>
<a name="l264"><span class="linenum"> 264</span></a>  <span class="comment">        // function to handle this question</span>
<a name="l265"><span class="linenum"> 265</span></a>          foreach (question_bank::<a class="function" onClick="logFunction('get_all_qtypes')" href="../_functions/get_all_qtypes.html" onMouseOver="funcPopup(event,'get_all_qtypes')">get_all_qtypes</a>() as <a class="var it260" onMouseOver="hilite(260)" onMouseOut="lolite()" onClick="logVariable('qtype')" href="../_variables/qtype.html">$qtype</a>) {
<a name="l266"><span class="linenum"> 266</span></a>              if (<a class="phpfunction" onClick="logFunction('method_exists')" href="../_functions/method_exists.html" onMouseOver="phpfuncPopup(event,'method_exists')">method_exists</a>(<a class="var it260" onMouseOver="hilite(260)" onMouseOut="lolite()" onClick="logVariable('qtype')" href="../_variables/qtype.html">$qtype</a>, <a class="var it559" onMouseOver="hilite(559)" onMouseOut="lolite()" onClick="logVariable('methodname')" href="../_variables/methodname.html">$methodname</a>)) {
<a name="l267"><span class="linenum"> 267</span></a>                  if (<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a> = <a class="var it260" onMouseOver="hilite(260)" onMouseOut="lolite()" onClick="logVariable('qtype')" href="../_variables/qtype.html">$qtype</a>-&gt;<a class="var it559" onMouseOver="hilite(559)" onMouseOut="lolite()" onClick="logVariable('methodname')" href="../_variables/methodname.html">$methodname</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>, <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>, <a class="var it812" onMouseOver="hilite(812)" onMouseOut="lolite()" onClick="logVariable('extra')" href="../_variables/extra.html">$extra</a>)) {
<a name="l268"><span class="linenum"> 268</span></a>                      return <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>;
<a name="l269"><span class="linenum"> 269</span></a>                  }
<a name="l270"><span class="linenum"> 270</span></a>              }
<a name="l271"><span class="linenum"> 271</span></a>          }
<a name="l272"><span class="linenum"> 272</span></a>          return false;
<a name="l273"><span class="linenum"> 273</span></a>      }
<a name="l274"><span class="linenum"> 274</span></a>  
<a name="l275"><span class="linenum"> 275</span></a>      <span class="comment">/**</span>
<a name="l276"><span class="linenum"> 276</span></a>  <span class="comment">     * Perform any required pre-processing</span>
<a name="l277"><span class="linenum"> 277</span></a>  <span class="comment">     * @return bool success</span>
<a name="l278"><span class="linenum"> 278</span></a>  <span class="comment">     */</span>
<a name="l279"><span class="linenum"> 279</span></a>      public function <a class="function" onClick="logFunction('importpreprocess')" href="../_functions/importpreprocess.html" onMouseOver="funcPopup(event,'importpreprocess')">importpreprocess</a>() {
<a name="l280"><span class="linenum"> 280</span></a>          return true;
<a name="l281"><span class="linenum"> 281</span></a>      }
<a name="l282"><span class="linenum"> 282</span></a>  
<a name="l283"><span class="linenum"> 283</span></a>      <span class="comment">/**</span>
<a name="l284"><span class="linenum"> 284</span></a>  <span class="comment">     * Process the file</span>
<a name="l285"><span class="linenum"> 285</span></a>  <span class="comment">     * This method should not normally be overidden</span>
<a name="l286"><span class="linenum"> 286</span></a>  <span class="comment">     * @param object $category</span>
<a name="l287"><span class="linenum"> 287</span></a>  <span class="comment">     * @return bool success</span>
<a name="l288"><span class="linenum"> 288</span></a>  <span class="comment">     */</span>
<a name="l289"><span class="linenum"> 289</span></a>      public function <a class="function" onClick="logFunction('importprocess')" href="../_functions/importprocess.html" onMouseOver="funcPopup(event,'importprocess')">importprocess</a>(<a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a>) {
<a name="l290"><span class="linenum"> 290</span></a>          global <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>, <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>;
<a name="l291"><span class="linenum"> 291</span></a>  
<a name="l292"><span class="linenum"> 292</span></a>  <span class="comment">        // Raise time and memory, as importing can be quite intensive.</span>
<a name="l293"><span class="linenum"> 293</span></a>          <a class="class" onClick="logClass('core_php_time_limit')" href="../_classes/core_php_time_limit.html" onMouseOver="classPopup(event,'core_php_time_limit')">core_php_time_limit</a>::<a class="function" onClick="logFunction('raise')" href="../_functions/raise.html" onMouseOver="funcPopup(event,'raise')">raise</a>();
<a name="l294"><span class="linenum"> 294</span></a>          <a class="function" onClick="logFunction('raise_memory_limit')" href="../_functions/raise_memory_limit.html" onMouseOver="funcPopup(event,'raise_memory_limit')">raise_memory_limit</a>(<a class="constant" onClick="logConstant('MEMORY_EXTRA')" href="../_constants/MEMORY_EXTRA.html" onMouseOver="constPopup(event,'MEMORY_EXTRA')">MEMORY_EXTRA</a>);
<a name="l295"><span class="linenum"> 295</span></a>  
<a name="l296"><span class="linenum"> 296</span></a>  <span class="comment">        // STAGE 1: Parse the file</span>
<a name="l297"><span class="linenum"> 297</span></a>          echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('parsingquestions', 'question'), 'notifysuccess');
<a name="l298"><span class="linenum"> 298</span></a>  
<a name="l299"><span class="linenum"> 299</span></a>          if (! <a class="var it255" onMouseOver="hilite(255)" onMouseOut="lolite()" onClick="logVariable('lines')" href="../_variables/lines.html">$lines</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('readdata')" href="../_functions/readdata.html" onMouseOver="funcPopup(event,'readdata')">readdata</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('filename')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/filename.html">filename</a>)) {
<a name="l300"><span class="linenum"> 300</span></a>              echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('cannotread', 'question'));
<a name="l301"><span class="linenum"> 301</span></a>              return false;
<a name="l302"><span class="linenum"> 302</span></a>          }
<a name="l303"><span class="linenum"> 303</span></a>  
<a name="l304"><span class="linenum"> 304</span></a>          if (!<a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../_variables/questions.html">$questions</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('readquestions')" href="../_functions/readquestions.html" onMouseOver="funcPopup(event,'readquestions')">readquestions</a>(<a class="var it255" onMouseOver="hilite(255)" onMouseOut="lolite()" onClick="logVariable('lines')" href="../_variables/lines.html">$lines</a>)) {   // Extract all the questions
<a name="l305"><span class="linenum"> 305</span></a>              echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('noquestionsinfile', 'question'));
<a name="l306"><span class="linenum"> 306</span></a>              return false;
<a name="l307"><span class="linenum"> 307</span></a>          }
<a name="l308"><span class="linenum"> 308</span></a>  
<a name="l309"><span class="linenum"> 309</span></a>  <span class="comment">        // STAGE 2: Write data to database</span>
<a name="l310"><span class="linenum"> 310</span></a>          echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('importingquestions', 'question',
<a name="l311"><span class="linenum"> 311</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('count_questions')" href="../_functions/count_questions.html" onMouseOver="funcPopup(event,'count_questions')">count_questions</a>(<a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../_variables/questions.html">$questions</a>)), 'notifysuccess');
<a name="l312"><span class="linenum"> 312</span></a>  
<a name="l313"><span class="linenum"> 313</span></a>  <span class="comment">        // check for errors before we continue</span>
<a name="l314"><span class="linenum"> 314</span></a>          if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stoponerror')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/stoponerror.html">stoponerror</a> and (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('importerrors')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/importerrors.html">importerrors</a>&gt;0)) {
<a name="l315"><span class="linenum"> 315</span></a>              echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('importparseerror', 'question'));
<a name="l316"><span class="linenum"> 316</span></a>              return true;
<a name="l317"><span class="linenum"> 317</span></a>          }
<a name="l318"><span class="linenum"> 318</span></a>  
<a name="l319"><span class="linenum"> 319</span></a>  <span class="comment">        // get list of valid answer grades</span>
<a name="l320"><span class="linenum"> 320</span></a>          <a class="var it5874" onMouseOver="hilite(5874)" onMouseOut="lolite()" onClick="logVariable('gradeoptionsfull')" href="../_variables/gradeoptionsfull.html">$gradeoptionsfull</a> = question_bank::<a class="function" onClick="logFunction('fraction_options_full')" href="../_functions/fraction_options_full.html" onMouseOver="funcPopup(event,'fraction_options_full')">fraction_options_full</a>();
<a name="l321"><span class="linenum"> 321</span></a>  
<a name="l322"><span class="linenum"> 322</span></a>  <span class="comment">        // check answer grades are valid</span>
<a name="l323"><span class="linenum"> 323</span></a>  <span class="comment">        // (now need to do this here because of 'stop on error': MDL-10689)</span>
<a name="l324"><span class="linenum"> 324</span></a>          <a class="var it5875" onMouseOver="hilite(5875)" onMouseOut="lolite()" onClick="logVariable('gradeerrors')" href="../_variables/gradeerrors.html">$gradeerrors</a> = 0;
<a name="l325"><span class="linenum"> 325</span></a>          <a class="var it5876" onMouseOver="hilite(5876)" onMouseOut="lolite()" onClick="logVariable('goodquestions')" href="../_variables/goodquestions.html">$goodquestions</a> = array();
<a name="l326"><span class="linenum"> 326</span></a>          foreach (<a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../_variables/questions.html">$questions</a> as <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>) {
<a name="l327"><span class="linenum"> 327</span></a>              if (!empty(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('fraction')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/fraction.html">fraction</a>) and (<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('fraction')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/fraction.html">fraction</a>))) {
<a name="l328"><span class="linenum"> 328</span></a>                  <a class="var it5877" onMouseOver="hilite(5877)" onMouseOut="lolite()" onClick="logVariable('fractions')" href="../_variables/fractions.html">$fractions</a> = <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('fraction')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/fraction.html">fraction</a>;
<a name="l329"><span class="linenum"> 329</span></a>                  <a class="var it5878" onMouseOver="hilite(5878)" onMouseOut="lolite()" onClick="logVariable('invalidfractions')" href="../_variables/invalidfractions.html">$invalidfractions</a> = array();
<a name="l330"><span class="linenum"> 330</span></a>                  foreach (<a class="var it5877" onMouseOver="hilite(5877)" onMouseOut="lolite()" onClick="logVariable('fractions')" href="../_variables/fractions.html">$fractions</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it765" onMouseOver="hilite(765)" onMouseOut="lolite()" onClick="logVariable('fraction')" href="../_variables/fraction.html">$fraction</a>) {
<a name="l331"><span class="linenum"> 331</span></a>                      <a class="var it5879" onMouseOver="hilite(5879)" onMouseOut="lolite()" onClick="logVariable('newfraction')" href="../_variables/newfraction.html">$newfraction</a> = <a class="function" onClick="logFunction('match_grade_options')" href="../_functions/match_grade_options.html" onMouseOver="funcPopup(event,'match_grade_options')">match_grade_options</a>(<a class="var it5874" onMouseOver="hilite(5874)" onMouseOut="lolite()" onClick="logVariable('gradeoptionsfull')" href="../_variables/gradeoptionsfull.html">$gradeoptionsfull</a>, <a class="var it765" onMouseOver="hilite(765)" onMouseOut="lolite()" onClick="logVariable('fraction')" href="../_variables/fraction.html">$fraction</a>,
<a name="l332"><span class="linenum"> 332</span></a>                              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('matchgrades')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/matchgrades.html">matchgrades</a>);
<a name="l333"><span class="linenum"> 333</span></a>                      if (<a class="var it5879" onMouseOver="hilite(5879)" onMouseOut="lolite()" onClick="logVariable('newfraction')" href="../_variables/newfraction.html">$newfraction</a> === false) {
<a name="l334"><span class="linenum"> 334</span></a>                          <a class="var it5878" onMouseOver="hilite(5878)" onMouseOut="lolite()" onClick="logVariable('invalidfractions')" href="../_variables/invalidfractions.html">$invalidfractions</a>[] = <a class="var it765" onMouseOver="hilite(765)" onMouseOut="lolite()" onClick="logVariable('fraction')" href="../_variables/fraction.html">$fraction</a>;
<a name="l335"><span class="linenum"> 335</span></a>                      } else {
<a name="l336"><span class="linenum"> 336</span></a>                          <a class="var it5877" onMouseOver="hilite(5877)" onMouseOut="lolite()" onClick="logVariable('fractions')" href="../_variables/fractions.html">$fractions</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>] = <a class="var it5879" onMouseOver="hilite(5879)" onMouseOut="lolite()" onClick="logVariable('newfraction')" href="../_variables/newfraction.html">$newfraction</a>;
<a name="l337"><span class="linenum"> 337</span></a>                      }
<a name="l338"><span class="linenum"> 338</span></a>                  }
<a name="l339"><span class="linenum"> 339</span></a>                  if (<a class="var it5878" onMouseOver="hilite(5878)" onMouseOut="lolite()" onClick="logVariable('invalidfractions')" href="../_variables/invalidfractions.html">$invalidfractions</a>) {
<a name="l340"><span class="linenum"> 340</span></a>                      echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('invalidgrade', 'question',
<a name="l341"><span class="linenum"> 341</span></a>                              <a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(', ', <a class="var it5878" onMouseOver="hilite(5878)" onMouseOut="lolite()" onClick="logVariable('invalidfractions')" href="../_variables/invalidfractions.html">$invalidfractions</a>)));
<a name="l342"><span class="linenum"> 342</span></a>                      ++<a class="var it5875" onMouseOver="hilite(5875)" onMouseOut="lolite()" onClick="logVariable('gradeerrors')" href="../_variables/gradeerrors.html">$gradeerrors</a>;
<a name="l343"><span class="linenum"> 343</span></a>                      continue;
<a name="l344"><span class="linenum"> 344</span></a>                  } else {
<a name="l345"><span class="linenum"> 345</span></a>                      <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('fraction')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/fraction.html">fraction</a> = <a class="var it5877" onMouseOver="hilite(5877)" onMouseOut="lolite()" onClick="logVariable('fractions')" href="../_variables/fractions.html">$fractions</a>;
<a name="l346"><span class="linenum"> 346</span></a>                  }
<a name="l347"><span class="linenum"> 347</span></a>              }
<a name="l348"><span class="linenum"> 348</span></a>              <a class="var it5876" onMouseOver="hilite(5876)" onMouseOut="lolite()" onClick="logVariable('goodquestions')" href="../_variables/goodquestions.html">$goodquestions</a>[] = <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>;
<a name="l349"><span class="linenum"> 349</span></a>          }
<a name="l350"><span class="linenum"> 350</span></a>          <a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../_variables/questions.html">$questions</a> = <a class="var it5876" onMouseOver="hilite(5876)" onMouseOut="lolite()" onClick="logVariable('goodquestions')" href="../_variables/goodquestions.html">$goodquestions</a>;
<a name="l351"><span class="linenum"> 351</span></a>  
<a name="l352"><span class="linenum"> 352</span></a>  <span class="comment">        // check for errors before we continue</span>
<a name="l353"><span class="linenum"> 353</span></a>          if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stoponerror')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/stoponerror.html">stoponerror</a> &amp;&amp; <a class="var it5875" onMouseOver="hilite(5875)" onMouseOut="lolite()" onClick="logVariable('gradeerrors')" href="../_variables/gradeerrors.html">$gradeerrors</a> &gt; 0) {
<a name="l354"><span class="linenum"> 354</span></a>              return false;
<a name="l355"><span class="linenum"> 355</span></a>          }
<a name="l356"><span class="linenum"> 356</span></a>  
<a name="l357"><span class="linenum"> 357</span></a>  <span class="comment">        // count number of questions processed</span>
<a name="l358"><span class="linenum"> 358</span></a>          <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a> = 0;
<a name="l359"><span class="linenum"> 359</span></a>  
<a name="l360"><span class="linenum"> 360</span></a>          foreach (<a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../_variables/questions.html">$questions</a> as <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>) {   // Process and store each question
<a name="l361"><span class="linenum"> 361</span></a>              <a class="var it4224" onMouseOver="hilite(4224)" onMouseOut="lolite()" onClick="logVariable('transaction')" href="../_variables/transaction.html">$transaction</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('start_delegated_transaction')" href="../_functions/start_delegated_transaction.html" onMouseOver="funcPopup(event,'start_delegated_transaction')">start_delegated_transaction</a>();
<a name="l362"><span class="linenum"> 362</span></a>  
<a name="l363"><span class="linenum"> 363</span></a>  <span class="comment">            // reset the php timeout</span>
<a name="l364"><span class="linenum"> 364</span></a>              <a class="class" onClick="logClass('core_php_time_limit')" href="../_classes/core_php_time_limit.html" onMouseOver="classPopup(event,'core_php_time_limit')">core_php_time_limit</a>::<a class="function" onClick="logFunction('raise')" href="../_functions/raise.html" onMouseOver="funcPopup(event,'raise')">raise</a>();
<a name="l365"><span class="linenum"> 365</span></a>  
<a name="l366"><span class="linenum"> 366</span></a>  <span class="comment">            // check for category modifiers</span>
<a name="l367"><span class="linenum"> 367</span></a>              if (<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('qtype')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/qtype.html">qtype</a> == 'category') {
<a name="l368"><span class="linenum"> 368</span></a>                  if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('catfromfile')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/catfromfile.html">catfromfile</a>) {
<a name="l369"><span class="linenum"> 369</span></a>  <span class="comment">                    // find/create category object</span>
<a name="l370"><span class="linenum"> 370</span></a>                      <a class="var it5880" onMouseOver="hilite(5880)" onMouseOut="lolite()" onClick="logVariable('catpath')" href="../_variables/catpath.html">$catpath</a> = <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('category')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/category.html">category</a>;
<a name="l371"><span class="linenum"> 371</span></a>                      <a class="var it5881" onMouseOver="hilite(5881)" onMouseOut="lolite()" onClick="logVariable('newcategory')" href="../_variables/newcategory.html">$newcategory</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('create_category_path')" href="../_functions/create_category_path.html" onMouseOver="funcPopup(event,'create_category_path')">create_category_path</a>(<a class="var it5880" onMouseOver="hilite(5880)" onMouseOut="lolite()" onClick="logVariable('catpath')" href="../_variables/catpath.html">$catpath</a>);
<a name="l372"><span class="linenum"> 372</span></a>                      if (!empty(<a class="var it5881" onMouseOver="hilite(5881)" onMouseOut="lolite()" onClick="logVariable('newcategory')" href="../_variables/newcategory.html">$newcategory</a>)) {
<a name="l373"><span class="linenum"> 373</span></a>                          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('category')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/category.html">category</a> = <a class="var it5881" onMouseOver="hilite(5881)" onMouseOut="lolite()" onClick="logVariable('newcategory')" href="../_variables/newcategory.html">$newcategory</a>;
<a name="l374"><span class="linenum"> 374</span></a>                      }
<a name="l375"><span class="linenum"> 375</span></a>                  }
<a name="l376"><span class="linenum"> 376</span></a>                  <a class="var it4224" onMouseOver="hilite(4224)" onMouseOut="lolite()" onClick="logVariable('transaction')" href="../_variables/transaction.html">$transaction</a>-&gt;<a class="function" onClick="logFunction('allow_commit')" href="../_functions/allow_commit.html" onMouseOver="funcPopup(event,'allow_commit')">allow_commit</a>();
<a name="l377"><span class="linenum"> 377</span></a>                  continue;
<a name="l378"><span class="linenum"> 378</span></a>              }
<a name="l379"><span class="linenum"> 379</span></a>              <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('context')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/context.html">context</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('importcontext')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/importcontext.html">importcontext</a>;
<a name="l380"><span class="linenum"> 380</span></a>  
<a name="l381"><span class="linenum"> 381</span></a>              <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a>++;
<a name="l382"><span class="linenum"> 382</span></a>  
<a name="l383"><span class="linenum"> 383</span></a>              echo &quot;&lt;hr /&gt;&lt;p&gt;&lt;b&gt;{<a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a>}&lt;/b&gt;. &quot;.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('format_question_text')" href="../_functions/format_question_text.html" onMouseOver="funcPopup(event,'format_question_text')">format_question_text</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>).&quot;&lt;/p&gt;&quot;;
<a name="l384"><span class="linenum"> 384</span></a>  
<a name="l385"><span class="linenum"> 385</span></a>              <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('category')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/category.html">category</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('category')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/category.html">category</a>-&gt;id;
<a name="l386"><span class="linenum"> 386</span></a>              <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('stamp')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/stamp.html">stamp</a> = <a class="function" onClick="logFunction('make_unique_id_code')" href="../_functions/make_unique_id_code.html" onMouseOver="funcPopup(event,'make_unique_id_code')">make_unique_id_code</a>();  <span class="comment">// Set the unique code (not to be changed)</span>
<a name="l387"><span class="linenum"> 387</span></a>  
<a name="l388"><span class="linenum"> 388</span></a>              <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('createdby')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/createdby.html">createdby</a> = <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../_variables/id.html">id</a>;
<a name="l389"><span class="linenum"> 389</span></a>              <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('timecreated')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/timecreated.html">timecreated</a> = <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l390"><span class="linenum"> 390</span></a>              <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('modifiedby')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/modifiedby.html">modifiedby</a> = <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../_variables/id.html">id</a>;
<a name="l391"><span class="linenum"> 391</span></a>              <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('timemodified')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l392"><span class="linenum"> 392</span></a>              <a class="var it5882" onMouseOver="hilite(5882)" onMouseOut="lolite()" onClick="logVariable('fileoptions')" href="../_variables/fileoptions.html">$fileoptions</a> = array(
<a name="l393"><span class="linenum"> 393</span></a>                      'subdirs' =&gt; true,
<a name="l394"><span class="linenum"> 394</span></a>                      'maxfiles' =&gt; -1,
<a name="l395"><span class="linenum"> 395</span></a>                      'maxbytes' =&gt; 0,
<a name="l396"><span class="linenum"> 396</span></a>                  );
<a name="l397"><span class="linenum"> 397</span></a>  
<a name="l398"><span class="linenum"> 398</span></a>              <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/id.html">id</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('question', <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>);
<a name="l399"><span class="linenum"> 399</span></a>  
<a name="l400"><span class="linenum"> 400</span></a>              if (isset(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('questiontextitemid')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/questiontextitemid.html">questiontextitemid</a>)) {
<a name="l401"><span class="linenum"> 401</span></a>                  <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('questiontext')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/questiontext.html">questiontext</a> = <a class="function" onClick="logFunction('file_save_draft_area_files')" href="../_functions/file_save_draft_area_files.html" onMouseOver="funcPopup(event,'file_save_draft_area_files')">file_save_draft_area_files</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('questiontextitemid')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/questiontextitemid.html">questiontextitemid</a>,
<a name="l402"><span class="linenum"> 402</span></a>                          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('importcontext')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/importcontext.html">importcontext</a>-&gt;id, 'question', 'questiontext', <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l403"><span class="linenum"> 403</span></a>                          <a class="var it5882" onMouseOver="hilite(5882)" onMouseOut="lolite()" onClick="logVariable('fileoptions')" href="../_variables/fileoptions.html">$fileoptions</a>, <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('questiontext')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/questiontext.html">questiontext</a>);
<a name="l404"><span class="linenum"> 404</span></a>              } else if (isset(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('questiontextfiles')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/questiontextfiles.html">questiontextfiles</a>)) {
<a name="l405"><span class="linenum"> 405</span></a>                  foreach (<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('questiontextfiles')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/questiontextfiles.html">questiontextfiles</a> as <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a>) {
<a name="l406"><span class="linenum"> 406</span></a>                      question_bank::<a class="function" onClick="logFunction('get_qtype')" href="../_functions/get_qtype.html" onMouseOver="funcPopup(event,'get_qtype')">get_qtype</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('qtype')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/qtype.html">qtype</a>)-&gt;<a class="function" onClick="logFunction('import_file')" href="../_functions/import_file.html" onMouseOver="funcPopup(event,'import_file')">import_file</a>(
<a name="l407"><span class="linenum"> 407</span></a>                              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('importcontext')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/importcontext.html">importcontext</a>, 'question', 'questiontext', <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a>);
<a name="l408"><span class="linenum"> 408</span></a>                  }
<a name="l409"><span class="linenum"> 409</span></a>              }
<a name="l410"><span class="linenum"> 410</span></a>              if (isset(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('generalfeedbackitemid')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/generalfeedbackitemid.html">generalfeedbackitemid</a>)) {
<a name="l411"><span class="linenum"> 411</span></a>                  <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('generalfeedback')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/generalfeedback.html">generalfeedback</a> = <a class="function" onClick="logFunction('file_save_draft_area_files')" href="../_functions/file_save_draft_area_files.html" onMouseOver="funcPopup(event,'file_save_draft_area_files')">file_save_draft_area_files</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('generalfeedbackitemid')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/generalfeedbackitemid.html">generalfeedbackitemid</a>,
<a name="l412"><span class="linenum"> 412</span></a>                          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('importcontext')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/importcontext.html">importcontext</a>-&gt;id, 'question', 'generalfeedback', <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/id.html">id</a>,
<a name="l413"><span class="linenum"> 413</span></a>                          <a class="var it5882" onMouseOver="hilite(5882)" onMouseOut="lolite()" onClick="logVariable('fileoptions')" href="../_variables/fileoptions.html">$fileoptions</a>, <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('generalfeedback')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/generalfeedback.html">generalfeedback</a>);
<a name="l414"><span class="linenum"> 414</span></a>              } else if (isset(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('generalfeedbackfiles')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/generalfeedbackfiles.html">generalfeedbackfiles</a>)) {
<a name="l415"><span class="linenum"> 415</span></a>                  foreach (<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('generalfeedbackfiles')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/generalfeedbackfiles.html">generalfeedbackfiles</a> as <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a>) {
<a name="l416"><span class="linenum"> 416</span></a>                      question_bank::<a class="function" onClick="logFunction('get_qtype')" href="../_functions/get_qtype.html" onMouseOver="funcPopup(event,'get_qtype')">get_qtype</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('qtype')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/qtype.html">qtype</a>)-&gt;<a class="function" onClick="logFunction('import_file')" href="../_functions/import_file.html" onMouseOver="funcPopup(event,'import_file')">import_file</a>(
<a name="l417"><span class="linenum"> 417</span></a>                              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('importcontext')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/importcontext.html">importcontext</a>, 'question', 'generalfeedback', <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../_variables/file.html">$file</a>);
<a name="l418"><span class="linenum"> 418</span></a>                  }
<a name="l419"><span class="linenum"> 419</span></a>              }
<a name="l420"><span class="linenum"> 420</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('question', <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>);
<a name="l421"><span class="linenum"> 421</span></a>  
<a name="l422"><span class="linenum"> 422</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('questionids')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/questionids.html">questionids</a>[] = <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/id.html">id</a>;
<a name="l423"><span class="linenum"> 423</span></a>  
<a name="l424"><span class="linenum"> 424</span></a>  <span class="comment">            // Now to save all the answers and type-specific options</span>
<a name="l425"><span class="linenum"> 425</span></a>  
<a name="l426"><span class="linenum"> 426</span></a>              <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = question_bank::<a class="function" onClick="logFunction('get_qtype')" href="../_functions/get_qtype.html" onMouseOver="funcPopup(event,'get_qtype')">get_qtype</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('qtype')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/qtype.html">qtype</a>)-&gt;<a class="function" onClick="logFunction('save_question_options')" href="../_functions/save_question_options.html" onMouseOver="funcPopup(event,'save_question_options')">save_question_options</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>);
<a name="l427"><span class="linenum"> 427</span></a>  
<a name="l428"><span class="linenum"> 428</span></a>              if (isset(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('tags')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/tags.html">tags</a>)) {
<a name="l429"><span class="linenum"> 429</span></a>                  <a class="class" onClick="logClass('core_tag_tag')" href="../_classes/core_tag_tag.html" onMouseOver="classPopup(event,'core_tag_tag')">core_tag_tag</a>::<a class="function" onClick="logFunction('set_item_tags')" href="../_functions/set_item_tags.html" onMouseOver="funcPopup(event,'set_item_tags')">set_item_tags</a>('core_question', 'question', <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('context')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/context.html">context</a>, <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('tags')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/tags.html">tags</a>);
<a name="l430"><span class="linenum"> 430</span></a>              }
<a name="l431"><span class="linenum"> 431</span></a>  
<a name="l432"><span class="linenum"> 432</span></a>              if (!empty(<a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('error')" class="var it43057" onMouseOver="hilite(43057)" onMouseOut="lolite()" href="../_variables/error.html">error</a>)) {
<a name="l433"><span class="linenum"> 433</span></a>                  echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('error')" class="var it43057" onMouseOver="hilite(43057)" onMouseOut="lolite()" href="../_variables/error.html">error</a>);
<a name="l434"><span class="linenum"> 434</span></a>  <span class="comment">                // Can't use $transaction-&gt;rollback(); since it requires an exception,</span>
<a name="l435"><span class="linenum"> 435</span></a>  <span class="comment">                // and I don't want to rewrite this code to change the error handling now.</span>
<a name="l436"><span class="linenum"> 436</span></a>                  <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('force_transaction_rollback')" href="../_functions/force_transaction_rollback.html" onMouseOver="funcPopup(event,'force_transaction_rollback')">force_transaction_rollback</a>();
<a name="l437"><span class="linenum"> 437</span></a>                  return false;
<a name="l438"><span class="linenum"> 438</span></a>              }
<a name="l439"><span class="linenum"> 439</span></a>  
<a name="l440"><span class="linenum"> 440</span></a>              <a class="var it4224" onMouseOver="hilite(4224)" onMouseOut="lolite()" onClick="logVariable('transaction')" href="../_variables/transaction.html">$transaction</a>-&gt;<a class="function" onClick="logFunction('allow_commit')" href="../_functions/allow_commit.html" onMouseOver="funcPopup(event,'allow_commit')">allow_commit</a>();
<a name="l441"><span class="linenum"> 441</span></a>  
<a name="l442"><span class="linenum"> 442</span></a>              if (!empty(<a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('notice')" class="var it43057" onMouseOver="hilite(43057)" onMouseOut="lolite()" href="../_variables/notice.html">notice</a>)) {
<a name="l443"><span class="linenum"> 443</span></a>                  echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('notification')" href="../_functions/notification.html" onMouseOver="funcPopup(event,'notification')">notification</a>(<a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('notice')" class="var it43057" onMouseOver="hilite(43057)" onMouseOut="lolite()" href="../_variables/notice.html">notice</a>);
<a name="l444"><span class="linenum"> 444</span></a>                  return true;
<a name="l445"><span class="linenum"> 445</span></a>              }
<a name="l446"><span class="linenum"> 446</span></a>  
<a name="l447"><span class="linenum"> 447</span></a>  <span class="comment">            // Give the question a unique version stamp determined by question_hash()</span>
<a name="l448"><span class="linenum"> 448</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('question', 'version', <a class="function" onClick="logFunction('question_hash')" href="../_functions/question_hash.html" onMouseOver="funcPopup(event,'question_hash')">question_hash</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>),
<a name="l449"><span class="linenum"> 449</span></a>                      array('id' =&gt; <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l450"><span class="linenum"> 450</span></a>          }
<a name="l451"><span class="linenum"> 451</span></a>          return true;
<a name="l452"><span class="linenum"> 452</span></a>      }
<a name="l453"><span class="linenum"> 453</span></a>  
<a name="l454"><span class="linenum"> 454</span></a>      <span class="comment">/**</span>
<a name="l455"><span class="linenum"> 455</span></a>  <span class="comment">     * Count all non-category questions in the questions array.</span>
<a name="l456"><span class="linenum"> 456</span></a>  <span class="comment">     *</span>
<a name="l457"><span class="linenum"> 457</span></a>  <span class="comment">     * @param array questions An array of question objects.</span>
<a name="l458"><span class="linenum"> 458</span></a>  <span class="comment">     * @return int The count.</span>
<a name="l459"><span class="linenum"> 459</span></a>  <span class="comment">     *</span>
<a name="l460"><span class="linenum"> 460</span></a>  <span class="comment">     */</span>
<a name="l461"><span class="linenum"> 461</span></a>      protected function <a class="function" onClick="logFunction('count_questions')" href="../_functions/count_questions.html" onMouseOver="funcPopup(event,'count_questions')">count_questions</a>(<a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../_variables/questions.html">$questions</a>) {
<a name="l462"><span class="linenum"> 462</span></a>          <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a> = 0;
<a name="l463"><span class="linenum"> 463</span></a>          if (!<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../_variables/questions.html">$questions</a>)) {
<a name="l464"><span class="linenum"> 464</span></a>              return <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a>;
<a name="l465"><span class="linenum"> 465</span></a>          }
<a name="l466"><span class="linenum"> 466</span></a>          foreach (<a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../_variables/questions.html">$questions</a> as <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>) {
<a name="l467"><span class="linenum"> 467</span></a>              if (!<a class="phpfunction" onClick="logFunction('is_object')" href="../_functions/is_object.html" onMouseOver="phpfuncPopup(event,'is_object')">is_object</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>) || !isset(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('qtype')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/qtype.html">qtype</a>) ||
<a name="l468"><span class="linenum"> 468</span></a>                      (<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('qtype')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/qtype.html">qtype</a> == 'category')) {
<a name="l469"><span class="linenum"> 469</span></a>                  continue;
<a name="l470"><span class="linenum"> 470</span></a>              }
<a name="l471"><span class="linenum"> 471</span></a>              <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a>++;
<a name="l472"><span class="linenum"> 472</span></a>          }
<a name="l473"><span class="linenum"> 473</span></a>          return <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a>;
<a name="l474"><span class="linenum"> 474</span></a>      }
<a name="l475"><span class="linenum"> 475</span></a>  
<a name="l476"><span class="linenum"> 476</span></a>      <span class="comment">/**</span>
<a name="l477"><span class="linenum"> 477</span></a>  <span class="comment">     * find and/or create the category described by a delimited list</span>
<a name="l478"><span class="linenum"> 478</span></a>  <span class="comment">     * e.g. $course$/tom/dick/harry or tom/dick/harry</span>
<a name="l479"><span class="linenum"> 479</span></a>  <span class="comment">     *</span>
<a name="l480"><span class="linenum"> 480</span></a>  <span class="comment">     * removes any context string no matter whether $getcontext is set</span>
<a name="l481"><span class="linenum"> 481</span></a>  <span class="comment">     * but if $getcontext is set then ignore the context and use selected category context.</span>
<a name="l482"><span class="linenum"> 482</span></a>  <span class="comment">     *</span>
<a name="l483"><span class="linenum"> 483</span></a>  <span class="comment">     * @param string catpath delimited category path</span>
<a name="l484"><span class="linenum"> 484</span></a>  <span class="comment">     * @param int courseid course to search for categories</span>
<a name="l485"><span class="linenum"> 485</span></a>  <span class="comment">     * @return mixed category object or null if fails</span>
<a name="l486"><span class="linenum"> 486</span></a>  <span class="comment">     */</span>
<a name="l487"><span class="linenum"> 487</span></a>      protected function <a class="function" onClick="logFunction('create_category_path')" href="../_functions/create_category_path.html" onMouseOver="funcPopup(event,'create_category_path')">create_category_path</a>(<a class="var it5880" onMouseOver="hilite(5880)" onMouseOut="lolite()" onClick="logVariable('catpath')" href="../_variables/catpath.html">$catpath</a>) {
<a name="l488"><span class="linenum"> 488</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l489"><span class="linenum"> 489</span></a>          <a class="var it5887" onMouseOver="hilite(5887)" onMouseOut="lolite()" onClick="logVariable('catnames')" href="../_variables/catnames.html">$catnames</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('split_category_path')" href="../_functions/split_category_path.html" onMouseOver="funcPopup(event,'split_category_path')">split_category_path</a>(<a class="var it5880" onMouseOver="hilite(5880)" onMouseOut="lolite()" onClick="logVariable('catpath')" href="../_variables/catpath.html">$catpath</a>);
<a name="l490"><span class="linenum"> 490</span></a>          <a class="var it311" onMouseOver="hilite(311)" onMouseOut="lolite()" onClick="logVariable('parent')" href="../_variables/parent.html">$parent</a> = 0;
<a name="l491"><span class="linenum"> 491</span></a>          <a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a> = null;
<a name="l492"><span class="linenum"> 492</span></a>  
<a name="l493"><span class="linenum"> 493</span></a>  <span class="comment">        // check for context id in path, it might not be there in pre 1.9 exports</span>
<a name="l494"><span class="linenum"> 494</span></a>          <a class="var it5888" onMouseOver="hilite(5888)" onMouseOut="lolite()" onClick="logVariable('matchcount')" href="../_variables/matchcount.html">$matchcount</a> = <a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^\$([a-z]+)\$$/', <a class="var it5887" onMouseOver="hilite(5887)" onMouseOut="lolite()" onClick="logVariable('catnames')" href="../_variables/catnames.html">$catnames</a>[0], <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>);
<a name="l495"><span class="linenum"> 495</span></a>          if (<a class="var it5888" onMouseOver="hilite(5888)" onMouseOut="lolite()" onClick="logVariable('matchcount')" href="../_variables/matchcount.html">$matchcount</a> == 1) {
<a name="l496"><span class="linenum"> 496</span></a>              <a class="var it782" onMouseOver="hilite(782)" onMouseOut="lolite()" onClick="logVariable('contextid')" href="../_variables/contextid.html">$contextid</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('translator')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/translator.html">translator</a>-&gt;<a class="function" onClick="logFunction('string_to_context')" href="../_functions/string_to_context.html" onMouseOver="funcPopup(event,'string_to_context')">string_to_context</a>(<a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../_variables/matches.html">$matches</a>[1]);
<a name="l497"><span class="linenum"> 497</span></a>              <a class="phpfunction" onClick="logFunction('array_shift')" href="../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it5887" onMouseOver="hilite(5887)" onMouseOut="lolite()" onClick="logVariable('catnames')" href="../_variables/catnames.html">$catnames</a>);
<a name="l498"><span class="linenum"> 498</span></a>          } else {
<a name="l499"><span class="linenum"> 499</span></a>              <a class="var it782" onMouseOver="hilite(782)" onMouseOut="lolite()" onClick="logVariable('contextid')" href="../_variables/contextid.html">$contextid</a> = false;
<a name="l500"><span class="linenum"> 500</span></a>          }
<a name="l501"><span class="linenum"> 501</span></a>  
<a name="l502"><span class="linenum"> 502</span></a>          if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('contextfromfile')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/contextfromfile.html">contextfromfile</a> &amp;&amp; <a class="var it782" onMouseOver="hilite(782)" onMouseOut="lolite()" onClick="logVariable('contextid')" href="../_variables/contextid.html">$contextid</a> !== false) {
<a name="l503"><span class="linenum"> 503</span></a>              <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a> = context::<a class="function" onClick="logFunction('instance_by_id')" href="../_functions/instance_by_id.html" onMouseOver="funcPopup(event,'instance_by_id')">instance_by_id</a>(<a class="var it782" onMouseOver="hilite(782)" onMouseOut="lolite()" onClick="logVariable('contextid')" href="../_variables/contextid.html">$contextid</a>);
<a name="l504"><span class="linenum"> 504</span></a>              <a class="function" onClick="logFunction('require_capability')" href="../_functions/require_capability.html" onMouseOver="funcPopup(event,'require_capability')">require_capability</a>('moodle/question:add', <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>);
<a name="l505"><span class="linenum"> 505</span></a>          } else {
<a name="l506"><span class="linenum"> 506</span></a>              <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a> = context::<a class="function" onClick="logFunction('instance_by_id')" href="../_functions/instance_by_id.html" onMouseOver="funcPopup(event,'instance_by_id')">instance_by_id</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('category')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/category.html">category</a>-&gt;contextid);
<a name="l507"><span class="linenum"> 507</span></a>          }
<a name="l508"><span class="linenum"> 508</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('importcontext')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/importcontext.html">importcontext</a> = <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>;
<a name="l509"><span class="linenum"> 509</span></a>  
<a name="l510"><span class="linenum"> 510</span></a>  <span class="comment">        // Now create any categories that need to be created.</span>
<a name="l511"><span class="linenum"> 511</span></a>          foreach (<a class="var it5887" onMouseOver="hilite(5887)" onMouseOut="lolite()" onClick="logVariable('catnames')" href="../_variables/catnames.html">$catnames</a> as <a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('catname')" href="../_variables/catname.html">$catname</a>) {
<a name="l512"><span class="linenum"> 512</span></a>              if (<a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('question_categories',
<a name="l513"><span class="linenum"> 513</span></a>                      array('name' =&gt; <a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('catname')" href="../_variables/catname.html">$catname</a>, 'contextid' =&gt; <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, 'parent' =&gt; <a class="var it311" onMouseOver="hilite(311)" onMouseOut="lolite()" onClick="logVariable('parent')" href="../_variables/parent.html">$parent</a>))) {
<a name="l514"><span class="linenum"> 514</span></a>                  <a class="var it311" onMouseOver="hilite(311)" onMouseOut="lolite()" onClick="logVariable('parent')" href="../_variables/parent.html">$parent</a> = <a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a>-&gt;<a onClick="logVariable('id')" class="var it42970" onMouseOver="hilite(42970)" onMouseOut="lolite()" href="../_variables/id.html">id</a>;
<a name="l515"><span class="linenum"> 515</span></a>              } else {
<a name="l516"><span class="linenum"> 516</span></a>                  <a class="function" onClick="logFunction('require_capability')" href="../_functions/require_capability.html" onMouseOver="funcPopup(event,'require_capability')">require_capability</a>('moodle/question:managecategory', <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>);
<a name="l517"><span class="linenum"> 517</span></a>  <span class="comment">                // create the new category</span>
<a name="l518"><span class="linenum"> 518</span></a>                  <a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a> = new stdClass();
<a name="l519"><span class="linenum"> 519</span></a>                  <a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a>-&gt;<a onClick="logVariable('contextid')" class="var it42970" onMouseOver="hilite(42970)" onMouseOut="lolite()" href="../_variables/contextid.html">contextid</a> = <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../_variables/id.html">id</a>;
<a name="l520"><span class="linenum"> 520</span></a>                  <a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a>-&gt;<a onClick="logVariable('name')" class="var it42970" onMouseOver="hilite(42970)" onMouseOut="lolite()" href="../_variables/name.html">name</a> = <a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('catname')" href="../_variables/catname.html">$catname</a>;
<a name="l521"><span class="linenum"> 521</span></a>                  <a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a>-&gt;<a onClick="logVariable('info')" class="var it42970" onMouseOver="hilite(42970)" onMouseOut="lolite()" href="../_variables/info.html">info</a> = '';
<a name="l522"><span class="linenum"> 522</span></a>                  <a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a>-&gt;<a onClick="logVariable('parent')" class="var it42970" onMouseOver="hilite(42970)" onMouseOut="lolite()" href="../_variables/parent.html">parent</a> = <a class="var it311" onMouseOver="hilite(311)" onMouseOut="lolite()" onClick="logVariable('parent')" href="../_variables/parent.html">$parent</a>;
<a name="l523"><span class="linenum"> 523</span></a>                  <a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a>-&gt;<a onClick="logVariable('sortorder')" class="var it42970" onMouseOver="hilite(42970)" onMouseOut="lolite()" href="../_variables/sortorder.html">sortorder</a> = 999;
<a name="l524"><span class="linenum"> 524</span></a>                  <a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a>-&gt;<a onClick="logVariable('stamp')" class="var it42970" onMouseOver="hilite(42970)" onMouseOut="lolite()" href="../_variables/stamp.html">stamp</a> = <a class="function" onClick="logFunction('make_unique_id_code')" href="../_functions/make_unique_id_code.html" onMouseOver="funcPopup(event,'make_unique_id_code')">make_unique_id_code</a>();
<a name="l525"><span class="linenum"> 525</span></a>                  <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('question_categories', <a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a>);
<a name="l526"><span class="linenum"> 526</span></a>                  <a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a>-&gt;<a onClick="logVariable('id')" class="var it42970" onMouseOver="hilite(42970)" onMouseOut="lolite()" href="../_variables/id.html">id</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>;
<a name="l527"><span class="linenum"> 527</span></a>                  <a class="var it311" onMouseOver="hilite(311)" onMouseOut="lolite()" onClick="logVariable('parent')" href="../_variables/parent.html">$parent</a> = <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>;
<a name="l528"><span class="linenum"> 528</span></a>              }
<a name="l529"><span class="linenum"> 529</span></a>          }
<a name="l530"><span class="linenum"> 530</span></a>          return <a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a>;
<a name="l531"><span class="linenum"> 531</span></a>      }
<a name="l532"><span class="linenum"> 532</span></a>  
<a name="l533"><span class="linenum"> 533</span></a>      <span class="comment">/**</span>
<a name="l534"><span class="linenum"> 534</span></a>  <span class="comment">     * Return complete file within an array, one item per line</span>
<a name="l535"><span class="linenum"> 535</span></a>  <span class="comment">     * @param string filename name of file</span>
<a name="l536"><span class="linenum"> 536</span></a>  <span class="comment">     * @return mixed contents array or false on failure</span>
<a name="l537"><span class="linenum"> 537</span></a>  <span class="comment">     */</span>
<a name="l538"><span class="linenum"> 538</span></a>      protected function <a class="function" onClick="logFunction('readdata')" href="../_functions/readdata.html" onMouseOver="funcPopup(event,'readdata')">readdata</a>(<a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../_variables/filename.html">$filename</a>) {
<a name="l539"><span class="linenum"> 539</span></a>          if (<a class="phpfunction" onClick="logFunction('is_readable')" href="../_functions/is_readable.html" onMouseOver="phpfuncPopup(event,'is_readable')">is_readable</a>(<a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../_variables/filename.html">$filename</a>)) {
<a name="l540"><span class="linenum"> 540</span></a>              <a class="var it5889" onMouseOver="hilite(5889)" onMouseOut="lolite()" onClick="logVariable('filearray')" href="../_variables/filearray.html">$filearray</a> = <a class="phpfunction" onClick="logFunction('file')" href="../_functions/file.html" onMouseOver="phpfuncPopup(event,'file')">file</a>(<a class="var it243" onMouseOver="hilite(243)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../_variables/filename.html">$filename</a>);
<a name="l541"><span class="linenum"> 541</span></a>  
<a name="l542"><span class="linenum"> 542</span></a>  <span class="comment">            // If the first line of the file starts with a UTF-8 BOM, remove it.</span>
<a name="l543"><span class="linenum"> 543</span></a>              <a class="var it5889" onMouseOver="hilite(5889)" onMouseOut="lolite()" onClick="logVariable('filearray')" href="../_variables/filearray.html">$filearray</a>[0] = <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('trim_utf8_bom')" href="../_functions/trim_utf8_bom.html" onMouseOver="funcPopup(event,'trim_utf8_bom')">trim_utf8_bom</a>(<a class="var it5889" onMouseOver="hilite(5889)" onMouseOut="lolite()" onClick="logVariable('filearray')" href="../_variables/filearray.html">$filearray</a>[0]);
<a name="l544"><span class="linenum"> 544</span></a>  
<a name="l545"><span class="linenum"> 545</span></a>  <span class="comment">            // Check for Macintosh OS line returns (ie file on one line), and fix.</span>
<a name="l546"><span class="linenum"> 546</span></a>              if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>(&quot;~\r~&quot;, <a class="var it5889" onMouseOver="hilite(5889)" onMouseOut="lolite()" onClick="logVariable('filearray')" href="../_variables/filearray.html">$filearray</a>[0]) AND !<a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>(&quot;~\n~&quot;, <a class="var it5889" onMouseOver="hilite(5889)" onMouseOut="lolite()" onClick="logVariable('filearray')" href="../_variables/filearray.html">$filearray</a>[0])) {
<a name="l547"><span class="linenum"> 547</span></a>                  return <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(&quot;\r&quot;, <a class="var it5889" onMouseOver="hilite(5889)" onMouseOut="lolite()" onClick="logVariable('filearray')" href="../_variables/filearray.html">$filearray</a>[0]);
<a name="l548"><span class="linenum"> 548</span></a>              } else {
<a name="l549"><span class="linenum"> 549</span></a>                  return <a class="var it5889" onMouseOver="hilite(5889)" onMouseOut="lolite()" onClick="logVariable('filearray')" href="../_variables/filearray.html">$filearray</a>;
<a name="l550"><span class="linenum"> 550</span></a>              }
<a name="l551"><span class="linenum"> 551</span></a>          }
<a name="l552"><span class="linenum"> 552</span></a>          return false;
<a name="l553"><span class="linenum"> 553</span></a>      }
<a name="l554"><span class="linenum"> 554</span></a>  
<a name="l555"><span class="linenum"> 555</span></a>      <span class="comment">/**</span>
<a name="l556"><span class="linenum"> 556</span></a>  <span class="comment">     * Parses an array of lines into an array of questions,</span>
<a name="l557"><span class="linenum"> 557</span></a>  <span class="comment">     * where each item is a question object as defined by</span>
<a name="l558"><span class="linenum"> 558</span></a>  <span class="comment">     * readquestion().   Questions are defined as anything</span>
<a name="l559"><span class="linenum"> 559</span></a>  <span class="comment">     * between blank lines.</span>
<a name="l560"><span class="linenum"> 560</span></a>  <span class="comment">     *</span>
<a name="l561"><span class="linenum"> 561</span></a>  <span class="comment">     * NOTE this method used to take $context as a second argument. However, at</span>
<a name="l562"><span class="linenum"> 562</span></a>  <span class="comment">     * the point where this method was called, it was impossible to know what</span>
<a name="l563"><span class="linenum"> 563</span></a>  <span class="comment">     * context the quetsions were going to be saved into, so the value could be</span>
<a name="l564"><span class="linenum"> 564</span></a>  <span class="comment">     * wrong. Also, none of the standard question formats were using this argument,</span>
<a name="l565"><span class="linenum"> 565</span></a>  <span class="comment">     * so it was removed. See MDL-32220.</span>
<a name="l566"><span class="linenum"> 566</span></a>  <span class="comment">     *</span>
<a name="l567"><span class="linenum"> 567</span></a>  <span class="comment">     * If your format does not use blank lines as a delimiter</span>
<a name="l568"><span class="linenum"> 568</span></a>  <span class="comment">     * then you will need to override this method. Even then</span>
<a name="l569"><span class="linenum"> 569</span></a>  <span class="comment">     * try to use readquestion for each question</span>
<a name="l570"><span class="linenum"> 570</span></a>  <span class="comment">     * @param array lines array of lines from readdata</span>
<a name="l571"><span class="linenum"> 571</span></a>  <span class="comment">     * @return array array of question objects</span>
<a name="l572"><span class="linenum"> 572</span></a>  <span class="comment">     */</span>
<a name="l573"><span class="linenum"> 573</span></a>      protected function <a class="function" onClick="logFunction('readquestions')" href="../_functions/readquestions.html" onMouseOver="funcPopup(event,'readquestions')">readquestions</a>(<a class="var it255" onMouseOver="hilite(255)" onMouseOut="lolite()" onClick="logVariable('lines')" href="../_variables/lines.html">$lines</a>) {
<a name="l574"><span class="linenum"> 574</span></a>  
<a name="l575"><span class="linenum"> 575</span></a>          <a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../_variables/questions.html">$questions</a> = array();
<a name="l576"><span class="linenum"> 576</span></a>          <a class="var it5890" onMouseOver="hilite(5890)" onMouseOut="lolite()" onClick="logVariable('currentquestion')" href="../_variables/currentquestion.html">$currentquestion</a> = array();
<a name="l577"><span class="linenum"> 577</span></a>  
<a name="l578"><span class="linenum"> 578</span></a>          foreach (<a class="var it255" onMouseOver="hilite(255)" onMouseOut="lolite()" onClick="logVariable('lines')" href="../_variables/lines.html">$lines</a> as <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('line')" href="../_variables/line.html">$line</a>) {
<a name="l579"><span class="linenum"> 579</span></a>              <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('line')" href="../_variables/line.html">$line</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('line')" href="../_variables/line.html">$line</a>);
<a name="l580"><span class="linenum"> 580</span></a>              if (empty(<a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('line')" href="../_variables/line.html">$line</a>)) {
<a name="l581"><span class="linenum"> 581</span></a>                  if (!empty(<a class="var it5890" onMouseOver="hilite(5890)" onMouseOut="lolite()" onClick="logVariable('currentquestion')" href="../_variables/currentquestion.html">$currentquestion</a>)) {
<a name="l582"><span class="linenum"> 582</span></a>                      if (<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('readquestion')" href="../_functions/readquestion.html" onMouseOver="funcPopup(event,'readquestion')">readquestion</a>(<a class="var it5890" onMouseOver="hilite(5890)" onMouseOut="lolite()" onClick="logVariable('currentquestion')" href="../_variables/currentquestion.html">$currentquestion</a>)) {
<a name="l583"><span class="linenum"> 583</span></a>                          <a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../_variables/questions.html">$questions</a>[] = <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>;
<a name="l584"><span class="linenum"> 584</span></a>                      }
<a name="l585"><span class="linenum"> 585</span></a>                      <a class="var it5890" onMouseOver="hilite(5890)" onMouseOut="lolite()" onClick="logVariable('currentquestion')" href="../_variables/currentquestion.html">$currentquestion</a> = array();
<a name="l586"><span class="linenum"> 586</span></a>                  }
<a name="l587"><span class="linenum"> 587</span></a>              } else {
<a name="l588"><span class="linenum"> 588</span></a>                  <a class="var it5890" onMouseOver="hilite(5890)" onMouseOut="lolite()" onClick="logVariable('currentquestion')" href="../_variables/currentquestion.html">$currentquestion</a>[] = <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('line')" href="../_variables/line.html">$line</a>;
<a name="l589"><span class="linenum"> 589</span></a>              }
<a name="l590"><span class="linenum"> 590</span></a>          }
<a name="l591"><span class="linenum"> 591</span></a>  
<a name="l592"><span class="linenum"> 592</span></a>          if (!empty(<a class="var it5890" onMouseOver="hilite(5890)" onMouseOut="lolite()" onClick="logVariable('currentquestion')" href="../_variables/currentquestion.html">$currentquestion</a>)) {  // There may be a final question
<a name="l593"><span class="linenum"> 593</span></a>              if (<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('readquestion')" href="../_functions/readquestion.html" onMouseOver="funcPopup(event,'readquestion')">readquestion</a>(<a class="var it5890" onMouseOver="hilite(5890)" onMouseOut="lolite()" onClick="logVariable('currentquestion')" href="../_variables/currentquestion.html">$currentquestion</a>)) {
<a name="l594"><span class="linenum"> 594</span></a>                  <a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../_variables/questions.html">$questions</a>[] = <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>;
<a name="l595"><span class="linenum"> 595</span></a>              }
<a name="l596"><span class="linenum"> 596</span></a>          }
<a name="l597"><span class="linenum"> 597</span></a>  
<a name="l598"><span class="linenum"> 598</span></a>          return <a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../_variables/questions.html">$questions</a>;
<a name="l599"><span class="linenum"> 599</span></a>      }
<a name="l600"><span class="linenum"> 600</span></a>  
<a name="l601"><span class="linenum"> 601</span></a>      <span class="comment">/**</span>
<a name="l602"><span class="linenum"> 602</span></a>  <span class="comment">     * return an &quot;empty&quot; question</span>
<a name="l603"><span class="linenum"> 603</span></a>  <span class="comment">     * Somewhere to specify question parameters that are not handled</span>
<a name="l604"><span class="linenum"> 604</span></a>  <span class="comment">     * by import but are required db fields.</span>
<a name="l605"><span class="linenum"> 605</span></a>  <span class="comment">     * This should not be overridden.</span>
<a name="l606"><span class="linenum"> 606</span></a>  <span class="comment">     * @return object default question</span>
<a name="l607"><span class="linenum"> 607</span></a>  <span class="comment">     */</span>
<a name="l608"><span class="linenum"> 608</span></a>      protected function <a class="function" onClick="logFunction('defaultquestion')" href="../_functions/defaultquestion.html" onMouseOver="funcPopup(event,'defaultquestion')">defaultquestion</a>() {
<a name="l609"><span class="linenum"> 609</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>;
<a name="l610"><span class="linenum"> 610</span></a>          static <a class="var it5891" onMouseOver="hilite(5891)" onMouseOut="lolite()" onClick="logVariable('defaultshuffleanswers')" href="../_variables/defaultshuffleanswers.html">$defaultshuffleanswers</a> = null;
<a name="l611"><span class="linenum"> 611</span></a>          if (<a class="phpfunction" onClick="logFunction('is_null')" href="../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it5891" onMouseOver="hilite(5891)" onMouseOut="lolite()" onClick="logVariable('defaultshuffleanswers')" href="../_variables/defaultshuffleanswers.html">$defaultshuffleanswers</a>)) {
<a name="l612"><span class="linenum"> 612</span></a>              <a class="var it5891" onMouseOver="hilite(5891)" onMouseOut="lolite()" onClick="logVariable('defaultshuffleanswers')" href="../_variables/defaultshuffleanswers.html">$defaultshuffleanswers</a> = <a class="function" onClick="logFunction('get_config')" href="../_functions/get_config.html" onMouseOver="funcPopup(event,'get_config')">get_config</a>('quiz', 'shuffleanswers');
<a name="l613"><span class="linenum"> 613</span></a>          }
<a name="l614"><span class="linenum"> 614</span></a>  
<a name="l615"><span class="linenum"> 615</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a> = new stdClass();
<a name="l616"><span class="linenum"> 616</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('shuffleanswers')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/shuffleanswers.html">shuffleanswers</a> = <a class="var it5891" onMouseOver="hilite(5891)" onMouseOut="lolite()" onClick="logVariable('defaultshuffleanswers')" href="../_variables/defaultshuffleanswers.html">$defaultshuffleanswers</a>;
<a name="l617"><span class="linenum"> 617</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('defaultmark')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/defaultmark.html">defaultmark</a> = 1;
<a name="l618"><span class="linenum"> 618</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('image')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/image.html">image</a> = &quot;&quot;;
<a name="l619"><span class="linenum"> 619</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('usecase')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/usecase.html">usecase</a> = 0;
<a name="l620"><span class="linenum"> 620</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('multiplier')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/multiplier.html">multiplier</a> = array();
<a name="l621"><span class="linenum"> 621</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('questiontextformat')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/questiontextformat.html">questiontextformat</a> = <a class="constant" onClick="logConstant('FORMAT_MOODLE')" href="../_constants/FORMAT_MOODLE.html" onMouseOver="constPopup(event,'FORMAT_MOODLE')">FORMAT_MOODLE</a>;
<a name="l622"><span class="linenum"> 622</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('generalfeedback')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/generalfeedback.html">generalfeedback</a> = '';
<a name="l623"><span class="linenum"> 623</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('generalfeedbackformat')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/generalfeedbackformat.html">generalfeedbackformat</a> = <a class="constant" onClick="logConstant('FORMAT_MOODLE')" href="../_constants/FORMAT_MOODLE.html" onMouseOver="constPopup(event,'FORMAT_MOODLE')">FORMAT_MOODLE</a>;
<a name="l624"><span class="linenum"> 624</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('correctfeedback')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/correctfeedback.html">correctfeedback</a> = '';
<a name="l625"><span class="linenum"> 625</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('partiallycorrectfeedback')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/partiallycorrectfeedback.html">partiallycorrectfeedback</a> = '';
<a name="l626"><span class="linenum"> 626</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('incorrectfeedback')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/incorrectfeedback.html">incorrectfeedback</a> = '';
<a name="l627"><span class="linenum"> 627</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('answernumbering')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/answernumbering.html">answernumbering</a> = 'abc';
<a name="l628"><span class="linenum"> 628</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('penalty')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/penalty.html">penalty</a> = 0.3333333;
<a name="l629"><span class="linenum"> 629</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('length')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/length.html">length</a> = 1;
<a name="l630"><span class="linenum"> 630</span></a>  
<a name="l631"><span class="linenum"> 631</span></a>  <span class="comment">        // this option in case the questiontypes class wants</span>
<a name="l632"><span class="linenum"> 632</span></a>  <span class="comment">        // to know where the data came from</span>
<a name="l633"><span class="linenum"> 633</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('export_process')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/export_process.html">export_process</a> = true;
<a name="l634"><span class="linenum"> 634</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('import_process')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/import_process.html">import_process</a> = true;
<a name="l635"><span class="linenum"> 635</span></a>  
<a name="l636"><span class="linenum"> 636</span></a>          return <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>;
<a name="l637"><span class="linenum"> 637</span></a>      }
<a name="l638"><span class="linenum"> 638</span></a>  
<a name="l639"><span class="linenum"> 639</span></a>      <span class="comment">/**</span>
<a name="l640"><span class="linenum"> 640</span></a>  <span class="comment">     * Construct a reasonable default question name, based on the start of the question text.</span>
<a name="l641"><span class="linenum"> 641</span></a>  <span class="comment">     * @param string $questiontext the question text.</span>
<a name="l642"><span class="linenum"> 642</span></a>  <span class="comment">     * @param string $default default question name to use if the constructed one comes out blank.</span>
<a name="l643"><span class="linenum"> 643</span></a>  <span class="comment">     * @return string a reasonable question name.</span>
<a name="l644"><span class="linenum"> 644</span></a>  <span class="comment">     */</span>
<a name="l645"><span class="linenum"> 645</span></a>      public function <a class="function" onClick="logFunction('create_default_question_name')" href="../_functions/create_default_question_name.html" onMouseOver="funcPopup(event,'create_default_question_name')">create_default_question_name</a>(<a class="var it446" onMouseOver="hilite(446)" onMouseOut="lolite()" onClick="logVariable('questiontext')" href="../_variables/questiontext.html">$questiontext</a>, <a class="var it777" onMouseOver="hilite(777)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>) {
<a name="l646"><span class="linenum"> 646</span></a>          <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('clean_question_name')" href="../_functions/clean_question_name.html" onMouseOver="funcPopup(event,'clean_question_name')">clean_question_name</a>(<a class="function" onClick="logFunction('shorten_text')" href="../_functions/shorten_text.html" onMouseOver="funcPopup(event,'shorten_text')">shorten_text</a>(<a class="var it446" onMouseOver="hilite(446)" onMouseOut="lolite()" onClick="logVariable('questiontext')" href="../_variables/questiontext.html">$questiontext</a>, 80));
<a name="l647"><span class="linenum"> 647</span></a>          if (<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>) {
<a name="l648"><span class="linenum"> 648</span></a>              return <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>;
<a name="l649"><span class="linenum"> 649</span></a>          } else {
<a name="l650"><span class="linenum"> 650</span></a>              return <a class="var it777" onMouseOver="hilite(777)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>;
<a name="l651"><span class="linenum"> 651</span></a>          }
<a name="l652"><span class="linenum"> 652</span></a>      }
<a name="l653"><span class="linenum"> 653</span></a>  
<a name="l654"><span class="linenum"> 654</span></a>      <span class="comment">/**</span>
<a name="l655"><span class="linenum"> 655</span></a>  <span class="comment">     * Ensure that a question name does not contain anything nasty, and will fit in the DB field.</span>
<a name="l656"><span class="linenum"> 656</span></a>  <span class="comment">     * @param string $name the raw question name.</span>
<a name="l657"><span class="linenum"> 657</span></a>  <span class="comment">     * @return string a safe question name.</span>
<a name="l658"><span class="linenum"> 658</span></a>  <span class="comment">     */</span>
<a name="l659"><span class="linenum"> 659</span></a>      public function <a class="function" onClick="logFunction('clean_question_name')" href="../_functions/clean_question_name.html" onMouseOver="funcPopup(event,'clean_question_name')">clean_question_name</a>(<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>) {
<a name="l660"><span class="linenum"> 660</span></a>          <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a> = <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, <a class="constant" onClick="logConstant('PARAM_TEXT')" href="../_constants/PARAM_TEXT.html" onMouseOver="constPopup(event,'PARAM_TEXT')">PARAM_TEXT</a>); <span class="comment">// Matches what the question editing form does.</span>
<a name="l661"><span class="linenum"> 661</span></a>          <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>);
<a name="l662"><span class="linenum"> 662</span></a>          <a class="var it5894" onMouseOver="hilite(5894)" onMouseOut="lolite()" onClick="logVariable('trimlength')" href="../_variables/trimlength.html">$trimlength</a> = 251;
<a name="l663"><span class="linenum"> 663</span></a>          while (<a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>) &gt; 255 &amp;&amp; <a class="var it5894" onMouseOver="hilite(5894)" onMouseOut="lolite()" onClick="logVariable('trimlength')" href="../_variables/trimlength.html">$trimlength</a> &gt; 0) {
<a name="l664"><span class="linenum"> 664</span></a>              <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a> = <a class="function" onClick="logFunction('shorten_text')" href="../_functions/shorten_text.html" onMouseOver="funcPopup(event,'shorten_text')">shorten_text</a>(<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, <a class="var it5894" onMouseOver="hilite(5894)" onMouseOut="lolite()" onClick="logVariable('trimlength')" href="../_variables/trimlength.html">$trimlength</a>);
<a name="l665"><span class="linenum"> 665</span></a>              <a class="var it5894" onMouseOver="hilite(5894)" onMouseOut="lolite()" onClick="logVariable('trimlength')" href="../_variables/trimlength.html">$trimlength</a> -= 10;
<a name="l666"><span class="linenum"> 666</span></a>          }
<a name="l667"><span class="linenum"> 667</span></a>          return <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>;
<a name="l668"><span class="linenum"> 668</span></a>      }
<a name="l669"><span class="linenum"> 669</span></a>  
<a name="l670"><span class="linenum"> 670</span></a>      <span class="comment">/**</span>
<a name="l671"><span class="linenum"> 671</span></a>  <span class="comment">     * Add a blank combined feedback to a question object.</span>
<a name="l672"><span class="linenum"> 672</span></a>  <span class="comment">     * @param object question</span>
<a name="l673"><span class="linenum"> 673</span></a>  <span class="comment">     * @return object question</span>
<a name="l674"><span class="linenum"> 674</span></a>  <span class="comment">     */</span>
<a name="l675"><span class="linenum"> 675</span></a>      protected function <a class="function" onClick="logFunction('add_blank_combined_feedback')" href="../_functions/add_blank_combined_feedback.html" onMouseOver="funcPopup(event,'add_blank_combined_feedback')">add_blank_combined_feedback</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>) {
<a name="l676"><span class="linenum"> 676</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('correctfeedback')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/correctfeedback.html">correctfeedback</a>['text'] = '';
<a name="l677"><span class="linenum"> 677</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('correctfeedback')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/correctfeedback.html">correctfeedback</a>['format'] = <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('questiontextformat')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/questiontextformat.html">questiontextformat</a>;
<a name="l678"><span class="linenum"> 678</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('correctfeedback')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/correctfeedback.html">correctfeedback</a>['files'] = array();
<a name="l679"><span class="linenum"> 679</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('partiallycorrectfeedback')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/partiallycorrectfeedback.html">partiallycorrectfeedback</a>['text'] = '';
<a name="l680"><span class="linenum"> 680</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('partiallycorrectfeedback')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/partiallycorrectfeedback.html">partiallycorrectfeedback</a>['format'] = <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('questiontextformat')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/questiontextformat.html">questiontextformat</a>;
<a name="l681"><span class="linenum"> 681</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('partiallycorrectfeedback')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/partiallycorrectfeedback.html">partiallycorrectfeedback</a>['files'] = array();
<a name="l682"><span class="linenum"> 682</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('incorrectfeedback')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/incorrectfeedback.html">incorrectfeedback</a>['text'] = '';
<a name="l683"><span class="linenum"> 683</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('incorrectfeedback')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/incorrectfeedback.html">incorrectfeedback</a>['format'] = <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('questiontextformat')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/questiontextformat.html">questiontextformat</a>;
<a name="l684"><span class="linenum"> 684</span></a>          <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('incorrectfeedback')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/incorrectfeedback.html">incorrectfeedback</a>['files'] = array();
<a name="l685"><span class="linenum"> 685</span></a>          return <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>;
<a name="l686"><span class="linenum"> 686</span></a>      }
<a name="l687"><span class="linenum"> 687</span></a>  
<a name="l688"><span class="linenum"> 688</span></a>      <span class="comment">/**</span>
<a name="l689"><span class="linenum"> 689</span></a>  <span class="comment">     * Given the data known to define a question in</span>
<a name="l690"><span class="linenum"> 690</span></a>  <span class="comment">     * this format, this function converts it into a question</span>
<a name="l691"><span class="linenum"> 691</span></a>  <span class="comment">     * object suitable for processing and insertion into Moodle.</span>
<a name="l692"><span class="linenum"> 692</span></a>  <span class="comment">     *</span>
<a name="l693"><span class="linenum"> 693</span></a>  <span class="comment">     * If your format does not use blank lines to delimit questions</span>
<a name="l694"><span class="linenum"> 694</span></a>  <span class="comment">     * (e.g. an XML format) you must override 'readquestions' too</span>
<a name="l695"><span class="linenum"> 695</span></a>  <span class="comment">     * @param $lines mixed data that represents question</span>
<a name="l696"><span class="linenum"> 696</span></a>  <span class="comment">     * @return object question object</span>
<a name="l697"><span class="linenum"> 697</span></a>  <span class="comment">     */</span>
<a name="l698"><span class="linenum"> 698</span></a>      protected function <a class="function" onClick="logFunction('readquestion')" href="../_functions/readquestion.html" onMouseOver="funcPopup(event,'readquestion')">readquestion</a>(<a class="var it255" onMouseOver="hilite(255)" onMouseOut="lolite()" onClick="logVariable('lines')" href="../_variables/lines.html">$lines</a>) {
<a name="l699"><span class="linenum"> 699</span></a>  <span class="comment">        // We should never get there unless the qformat plugin is broken.</span>
<a name="l700"><span class="linenum"> 700</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Question format plugin is missing important code: readquestion.');
<a name="l701"><span class="linenum"> 701</span></a>  
<a name="l702"><span class="linenum"> 702</span></a>          return null;
<a name="l703"><span class="linenum"> 703</span></a>      }
<a name="l704"><span class="linenum"> 704</span></a>  
<a name="l705"><span class="linenum"> 705</span></a>      <span class="comment">/**</span>
<a name="l706"><span class="linenum"> 706</span></a>  <span class="comment">     * Override if any post-processing is required</span>
<a name="l707"><span class="linenum"> 707</span></a>  <span class="comment">     * @return bool success</span>
<a name="l708"><span class="linenum"> 708</span></a>  <span class="comment">     */</span>
<a name="l709"><span class="linenum"> 709</span></a>      public function <a class="function" onClick="logFunction('importpostprocess')" href="../_functions/importpostprocess.html" onMouseOver="funcPopup(event,'importpostprocess')">importpostprocess</a>() {
<a name="l710"><span class="linenum"> 710</span></a>          return true;
<a name="l711"><span class="linenum"> 711</span></a>      }
<a name="l712"><span class="linenum"> 712</span></a>  
<a name="l713"><span class="linenum"> 713</span></a>      <span class="comment">/*******************</span>
<a name="l714"><span class="linenum"> 714</span></a>  <span class="comment">     * EXPORT FUNCTIONS</span>
<a name="l715"><span class="linenum"> 715</span></a>  <span class="comment">     *******************/</span>
<a name="l716"><span class="linenum"> 716</span></a>  
<a name="l717"><span class="linenum"> 717</span></a>      <span class="comment">/**</span>
<a name="l718"><span class="linenum"> 718</span></a>  <span class="comment">     * Provide export functionality for plugin questiontypes</span>
<a name="l719"><span class="linenum"> 719</span></a>  <span class="comment">     * Do not override</span>
<a name="l720"><span class="linenum"> 720</span></a>  <span class="comment">     * @param name questiontype name</span>
<a name="l721"><span class="linenum"> 721</span></a>  <span class="comment">     * @param question object data to export</span>
<a name="l722"><span class="linenum"> 722</span></a>  <span class="comment">     * @param extra mixed any addition format specific data needed</span>
<a name="l723"><span class="linenum"> 723</span></a>  <span class="comment">     * @return string the data to append to export or false if error (or unhandled)</span>
<a name="l724"><span class="linenum"> 724</span></a>  <span class="comment">     */</span>
<a name="l725"><span class="linenum"> 725</span></a>      protected function <a class="function" onClick="logFunction('try_exporting_using_qtypes')" href="../_functions/try_exporting_using_qtypes.html" onMouseOver="funcPopup(event,'try_exporting_using_qtypes')">try_exporting_using_qtypes</a>(<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>, <a class="var it812" onMouseOver="hilite(812)" onMouseOut="lolite()" onClick="logVariable('extra')" href="../_variables/extra.html">$extra</a>=null) {
<a name="l726"><span class="linenum"> 726</span></a>  <span class="comment">        // work out the name of format in use</span>
<a name="l727"><span class="linenum"> 727</span></a>          <a class="var it5873" onMouseOver="hilite(5873)" onMouseOut="lolite()" onClick="logVariable('formatname')" href="../_variables/formatname.html">$formatname</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="phpfunction" onClick="logFunction('get_class')" href="../_functions/get_class.html" onMouseOver="phpfuncPopup(event,'get_class')">get_class</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>), <a class="function" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>('qformat_'));
<a name="l728"><span class="linenum"> 728</span></a>          <a class="var it559" onMouseOver="hilite(559)" onMouseOut="lolite()" onClick="logVariable('methodname')" href="../_variables/methodname.html">$methodname</a> = &quot;export_to_{<a class="var it5873" onMouseOver="hilite(5873)" onMouseOut="lolite()" onClick="logVariable('formatname')" href="../_variables/formatname.html">$formatname</a>}&quot;;
<a name="l729"><span class="linenum"> 729</span></a>  
<a name="l730"><span class="linenum"> 730</span></a>          <a class="var it260" onMouseOver="hilite(260)" onMouseOut="lolite()" onClick="logVariable('qtype')" href="../_variables/qtype.html">$qtype</a> = question_bank::<a class="function" onClick="logFunction('get_qtype')" href="../_functions/get_qtype.html" onMouseOver="funcPopup(event,'get_qtype')">get_qtype</a>(<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>, false);
<a name="l731"><span class="linenum"> 731</span></a>          if (<a class="phpfunction" onClick="logFunction('method_exists')" href="../_functions/method_exists.html" onMouseOver="phpfuncPopup(event,'method_exists')">method_exists</a>(<a class="var it260" onMouseOver="hilite(260)" onMouseOut="lolite()" onClick="logVariable('qtype')" href="../_variables/qtype.html">$qtype</a>, <a class="var it559" onMouseOver="hilite(559)" onMouseOut="lolite()" onClick="logVariable('methodname')" href="../_variables/methodname.html">$methodname</a>)) {
<a name="l732"><span class="linenum"> 732</span></a>              return <a class="var it260" onMouseOver="hilite(260)" onMouseOut="lolite()" onClick="logVariable('qtype')" href="../_variables/qtype.html">$qtype</a>-&gt;<a class="var it559" onMouseOver="hilite(559)" onMouseOut="lolite()" onClick="logVariable('methodname')" href="../_variables/methodname.html">$methodname</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>, <a class="var it812" onMouseOver="hilite(812)" onMouseOut="lolite()" onClick="logVariable('extra')" href="../_variables/extra.html">$extra</a>);
<a name="l733"><span class="linenum"> 733</span></a>          }
<a name="l734"><span class="linenum"> 734</span></a>          return false;
<a name="l735"><span class="linenum"> 735</span></a>      }
<a name="l736"><span class="linenum"> 736</span></a>  
<a name="l737"><span class="linenum"> 737</span></a>      <span class="comment">/**</span>
<a name="l738"><span class="linenum"> 738</span></a>  <span class="comment">     * Do any pre-processing that may be required</span>
<a name="l739"><span class="linenum"> 739</span></a>  <span class="comment">     * @param bool success</span>
<a name="l740"><span class="linenum"> 740</span></a>  <span class="comment">     */</span>
<a name="l741"><span class="linenum"> 741</span></a>      public function <a class="function" onClick="logFunction('exportpreprocess')" href="../_functions/exportpreprocess.html" onMouseOver="funcPopup(event,'exportpreprocess')">exportpreprocess</a>() {
<a name="l742"><span class="linenum"> 742</span></a>          return true;
<a name="l743"><span class="linenum"> 743</span></a>      }
<a name="l744"><span class="linenum"> 744</span></a>  
<a name="l745"><span class="linenum"> 745</span></a>      <span class="comment">/**</span>
<a name="l746"><span class="linenum"> 746</span></a>  <span class="comment">     * Enable any processing to be done on the content</span>
<a name="l747"><span class="linenum"> 747</span></a>  <span class="comment">     * just prior to the file being saved</span>
<a name="l748"><span class="linenum"> 748</span></a>  <span class="comment">     * default is to do nothing</span>
<a name="l749"><span class="linenum"> 749</span></a>  <span class="comment">     * @param string output text</span>
<a name="l750"><span class="linenum"> 750</span></a>  <span class="comment">     * @param string processed output text</span>
<a name="l751"><span class="linenum"> 751</span></a>  <span class="comment">     */</span>
<a name="l752"><span class="linenum"> 752</span></a>      protected function <a class="function" onClick="logFunction('presave_process')" href="../_functions/presave_process.html" onMouseOver="funcPopup(event,'presave_process')">presave_process</a>(<a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../_variables/content.html">$content</a>) {
<a name="l753"><span class="linenum"> 753</span></a>          return <a class="var it253" onMouseOver="hilite(253)" onMouseOut="lolite()" onClick="logVariable('content')" href="../_variables/content.html">$content</a>;
<a name="l754"><span class="linenum"> 754</span></a>      }
<a name="l755"><span class="linenum"> 755</span></a>  
<a name="l756"><span class="linenum"> 756</span></a>      <span class="comment">/**</span>
<a name="l757"><span class="linenum"> 757</span></a>  <span class="comment">     * Do the export</span>
<a name="l758"><span class="linenum"> 758</span></a>  <span class="comment">     * For most types this should not need to be overrided</span>
<a name="l759"><span class="linenum"> 759</span></a>  <span class="comment">     * @return stored_file</span>
<a name="l760"><span class="linenum"> 760</span></a>  <span class="comment">     */</span>
<a name="l761"><span class="linenum"> 761</span></a>      public function <a class="function" onClick="logFunction('exportprocess')" href="../_functions/exportprocess.html" onMouseOver="funcPopup(event,'exportprocess')">exportprocess</a>() {
<a name="l762"><span class="linenum"> 762</span></a>          global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>;
<a name="l763"><span class="linenum"> 763</span></a>  
<a name="l764"><span class="linenum"> 764</span></a>  <span class="comment">        // get the questions (from database) in this category</span>
<a name="l765"><span class="linenum"> 765</span></a>  <span class="comment">        // only get q's with no parents (no cloze subquestions specifically)</span>
<a name="l766"><span class="linenum"> 766</span></a>          if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('category')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/category.html">category</a>) {
<a name="l767"><span class="linenum"> 767</span></a>              <a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../_variables/questions.html">$questions</a> = <a class="function" onClick="logFunction('get_questions_category')" href="../_functions/get_questions_category.html" onMouseOver="funcPopup(event,'get_questions_category')">get_questions_category</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('category')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/category.html">category</a>, true);
<a name="l768"><span class="linenum"> 768</span></a>          } else {
<a name="l769"><span class="linenum"> 769</span></a>              <a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../_variables/questions.html">$questions</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('questions')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/questions.html">questions</a>;
<a name="l770"><span class="linenum"> 770</span></a>          }
<a name="l771"><span class="linenum"> 771</span></a>  
<a name="l772"><span class="linenum"> 772</span></a>          <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a> = 0;
<a name="l773"><span class="linenum"> 773</span></a>  
<a name="l774"><span class="linenum"> 774</span></a>  <span class="comment">        // results are first written into string (and then to a file)</span>
<a name="l775"><span class="linenum"> 775</span></a>  <span class="comment">        // so create/initialize the string here</span>
<a name="l776"><span class="linenum"> 776</span></a>          <a class="var it5895" onMouseOver="hilite(5895)" onMouseOut="lolite()" onClick="logVariable('expout')" href="../_variables/expout.html">$expout</a> = &quot;&quot;;
<a name="l777"><span class="linenum"> 777</span></a>  
<a name="l778"><span class="linenum"> 778</span></a>  <span class="comment">        // track which category questions are in</span>
<a name="l779"><span class="linenum"> 779</span></a>  <span class="comment">        // if it changes we will record the category change in the output</span>
<a name="l780"><span class="linenum"> 780</span></a>  <span class="comment">        // file if selected. 0 means that it will get printed before the 1st question</span>
<a name="l781"><span class="linenum"> 781</span></a>          <a class="var it5896" onMouseOver="hilite(5896)" onMouseOut="lolite()" onClick="logVariable('trackcategory')" href="../_variables/trackcategory.html">$trackcategory</a> = 0;
<a name="l782"><span class="linenum"> 782</span></a>  
<a name="l783"><span class="linenum"> 783</span></a>  <span class="comment">        // iterate through questions</span>
<a name="l784"><span class="linenum"> 784</span></a>          foreach (<a class="var it256" onMouseOver="hilite(256)" onMouseOut="lolite()" onClick="logVariable('questions')" href="../_variables/questions.html">$questions</a> as <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>) {
<a name="l785"><span class="linenum"> 785</span></a>  <span class="comment">            // used by file api</span>
<a name="l786"><span class="linenum"> 786</span></a>              <a class="var it782" onMouseOver="hilite(782)" onMouseOut="lolite()" onClick="logVariable('contextid')" href="../_variables/contextid.html">$contextid</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_field')" href="../_functions/get_field.html" onMouseOver="funcPopup(event,'get_field')">get_field</a>('question_categories', 'contextid',
<a name="l787"><span class="linenum"> 787</span></a>                      array('id' =&gt; <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('category')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/category.html">category</a>));
<a name="l788"><span class="linenum"> 788</span></a>              <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('contextid')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/contextid.html">contextid</a> = <a class="var it782" onMouseOver="hilite(782)" onMouseOut="lolite()" onClick="logVariable('contextid')" href="../_variables/contextid.html">$contextid</a>;
<a name="l789"><span class="linenum"> 789</span></a>  
<a name="l790"><span class="linenum"> 790</span></a>  <span class="comment">            // do not export hidden questions</span>
<a name="l791"><span class="linenum"> 791</span></a>              if (!empty(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('hidden')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/hidden.html">hidden</a>)) {
<a name="l792"><span class="linenum"> 792</span></a>                  continue;
<a name="l793"><span class="linenum"> 793</span></a>              }
<a name="l794"><span class="linenum"> 794</span></a>  
<a name="l795"><span class="linenum"> 795</span></a>  <span class="comment">            // do not export random questions</span>
<a name="l796"><span class="linenum"> 796</span></a>              if (<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('qtype')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/qtype.html">qtype</a> == 'random') {
<a name="l797"><span class="linenum"> 797</span></a>                  continue;
<a name="l798"><span class="linenum"> 798</span></a>              }
<a name="l799"><span class="linenum"> 799</span></a>  
<a name="l800"><span class="linenum"> 800</span></a>  <span class="comment">            // check if we need to record category change</span>
<a name="l801"><span class="linenum"> 801</span></a>              if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('cattofile')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/cattofile.html">cattofile</a>) {
<a name="l802"><span class="linenum"> 802</span></a>                  if (<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('category')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/category.html">category</a> != <a class="var it5896" onMouseOver="hilite(5896)" onMouseOut="lolite()" onClick="logVariable('trackcategory')" href="../_variables/trackcategory.html">$trackcategory</a>) {
<a name="l803"><span class="linenum"> 803</span></a>                      <a class="var it5896" onMouseOver="hilite(5896)" onMouseOut="lolite()" onClick="logVariable('trackcategory')" href="../_variables/trackcategory.html">$trackcategory</a> = <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('category')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/category.html">category</a>;
<a name="l804"><span class="linenum"> 804</span></a>                      <a class="var it906" onMouseOver="hilite(906)" onMouseOut="lolite()" onClick="logVariable('categoryname')" href="../_variables/categoryname.html">$categoryname</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_category_path')" href="../_functions/get_category_path.html" onMouseOver="funcPopup(event,'get_category_path')">get_category_path</a>(<a class="var it5896" onMouseOver="hilite(5896)" onMouseOut="lolite()" onClick="logVariable('trackcategory')" href="../_variables/trackcategory.html">$trackcategory</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('contexttofile')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/contexttofile.html">contexttofile</a>);
<a name="l805"><span class="linenum"> 805</span></a>  
<a name="l806"><span class="linenum"> 806</span></a>  <span class="comment">                    // create 'dummy' question for category export</span>
<a name="l807"><span class="linenum"> 807</span></a>                      <a class="var it5897" onMouseOver="hilite(5897)" onMouseOut="lolite()" onClick="logVariable('dummyquestion')" href="../_variables/dummyquestion.html">$dummyquestion</a> = new stdClass();
<a name="l808"><span class="linenum"> 808</span></a>                      <a class="var it5897" onMouseOver="hilite(5897)" onMouseOut="lolite()" onClick="logVariable('dummyquestion')" href="../_variables/dummyquestion.html">$dummyquestion</a>-&gt;<a onClick="logVariable('qtype')" class="var it43377" onMouseOver="hilite(43377)" onMouseOut="lolite()" href="../_variables/qtype.html">qtype</a> = 'category';
<a name="l809"><span class="linenum"> 809</span></a>                      <a class="var it5897" onMouseOver="hilite(5897)" onMouseOut="lolite()" onClick="logVariable('dummyquestion')" href="../_variables/dummyquestion.html">$dummyquestion</a>-&gt;<a onClick="logVariable('category')" class="var it43377" onMouseOver="hilite(43377)" onMouseOut="lolite()" href="../_variables/category.html">category</a> = <a class="var it906" onMouseOver="hilite(906)" onMouseOut="lolite()" onClick="logVariable('categoryname')" href="../_variables/categoryname.html">$categoryname</a>;
<a name="l810"><span class="linenum"> 810</span></a>                      <a class="var it5897" onMouseOver="hilite(5897)" onMouseOut="lolite()" onClick="logVariable('dummyquestion')" href="../_variables/dummyquestion.html">$dummyquestion</a>-&gt;<a onClick="logVariable('name')" class="var it43377" onMouseOver="hilite(43377)" onMouseOut="lolite()" href="../_variables/name.html">name</a> = 'Switch category to ' . <a class="var it906" onMouseOver="hilite(906)" onMouseOut="lolite()" onClick="logVariable('categoryname')" href="../_variables/categoryname.html">$categoryname</a>;
<a name="l811"><span class="linenum"> 811</span></a>                      <a class="var it5897" onMouseOver="hilite(5897)" onMouseOut="lolite()" onClick="logVariable('dummyquestion')" href="../_variables/dummyquestion.html">$dummyquestion</a>-&gt;<a onClick="logVariable('id')" class="var it43377" onMouseOver="hilite(43377)" onMouseOut="lolite()" href="../_variables/id.html">id</a> = 0;
<a name="l812"><span class="linenum"> 812</span></a>                      <a class="var it5897" onMouseOver="hilite(5897)" onMouseOut="lolite()" onClick="logVariable('dummyquestion')" href="../_variables/dummyquestion.html">$dummyquestion</a>-&gt;<a onClick="logVariable('questiontextformat')" class="var it43377" onMouseOver="hilite(43377)" onMouseOut="lolite()" href="../_variables/questiontextformat.html">questiontextformat</a> = '';
<a name="l813"><span class="linenum"> 813</span></a>                      <a class="var it5897" onMouseOver="hilite(5897)" onMouseOut="lolite()" onClick="logVariable('dummyquestion')" href="../_variables/dummyquestion.html">$dummyquestion</a>-&gt;<a onClick="logVariable('contextid')" class="var it43377" onMouseOver="hilite(43377)" onMouseOut="lolite()" href="../_variables/contextid.html">contextid</a> = 0;
<a name="l814"><span class="linenum"> 814</span></a>                      <a class="var it5895" onMouseOver="hilite(5895)" onMouseOut="lolite()" onClick="logVariable('expout')" href="../_variables/expout.html">$expout</a> .= <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('writequestion')" href="../_functions/writequestion.html" onMouseOver="funcPopup(event,'writequestion')">writequestion</a>(<a class="var it5897" onMouseOver="hilite(5897)" onMouseOut="lolite()" onClick="logVariable('dummyquestion')" href="../_variables/dummyquestion.html">$dummyquestion</a>) . &quot;\n&quot;;
<a name="l815"><span class="linenum"> 815</span></a>                  }
<a name="l816"><span class="linenum"> 816</span></a>              }
<a name="l817"><span class="linenum"> 817</span></a>  
<a name="l818"><span class="linenum"> 818</span></a>  <span class="comment">            // export the question displaying message</span>
<a name="l819"><span class="linenum"> 819</span></a>              <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a>++;
<a name="l820"><span class="linenum"> 820</span></a>  
<a name="l821"><span class="linenum"> 821</span></a>              if (<a class="function" onClick="logFunction('question_has_capability_on')" href="../_functions/question_has_capability_on.html" onMouseOver="funcPopup(event,'question_has_capability_on')">question_has_capability_on</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>, 'view', <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('category')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/category.html">category</a>)) {
<a name="l822"><span class="linenum"> 822</span></a>                  <a class="var it5895" onMouseOver="hilite(5895)" onMouseOut="lolite()" onClick="logVariable('expout')" href="../_variables/expout.html">$expout</a> .= <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('writequestion')" href="../_functions/writequestion.html" onMouseOver="funcPopup(event,'writequestion')">writequestion</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>, <a class="var it782" onMouseOver="hilite(782)" onMouseOut="lolite()" onClick="logVariable('contextid')" href="../_variables/contextid.html">$contextid</a>) . &quot;\n&quot;;
<a name="l823"><span class="linenum"> 823</span></a>              }
<a name="l824"><span class="linenum"> 824</span></a>          }
<a name="l825"><span class="linenum"> 825</span></a>  
<a name="l826"><span class="linenum"> 826</span></a>  <span class="comment">        // continue path for following error checks</span>
<a name="l827"><span class="linenum"> 827</span></a>          <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('course')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/course.html">course</a>;
<a name="l828"><span class="linenum"> 828</span></a>          <a class="var it5898" onMouseOver="hilite(5898)" onMouseOut="lolite()" onClick="logVariable('continuepath')" href="../_variables/continuepath.html">$continuepath</a> = &quot;{<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>}/question/export.php?courseid={<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('course')" href="../_variables/course.html">$course</a>-&gt;<a onClick="logVariable('id')" class="var it42904" onMouseOver="hilite(42904)" onMouseOut="lolite()" href="../_variables/id.html">id</a>}&quot;;
<a name="l829"><span class="linenum"> 829</span></a>  
<a name="l830"><span class="linenum"> 830</span></a>  <span class="comment">        // did we actually process anything</span>
<a name="l831"><span class="linenum"> 831</span></a>          if (<a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../_variables/count.html">$count</a>==0) {
<a name="l832"><span class="linenum"> 832</span></a>              <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('noquestions', 'question', <a class="var it5898" onMouseOver="hilite(5898)" onMouseOut="lolite()" onClick="logVariable('continuepath')" href="../_variables/continuepath.html">$continuepath</a>);
<a name="l833"><span class="linenum"> 833</span></a>          }
<a name="l834"><span class="linenum"> 834</span></a>  
<a name="l835"><span class="linenum"> 835</span></a>  <span class="comment">        // final pre-process on exported data</span>
<a name="l836"><span class="linenum"> 836</span></a>          <a class="var it5895" onMouseOver="hilite(5895)" onMouseOut="lolite()" onClick="logVariable('expout')" href="../_variables/expout.html">$expout</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('presave_process')" href="../_functions/presave_process.html" onMouseOver="funcPopup(event,'presave_process')">presave_process</a>(<a class="var it5895" onMouseOver="hilite(5895)" onMouseOut="lolite()" onClick="logVariable('expout')" href="../_variables/expout.html">$expout</a>);
<a name="l837"><span class="linenum"> 837</span></a>          return <a class="var it5895" onMouseOver="hilite(5895)" onMouseOut="lolite()" onClick="logVariable('expout')" href="../_variables/expout.html">$expout</a>;
<a name="l838"><span class="linenum"> 838</span></a>      }
<a name="l839"><span class="linenum"> 839</span></a>  
<a name="l840"><span class="linenum"> 840</span></a>      <span class="comment">/**</span>
<a name="l841"><span class="linenum"> 841</span></a>  <span class="comment">     * get the category as a path (e.g., tom/dick/harry)</span>
<a name="l842"><span class="linenum"> 842</span></a>  <span class="comment">     * @param int id the id of the most nested catgory</span>
<a name="l843"><span class="linenum"> 843</span></a>  <span class="comment">     * @return string the path</span>
<a name="l844"><span class="linenum"> 844</span></a>  <span class="comment">     */</span>
<a name="l845"><span class="linenum"> 845</span></a>      protected function <a class="function" onClick="logFunction('get_category_path')" href="../_functions/get_category_path.html" onMouseOver="funcPopup(event,'get_category_path')">get_category_path</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>, <a class="var it5899" onMouseOver="hilite(5899)" onMouseOut="lolite()" onClick="logVariable('includecontext')" href="../_variables/includecontext.html">$includecontext</a> = true) {
<a name="l846"><span class="linenum"> 846</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l847"><span class="linenum"> 847</span></a>  
<a name="l848"><span class="linenum"> 848</span></a>          if (!<a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('question_categories', array('id' =&gt; <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>))) {
<a name="l849"><span class="linenum"> 849</span></a>              <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('cannotfindcategory', 'error', '', <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>);
<a name="l850"><span class="linenum"> 850</span></a>          }
<a name="l851"><span class="linenum"> 851</span></a>          <a class="var it5900" onMouseOver="hilite(5900)" onMouseOut="lolite()" onClick="logVariable('contextstring')" href="../_variables/contextstring.html">$contextstring</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('translator')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../_variables/translator.html">translator</a>-&gt;<a class="function" onClick="logFunction('context_to_string')" href="../_functions/context_to_string.html" onMouseOver="funcPopup(event,'context_to_string')">context_to_string</a>(<a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a>-&gt;<a onClick="logVariable('contextid')" class="var it42970" onMouseOver="hilite(42970)" onMouseOut="lolite()" href="../_variables/contextid.html">contextid</a>);
<a name="l852"><span class="linenum"> 852</span></a>  
<a name="l853"><span class="linenum"> 853</span></a>          <a class="var it5901" onMouseOver="hilite(5901)" onMouseOut="lolite()" onClick="logVariable('pathsections')" href="../_variables/pathsections.html">$pathsections</a> = array();
<a name="l854"><span class="linenum"> 854</span></a>          do {
<a name="l855"><span class="linenum"> 855</span></a>              <a class="var it5901" onMouseOver="hilite(5901)" onMouseOut="lolite()" onClick="logVariable('pathsections')" href="../_variables/pathsections.html">$pathsections</a>[] = <a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a>-&gt;<a onClick="logVariable('name')" class="var it42970" onMouseOver="hilite(42970)" onMouseOut="lolite()" href="../_variables/name.html">name</a>;
<a name="l856"><span class="linenum"> 856</span></a>              <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a> = <a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a>-&gt;<a onClick="logVariable('parent')" class="var it42970" onMouseOver="hilite(42970)" onMouseOut="lolite()" href="../_variables/parent.html">parent</a>;
<a name="l857"><span class="linenum"> 857</span></a>          } while (<a class="var it261" onMouseOver="hilite(261)" onMouseOut="lolite()" onClick="logVariable('category')" href="../_variables/category.html">$category</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('question_categories', array('id' =&gt; <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>)));
<a name="l858"><span class="linenum"> 858</span></a>  
<a name="l859"><span class="linenum"> 859</span></a>          if (<a class="var it5899" onMouseOver="hilite(5899)" onMouseOut="lolite()" onClick="logVariable('includecontext')" href="../_variables/includecontext.html">$includecontext</a>) {
<a name="l860"><span class="linenum"> 860</span></a>              <a class="var it5901" onMouseOver="hilite(5901)" onMouseOut="lolite()" onClick="logVariable('pathsections')" href="../_variables/pathsections.html">$pathsections</a>[] = '$' . <a class="var it5900" onMouseOver="hilite(5900)" onMouseOut="lolite()" onClick="logVariable('contextstring')" href="../_variables/contextstring.html">$contextstring</a> . '$';
<a name="l861"><span class="linenum"> 861</span></a>          }
<a name="l862"><span class="linenum"> 862</span></a>  
<a name="l863"><span class="linenum"> 863</span></a>          <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('path')" href="../_variables/path.html">$path</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('assemble_category_path')" href="../_functions/assemble_category_path.html" onMouseOver="funcPopup(event,'assemble_category_path')">assemble_category_path</a>(<a class="phpfunction" onClick="logFunction('array_reverse')" href="../_functions/array_reverse.html" onMouseOver="phpfuncPopup(event,'array_reverse')">array_reverse</a>(<a class="var it5901" onMouseOver="hilite(5901)" onMouseOut="lolite()" onClick="logVariable('pathsections')" href="../_variables/pathsections.html">$pathsections</a>));
<a name="l864"><span class="linenum"> 864</span></a>  
<a name="l865"><span class="linenum"> 865</span></a>          return <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('path')" href="../_variables/path.html">$path</a>;
<a name="l866"><span class="linenum"> 866</span></a>      }
<a name="l867"><span class="linenum"> 867</span></a>  
<a name="l868"><span class="linenum"> 868</span></a>      <span class="comment">/**</span>
<a name="l869"><span class="linenum"> 869</span></a>  <span class="comment">     * Convert a list of category names, possibly preceeded by one of the</span>
<a name="l870"><span class="linenum"> 870</span></a>  <span class="comment">     * context tokens like $course$, into a string representation of the</span>
<a name="l871"><span class="linenum"> 871</span></a>  <span class="comment">     * category path.</span>
<a name="l872"><span class="linenum"> 872</span></a>  <span class="comment">     *</span>
<a name="l873"><span class="linenum"> 873</span></a>  <span class="comment">     * Names are separated by / delimiters. And /s in the name are replaced by //.</span>
<a name="l874"><span class="linenum"> 874</span></a>  <span class="comment">     *</span>
<a name="l875"><span class="linenum"> 875</span></a>  <span class="comment">     * To reverse the process and split the paths into names, use</span>
<a name="l876"><span class="linenum"> 876</span></a>  <span class="comment">     * {@link split_category_path()}.</span>
<a name="l877"><span class="linenum"> 877</span></a>  <span class="comment">     *</span>
<a name="l878"><span class="linenum"> 878</span></a>  <span class="comment">     * @param array $names</span>
<a name="l879"><span class="linenum"> 879</span></a>  <span class="comment">     * @return string</span>
<a name="l880"><span class="linenum"> 880</span></a>  <span class="comment">     */</span>
<a name="l881"><span class="linenum"> 881</span></a>      protected function <a class="function" onClick="logFunction('assemble_category_path')" href="../_functions/assemble_category_path.html" onMouseOver="funcPopup(event,'assemble_category_path')">assemble_category_path</a>(<a class="var it3550" onMouseOver="hilite(3550)" onMouseOut="lolite()" onClick="logVariable('names')" href="../_variables/names.html">$names</a>) {
<a name="l882"><span class="linenum"> 882</span></a>          <a class="var it5902" onMouseOver="hilite(5902)" onMouseOut="lolite()" onClick="logVariable('escapednames')" href="../_variables/escapednames.html">$escapednames</a> = array();
<a name="l883"><span class="linenum"> 883</span></a>          foreach (<a class="var it3550" onMouseOver="hilite(3550)" onMouseOut="lolite()" onClick="logVariable('names')" href="../_variables/names.html">$names</a> as <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>) {
<a name="l884"><span class="linenum"> 884</span></a>              <a class="var it5903" onMouseOver="hilite(5903)" onMouseOut="lolite()" onClick="logVariable('escapedname')" href="../_variables/escapedname.html">$escapedname</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('/', '//', <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../_variables/name.html">$name</a>);
<a name="l885"><span class="linenum"> 885</span></a>              if (<a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it5903" onMouseOver="hilite(5903)" onMouseOut="lolite()" onClick="logVariable('escapedname')" href="../_variables/escapedname.html">$escapedname</a>, 0, 1) == '/') {
<a name="l886"><span class="linenum"> 886</span></a>                  <a class="var it5903" onMouseOver="hilite(5903)" onMouseOut="lolite()" onClick="logVariable('escapedname')" href="../_variables/escapedname.html">$escapedname</a> = ' ' . <a class="var it5903" onMouseOver="hilite(5903)" onMouseOut="lolite()" onClick="logVariable('escapedname')" href="../_variables/escapedname.html">$escapedname</a>;
<a name="l887"><span class="linenum"> 887</span></a>              }
<a name="l888"><span class="linenum"> 888</span></a>              if (<a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it5903" onMouseOver="hilite(5903)" onMouseOut="lolite()" onClick="logVariable('escapedname')" href="../_variables/escapedname.html">$escapedname</a>, -1) == '/') {
<a name="l889"><span class="linenum"> 889</span></a>                  <a class="var it5903" onMouseOver="hilite(5903)" onMouseOut="lolite()" onClick="logVariable('escapedname')" href="../_variables/escapedname.html">$escapedname</a> = <a class="var it5903" onMouseOver="hilite(5903)" onMouseOut="lolite()" onClick="logVariable('escapedname')" href="../_variables/escapedname.html">$escapedname</a> . ' ';
<a name="l890"><span class="linenum"> 890</span></a>              }
<a name="l891"><span class="linenum"> 891</span></a>              <a class="var it5902" onMouseOver="hilite(5902)" onMouseOut="lolite()" onClick="logVariable('escapednames')" href="../_variables/escapednames.html">$escapednames</a>[] = <a class="var it5903" onMouseOver="hilite(5903)" onMouseOut="lolite()" onClick="logVariable('escapedname')" href="../_variables/escapedname.html">$escapedname</a>;
<a name="l892"><span class="linenum"> 892</span></a>          }
<a name="l893"><span class="linenum"> 893</span></a>          return <a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>('/', <a class="var it5902" onMouseOver="hilite(5902)" onMouseOut="lolite()" onClick="logVariable('escapednames')" href="../_variables/escapednames.html">$escapednames</a>);
<a name="l894"><span class="linenum"> 894</span></a>      }
<a name="l895"><span class="linenum"> 895</span></a>  
<a name="l896"><span class="linenum"> 896</span></a>      <span class="comment">/**</span>
<a name="l897"><span class="linenum"> 897</span></a>  <span class="comment">     * Convert a string, as returned by {@link assemble_category_path()},</span>
<a name="l898"><span class="linenum"> 898</span></a>  <span class="comment">     * back into an array of category names.</span>
<a name="l899"><span class="linenum"> 899</span></a>  <span class="comment">     *</span>
<a name="l900"><span class="linenum"> 900</span></a>  <span class="comment">     * Each category name is cleaned by a call to clean_param(, PARAM_TEXT),</span>
<a name="l901"><span class="linenum"> 901</span></a>  <span class="comment">     * which matches the cleaning in question/category_form.php.</span>
<a name="l902"><span class="linenum"> 902</span></a>  <span class="comment">     *</span>
<a name="l903"><span class="linenum"> 903</span></a>  <span class="comment">     * @param string $path</span>
<a name="l904"><span class="linenum"> 904</span></a>  <span class="comment">     * @return array of category names.</span>
<a name="l905"><span class="linenum"> 905</span></a>  <span class="comment">     */</span>
<a name="l906"><span class="linenum"> 906</span></a>      protected function <a class="function" onClick="logFunction('split_category_path')" href="../_functions/split_category_path.html" onMouseOver="funcPopup(event,'split_category_path')">split_category_path</a>(<a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('path')" href="../_variables/path.html">$path</a>) {
<a name="l907"><span class="linenum"> 907</span></a>          <a class="var it5904" onMouseOver="hilite(5904)" onMouseOut="lolite()" onClick="logVariable('rawnames')" href="../_variables/rawnames.html">$rawnames</a> = <a class="phpfunction" onClick="logFunction('preg_split')" href="../_functions/preg_split.html" onMouseOver="phpfuncPopup(event,'preg_split')">preg_split</a>('~(?&lt;!/)/(?!/)~', <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('path')" href="../_variables/path.html">$path</a>);
<a name="l908"><span class="linenum"> 908</span></a>          <a class="var it3550" onMouseOver="hilite(3550)" onMouseOut="lolite()" onClick="logVariable('names')" href="../_variables/names.html">$names</a> = array();
<a name="l909"><span class="linenum"> 909</span></a>          foreach (<a class="var it5904" onMouseOver="hilite(5904)" onMouseOut="lolite()" onClick="logVariable('rawnames')" href="../_variables/rawnames.html">$rawnames</a> as <a class="var it2648" onMouseOver="hilite(2648)" onMouseOut="lolite()" onClick="logVariable('rawname')" href="../_variables/rawname.html">$rawname</a>) {
<a name="l910"><span class="linenum"> 910</span></a>              <a class="var it3550" onMouseOver="hilite(3550)" onMouseOut="lolite()" onClick="logVariable('names')" href="../_variables/names.html">$names</a>[] = <a class="function" onClick="logFunction('clean_param')" href="../_functions/clean_param.html" onMouseOver="funcPopup(event,'clean_param')">clean_param</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="phpfunction" onClick="logFunction('str_replace')" href="../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('//', '/', <a class="var it2648" onMouseOver="hilite(2648)" onMouseOut="lolite()" onClick="logVariable('rawname')" href="../_variables/rawname.html">$rawname</a>)), <a class="constant" onClick="logConstant('PARAM_TEXT')" href="../_constants/PARAM_TEXT.html" onMouseOver="constPopup(event,'PARAM_TEXT')">PARAM_TEXT</a>);
<a name="l911"><span class="linenum"> 911</span></a>          }
<a name="l912"><span class="linenum"> 912</span></a>          return <a class="var it3550" onMouseOver="hilite(3550)" onMouseOut="lolite()" onClick="logVariable('names')" href="../_variables/names.html">$names</a>;
<a name="l913"><span class="linenum"> 913</span></a>      }
<a name="l914"><span class="linenum"> 914</span></a>  
<a name="l915"><span class="linenum"> 915</span></a>      <span class="comment">/**</span>
<a name="l916"><span class="linenum"> 916</span></a>  <span class="comment">     * Do an post-processing that may be required</span>
<a name="l917"><span class="linenum"> 917</span></a>  <span class="comment">     * @return bool success</span>
<a name="l918"><span class="linenum"> 918</span></a>  <span class="comment">     */</span>
<a name="l919"><span class="linenum"> 919</span></a>      protected function <a class="function" onClick="logFunction('exportpostprocess')" href="../_functions/exportpostprocess.html" onMouseOver="funcPopup(event,'exportpostprocess')">exportpostprocess</a>() {
<a name="l920"><span class="linenum"> 920</span></a>          return true;
<a name="l921"><span class="linenum"> 921</span></a>      }
<a name="l922"><span class="linenum"> 922</span></a>  
<a name="l923"><span class="linenum"> 923</span></a>      <span class="comment">/**</span>
<a name="l924"><span class="linenum"> 924</span></a>  <span class="comment">     * convert a single question object into text output in the given</span>
<a name="l925"><span class="linenum"> 925</span></a>  <span class="comment">     * format.</span>
<a name="l926"><span class="linenum"> 926</span></a>  <span class="comment">     * This must be overriden</span>
<a name="l927"><span class="linenum"> 927</span></a>  <span class="comment">     * @param object question question object</span>
<a name="l928"><span class="linenum"> 928</span></a>  <span class="comment">     * @return mixed question export text or null if not implemented</span>
<a name="l929"><span class="linenum"> 929</span></a>  <span class="comment">     */</span>
<a name="l930"><span class="linenum"> 930</span></a>      protected function <a class="function" onClick="logFunction('writequestion')" href="../_functions/writequestion.html" onMouseOver="funcPopup(event,'writequestion')">writequestion</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>) {
<a name="l931"><span class="linenum"> 931</span></a>  <span class="comment">        // if not overidden, then this is an error.</span>
<a name="l932"><span class="linenum"> 932</span></a>          throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Question format plugin is missing important code: writequestion.');
<a name="l933"><span class="linenum"> 933</span></a>          return null;
<a name="l934"><span class="linenum"> 934</span></a>      }
<a name="l935"><span class="linenum"> 935</span></a>  
<a name="l936"><span class="linenum"> 936</span></a>      <span class="comment">/**</span>
<a name="l937"><span class="linenum"> 937</span></a>  <span class="comment">     * Convert the question text to plain text, so it can safely be displayed</span>
<a name="l938"><span class="linenum"> 938</span></a>  <span class="comment">     * during import to let the user see roughly what is going on.</span>
<a name="l939"><span class="linenum"> 939</span></a>  <span class="comment">     */</span>
<a name="l940"><span class="linenum"> 940</span></a>      protected function <a class="function" onClick="logFunction('format_question_text')" href="../_functions/format_question_text.html" onMouseOver="funcPopup(event,'format_question_text')">format_question_text</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>) {
<a name="l941"><span class="linenum"> 941</span></a>          return question_utils::<a class="function" onClick="logFunction('to_plain_text')" href="../_functions/to_plain_text.html" onMouseOver="funcPopup(event,'to_plain_text')">to_plain_text</a>(<a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('questiontext')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/questiontext.html">questiontext</a>,
<a name="l942"><span class="linenum"> 942</span></a>                  <a class="var it259" onMouseOver="hilite(259)" onMouseOut="lolite()" onClick="logVariable('question')" href="../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('questiontextformat')" class="var it43018" onMouseOver="hilite(43018)" onMouseOut="lolite()" href="../_variables/questiontextformat.html">questiontextformat</a>);
<a name="l943"><span class="linenum"> 943</span></a>      }
<a name="l944"><span class="linenum"> 944</span></a>  }
<a name="l945"><span class="linenum"> 945</span></a>  
<a name="l946"><span class="linenum"> 946</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('qformat_based_on_xml')" href="../_classes/qformat_based_on_xml.html" onMouseOver="classPopup(event,'qformat_based_on_xml')">qformat_based_on_xml</a> <span class="keyword">extends</span> <a class="class" onClick="logClass('qformat_default')" href="../_classes/qformat_default.html" onMouseOver="classPopup(event,'qformat_default')">qformat_default</a> {
<a name="l947"><span class="linenum"> 947</span></a>  
<a name="l948"><span class="linenum"> 948</span></a>      <span class="comment">/**</span>
<a name="l949"><span class="linenum"> 949</span></a>  <span class="comment">     * A lot of imported files contain unwanted entities.</span>
<a name="l950"><span class="linenum"> 950</span></a>  <span class="comment">     * This method tries to clean up all known problems.</span>
<a name="l951"><span class="linenum"> 951</span></a>  <span class="comment">     * @param string str string to correct</span>
<a name="l952"><span class="linenum"> 952</span></a>  <span class="comment">     * @return string the corrected string</span>
<a name="l953"><span class="linenum"> 953</span></a>  <span class="comment">     */</span>
<a name="l954"><span class="linenum"> 954</span></a>      public function <a class="function" onClick="logFunction('cleaninput')" href="../_functions/cleaninput.html" onMouseOver="funcPopup(event,'cleaninput')">cleaninput</a>(<a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>) {
<a name="l955"><span class="linenum"> 955</span></a>  
<a name="l956"><span class="linenum"> 956</span></a>          <a class="var it5905" onMouseOver="hilite(5905)" onMouseOut="lolite()" onClick="logVariable('html_code_list')" href="../_variables/html_code_list.html">$html_code_list</a> = array(
<a name="l957"><span class="linenum"> 957</span></a>              &quot;&amp;#039;&quot; =&gt; &quot;'&quot;,
<a name="l958"><span class="linenum"> 958</span></a>              &quot;&amp;#8217;&quot; =&gt; &quot;'&quot;,
<a name="l959"><span class="linenum"> 959</span></a>              &quot;&amp;#8220;&quot; =&gt; &quot;\&quot;&quot;,
<a name="l960"><span class="linenum"> 960</span></a>              &quot;&amp;#8221;&quot; =&gt; &quot;\&quot;&quot;,
<a name="l961"><span class="linenum"> 961</span></a>              &quot;&amp;#8211;&quot; =&gt; &quot;-&quot;,
<a name="l962"><span class="linenum"> 962</span></a>              &quot;&amp;#8212;&quot; =&gt; &quot;-&quot;,
<a name="l963"><span class="linenum"> 963</span></a>          );
<a name="l964"><span class="linenum"> 964</span></a>          <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a> = <a class="phpfunction" onClick="logFunction('strtr')" href="../_functions/strtr.html" onMouseOver="phpfuncPopup(event,'strtr')">strtr</a>(<a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>, <a class="var it5905" onMouseOver="hilite(5905)" onMouseOut="lolite()" onClick="logVariable('html_code_list')" href="../_variables/html_code_list.html">$html_code_list</a>);
<a name="l965"><span class="linenum"> 965</span></a>  <span class="comment">        // Use core_text entities_to_utf8 function to convert only numerical entities.</span>
<a name="l966"><span class="linenum"> 966</span></a>          <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a> = <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('entities_to_utf8')" href="../_functions/entities_to_utf8.html" onMouseOver="funcPopup(event,'entities_to_utf8')">entities_to_utf8</a>(<a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>, false);
<a name="l967"><span class="linenum"> 967</span></a>          return <a class="var it163" onMouseOver="hilite(163)" onMouseOut="lolite()" onClick="logVariable('str')" href="../_variables/str.html">$str</a>;
<a name="l968"><span class="linenum"> 968</span></a>      }
<a name="l969"><span class="linenum"> 969</span></a>  
<a name="l970"><span class="linenum"> 970</span></a>      <span class="comment">/**</span>
<a name="l971"><span class="linenum"> 971</span></a>  <span class="comment">     * Return the array moodle is expecting</span>
<a name="l972"><span class="linenum"> 972</span></a>  <span class="comment">     * for an HTML text. No processing is done on $text.</span>
<a name="l973"><span class="linenum"> 973</span></a>  <span class="comment">     * qformat classes that want to process $text</span>
<a name="l974"><span class="linenum"> 974</span></a>  <span class="comment">     * for instance to import external images files</span>
<a name="l975"><span class="linenum"> 975</span></a>  <span class="comment">     * and recode urls in $text must overwrite this method.</span>
<a name="l976"><span class="linenum"> 976</span></a>  <span class="comment">     * @param array $text some HTML text string</span>
<a name="l977"><span class="linenum"> 977</span></a>  <span class="comment">     * @return array with keys text, format and files.</span>
<a name="l978"><span class="linenum"> 978</span></a>  <span class="comment">     */</span>
<a name="l979"><span class="linenum"> 979</span></a>      public function <a class="function" onClick="logFunction('text_field')" href="../_functions/text_field.html" onMouseOver="funcPopup(event,'text_field')">text_field</a>(<a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../_variables/text.html">$text</a>) {
<a name="l980"><span class="linenum"> 980</span></a>          return array(
<a name="l981"><span class="linenum"> 981</span></a>              'text' =&gt; <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../_variables/text.html">$text</a>),
<a name="l982"><span class="linenum"> 982</span></a>              'format' =&gt; <a class="constant" onClick="logConstant('FORMAT_HTML')" href="../_constants/FORMAT_HTML.html" onMouseOver="constPopup(event,'FORMAT_HTML')">FORMAT_HTML</a>,
<a name="l983"><span class="linenum"> 983</span></a>              'files' =&gt; array(),
<a name="l984"><span class="linenum"> 984</span></a>          );
<a name="l985"><span class="linenum"> 985</span></a>      }
<a name="l986"><span class="linenum"> 986</span></a>  
<a name="l987"><span class="linenum"> 987</span></a>      <span class="comment">/**</span>
<a name="l988"><span class="linenum"> 988</span></a>  <span class="comment">     * Return the value of a node, given a path to the node</span>
<a name="l989"><span class="linenum"> 989</span></a>  <span class="comment">     * if it doesn't exist return the default value.</span>
<a name="l990"><span class="linenum"> 990</span></a>  <span class="comment">     * @param array xml data to read</span>
<a name="l991"><span class="linenum"> 991</span></a>  <span class="comment">     * @param array path path to node expressed as array</span>
<a name="l992"><span class="linenum"> 992</span></a>  <span class="comment">     * @param mixed default</span>
<a name="l993"><span class="linenum"> 993</span></a>  <span class="comment">     * @param bool istext process as text</span>
<a name="l994"><span class="linenum"> 994</span></a>  <span class="comment">     * @param string error if set value must exist, return false and issue message if not</span>
<a name="l995"><span class="linenum"> 995</span></a>  <span class="comment">     * @return mixed value</span>
<a name="l996"><span class="linenum"> 996</span></a>  <span class="comment">     */</span>
<a name="l997"><span class="linenum"> 997</span></a>      public function <a class="function" onClick="logFunction('getpath')" href="../_functions/getpath.html" onMouseOver="funcPopup(event,'getpath')">getpath</a>(<a class="var it1525" onMouseOver="hilite(1525)" onMouseOut="lolite()" onClick="logVariable('xml')" href="../_variables/xml.html">$xml</a>, <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('path')" href="../_variables/path.html">$path</a>, <a class="var it777" onMouseOver="hilite(777)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>, <a class="var it5906" onMouseOver="hilite(5906)" onMouseOut="lolite()" onClick="logVariable('istext')" href="../_variables/istext.html">$istext</a>=false, <a class="var it275" onMouseOver="hilite(275)" onMouseOut="lolite()" onClick="logVariable('error')" href="../_variables/error.html">$error</a>='') {
<a name="l998"><span class="linenum"> 998</span></a>          foreach (<a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('path')" href="../_variables/path.html">$path</a> as <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../_variables/index.html">$index</a>) {
<a name="l999"><span class="linenum"> 999</span></a>              if (!isset(<a class="var it1525" onMouseOver="hilite(1525)" onMouseOut="lolite()" onClick="logVariable('xml')" href="../_variables/xml.html">$xml</a>[<a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../_variables/index.html">$index</a>])) {
<a name="l1000"><span class="linenum">1000</span></a>                  if (!empty(<a class="var it275" onMouseOver="hilite(275)" onMouseOut="lolite()" onClick="logVariable('error')" href="../_variables/error.html">$error</a>)) {
<a name="l1001"><span class="linenum">1001</span></a>                      <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('error')" href="../_functions/error.html" onMouseOver="funcPopup(event,'error')">error</a>(<a class="var it275" onMouseOver="hilite(275)" onMouseOut="lolite()" onClick="logVariable('error')" href="../_variables/error.html">$error</a>);
<a name="l1002"><span class="linenum">1002</span></a>                      return false;
<a name="l1003"><span class="linenum">1003</span></a>                  } else {
<a name="l1004"><span class="linenum">1004</span></a>                      return <a class="var it777" onMouseOver="hilite(777)" onMouseOut="lolite()" onClick="logVariable('default')" href="../_variables/default.html">$default</a>;
<a name="l1005"><span class="linenum">1005</span></a>                  }
<a name="l1006"><span class="linenum">1006</span></a>              }
<a name="l1007"><span class="linenum">1007</span></a>  
<a name="l1008"><span class="linenum">1008</span></a>              <a class="var it1525" onMouseOver="hilite(1525)" onMouseOut="lolite()" onClick="logVariable('xml')" href="../_variables/xml.html">$xml</a> = <a class="var it1525" onMouseOver="hilite(1525)" onMouseOut="lolite()" onClick="logVariable('xml')" href="../_variables/xml.html">$xml</a>[<a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../_variables/index.html">$index</a>];
<a name="l1009"><span class="linenum">1009</span></a>          }
<a name="l1010"><span class="linenum">1010</span></a>  
<a name="l1011"><span class="linenum">1011</span></a>          if (<a class="var it5906" onMouseOver="hilite(5906)" onMouseOut="lolite()" onClick="logVariable('istext')" href="../_variables/istext.html">$istext</a>) {
<a name="l1012"><span class="linenum">1012</span></a>              if (!<a class="phpfunction" onClick="logFunction('is_string')" href="../_functions/is_string.html" onMouseOver="phpfuncPopup(event,'is_string')">is_string</a>(<a class="var it1525" onMouseOver="hilite(1525)" onMouseOut="lolite()" onClick="logVariable('xml')" href="../_variables/xml.html">$xml</a>)) {
<a name="l1013"><span class="linenum">1013</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('error')" href="../_functions/error.html" onMouseOver="funcPopup(event,'error')">error</a>(<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('invalidxml', 'qformat_xml'));
<a name="l1014"><span class="linenum">1014</span></a>              }
<a name="l1015"><span class="linenum">1015</span></a>              <a class="var it1525" onMouseOver="hilite(1525)" onMouseOut="lolite()" onClick="logVariable('xml')" href="../_variables/xml.html">$xml</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it1525" onMouseOver="hilite(1525)" onMouseOut="lolite()" onClick="logVariable('xml')" href="../_variables/xml.html">$xml</a>);
<a name="l1016"><span class="linenum">1016</span></a>          }
<a name="l1017"><span class="linenum">1017</span></a>  
<a name="l1018"><span class="linenum">1018</span></a>          return <a class="var it1525" onMouseOver="hilite(1525)" onMouseOut="lolite()" onClick="logVariable('xml')" href="../_variables/xml.html">$xml</a>;
<a name="l1019"><span class="linenum">1019</span></a>      }
<a name="l1020"><span class="linenum">1020</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'update_record': ['update_record', 'Update a record in a table ', [['lib/dml','pdo_moodle_database.php',461],['lib/dml','oci_native_moodle_database.php',1404],['lib/dml','pgsql_native_moodle_database.php',1089],['lib/dml','mssql_native_moodle_database.php',1067],['lib/dml','mysqli_native_moodle_database.php',1405],['lib/dml','sqlsrv_native_moodle_database.php',1148],['lib/dml/tests','dml_test.php',5551]], 650],
'cleaninput': ['cleaninput', 'A lot of imported files contain unwanted entities. This method tries to clean up all known problems. ', [['question','format.php',948],['mod/lesson','format.php',749]], 5],
'writequestion': ['writequestion', 'convert a single question object into text output in the given format. This must be overriden ', [['question','format.php',923],['question/format/xml','format.php',1134],['question/format/xhtml','format.php',47],['question/format/gift','format.php',633]], 24],
'create_default_question_name': ['create_default_question_name', 'Construct a reasonable default question name, based on the start of the question text. ', [['question','format.php',639],['mod/lesson','format.php',639]], 15],
'readquestions': ['readquestions', 'Parse the array of objects into an array of questions. Each object is the content of a .dat questions file. This *could* burn memory - but it won\'t happen that much so fingers crossed! ', [['question/format/blackboard_six','format.php',182],['question','format.php',555],['question/format/blackboard_six','formatqti.php',36],['question/format/blackboard_six','formatpool.php',43],['question/format/aiken','format.php',60],['question/format/webct','format.php',335],['question/format/multianswer','format.php',42],['question/format/xml','format.php',913],['mod/lesson','format.php',595],['question/format/examview','format.php',159]], 30],
'start_delegated_transaction': ['start_delegated_transaction', 'On DBs that support it, switch to transaction mode and begin a transaction you\'ll need to ensure you call allow_commit() on the returned object or your changes *will* be lost. ', [['lib/dml','moodle_database.php',2393]], 145],
'fraction_options_full': ['fraction_options_full', '', [['question/engine','bank.php',410]], 6],
'raise_memory_limit': ['raise_memory_limit', 'Function to raise the memory limit to a new value. Will respect the memory limit if it is higher, thus allowing settings in php.ini, apache conf or command line switches to override it. ', [['lib','setuplib.php',1206]], 59],
'setfilename': ['setfilename', 'set the filename ', [['question','format.php',141],['lib/google/src/Google/Service','MapsEngine.php',4928],['lib/editor/tinymce/plugins/spellchecker/classes/utils','Logger.php',107],['lib/google/src/Google/Service','ShoppingContent.php',3838],['lib/google/src/Google/Service','Genomics.php',2745],['lib/google/src/Google/Service','Gmail.php',1908],['lib/google/src/Google/Service','YouTube.php',11970],['lib/google/src/Google/Service','Dfareporting.php',13515],['lib/google/src/Google/Service','Dfareporting.php',19194]], 1],
'question_has_capability_on': ['question_has_capability_on', 'Check capability on category ', [['lib','questionlib.php',1300]], 22],
'shorten_text': ['shorten_text', 'Given some text (which may contain HTML) and an ideal length, this function truncates the text neatly on a word boundary if possible ', [['lib','moodlelib.php',7822]], 87],
'strlen': ['strlen', 'Counts the number of characters. Unit-tested by Kasper (single byte charsets only) ', [['lib/typo3','class.t3lib_cs.php',1520],['lib/classes','text.php',305]], 1649],
'to_plain_text': ['to_plain_text', 'Convert part of some question content to plain text. ', [['question/engine','lib.php',942]], 6],
'get_qtype': ['get_qtype', 'Get the question type class for a particular question type. ', [['question/engine','bank.php',80],['question/format/xml','format.php',1009]], 113],
'match_grade_options': ['match_grade_options', 'Check whether a given grade is one of a list of allowed options. If not, depending on $matchgrades, either return the nearest match, or return false to signal an error. ', [['lib','questionlib.php',181]], 10],
'setstoponerror': ['setstoponerror', 'set stoponerror ', [['question','format.php',198]], 1],
'setmatchgrades': ['setmatchgrades', 'set matchgrades ', [['question','format.php',158]], 1],
'add_blank_combined_feedback': ['add_blank_combined_feedback', 'Add a blank combined feedback to a question object. ', [['question','format.php',670],['mod/lesson','format.php',733]], 10],
'defaultquestion': ['defaultquestion', 'return an "empty" question Somewhere to specify question parameters that are not handled by import but are required db fields. This should not be overridden. ', [['question','format.php',601],['mod/lesson','format.php',670]], 17],
'exportpreprocess': ['exportpreprocess', 'Do any pre-processing that may be required ', [['question','format.php',737]], 1],
'mimeinfo': ['mimeinfo', 'Obtains information about a filetype based on its extension. Will use a default if no information is present about that particular extension. ', [['lib','filelib.php',1422]], 33],
'force_transaction_rollback': ['force_transaction_rollback', 'Force rollback of all delegated transaction. Does not throw any exceptions and does not log anything. ', [['lib/dml','moodle_database.php',2527]], 18],
'setcontextfromfile': ['setcontextfromfile', 'set contextfromfile ', [['question','format.php',174]], 1],
'raise': ['raise', 'Sets the PHP time limit to a number of seconds from now. ', [['lib/classes','php_time_limit.php',41]], 90],
'file_save_draft_area_files': ['file_save_draft_area_files', 'Saves files from a draft file area to a real one (merging the list of files). Can rewrite URLs in some content at the same time if desired. ', [['lib','filelib.php',778]], 61],
'split_category_path': ['split_category_path', 'Convert a string, as returned by {@link assemble_category_path()}, back into an array of category names. ', [['question','format.php',896],['question/tests','importexport_test.php',45]], 4],
'print_error': ['print_error', 'Abort execution by throwing of a general exception, default exception handler displays the error message in most cases. ', [['lib','setuplib.php',481]], 1488],
'get_category_path': ['get_category_path', 'get the category as a path (e.g., tom/dick/harry) ', [['question','format.php',840]], 1],
'import_file': ['import_file', '', [['question/type','questiontypebase.php',1398]], 3],
'importprocess': ['importprocess', 'Process the file This method should not normally be overidden ', [['question','format.php',283],['mod/lesson','format.php',403]], 2],
'set_field': ['set_field', 'Set a single field in every table record where all the given conditions met. ', [['lib/dml','moodle_database.php',1737],['availability/condition/profile/tests','condition_test.php',349]], 485],
'format_question_text': ['format_question_text', 'Convert the question text to plain text, so it can safely be displayed during import to let the user see roughly what is going on. ', [['question','format.php',936],['mod/lesson','format.php',717]], 2],
'setcatfromfile': ['setcatfromfile', 'set catfromfile ', [['question','format.php',166]], 1],
'readdata': ['readdata', 'Return content of all files containing questions, as an array one element for each file found, For each file, the corresponding element is an array of lines. ', [['question/format/blackboard_six','format.php',75],['question','format.php',533],['question/format/webct','format.php',264],['mod/lesson','format.php',579]], 2],
'provide_import': ['provide_import', '', [['question','format.php',61],['question/format/blackboard_six','formatbase.php',40],['question/format/aiken','format.php',56],['question/format/webct','format.php',172],['question/format/multianswer','format.php',38],['question/format/xml','format.php',49],['question/format/missingword','format.php',54],['mod/lesson','format.php',356],['question/format/gift','format.php',64],['question/format/examview','format.php',56]], 2],
'try_importing_using_qtypes': ['try_importing_using_qtypes', 'Import for questiontype plugins Do not override. ', [['question','format.php',236],['mod/lesson','format.php',384]], 5],
'context_to_string': ['context_to_string', '', [['lib','questionlib.php',1265]], 1],
'setquestions': ['setquestions', 'Set the specific questions to export. Should not include questions with parents (sub questions of cloze question type). Only used for question export. ', [['question','format.php',111]], 0],
'clean_question_name': ['clean_question_name', 'Ensure that a question name does not contain anything nasty, and will fit in the DB field. ', [['question','format.php',654],['mod/lesson','format.php',654]], 13],
'error': ['error', '', [['lib','deprecatedlib.php',863],['lib/minify/lib','FirePHP.php',416],['question','format.php',218],['lib/simplepie/library','SimplePie.php',1554],['lib/adodb','adodb-active-record.inc.php',546],['auth/cas/CAS','CAS.php',535],['lib/tcpdf','tcpdf.php',2915],['lib/lessphp/Tree','DefaultFunc.php',27],['lib/editor/tinymce/plugins/spellchecker/classes/utils','Logger.php',166],['lib/editor/tinymce/tiny_mce/3.5.11','tiny_mce_src.js',10815],['admin/tool/uploadcourse/classes','course.php',238],['lib/yuilib/3.17.2/cookie','cookie.js',34],['lib/htmlpurifier/HTMLPurifier/ConfigSchema','ValidatorAtom.php',124],['lib/htmlpurifier/HTMLPurifier','VarParser.php',143],['mod/lesson','format.php',364],['lib/tcpdf','tcpdf_parser.php',797],['lib/adodb','adodb-active-recordx.inc.php',575],['lib/yuilib/3.17.2/cookie','cookie-debug.js',34],['lib/tcpdf/include','tcpdf_filters.php',467],['lib/mustache/src/Mustache/Logger','AbstractLogger.php',61],['lib/lessphp','Parser.php',2615],['lib/horde/framework/Horde/Imap/Client','DateTime.php',69],['lib/simplepie/library/SimplePie','Misc.php',154],['lib/google/src/Google/Logger','Abstract.php',200],['lib/classes','notification.php',160],['lib/mustache/src/Mustache','Logger.php',72],['lib/htmlpurifier/HTMLPurifier/ConfigSchema','Validator.php',224]], 936],
'presave_process': ['presave_process', 'Enable any processing to be done on the content just prior to the file being saved default is to do nothing ', [['question','format.php',745],['question/format/xml','format.php',1127],['question/format/xhtml','format.php',160]], 1],
'require_capability': ['require_capability', 'Wrapper round the require_capability funciton that automatically passes in the quiz context. ', [['mod/quiz','attemptlib.php',306],['mod/quiz','attemptlib.php',929],['lib','accesslib.php',762],['backup/util/ui','restore_ui_components.php',157]], 690],
'make_unique_id_code': ['make_unique_id_code', 'make_unique_id_code ', [['lib','moodlelib.php',8250]], 26],
'exportprocess': ['exportprocess', 'Do the export For most types this should not need to be overrided ', [['question','format.php',756]], 1],
'setcontexttofile': ['setcontexttofile', 'set contexttofile ', [['question','format.php',190]], 2],
'trim_utf8_bom': ['trim_utf8_bom', 'Removes the BOM from unicode string {@link http://unicode.org/faq/utf_bom.html} ', [['lib/classes','text.php',611]], 3],
's': ['s', 'Count of attempts selected by $this->whichattempts ', [['mod/quiz/report/statistics/classes','calculated.php',91],['lib','weblib.php',84]], 1072],
'importpreprocess': ['importpreprocess', 'Perform any required pre-processing ', [['question','format.php',275],['mod/lesson','format.php',398]], 2],
'assemble_category_path': ['assemble_category_path', 'Convert a list of category names, possibly preceeded by one of the context tokens like $course$, into a string representation of the category path. ', [['question','format.php',868],['question/tests','importexport_test.php',41]], 3],
'setcourse': ['setcourse', 'set the course class variable ', [['question','format.php',124]], 2],
'question_hash': ['question_hash', 'Creates a stamp that uniquely identifies this version of the question ', [['lib','questionlib.php',833]], 2],
'entities_to_utf8': ['entities_to_utf8', 'Converts numeric entities (UNICODE, eg. decimal (&#1234;) or hexadecimal (&#x1b;)) to UTF-8 multibyte chars ', [['lib/typo3','class.t3lib_cs.php',810],['lib/classes','text.php',548]], 11],
'notification': ['notification', 'Output a notification (that is, a status message about something that has just happened). ', [['lib','outputrenderers.php',2849],['lib','outputrenderers.php',4412],['lib','outputrenderers.php',4496]], 540],
'get_config': ['get_config', 'Config get method. ', [['lib/classes/antivirus','scanner.php',54],['competency/classes','competency_rule.php',59],['question/engine','bank.php',109],['admin/tool/log/classes/helper','store.php',63],['lib','moodlelib.php',1409],['lib','enrollib.php',1142],['lib/editor/tinymce/classes','plugin.php',73],['competency/classes','competency_rule_points.php',43],['search/classes','base.php',169],['mod/assign','assignmentplugin.php',345],['lib/portfolio','plugin.php',546]], 934],
'get_mimetype': ['get_mimetype', 'Returns mimetype ', [['lib/filebrowser','file_info.php',277],['lib/filebrowser','virtual_root_file.php',254],['lib/filebrowser','file_info_stored.php',240],['lib/filestorage','stored_file.php',738],['lib','medialib.php',192],['lib/portfolio','caller.php',453]], 59],
'allow_commit': ['allow_commit', 'Commit delegated transaction. The real database commit SQL is executed only after committing all delegated transactions. ', [['lib/dml','moodle_transaction.php',78]], 135],
'setcattofile': ['setcattofile', 'set cattofile ', [['question','format.php',182]], 2],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required, Some conversions and safety checks are carried out. Lobs are supported. If the return ID isn\'t required, then this just reports success as true/false. $data is an object containing needed data ', [['lib/dml','pdo_moodle_database.php',387],['lib/dml','oci_native_moodle_database.php',1297],['lib/dml','pgsql_native_moodle_database.php',889],['lib/dml','mssql_native_moodle_database.php',962],['lib/dml','mysqli_native_moodle_database.php',1185],['question/engine/upgrade','upgradelib.php',124],['lib/dml','sqlsrv_native_moodle_database.php',1045],['lib/dml/tests','dml_test.php',5548]], 1611],
'save_question_options': ['save_question_options', 'Saves question-type specific options ', [['question/type','questiontypebase.php',412],['question/type/calculated','questiontype.php',133],['question/type/multianswer','questiontype.php',80],['question/type/numerical','questiontype.php',149],['question/type/multichoice','questiontype.php',47],['question/type/truefalse','questiontype.php',39],['question/type/random','questiontype.php',161],['question/type/match','questiontype.php',50],['question/type/ddmarker','questiontype.php',88],['question/type/shortanswer','questiontype.php',57],['question/type/calculatedsimple','questiontype.php',43],['question/type/gapselect','questiontypebase.php',39],['question/type/ddimageortext','questiontype.php',58],['question/type/randomsamatch','questiontype.php',64],['question/type/calculatedmulti','questiontype.php',41],['question/type/essay','questiontype.php',54]], 3],
'importpostprocess': ['importpostprocess', 'Override if any post-processing is required ', [['question','format.php',705],['question/format/blackboard_six','formatbase.php',68],['question/format/webct','format.php',252],['mod/lesson','format.php',710]], 2],
'setcategory': ['setcategory', 'Set Category ', [['lib/phpexcel/PHPExcel','DocumentProperties.php',340],['question','format.php',99],['lib/google/src/Google/Service','Webmasters.php',904],['lib/google/src/Google/Service','Games.php',2857],['lib/google/src/Google/Service','Games.php',2983],['lib/phpexcel/PHPExcel/Calculation','Function.php',94],['lib/google/src/Google/Service','Drive.php',3256],['lib/google/src/Google/Service','Webfonts.php',120]], 7],
'readquestion': ['readquestion', 'Given the data known to define a question in this format, this function converts it into a question object suitable for processing and insertion into Moodle. ', [['question','format.php',688],['question/format/aiken','format.php',122],['question/format/missingword','format.php',58],['mod/lesson','format.php',628],['question/format/gift','format.php',161],['question/format/examview','format.php',186]], 18],
'instance_by_id': ['instance_by_id', 'Get a context instance as an object, from a given context id. ', [['lib','accesslib.php',5434]], 235],
'setcontexts': ['setcontexts', 'set an array of contexts. ', [['question','format.php',132],['lib/google/src/Google/Service','AdExchangeBuyer.php',3003]], 2],
'setrealfilename': ['setrealfilename', 'set the "real" filename (this is what the user typed, regardless of wha happened next) ', [['question','format.php',149]], 1],
'string_to_context': ['string_to_context', '', [['lib','questionlib.php',1269]], 1],
'get_questions_category': ['get_questions_category', 'Function to read all questions for category into big array ', [['question','editlib.php',53]], 1],
'create_category_path': ['create_category_path', 'find and/or create the category described by a delimited list e.g. $course$/tom/dick/harry or tom/dick/harry ', [['question','format.php',476]], 1],
'try_exporting_using_qtypes': ['try_exporting_using_qtypes', 'Provide export functionality for plugin questiontypes Do not override ', [['question','format.php',717]], 2],
'get_all_qtypes': ['get_all_qtypes', '', [['question/engine','bank.php',150]], 9],
'clean_param': ['clean_param', 'Used by {@link optional_param()} and {@link required_param()} to clean the variables and/or cast to specific types, based on an options field. <code> $course->format = clean_param($course->format, PARAM_ALPHA); $selectedgradeitem = clean_param($selectedgradeitem, PARAM_INT); </code> ', [['lib','moodlelib.php',769]], 635],
'provide_export': ['provide_export', '', [['question','format.php',66],['question/format/xml','format.php',53],['question/format/xhtml','format.php',39],['question/format/gift','format.php',68]], 2],
'export_file_extension': ['export_file_extension', '', [['question','format.php',79],['question/format/xml','format.php',1005],['question/format/xhtml','format.php',192],['question/format/gift','format.php',72]], 2],
'get_record': ['get_record', 'Load a single record. ', [['competency/classes','persistent.php',738],['lib/dml','moodle_database.php',1462]], 3224],
'getpath': ['getpath', 'Return the value of a node, given a path to the node if it doesn\'t exist return the default value. ', [['question','format.php',987],['lib/htmlpurifier/HTMLPurifier','Bootstrap.php',53],['lib/google/src/Google/Service','Appengine.php',1548],['lib/google/src/Google/Service','Appengine.php',1673],['lib/xmldb','xmldb_structure.php',51],['lib/minify/lib/Minify/Cache','File.php',114],['auth/cas/CAS/CAS/PGTStorage','File.php',60],['lib/editor/tinymce/plugins/spellchecker/classes/utils','Logger.php',103],['lib/google/src/Google/Service','Webmasters.php',1146],['lib/google/src/Google/Service','Clouddebugger.php',1177],['lib/google/src/Google/Service','Datastore.php',617],['question/format/xml','format.php',117],['mod/lesson','format.php',788],['lib/lessphp/Tree','Import.php',103],['lib/phpexcel/PHPExcel/Worksheet','Drawing.php',82],['lib/phpexcel/PHPExcel/Worksheet','HeaderFooterDrawing.php',292],['lib/google/src/Google/Service','Compute.php',17075],['lib/google/src/Google/Service','Compute.php',17294],['lib/google/src/Google/Service','Manager.php',913],['lib/google/src/Google/Service','Manager.php',1468]], 231],
'set_item_tags': ['set_item_tags', 'Sets the list of tag instances for one item (table record). ', [['tag/classes','tag.php',666]], 57],
'can_import_file': ['can_import_file', 'Check if the given file is capable of being imported by this plugin. ', [['question','format.php',83],['question/format/blackboard_six','formatbase.php',48],['question/format/webct','format.php',180]], 1],
'mime_type': ['mime_type', '', [['question','format.php',71],['question/format/blackboard_six','formatbase.php',64],['question/format/webct','format.php',188],['question/format/xml','format.php',57],['question/format/examview','format.php',60]], 3],
'count_questions': ['count_questions', 'Count all non-category questions in the questions array. ', [['question','format.php',454],['mod/lesson','format.php',557]], 2],
'get_field': ['get_field', 'Gets an instance of the form field. ', [['lib/behat','behat_field_manager.php',248],['mod/quiz/report/statistics/classes','calculated.php',109],['lib/dml','moodle_database.php',1546],['user/filters','lib.php',124]], 536],
'get_string': ['get_string', 'Get String returns a requested string ', [['lib/classes','string_manager_install.php',95],['lib','moodlelib.php',6735],['lib','moodlelib.php',9695],['lib/external','externallib.php',102],['question/behaviour','behaviourbase.php',770],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38]], 20134],
'exportpostprocess': ['exportpostprocess', 'Do an post-processing that may be required ', [['question','format.php',915]], 0],
'set_can_access_backupdata': ['set_can_access_backupdata', '', [['question','format.php',210]], 0],
'text_field': ['text_field', 'Return the array moodle is expecting for an HTML text. No processing is done on $text. qformat classes that want to process $text for instance to import external images files and recode urls in $text must overwrite this method. ', [['question','format.php',970],['question/format/blackboard_six','formatbase.php',117],['question/format/aiken','format.php',114],['question/format/webct','format.php',222],['mod/lesson','format.php',771]], 34],
'debugging': ['debugging', 'Standard Debugging Function ', [['lib','weblib.php',3012]], 1007],
'is_null': ['is_null', '', [], 2003],
'preg_split': ['preg_split', '', [], 146],
'is_array': ['is_array', '', [], 1608],
'method_exists': ['method_exists', '', [], 265],
'implode': ['implode', '', [], 1281],
'trim': ['trim', '', [], 1948],
'time': ['time', '', [], 1959],
'count': ['count', '', [], 4095],
'get_class': ['get_class', '', [], 305],
'is_string': ['is_string', '', [], 536],
'explode': ['explode', '', [], 1572],
'array_shift': ['array_shift', '', [], 700],
'substr': ['substr', '', [], 2823],
'is_object': ['is_object', '', [], 544],
'is_readable': ['is_readable', '', [], 196],
'array_reverse': ['array_reverse', '', [], 130],
'defined': ['defined', '', [], 4731],
'file': ['file', '', [], 92],
'str_replace': ['str_replace', '', [], 1648],
'strtr': ['strtr', '', [], 63],
'preg_match': ['preg_match', '', [], 1286]};
CLASS_DATA={
'coding_exception': ['coding_exception', 'Exception indicating programming error, must be fixed by a programer. For example a core API might throw this type of exception if a plugin calls it incorrectly. ', [['lib','setuplib.php',239]], 1200],
'context_to_string_translator': ['context_to_string_translator', 'Converts contextlevels to strings and back to help with reading/writing contexts to/from import/export files. ', [['lib','questionlib.php',1248]], 1],
'core_text': ['core_text', 'defines string api\'s for manipulating strings ', [['lib/classes','text.php',27]], 566],
'core_tag_tag': ['core_tag_tag', 'Represents one tag and also contains lots of useful tag-related methods as static functions. ', [['tag/classes','tag.php',27]], 352],
'core_php_time_limit': ['core_php_time_limit', 'Utility class to manage PHP time limit. ', [['lib/classes','php_time_limit.php',27]], 92],
'qformat_based_on_xml': ['qformat_based_on_xml', '', [['question','format.php',946],['mod/lesson','format.php',743]], 2],
'qformat_default': ['qformat_default', 'Base class for question import and export formats. ', [['question','format.php',30],['mod/lesson','format.php',341]], 11]};
CONST_DATA={
'FORMAT_HTML': ['FORMAT_HTML', '', [['lib','weblib.php',47]], 1121],
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',140],['','install.php',93],['lib','setup.php',391]], 4153],
'PARAM_TEXT': ['PARAM_TEXT', '', [['lib','moodlelib.php',228]], 542],
'FORMAT_MOODLE': ['FORMAT_MOODLE', '', [['lib','weblib.php',42]], 506],
'MEMORY_EXTRA': ['MEMORY_EXTRA', '', [['lib','setuplib.php',50]], 40]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Aug 11 10:00:09 2016</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
