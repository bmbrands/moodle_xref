<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /question/engine/datalib.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Aug 11 10:00:09 2016 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='question/engine';
filename='datalib.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/question/engine/</a> -> <a href="datalib.php.html">datalib.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="datalib.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="datalib.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * Code for loading and saving question attempts to and from the database.</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * Note that many of the methods of this class should be considered private to</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * the question engine. They should be accessed through the</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * {@link question_engine} class. For example, you should call</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * {@link question_engine::save_questions_usage_by_activity()} rather than</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> * {@link question_engine_data_mapper::insert_questions_usage_by_activity()}.</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment"> * The exception to this is some of the reporting methods, like</span>
<a name="l26"><span class="linenum">  26</span></a>  <span class="comment"> * {@link question_engine_data_mapper::load_attempts_at_question()}.</span>
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment"> *</span>
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment"> * (TODO, probably we should split this class up, so that it has no public</span>
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment"> * methods. They should all be moved to a new public class.)</span>
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment"> *</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment"> * A note for future reference. This code is pretty efficient but there are some</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> * potential optimisations that could be contemplated, at the cost of making the</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> * code more complex:</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> *</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> * 1. (This is probably not worth doing.) In the unit-of-work save method, we</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment"> *    could get all the ids for steps due to be deleted or modified,</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment"> *    and delete all the question_attempt_step_data for all of those steps in one</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment"> *    query. That would save one DB query for each -&gt;stepsupdated. However that number</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="comment"> *    is 0 except when re-grading, and when regrading, there are many more inserts</span>
<a name="l40"><span class="linenum">  40</span></a>  <span class="comment"> *    into question_attempt_step_data than deletes, so it is really hardly worth it.</span>
<a name="l41"><span class="linenum">  41</span></a>  <span class="comment"> *</span>
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment"> * @package    core_question</span>
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment"> * @copyright  2009 The Open University</span>
<a name="l44"><span class="linenum">  44</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l45"><span class="linenum">  45</span></a>  <span class="comment"> */</span>
<a name="l46"><span class="linenum">  46</span></a>  
<a name="l47"><span class="linenum">  47</span></a>  
<a name="l48"><span class="linenum">  48</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die();
<a name="l49"><span class="linenum">  49</span></a>  
<a name="l50"><span class="linenum">  50</span></a>  
<a name="l51"><span class="linenum">  51</span></a>  <span class="comment">/**</span>
<a name="l52"><span class="linenum">  52</span></a>  <span class="comment"> * This class controls the loading and saving of question engine data to and from</span>
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment"> * the database.</span>
<a name="l54"><span class="linenum">  54</span></a>  <span class="comment"> *</span>
<a name="l55"><span class="linenum">  55</span></a>  <span class="comment"> * @copyright  2009 The Open University</span>
<a name="l56"><span class="linenum">  56</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l57"><span class="linenum">  57</span></a>  <span class="comment"> */</span>
<a name="l58"><span class="linenum">  58</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('question_engine_data_mapper')" href="../../_classes/question_engine_data_mapper.html" onMouseOver="classPopup(event,'question_engine_data_mapper')">question_engine_data_mapper</a> {
<a name="l59"><span class="linenum">  59</span></a>      <span class="comment">/**</span>
<a name="l60"><span class="linenum">  60</span></a>  <span class="comment">     * @var moodle_database normally points to global $DB, but I prefer not to</span>
<a name="l61"><span class="linenum">  61</span></a>  <span class="comment">     * use globals if I can help it.</span>
<a name="l62"><span class="linenum">  62</span></a>  <span class="comment">     */</span>
<a name="l63"><span class="linenum">  63</span></a>      protected <a class="var it9196" onMouseOver="hilite(9196)" onMouseOut="lolite()" onClick="logVariable('db')" href="../../_variables/db.html">$db</a>;
<a name="l64"><span class="linenum">  64</span></a>  
<a name="l65"><span class="linenum">  65</span></a>      <span class="comment">/**</span>
<a name="l66"><span class="linenum">  66</span></a>  <span class="comment">     * @param moodle_database $db a database connectoin. Defaults to global $DB.</span>
<a name="l67"><span class="linenum">  67</span></a>  <span class="comment">     */</span>
<a name="l68"><span class="linenum">  68</span></a>      public function <a class="function" onClick="logFunction('__construct')" href="../../_functions/__construct.html" onMouseOver="funcPopup(event,'__construct')">__construct</a>(moodle_database <a class="var it9196" onMouseOver="hilite(9196)" onMouseOut="lolite()" onClick="logVariable('db')" href="../../_variables/db.html">$db</a> = null) {
<a name="l69"><span class="linenum">  69</span></a>          if (<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it9196" onMouseOver="hilite(9196)" onMouseOut="lolite()" onClick="logVariable('db')" href="../../_variables/db.html">$db</a>)) {
<a name="l70"><span class="linenum">  70</span></a>              global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l71"><span class="linenum">  71</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l72"><span class="linenum">  72</span></a>          } else {
<a name="l73"><span class="linenum">  73</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a> = <a class="var it9196" onMouseOver="hilite(9196)" onMouseOut="lolite()" onClick="logVariable('db')" href="../../_variables/db.html">$db</a>;
<a name="l74"><span class="linenum">  74</span></a>          }
<a name="l75"><span class="linenum">  75</span></a>      }
<a name="l76"><span class="linenum">  76</span></a>  
<a name="l77"><span class="linenum">  77</span></a>      <span class="comment">/**</span>
<a name="l78"><span class="linenum">  78</span></a>  <span class="comment">     * Store an entire {@link question_usage_by_activity} in the database,</span>
<a name="l79"><span class="linenum">  79</span></a>  <span class="comment">     * including all the question_attempts that comprise it.</span>
<a name="l80"><span class="linenum">  80</span></a>  <span class="comment">     *</span>
<a name="l81"><span class="linenum">  81</span></a>  <span class="comment">     * You should not call this method directly. You should use</span>
<a name="l82"><span class="linenum">  82</span></a>  <span class="comment">     * @link question_engine::save_questions_usage_by_activity()}.</span>
<a name="l83"><span class="linenum">  83</span></a>  <span class="comment">     *</span>
<a name="l84"><span class="linenum">  84</span></a>  <span class="comment">     * @param question_usage_by_activity $quba the usage to store.</span>
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment">     */</span>
<a name="l86"><span class="linenum">  86</span></a>      public function <a class="function" onClick="logFunction('insert_questions_usage_by_activity')" href="../../_functions/insert_questions_usage_by_activity.html" onMouseOver="funcPopup(event,'insert_questions_usage_by_activity')">insert_questions_usage_by_activity</a>(question_usage_by_activity <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>) {
<a name="l87"><span class="linenum">  87</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a> = new stdClass();
<a name="l88"><span class="linenum">  88</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('contextid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/contextid.html">contextid</a> = <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>-&gt;<a class="function" onClick="logFunction('get_owning_context')" href="../../_functions/get_owning_context.html" onMouseOver="funcPopup(event,'get_owning_context')">get_owning_context</a>()-&gt;id;
<a name="l89"><span class="linenum">  89</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('component')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/component.html">component</a> = <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>-&gt;<a class="function" onClick="logFunction('get_owning_component')" href="../../_functions/get_owning_component.html" onMouseOver="funcPopup(event,'get_owning_component')">get_owning_component</a>();
<a name="l90"><span class="linenum">  90</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('preferredbehaviour')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/preferredbehaviour.html">preferredbehaviour</a> = <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>-&gt;<a class="function" onClick="logFunction('get_preferred_behaviour')" href="../../_functions/get_preferred_behaviour.html" onMouseOver="funcPopup(event,'get_preferred_behaviour')">get_preferred_behaviour</a>();
<a name="l91"><span class="linenum">  91</span></a>  
<a name="l92"><span class="linenum">  92</span></a>          <a class="var it3717" onMouseOver="hilite(3717)" onMouseOut="lolite()" onClick="logVariable('newid')" href="../../_variables/newid.html">$newid</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('question_usages', <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>);
<a name="l93"><span class="linenum">  93</span></a>          <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>-&gt;<a class="function" onClick="logFunction('set_id_from_database')" href="../../_functions/set_id_from_database.html" onMouseOver="funcPopup(event,'set_id_from_database')">set_id_from_database</a>(<a class="var it3717" onMouseOver="hilite(3717)" onMouseOut="lolite()" onClick="logVariable('newid')" href="../../_variables/newid.html">$newid</a>);
<a name="l94"><span class="linenum">  94</span></a>  
<a name="l95"><span class="linenum">  95</span></a>  <span class="comment">        // Initially an array of array of question_attempt_step_objects.</span>
<a name="l96"><span class="linenum">  96</span></a>  <span class="comment">        // Built as a nested array for efficiency, then flattened.</span>
<a name="l97"><span class="linenum">  97</span></a>          <a class="var it4603" onMouseOver="hilite(4603)" onMouseOut="lolite()" onClick="logVariable('stepdata')" href="../../_variables/stepdata.html">$stepdata</a> = array();
<a name="l98"><span class="linenum">  98</span></a>  
<a name="l99"><span class="linenum">  99</span></a>          foreach (<a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>-&gt;<a class="function" onClick="logFunction('get_attempt_iterator')" href="../../_functions/get_attempt_iterator.html" onMouseOver="funcPopup(event,'get_attempt_iterator')">get_attempt_iterator</a>() as <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>) {
<a name="l100"><span class="linenum"> 100</span></a>              <a class="var it4603" onMouseOver="hilite(4603)" onMouseOut="lolite()" onClick="logVariable('stepdata')" href="../../_variables/stepdata.html">$stepdata</a>[] = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('insert_question_attempt')" href="../../_functions/insert_question_attempt.html" onMouseOver="funcPopup(event,'insert_question_attempt')">insert_question_attempt</a>(<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>, <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>-&gt;<a class="function" onClick="logFunction('get_owning_context')" href="../../_functions/get_owning_context.html" onMouseOver="funcPopup(event,'get_owning_context')">get_owning_context</a>());
<a name="l101"><span class="linenum"> 101</span></a>          }
<a name="l102"><span class="linenum"> 102</span></a>  
<a name="l103"><span class="linenum"> 103</span></a>          <a class="var it4603" onMouseOver="hilite(4603)" onMouseOut="lolite()" onClick="logVariable('stepdata')" href="../../_variables/stepdata.html">$stepdata</a> = <a class="phpfunction" onClick="logFunction('call_user_func_array')" href="../../_functions/call_user_func_array.html" onMouseOver="phpfuncPopup(event,'call_user_func_array')">call_user_func_array</a>('array_merge', <a class="var it4603" onMouseOver="hilite(4603)" onMouseOut="lolite()" onClick="logVariable('stepdata')" href="../../_variables/stepdata.html">$stepdata</a>);
<a name="l104"><span class="linenum"> 104</span></a>          if (<a class="var it4603" onMouseOver="hilite(4603)" onMouseOut="lolite()" onClick="logVariable('stepdata')" href="../../_variables/stepdata.html">$stepdata</a>) {
<a name="l105"><span class="linenum"> 105</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('insert_all_step_data')" href="../../_functions/insert_all_step_data.html" onMouseOver="funcPopup(event,'insert_all_step_data')">insert_all_step_data</a>(<a class="var it4603" onMouseOver="hilite(4603)" onMouseOut="lolite()" onClick="logVariable('stepdata')" href="../../_variables/stepdata.html">$stepdata</a>);
<a name="l106"><span class="linenum"> 106</span></a>          }
<a name="l107"><span class="linenum"> 107</span></a>      }
<a name="l108"><span class="linenum"> 108</span></a>  
<a name="l109"><span class="linenum"> 109</span></a>      <span class="comment">/**</span>
<a name="l110"><span class="linenum"> 110</span></a>  <span class="comment">     * Store an entire {@link question_attempt} in the database,</span>
<a name="l111"><span class="linenum"> 111</span></a>  <span class="comment">     * including all the question_attempt_steps that comprise it.</span>
<a name="l112"><span class="linenum"> 112</span></a>  <span class="comment">     *</span>
<a name="l113"><span class="linenum"> 113</span></a>  <span class="comment">     * You should not call this method directly. You should use</span>
<a name="l114"><span class="linenum"> 114</span></a>  <span class="comment">     * @link question_engine::save_questions_usage_by_activity()}.</span>
<a name="l115"><span class="linenum"> 115</span></a>  <span class="comment">     *</span>
<a name="l116"><span class="linenum"> 116</span></a>  <span class="comment">     * @param question_attempt $qa the question attempt to store.</span>
<a name="l117"><span class="linenum"> 117</span></a>  <span class="comment">     * @param context $context the context of the owning question_usage_by_activity.</span>
<a name="l118"><span class="linenum"> 118</span></a>  <span class="comment">     * @return array of question_attempt_step_data rows, that still need to be inserted.</span>
<a name="l119"><span class="linenum"> 119</span></a>  <span class="comment">     */</span>
<a name="l120"><span class="linenum"> 120</span></a>      public function <a class="function" onClick="logFunction('insert_question_attempt')" href="../../_functions/insert_question_attempt.html" onMouseOver="funcPopup(event,'insert_question_attempt')">insert_question_attempt</a>(question_attempt <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>) {
<a name="l121"><span class="linenum"> 121</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a> = new stdClass();
<a name="l122"><span class="linenum"> 122</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('questionusageid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/questionusageid.html">questionusageid</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_usage_id')" href="../../_functions/get_usage_id.html" onMouseOver="funcPopup(event,'get_usage_id')">get_usage_id</a>();
<a name="l123"><span class="linenum"> 123</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('slot')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/slot.html">slot</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_slot')" href="../../_functions/get_slot.html" onMouseOver="funcPopup(event,'get_slot')">get_slot</a>();
<a name="l124"><span class="linenum"> 124</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('behaviour')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/behaviour.html">behaviour</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_behaviour_name')" href="../../_functions/get_behaviour_name.html" onMouseOver="funcPopup(event,'get_behaviour_name')">get_behaviour_name</a>();
<a name="l125"><span class="linenum"> 125</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('questionid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/questionid.html">questionid</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_question')" href="../../_functions/get_question.html" onMouseOver="funcPopup(event,'get_question')">get_question</a>()-&gt;id;
<a name="l126"><span class="linenum"> 126</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('variant')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/variant.html">variant</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_variant')" href="../../_functions/get_variant.html" onMouseOver="funcPopup(event,'get_variant')">get_variant</a>();
<a name="l127"><span class="linenum"> 127</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('maxmark')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/maxmark.html">maxmark</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_max_mark')" href="../../_functions/get_max_mark.html" onMouseOver="funcPopup(event,'get_max_mark')">get_max_mark</a>();
<a name="l128"><span class="linenum"> 128</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('minfraction')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/minfraction.html">minfraction</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_min_fraction')" href="../../_functions/get_min_fraction.html" onMouseOver="funcPopup(event,'get_min_fraction')">get_min_fraction</a>();
<a name="l129"><span class="linenum"> 129</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('maxfraction')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/maxfraction.html">maxfraction</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_max_fraction')" href="../../_functions/get_max_fraction.html" onMouseOver="funcPopup(event,'get_max_fraction')">get_max_fraction</a>();
<a name="l130"><span class="linenum"> 130</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('flagged')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/flagged.html">flagged</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('is_flagged')" href="../../_functions/is_flagged.html" onMouseOver="funcPopup(event,'is_flagged')">is_flagged</a>();
<a name="l131"><span class="linenum"> 131</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('questionsummary')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/questionsummary.html">questionsummary</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_question_summary')" href="../../_functions/get_question_summary.html" onMouseOver="funcPopup(event,'get_question_summary')">get_question_summary</a>();
<a name="l132"><span class="linenum"> 132</span></a>          if (<a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="function" onClick="logFunction('strlen')" href="../../_functions/strlen.html" onMouseOver="funcPopup(event,'strlen')">strlen</a>(<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('questionsummary')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/questionsummary.html">questionsummary</a>) &gt; question_bank::MAX_SUMMARY_LENGTH) {
<a name="l133"><span class="linenum"> 133</span></a>  <span class="comment">            // It seems some people write very long quesions! MDL-30760</span>
<a name="l134"><span class="linenum"> 134</span></a>              <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('questionsummary')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/questionsummary.html">questionsummary</a> = <a class="class" onClick="logClass('core_text')" href="../../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('questionsummary')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/questionsummary.html">questionsummary</a>,
<a name="l135"><span class="linenum"> 135</span></a>                      0, question_bank::MAX_SUMMARY_LENGTH - 3) . '...';
<a name="l136"><span class="linenum"> 136</span></a>          }
<a name="l137"><span class="linenum"> 137</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('rightanswer')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/rightanswer.html">rightanswer</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_right_answer_summary')" href="../../_functions/get_right_answer_summary.html" onMouseOver="funcPopup(event,'get_right_answer_summary')">get_right_answer_summary</a>();
<a name="l138"><span class="linenum"> 138</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('responsesummary')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/responsesummary.html">responsesummary</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_response_summary')" href="../../_functions/get_response_summary.html" onMouseOver="funcPopup(event,'get_response_summary')">get_response_summary</a>();
<a name="l139"><span class="linenum"> 139</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('timemodified')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l140"><span class="linenum"> 140</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('question_attempts', <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>);
<a name="l141"><span class="linenum"> 141</span></a>          <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('set_database_id')" href="../../_functions/set_database_id.html" onMouseOver="funcPopup(event,'set_database_id')">set_database_id</a>(<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l142"><span class="linenum"> 142</span></a>  
<a name="l143"><span class="linenum"> 143</span></a>  <span class="comment">        // Initially an array of array of question_attempt_step_objects.</span>
<a name="l144"><span class="linenum"> 144</span></a>  <span class="comment">        // Built as a nested array for efficiency, then flattened.</span>
<a name="l145"><span class="linenum"> 145</span></a>          <a class="var it4603" onMouseOver="hilite(4603)" onMouseOut="lolite()" onClick="logVariable('stepdata')" href="../../_variables/stepdata.html">$stepdata</a> = array();
<a name="l146"><span class="linenum"> 146</span></a>  
<a name="l147"><span class="linenum"> 147</span></a>          foreach (<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_step_iterator')" href="../../_functions/get_step_iterator.html" onMouseOver="funcPopup(event,'get_step_iterator')">get_step_iterator</a>() as <a class="var it3067" onMouseOver="hilite(3067)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../_variables/seq.html">$seq</a> =&gt; <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>) {
<a name="l148"><span class="linenum"> 148</span></a>              <a class="var it4603" onMouseOver="hilite(4603)" onMouseOut="lolite()" onClick="logVariable('stepdata')" href="../../_variables/stepdata.html">$stepdata</a>[] = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('insert_question_attempt_step')" href="../../_functions/insert_question_attempt_step.html" onMouseOver="funcPopup(event,'insert_question_attempt_step')">insert_question_attempt_step</a>(<a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>, <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it3067" onMouseOver="hilite(3067)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../_variables/seq.html">$seq</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l149"><span class="linenum"> 149</span></a>          }
<a name="l150"><span class="linenum"> 150</span></a>  
<a name="l151"><span class="linenum"> 151</span></a>          return <a class="phpfunction" onClick="logFunction('call_user_func_array')" href="../../_functions/call_user_func_array.html" onMouseOver="phpfuncPopup(event,'call_user_func_array')">call_user_func_array</a>('array_merge', <a class="var it4603" onMouseOver="hilite(4603)" onMouseOut="lolite()" onClick="logVariable('stepdata')" href="../../_variables/stepdata.html">$stepdata</a>);
<a name="l152"><span class="linenum"> 152</span></a>      }
<a name="l153"><span class="linenum"> 153</span></a>  
<a name="l154"><span class="linenum"> 154</span></a>      <span class="comment">/**</span>
<a name="l155"><span class="linenum"> 155</span></a>  <span class="comment">     * Helper method used by insert_question_attempt_step and update_question_attempt_step</span>
<a name="l156"><span class="linenum"> 156</span></a>  <span class="comment">     * @param question_attempt_step $step the step to store.</span>
<a name="l157"><span class="linenum"> 157</span></a>  <span class="comment">     * @param int $questionattemptid the question attept id this step belongs to.</span>
<a name="l158"><span class="linenum"> 158</span></a>  <span class="comment">     * @param int $seq the sequence number of this stop.</span>
<a name="l159"><span class="linenum"> 159</span></a>  <span class="comment">     * @return stdClass data to insert into the database.</span>
<a name="l160"><span class="linenum"> 160</span></a>  <span class="comment">     */</span>
<a name="l161"><span class="linenum"> 161</span></a>      protected function <a class="function" onClick="logFunction('make_step_record')" href="../../_functions/make_step_record.html" onMouseOver="funcPopup(event,'make_step_record')">make_step_record</a>(question_attempt_step <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>, <a class="var it9202" onMouseOver="hilite(9202)" onMouseOut="lolite()" onClick="logVariable('questionattemptid')" href="../../_variables/questionattemptid.html">$questionattemptid</a>, <a class="var it3067" onMouseOver="hilite(3067)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../_variables/seq.html">$seq</a>) {
<a name="l162"><span class="linenum"> 162</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a> = new stdClass();
<a name="l163"><span class="linenum"> 163</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('questionattemptid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/questionattemptid.html">questionattemptid</a> = <a class="var it9202" onMouseOver="hilite(9202)" onMouseOut="lolite()" onClick="logVariable('questionattemptid')" href="../../_variables/questionattemptid.html">$questionattemptid</a>;
<a name="l164"><span class="linenum"> 164</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('sequencenumber')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/sequencenumber.html">sequencenumber</a> = <a class="var it3067" onMouseOver="hilite(3067)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../_variables/seq.html">$seq</a>;
<a name="l165"><span class="linenum"> 165</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('state')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/state.html">state</a> = (string) <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>-&gt;<a class="function" onClick="logFunction('get_state')" href="../../_functions/get_state.html" onMouseOver="funcPopup(event,'get_state')">get_state</a>();
<a name="l166"><span class="linenum"> 166</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('fraction')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/fraction.html">fraction</a> = <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>-&gt;<a class="function" onClick="logFunction('get_fraction')" href="../../_functions/get_fraction.html" onMouseOver="funcPopup(event,'get_fraction')">get_fraction</a>();
<a name="l167"><span class="linenum"> 167</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('timecreated')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/timecreated.html">timecreated</a> = <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>-&gt;<a class="function" onClick="logFunction('get_timecreated')" href="../../_functions/get_timecreated.html" onMouseOver="funcPopup(event,'get_timecreated')">get_timecreated</a>();
<a name="l168"><span class="linenum"> 168</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('userid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/userid.html">userid</a> = <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>-&gt;<a class="function" onClick="logFunction('get_user_id')" href="../../_functions/get_user_id.html" onMouseOver="funcPopup(event,'get_user_id')">get_user_id</a>();
<a name="l169"><span class="linenum"> 169</span></a>          return <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>;
<a name="l170"><span class="linenum"> 170</span></a>      }
<a name="l171"><span class="linenum"> 171</span></a>  
<a name="l172"><span class="linenum"> 172</span></a>      <span class="comment">/**</span>
<a name="l173"><span class="linenum"> 173</span></a>  <span class="comment">     * Helper method used by insert_question_attempt_step and update_question_attempt_step</span>
<a name="l174"><span class="linenum"> 174</span></a>  <span class="comment">     * @param question_attempt_step $step the step to store.</span>
<a name="l175"><span class="linenum"> 175</span></a>  <span class="comment">     * @param int $stepid the id of the step.</span>
<a name="l176"><span class="linenum"> 176</span></a>  <span class="comment">     * @param context $context the context of the owning question_usage_by_activity.</span>
<a name="l177"><span class="linenum"> 177</span></a>  <span class="comment">     * @return array of question_attempt_step_data rows, that still need to be inserted.</span>
<a name="l178"><span class="linenum"> 178</span></a>  <span class="comment">     */</span>
<a name="l179"><span class="linenum"> 179</span></a>      protected function <a class="function" onClick="logFunction('prepare_step_data')" href="../../_functions/prepare_step_data.html" onMouseOver="funcPopup(event,'prepare_step_data')">prepare_step_data</a>(question_attempt_step <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>, <a class="var it9204" onMouseOver="hilite(9204)" onMouseOut="lolite()" onClick="logVariable('stepid')" href="../../_variables/stepid.html">$stepid</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>) {
<a name="l180"><span class="linenum"> 180</span></a>          <a class="var it1106" onMouseOver="hilite(1106)" onMouseOut="lolite()" onClick="logVariable('rows')" href="../../_variables/rows.html">$rows</a> = array();
<a name="l181"><span class="linenum"> 181</span></a>          foreach (<a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>-&gt;<a class="function" onClick="logFunction('get_all_data')" href="../../_functions/get_all_data.html" onMouseOver="funcPopup(event,'get_all_data')">get_all_data</a>() as <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a> =&gt; <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>) {
<a name="l182"><span class="linenum"> 182</span></a>              if (<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> instanceof question_file_saver) {
<a name="l183"><span class="linenum"> 183</span></a>                  <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>-&gt;<a class="function" onClick="logFunction('save_files')" href="../../_functions/save_files.html" onMouseOver="funcPopup(event,'save_files')">save_files</a>(<a class="var it9204" onMouseOver="hilite(9204)" onMouseOut="lolite()" onClick="logVariable('stepid')" href="../../_variables/stepid.html">$stepid</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l184"><span class="linenum"> 184</span></a>              }
<a name="l185"><span class="linenum"> 185</span></a>              if (<a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> instanceof question_response_files) {
<a name="l186"><span class="linenum"> 186</span></a>                  <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = (string) <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l187"><span class="linenum"> 187</span></a>              }
<a name="l188"><span class="linenum"> 188</span></a>  
<a name="l189"><span class="linenum"> 189</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a> = new stdClass();
<a name="l190"><span class="linenum"> 190</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('attemptstepid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/attemptstepid.html">attemptstepid</a> = <a class="var it9204" onMouseOver="hilite(9204)" onMouseOut="lolite()" onClick="logVariable('stepid')" href="../../_variables/stepid.html">$stepid</a>;
<a name="l191"><span class="linenum"> 191</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('name')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/name.html">name</a> = <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>;
<a name="l192"><span class="linenum"> 192</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('value')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/value.html">value</a> = <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l193"><span class="linenum"> 193</span></a>              <a class="var it1106" onMouseOver="hilite(1106)" onMouseOut="lolite()" onClick="logVariable('rows')" href="../../_variables/rows.html">$rows</a>[] = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>;
<a name="l194"><span class="linenum"> 194</span></a>          }
<a name="l195"><span class="linenum"> 195</span></a>          return <a class="var it1106" onMouseOver="hilite(1106)" onMouseOut="lolite()" onClick="logVariable('rows')" href="../../_variables/rows.html">$rows</a>;
<a name="l196"><span class="linenum"> 196</span></a>      }
<a name="l197"><span class="linenum"> 197</span></a>  
<a name="l198"><span class="linenum"> 198</span></a>      <span class="comment">/**</span>
<a name="l199"><span class="linenum"> 199</span></a>  <span class="comment">     * Insert a lot of records into question_attempt_step_data in one go.</span>
<a name="l200"><span class="linenum"> 200</span></a>  <span class="comment">     *</span>
<a name="l201"><span class="linenum"> 201</span></a>  <span class="comment">     * Private method, only for use by other parts of the question engine.</span>
<a name="l202"><span class="linenum"> 202</span></a>  <span class="comment">     *</span>
<a name="l203"><span class="linenum"> 203</span></a>  <span class="comment">     * @param array $rows the rows to insert.</span>
<a name="l204"><span class="linenum"> 204</span></a>  <span class="comment">     */</span>
<a name="l205"><span class="linenum"> 205</span></a>      public function <a class="function" onClick="logFunction('insert_all_step_data')" href="../../_functions/insert_all_step_data.html" onMouseOver="funcPopup(event,'insert_all_step_data')">insert_all_step_data</a>(array <a class="var it1106" onMouseOver="hilite(1106)" onMouseOut="lolite()" onClick="logVariable('rows')" href="../../_variables/rows.html">$rows</a>) {
<a name="l206"><span class="linenum"> 206</span></a>          if (!<a class="var it1106" onMouseOver="hilite(1106)" onMouseOut="lolite()" onClick="logVariable('rows')" href="../../_variables/rows.html">$rows</a>) {
<a name="l207"><span class="linenum"> 207</span></a>              return;
<a name="l208"><span class="linenum"> 208</span></a>          }
<a name="l209"><span class="linenum"> 209</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('insert_records')" href="../../_functions/insert_records.html" onMouseOver="funcPopup(event,'insert_records')">insert_records</a>('question_attempt_step_data', <a class="var it1106" onMouseOver="hilite(1106)" onMouseOut="lolite()" onClick="logVariable('rows')" href="../../_variables/rows.html">$rows</a>);
<a name="l210"><span class="linenum"> 210</span></a>      }
<a name="l211"><span class="linenum"> 211</span></a>  
<a name="l212"><span class="linenum"> 212</span></a>      <span class="comment">/**</span>
<a name="l213"><span class="linenum"> 213</span></a>  <span class="comment">     * Store a {@link question_attempt_step} in the database.</span>
<a name="l214"><span class="linenum"> 214</span></a>  <span class="comment">     *</span>
<a name="l215"><span class="linenum"> 215</span></a>  <span class="comment">     * Private method, only for use by other parts of the question engine.</span>
<a name="l216"><span class="linenum"> 216</span></a>  <span class="comment">     *</span>
<a name="l217"><span class="linenum"> 217</span></a>  <span class="comment">     * @param question_attempt_step $step the step to store.</span>
<a name="l218"><span class="linenum"> 218</span></a>  <span class="comment">     * @param int $questionattemptid the question attept id this step belongs to.</span>
<a name="l219"><span class="linenum"> 219</span></a>  <span class="comment">     * @param int $seq the sequence number of this stop.</span>
<a name="l220"><span class="linenum"> 220</span></a>  <span class="comment">     * @param context $context the context of the owning question_usage_by_activity.</span>
<a name="l221"><span class="linenum"> 221</span></a>  <span class="comment">     * @return array of question_attempt_step_data rows, that still need to be inserted.</span>
<a name="l222"><span class="linenum"> 222</span></a>  <span class="comment">     */</span>
<a name="l223"><span class="linenum"> 223</span></a>      public function <a class="function" onClick="logFunction('insert_question_attempt_step')" href="../../_functions/insert_question_attempt_step.html" onMouseOver="funcPopup(event,'insert_question_attempt_step')">insert_question_attempt_step</a>(question_attempt_step <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>,
<a name="l224"><span class="linenum"> 224</span></a>              <a class="var it9202" onMouseOver="hilite(9202)" onMouseOut="lolite()" onClick="logVariable('questionattemptid')" href="../../_variables/questionattemptid.html">$questionattemptid</a>, <a class="var it3067" onMouseOver="hilite(3067)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../_variables/seq.html">$seq</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>) {
<a name="l225"><span class="linenum"> 225</span></a>  
<a name="l226"><span class="linenum"> 226</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('make_step_record')" href="../../_functions/make_step_record.html" onMouseOver="funcPopup(event,'make_step_record')">make_step_record</a>(<a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>, <a class="var it9202" onMouseOver="hilite(9202)" onMouseOut="lolite()" onClick="logVariable('questionattemptid')" href="../../_variables/questionattemptid.html">$questionattemptid</a>, <a class="var it3067" onMouseOver="hilite(3067)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../_variables/seq.html">$seq</a>);
<a name="l227"><span class="linenum"> 227</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('question_attempt_steps', <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>);
<a name="l228"><span class="linenum"> 228</span></a>  
<a name="l229"><span class="linenum"> 229</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_step_data')" href="../../_functions/prepare_step_data.html" onMouseOver="funcPopup(event,'prepare_step_data')">prepare_step_data</a>(<a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>, <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l230"><span class="linenum"> 230</span></a>      }
<a name="l231"><span class="linenum"> 231</span></a>  
<a name="l232"><span class="linenum"> 232</span></a>      <span class="comment">/**</span>
<a name="l233"><span class="linenum"> 233</span></a>  <span class="comment">     * Update a {@link question_attempt_step} in the database.</span>
<a name="l234"><span class="linenum"> 234</span></a>  <span class="comment">     *</span>
<a name="l235"><span class="linenum"> 235</span></a>  <span class="comment">     * Private method, only for use by other parts of the question engine.</span>
<a name="l236"><span class="linenum"> 236</span></a>  <span class="comment">     *</span>
<a name="l237"><span class="linenum"> 237</span></a>  <span class="comment">     * @param question_attempt_step $qa the step to store.</span>
<a name="l238"><span class="linenum"> 238</span></a>  <span class="comment">     * @param int $questionattemptid the question attept id this step belongs to.</span>
<a name="l239"><span class="linenum"> 239</span></a>  <span class="comment">     * @param int $seq the sequence number of this stop.</span>
<a name="l240"><span class="linenum"> 240</span></a>  <span class="comment">     * @param context $context the context of the owning question_usage_by_activity.</span>
<a name="l241"><span class="linenum"> 241</span></a>  <span class="comment">     * @return array of question_attempt_step_data rows, that still need to be inserted.</span>
<a name="l242"><span class="linenum"> 242</span></a>  <span class="comment">     */</span>
<a name="l243"><span class="linenum"> 243</span></a>      public function <a class="function" onClick="logFunction('update_question_attempt_step')" href="../../_functions/update_question_attempt_step.html" onMouseOver="funcPopup(event,'update_question_attempt_step')">update_question_attempt_step</a>(question_attempt_step <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>,
<a name="l244"><span class="linenum"> 244</span></a>              <a class="var it9202" onMouseOver="hilite(9202)" onMouseOut="lolite()" onClick="logVariable('questionattemptid')" href="../../_variables/questionattemptid.html">$questionattemptid</a>, <a class="var it3067" onMouseOver="hilite(3067)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../_variables/seq.html">$seq</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>) {
<a name="l245"><span class="linenum"> 245</span></a>  
<a name="l246"><span class="linenum"> 246</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('make_step_record')" href="../../_functions/make_step_record.html" onMouseOver="funcPopup(event,'make_step_record')">make_step_record</a>(<a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>, <a class="var it9202" onMouseOver="hilite(9202)" onMouseOut="lolite()" onClick="logVariable('questionattemptid')" href="../../_variables/questionattemptid.html">$questionattemptid</a>, <a class="var it3067" onMouseOver="hilite(3067)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../_variables/seq.html">$seq</a>);
<a name="l247"><span class="linenum"> 247</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>-&gt;<a class="function" onClick="logFunction('get_id')" href="../../_functions/get_id.html" onMouseOver="funcPopup(event,'get_id')">get_id</a>();
<a name="l248"><span class="linenum"> 248</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('question_attempt_steps', <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>);
<a name="l249"><span class="linenum"> 249</span></a>  
<a name="l250"><span class="linenum"> 250</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('question_attempt_step_data',
<a name="l251"><span class="linenum"> 251</span></a>                  array('attemptstepid' =&gt; <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>));
<a name="l252"><span class="linenum"> 252</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('prepare_step_data')" href="../../_functions/prepare_step_data.html" onMouseOver="funcPopup(event,'prepare_step_data')">prepare_step_data</a>(<a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>, <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>);
<a name="l253"><span class="linenum"> 253</span></a>      }
<a name="l254"><span class="linenum"> 254</span></a>  
<a name="l255"><span class="linenum"> 255</span></a>      <span class="comment">/**</span>
<a name="l256"><span class="linenum"> 256</span></a>  <span class="comment">     * Store new metadata for an existing {@link question_attempt} in the database.</span>
<a name="l257"><span class="linenum"> 257</span></a>  <span class="comment">     *</span>
<a name="l258"><span class="linenum"> 258</span></a>  <span class="comment">     * Private method, only for use by other parts of the question engine.</span>
<a name="l259"><span class="linenum"> 259</span></a>  <span class="comment">     *</span>
<a name="l260"><span class="linenum"> 260</span></a>  <span class="comment">     * @param question_attempt $qa the question attempt to store meta data for.</span>
<a name="l261"><span class="linenum"> 261</span></a>  <span class="comment">     * @param array $names the names of the metadata variables to store.</span>
<a name="l262"><span class="linenum"> 262</span></a>  <span class="comment">     * @return array of question_attempt_step_data rows, that still need to be inserted.</span>
<a name="l263"><span class="linenum"> 263</span></a>  <span class="comment">     */</span>
<a name="l264"><span class="linenum"> 264</span></a>      public function <a class="function" onClick="logFunction('insert_question_attempt_metadata')" href="../../_functions/insert_question_attempt_metadata.html" onMouseOver="funcPopup(event,'insert_question_attempt_metadata')">insert_question_attempt_metadata</a>(question_attempt <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>, array <a class="var it3550" onMouseOver="hilite(3550)" onMouseOut="lolite()" onClick="logVariable('names')" href="../../_variables/names.html">$names</a>) {
<a name="l265"><span class="linenum"> 265</span></a>          <a class="var it9206" onMouseOver="hilite(9206)" onMouseOut="lolite()" onClick="logVariable('firststep')" href="../../_variables/firststep.html">$firststep</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_step')" href="../../_functions/get_step.html" onMouseOver="funcPopup(event,'get_step')">get_step</a>(0);
<a name="l266"><span class="linenum"> 266</span></a>  
<a name="l267"><span class="linenum"> 267</span></a>          <a class="var it1106" onMouseOver="hilite(1106)" onMouseOut="lolite()" onClick="logVariable('rows')" href="../../_variables/rows.html">$rows</a> = array();
<a name="l268"><span class="linenum"> 268</span></a>          foreach (<a class="var it3550" onMouseOver="hilite(3550)" onMouseOut="lolite()" onClick="logVariable('names')" href="../../_variables/names.html">$names</a> as <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>) {
<a name="l269"><span class="linenum"> 269</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a> = new stdClass();
<a name="l270"><span class="linenum"> 270</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('attemptstepid')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/attemptstepid.html">attemptstepid</a> = <a class="var it9206" onMouseOver="hilite(9206)" onMouseOut="lolite()" onClick="logVariable('firststep')" href="../../_variables/firststep.html">$firststep</a>-&gt;<a class="function" onClick="logFunction('get_id')" href="../../_functions/get_id.html" onMouseOver="funcPopup(event,'get_id')">get_id</a>();
<a name="l271"><span class="linenum"> 271</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('name')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/name.html">name</a> = ':_' . <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>;
<a name="l272"><span class="linenum"> 272</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('value')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../../_variables/value.html">value</a> = <a class="var it9206" onMouseOver="hilite(9206)" onMouseOut="lolite()" onClick="logVariable('firststep')" href="../../_variables/firststep.html">$firststep</a>-&gt;<a class="function" onClick="logFunction('get_metadata_var')" href="../../_functions/get_metadata_var.html" onMouseOver="funcPopup(event,'get_metadata_var')">get_metadata_var</a>(<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>);
<a name="l273"><span class="linenum"> 273</span></a>              <a class="var it1106" onMouseOver="hilite(1106)" onMouseOut="lolite()" onClick="logVariable('rows')" href="../../_variables/rows.html">$rows</a>[] = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>;
<a name="l274"><span class="linenum"> 274</span></a>          }
<a name="l275"><span class="linenum"> 275</span></a>  
<a name="l276"><span class="linenum"> 276</span></a>          return <a class="var it1106" onMouseOver="hilite(1106)" onMouseOut="lolite()" onClick="logVariable('rows')" href="../../_variables/rows.html">$rows</a>;
<a name="l277"><span class="linenum"> 277</span></a>      }
<a name="l278"><span class="linenum"> 278</span></a>  
<a name="l279"><span class="linenum"> 279</span></a>      <span class="comment">/**</span>
<a name="l280"><span class="linenum"> 280</span></a>  <span class="comment">     * Updates existing metadata for an existing {@link question_attempt} in the database.</span>
<a name="l281"><span class="linenum"> 281</span></a>  <span class="comment">     *</span>
<a name="l282"><span class="linenum"> 282</span></a>  <span class="comment">     * Private method, only for use by other parts of the question engine.</span>
<a name="l283"><span class="linenum"> 283</span></a>  <span class="comment">     *</span>
<a name="l284"><span class="linenum"> 284</span></a>  <span class="comment">     * @param question_attempt $qa the question attempt to store meta data for.</span>
<a name="l285"><span class="linenum"> 285</span></a>  <span class="comment">     * @param array $names the names of the metadata variables to store.</span>
<a name="l286"><span class="linenum"> 286</span></a>  <span class="comment">     * @return array of question_attempt_step_data rows, that still need to be inserted.</span>
<a name="l287"><span class="linenum"> 287</span></a>  <span class="comment">     */</span>
<a name="l288"><span class="linenum"> 288</span></a>      public function <a class="function" onClick="logFunction('update_question_attempt_metadata')" href="../../_functions/update_question_attempt_metadata.html" onMouseOver="funcPopup(event,'update_question_attempt_metadata')">update_question_attempt_metadata</a>(question_attempt <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>, array <a class="var it3550" onMouseOver="hilite(3550)" onMouseOut="lolite()" onClick="logVariable('names')" href="../../_variables/names.html">$names</a>) {
<a name="l289"><span class="linenum"> 289</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l290"><span class="linenum"> 290</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it323" onMouseOver="hilite(323)" onMouseOut="lolite()" onClick="logVariable('condition')" href="../../_variables/condition.html">$condition</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it3550" onMouseOver="hilite(3550)" onMouseOut="lolite()" onClick="logVariable('names')" href="../../_variables/names.html">$names</a>);
<a name="l291"><span class="linenum"> 291</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>[] = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_step')" href="../../_functions/get_step.html" onMouseOver="funcPopup(event,'get_step')">get_step</a>(0)-&gt;<a class="function" onClick="logFunction('get_id')" href="../../_functions/get_id.html" onMouseOver="funcPopup(event,'get_id')">get_id</a>();
<a name="l292"><span class="linenum"> 292</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records_select')" href="../../_functions/delete_records_select.html" onMouseOver="funcPopup(event,'delete_records_select')">delete_records_select</a>('question_attempt_step_data',
<a name="l293"><span class="linenum"> 293</span></a>                  'name ' . <a class="var it323" onMouseOver="hilite(323)" onMouseOut="lolite()" onClick="logVariable('condition')" href="../../_variables/condition.html">$condition</a> . ' AND attemptstepid = ?', <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l294"><span class="linenum"> 294</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('insert_question_attempt_metadata')" href="../../_functions/insert_question_attempt_metadata.html" onMouseOver="funcPopup(event,'insert_question_attempt_metadata')">insert_question_attempt_metadata</a>(<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>, <a class="var it3550" onMouseOver="hilite(3550)" onMouseOut="lolite()" onClick="logVariable('names')" href="../../_variables/names.html">$names</a>);
<a name="l295"><span class="linenum"> 295</span></a>      }
<a name="l296"><span class="linenum"> 296</span></a>  
<a name="l297"><span class="linenum"> 297</span></a>      <span class="comment">/**</span>
<a name="l298"><span class="linenum"> 298</span></a>  <span class="comment">     * Load a {@link question_attempt_step} from the database.</span>
<a name="l299"><span class="linenum"> 299</span></a>  <span class="comment">     *</span>
<a name="l300"><span class="linenum"> 300</span></a>  <span class="comment">     * Private method, only for use by other parts of the question engine.</span>
<a name="l301"><span class="linenum"> 301</span></a>  <span class="comment">     *</span>
<a name="l302"><span class="linenum"> 302</span></a>  <span class="comment">     * @param int $stepid the id of the step to load.</span>
<a name="l303"><span class="linenum"> 303</span></a>  <span class="comment">     * @param question_attempt_step the step that was loaded.</span>
<a name="l304"><span class="linenum"> 304</span></a>  <span class="comment">     */</span>
<a name="l305"><span class="linenum"> 305</span></a>      public function <a class="function" onClick="logFunction('load_question_attempt_step')" href="../../_functions/load_question_attempt_step.html" onMouseOver="funcPopup(event,'load_question_attempt_step')">load_question_attempt_step</a>(<a class="var it9204" onMouseOver="hilite(9204)" onMouseOut="lolite()" onClick="logVariable('stepid')" href="../../_variables/stepid.html">$stepid</a>) {
<a name="l306"><span class="linenum"> 306</span></a>          <a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_recordset_sql')" href="../../_functions/get_recordset_sql.html" onMouseOver="funcPopup(event,'get_recordset_sql')">get_recordset_sql</a>(&quot;
<a name="l307"><span class="linenum"> 307</span></a>  SELECT
<a name="l308"><span class="linenum"> 308</span></a>      quba.contextid,
<a name="l309"><span class="linenum"> 309</span></a>      COALESCE(q.qtype, 'missingtype') AS qtype,
<a name="l310"><span class="linenum"> 310</span></a>      qas.id AS attemptstepid,
<a name="l311"><span class="linenum"> 311</span></a>      qas.questionattemptid,
<a name="l312"><span class="linenum"> 312</span></a>      qas.sequencenumber,
<a name="l313"><span class="linenum"> 313</span></a>      qas.state,
<a name="l314"><span class="linenum"> 314</span></a>      qas.fraction,
<a name="l315"><span class="linenum"> 315</span></a>      qas.timecreated,
<a name="l316"><span class="linenum"> 316</span></a>      qas.userid,
<a name="l317"><span class="linenum"> 317</span></a>      qasd.name,
<a name="l318"><span class="linenum"> 318</span></a>      qasd.value
<a name="l319"><span class="linenum"> 319</span></a>  
<a name="l320"><span class="linenum"> 320</span></a>  FROM      {question_attempt_steps}     qas
<a name="l321"><span class="linenum"> 321</span></a>  JOIN      {question_attempts}          qa   ON qa.id              = qas.questionattemptid
<a name="l322"><span class="linenum"> 322</span></a>  JOIN      {question_usages}            quba ON quba.id            = qa.questionusageid
<a name="l323"><span class="linenum"> 323</span></a>  LEFT JOIN {question}                   q    ON q.id               = qa.questionid
<a name="l324"><span class="linenum"> 324</span></a>  LEFT JOIN {question_attempt_step_data} qasd ON qasd.attemptstepid = qas.id
<a name="l325"><span class="linenum"> 325</span></a>  
<a name="l326"><span class="linenum"> 326</span></a>  WHERE
<a name="l327"><span class="linenum"> 327</span></a>      qas.id = :stepid
<a name="l328"><span class="linenum"> 328</span></a>          &quot;, array('stepid' =&gt; <a class="var it9204" onMouseOver="hilite(9204)" onMouseOut="lolite()" onClick="logVariable('stepid')" href="../../_variables/stepid.html">$stepid</a>));
<a name="l329"><span class="linenum"> 329</span></a>  
<a name="l330"><span class="linenum"> 330</span></a>          if (!<a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>-&gt;<a class="function" onClick="logFunction('valid')" href="../../_functions/valid.html" onMouseOver="funcPopup(event,'valid')">valid</a>()) {
<a name="l331"><span class="linenum"> 331</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Failed to load question_attempt_step ' . <a class="var it9204" onMouseOver="hilite(9204)" onMouseOut="lolite()" onClick="logVariable('stepid')" href="../../_variables/stepid.html">$stepid</a>);
<a name="l332"><span class="linenum"> 332</span></a>          }
<a name="l333"><span class="linenum"> 333</span></a>  
<a name="l334"><span class="linenum"> 334</span></a>          <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a> = <a class="class" onClick="logClass('question_attempt_step')" href="../../_classes/question_attempt_step.html" onMouseOver="classPopup(event,'question_attempt_step')">question_attempt_step</a>::<a class="function" onClick="logFunction('load_from_records')" href="../../_functions/load_from_records.html" onMouseOver="funcPopup(event,'load_from_records')">load_from_records</a>(<a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>, <a class="var it9204" onMouseOver="hilite(9204)" onMouseOut="lolite()" onClick="logVariable('stepid')" href="../../_variables/stepid.html">$stepid</a>);
<a name="l335"><span class="linenum"> 335</span></a>          <a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l336"><span class="linenum"> 336</span></a>  
<a name="l337"><span class="linenum"> 337</span></a>          return <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>;
<a name="l338"><span class="linenum"> 338</span></a>      }
<a name="l339"><span class="linenum"> 339</span></a>  
<a name="l340"><span class="linenum"> 340</span></a>      <span class="comment">/**</span>
<a name="l341"><span class="linenum"> 341</span></a>  <span class="comment">     * Load a {@link question_attempt} from the database, including all its</span>
<a name="l342"><span class="linenum"> 342</span></a>  <span class="comment">     * steps.</span>
<a name="l343"><span class="linenum"> 343</span></a>  <span class="comment">     *</span>
<a name="l344"><span class="linenum"> 344</span></a>  <span class="comment">     * Normally, you should use {@link question_engine::load_questions_usage_by_activity()}</span>
<a name="l345"><span class="linenum"> 345</span></a>  <span class="comment">     * but there may be rare occasions where for performance reasons, you only</span>
<a name="l346"><span class="linenum"> 346</span></a>  <span class="comment">     * wish to load one qa, in which case you may call this method.</span>
<a name="l347"><span class="linenum"> 347</span></a>  <span class="comment">     *</span>
<a name="l348"><span class="linenum"> 348</span></a>  <span class="comment">     * @param int $questionattemptid the id of the question attempt to load.</span>
<a name="l349"><span class="linenum"> 349</span></a>  <span class="comment">     * @param question_attempt the question attempt that was loaded.</span>
<a name="l350"><span class="linenum"> 350</span></a>  <span class="comment">     */</span>
<a name="l351"><span class="linenum"> 351</span></a>      public function <a class="function" onClick="logFunction('load_question_attempt')" href="../../_functions/load_question_attempt.html" onMouseOver="funcPopup(event,'load_question_attempt')">load_question_attempt</a>(<a class="var it9202" onMouseOver="hilite(9202)" onMouseOut="lolite()" onClick="logVariable('questionattemptid')" href="../../_variables/questionattemptid.html">$questionattemptid</a>) {
<a name="l352"><span class="linenum"> 352</span></a>          <a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_recordset_sql')" href="../../_functions/get_recordset_sql.html" onMouseOver="funcPopup(event,'get_recordset_sql')">get_recordset_sql</a>(&quot;
<a name="l353"><span class="linenum"> 353</span></a>  SELECT
<a name="l354"><span class="linenum"> 354</span></a>      quba.contextid,
<a name="l355"><span class="linenum"> 355</span></a>      quba.preferredbehaviour,
<a name="l356"><span class="linenum"> 356</span></a>      qa.id AS questionattemptid,
<a name="l357"><span class="linenum"> 357</span></a>      qa.questionusageid,
<a name="l358"><span class="linenum"> 358</span></a>      qa.slot,
<a name="l359"><span class="linenum"> 359</span></a>      qa.behaviour,
<a name="l360"><span class="linenum"> 360</span></a>      qa.questionid,
<a name="l361"><span class="linenum"> 361</span></a>      qa.variant,
<a name="l362"><span class="linenum"> 362</span></a>      qa.maxmark,
<a name="l363"><span class="linenum"> 363</span></a>      qa.minfraction,
<a name="l364"><span class="linenum"> 364</span></a>      qa.maxfraction,
<a name="l365"><span class="linenum"> 365</span></a>      qa.flagged,
<a name="l366"><span class="linenum"> 366</span></a>      qa.questionsummary,
<a name="l367"><span class="linenum"> 367</span></a>      qa.rightanswer,
<a name="l368"><span class="linenum"> 368</span></a>      qa.responsesummary,
<a name="l369"><span class="linenum"> 369</span></a>      qa.timemodified,
<a name="l370"><span class="linenum"> 370</span></a>      qas.id AS attemptstepid,
<a name="l371"><span class="linenum"> 371</span></a>      qas.sequencenumber,
<a name="l372"><span class="linenum"> 372</span></a>      qas.state,
<a name="l373"><span class="linenum"> 373</span></a>      qas.fraction,
<a name="l374"><span class="linenum"> 374</span></a>      qas.timecreated,
<a name="l375"><span class="linenum"> 375</span></a>      qas.userid,
<a name="l376"><span class="linenum"> 376</span></a>      qasd.name,
<a name="l377"><span class="linenum"> 377</span></a>      qasd.value
<a name="l378"><span class="linenum"> 378</span></a>  
<a name="l379"><span class="linenum"> 379</span></a>  FROM      {question_attempts}          qa
<a name="l380"><span class="linenum"> 380</span></a>  JOIN      {question_usages}            quba ON quba.id               = qa.questionusageid
<a name="l381"><span class="linenum"> 381</span></a>  LEFT JOIN {question_attempt_steps}     qas  ON qas.questionattemptid = qa.id
<a name="l382"><span class="linenum"> 382</span></a>  LEFT JOIN {question_attempt_step_data} qasd ON qasd.attemptstepid    = qas.id
<a name="l383"><span class="linenum"> 383</span></a>  
<a name="l384"><span class="linenum"> 384</span></a>  WHERE
<a name="l385"><span class="linenum"> 385</span></a>      qa.id = :questionattemptid
<a name="l386"><span class="linenum"> 386</span></a>  
<a name="l387"><span class="linenum"> 387</span></a>  ORDER BY
<a name="l388"><span class="linenum"> 388</span></a>      qas.sequencenumber
<a name="l389"><span class="linenum"> 389</span></a>          &quot;, array('questionattemptid' =&gt; <a class="var it9202" onMouseOver="hilite(9202)" onMouseOut="lolite()" onClick="logVariable('questionattemptid')" href="../../_variables/questionattemptid.html">$questionattemptid</a>));
<a name="l390"><span class="linenum"> 390</span></a>  
<a name="l391"><span class="linenum"> 391</span></a>          if (!<a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>-&gt;<a class="function" onClick="logFunction('valid')" href="../../_functions/valid.html" onMouseOver="funcPopup(event,'valid')">valid</a>()) {
<a name="l392"><span class="linenum"> 392</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Failed to load question_attempt ' . <a class="var it9202" onMouseOver="hilite(9202)" onMouseOut="lolite()" onClick="logVariable('questionattemptid')" href="../../_variables/questionattemptid.html">$questionattemptid</a>);
<a name="l393"><span class="linenum"> 393</span></a>          }
<a name="l394"><span class="linenum"> 394</span></a>  
<a name="l395"><span class="linenum"> 395</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a> = <a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>-&gt;<a class="phpfunction" onClick="logFunction('current')" href="../../_functions/current.html" onMouseOver="phpfuncPopup(event,'current')">current</a>();
<a name="l396"><span class="linenum"> 396</span></a>          <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a> = <a class="class" onClick="logClass('question_attempt')" href="../../_classes/question_attempt.html" onMouseOver="classPopup(event,'question_attempt')">question_attempt</a>::<a class="function" onClick="logFunction('load_from_records')" href="../../_functions/load_from_records.html" onMouseOver="funcPopup(event,'load_from_records')">load_from_records</a>(<a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>, <a class="var it9202" onMouseOver="hilite(9202)" onMouseOut="lolite()" onClick="logVariable('questionattemptid')" href="../../_variables/questionattemptid.html">$questionattemptid</a>,
<a name="l397"><span class="linenum"> 397</span></a>                  <span class="keyword">new </span><a class="class" onClick="logClass('question_usage_null_observer')" href="../../_classes/question_usage_null_observer.html" onMouseOver="classPopup(event,'question_usage_null_observer')">question_usage_null_observer</a>(), <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('preferredbehaviour')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/preferredbehaviour.html">preferredbehaviour</a>);
<a name="l398"><span class="linenum"> 398</span></a>          <a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l399"><span class="linenum"> 399</span></a>  
<a name="l400"><span class="linenum"> 400</span></a>          return <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>;
<a name="l401"><span class="linenum"> 401</span></a>      }
<a name="l402"><span class="linenum"> 402</span></a>  
<a name="l403"><span class="linenum"> 403</span></a>      <span class="comment">/**</span>
<a name="l404"><span class="linenum"> 404</span></a>  <span class="comment">     * Load a {@link question_usage_by_activity} from the database, including</span>
<a name="l405"><span class="linenum"> 405</span></a>  <span class="comment">     * all its {@link question_attempt}s and all their steps.</span>
<a name="l406"><span class="linenum"> 406</span></a>  <span class="comment">     *</span>
<a name="l407"><span class="linenum"> 407</span></a>  <span class="comment">     * You should call {@link question_engine::load_questions_usage_by_activity()}</span>
<a name="l408"><span class="linenum"> 408</span></a>  <span class="comment">     * rather than calling this method directly.</span>
<a name="l409"><span class="linenum"> 409</span></a>  <span class="comment">     *</span>
<a name="l410"><span class="linenum"> 410</span></a>  <span class="comment">     * @param int $qubaid the id of the usage to load.</span>
<a name="l411"><span class="linenum"> 411</span></a>  <span class="comment">     * @param question_usage_by_activity the usage that was loaded.</span>
<a name="l412"><span class="linenum"> 412</span></a>  <span class="comment">     */</span>
<a name="l413"><span class="linenum"> 413</span></a>      public function <a class="function" onClick="logFunction('load_questions_usage_by_activity')" href="../../_functions/load_questions_usage_by_activity.html" onMouseOver="funcPopup(event,'load_questions_usage_by_activity')">load_questions_usage_by_activity</a>(<a class="var it9207" onMouseOver="hilite(9207)" onMouseOut="lolite()" onClick="logVariable('qubaid')" href="../../_variables/qubaid.html">$qubaid</a>) {
<a name="l414"><span class="linenum"> 414</span></a>          <a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_recordset_sql')" href="../../_functions/get_recordset_sql.html" onMouseOver="funcPopup(event,'get_recordset_sql')">get_recordset_sql</a>(&quot;
<a name="l415"><span class="linenum"> 415</span></a>  SELECT
<a name="l416"><span class="linenum"> 416</span></a>      quba.id AS qubaid,
<a name="l417"><span class="linenum"> 417</span></a>      quba.contextid,
<a name="l418"><span class="linenum"> 418</span></a>      quba.component,
<a name="l419"><span class="linenum"> 419</span></a>      quba.preferredbehaviour,
<a name="l420"><span class="linenum"> 420</span></a>      qa.id AS questionattemptid,
<a name="l421"><span class="linenum"> 421</span></a>      qa.questionusageid,
<a name="l422"><span class="linenum"> 422</span></a>      qa.slot,
<a name="l423"><span class="linenum"> 423</span></a>      qa.behaviour,
<a name="l424"><span class="linenum"> 424</span></a>      qa.questionid,
<a name="l425"><span class="linenum"> 425</span></a>      qa.variant,
<a name="l426"><span class="linenum"> 426</span></a>      qa.maxmark,
<a name="l427"><span class="linenum"> 427</span></a>      qa.minfraction,
<a name="l428"><span class="linenum"> 428</span></a>      qa.maxfraction,
<a name="l429"><span class="linenum"> 429</span></a>      qa.flagged,
<a name="l430"><span class="linenum"> 430</span></a>      qa.questionsummary,
<a name="l431"><span class="linenum"> 431</span></a>      qa.rightanswer,
<a name="l432"><span class="linenum"> 432</span></a>      qa.responsesummary,
<a name="l433"><span class="linenum"> 433</span></a>      qa.timemodified,
<a name="l434"><span class="linenum"> 434</span></a>      qas.id AS attemptstepid,
<a name="l435"><span class="linenum"> 435</span></a>      qas.sequencenumber,
<a name="l436"><span class="linenum"> 436</span></a>      qas.state,
<a name="l437"><span class="linenum"> 437</span></a>      qas.fraction,
<a name="l438"><span class="linenum"> 438</span></a>      qas.timecreated,
<a name="l439"><span class="linenum"> 439</span></a>      qas.userid,
<a name="l440"><span class="linenum"> 440</span></a>      qasd.name,
<a name="l441"><span class="linenum"> 441</span></a>      qasd.value
<a name="l442"><span class="linenum"> 442</span></a>  
<a name="l443"><span class="linenum"> 443</span></a>  FROM      {question_usages}            quba
<a name="l444"><span class="linenum"> 444</span></a>  LEFT JOIN {question_attempts}          qa   ON qa.questionusageid    = quba.id
<a name="l445"><span class="linenum"> 445</span></a>  LEFT JOIN {question_attempt_steps}     qas  ON qas.questionattemptid = qa.id
<a name="l446"><span class="linenum"> 446</span></a>  LEFT JOIN {question_attempt_step_data} qasd ON qasd.attemptstepid    = qas.id
<a name="l447"><span class="linenum"> 447</span></a>  
<a name="l448"><span class="linenum"> 448</span></a>  WHERE
<a name="l449"><span class="linenum"> 449</span></a>      quba.id = :qubaid
<a name="l450"><span class="linenum"> 450</span></a>  
<a name="l451"><span class="linenum"> 451</span></a>  ORDER BY
<a name="l452"><span class="linenum"> 452</span></a>      qa.slot,
<a name="l453"><span class="linenum"> 453</span></a>      qas.sequencenumber
<a name="l454"><span class="linenum"> 454</span></a>      &quot;, array('qubaid' =&gt; <a class="var it9207" onMouseOver="hilite(9207)" onMouseOut="lolite()" onClick="logVariable('qubaid')" href="../../_variables/qubaid.html">$qubaid</a>));
<a name="l455"><span class="linenum"> 455</span></a>  
<a name="l456"><span class="linenum"> 456</span></a>          if (!<a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>-&gt;<a class="function" onClick="logFunction('valid')" href="../../_functions/valid.html" onMouseOver="funcPopup(event,'valid')">valid</a>()) {
<a name="l457"><span class="linenum"> 457</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Failed to load questions_usage_by_activity ' . <a class="var it9207" onMouseOver="hilite(9207)" onMouseOut="lolite()" onClick="logVariable('qubaid')" href="../../_variables/qubaid.html">$qubaid</a>);
<a name="l458"><span class="linenum"> 458</span></a>          }
<a name="l459"><span class="linenum"> 459</span></a>  
<a name="l460"><span class="linenum"> 460</span></a>          <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a> = <a class="class" onClick="logClass('question_usage_by_activity')" href="../../_classes/question_usage_by_activity.html" onMouseOver="classPopup(event,'question_usage_by_activity')">question_usage_by_activity</a>::<a class="function" onClick="logFunction('load_from_records')" href="../../_functions/load_from_records.html" onMouseOver="funcPopup(event,'load_from_records')">load_from_records</a>(<a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>, <a class="var it9207" onMouseOver="hilite(9207)" onMouseOut="lolite()" onClick="logVariable('qubaid')" href="../../_variables/qubaid.html">$qubaid</a>);
<a name="l461"><span class="linenum"> 461</span></a>          <a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l462"><span class="linenum"> 462</span></a>  
<a name="l463"><span class="linenum"> 463</span></a>          return <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>;
<a name="l464"><span class="linenum"> 464</span></a>      }
<a name="l465"><span class="linenum"> 465</span></a>  
<a name="l466"><span class="linenum"> 466</span></a>      <span class="comment">/**</span>
<a name="l467"><span class="linenum"> 467</span></a>  <span class="comment">     * Load all {@link question_usage_by_activity} from the database for one qubaid_condition</span>
<a name="l468"><span class="linenum"> 468</span></a>  <span class="comment">     * Include all its {@link question_attempt}s and all their steps.</span>
<a name="l469"><span class="linenum"> 469</span></a>  <span class="comment">     *</span>
<a name="l470"><span class="linenum"> 470</span></a>  <span class="comment">     * This method may be called publicly.</span>
<a name="l471"><span class="linenum"> 471</span></a>  <span class="comment">     *</span>
<a name="l472"><span class="linenum"> 472</span></a>  <span class="comment">     * @param qubaid_condition $qubaids the condition that tells us which usages to load.</span>
<a name="l473"><span class="linenum"> 473</span></a>  <span class="comment">     * @return question_usage_by_activity[] the usages that were loaded.</span>
<a name="l474"><span class="linenum"> 474</span></a>  <span class="comment">     */</span>
<a name="l475"><span class="linenum"> 475</span></a>      public function <a class="function" onClick="logFunction('load_questions_usages_by_activity')" href="../../_functions/load_questions_usages_by_activity.html" onMouseOver="funcPopup(event,'load_questions_usages_by_activity')">load_questions_usages_by_activity</a>(<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>) {
<a name="l476"><span class="linenum"> 476</span></a>          <a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_recordset_sql')" href="../../_functions/get_recordset_sql.html" onMouseOver="funcPopup(event,'get_recordset_sql')">get_recordset_sql</a>(&quot;
<a name="l477"><span class="linenum"> 477</span></a>  SELECT
<a name="l478"><span class="linenum"> 478</span></a>      quba.id AS qubaid,
<a name="l479"><span class="linenum"> 479</span></a>      quba.contextid,
<a name="l480"><span class="linenum"> 480</span></a>      quba.component,
<a name="l481"><span class="linenum"> 481</span></a>      quba.preferredbehaviour,
<a name="l482"><span class="linenum"> 482</span></a>      qa.id AS questionattemptid,
<a name="l483"><span class="linenum"> 483</span></a>      qa.questionusageid,
<a name="l484"><span class="linenum"> 484</span></a>      qa.slot,
<a name="l485"><span class="linenum"> 485</span></a>      qa.behaviour,
<a name="l486"><span class="linenum"> 486</span></a>      qa.questionid,
<a name="l487"><span class="linenum"> 487</span></a>      qa.variant,
<a name="l488"><span class="linenum"> 488</span></a>      qa.maxmark,
<a name="l489"><span class="linenum"> 489</span></a>      qa.minfraction,
<a name="l490"><span class="linenum"> 490</span></a>      qa.maxfraction,
<a name="l491"><span class="linenum"> 491</span></a>      qa.flagged,
<a name="l492"><span class="linenum"> 492</span></a>      qa.questionsummary,
<a name="l493"><span class="linenum"> 493</span></a>      qa.rightanswer,
<a name="l494"><span class="linenum"> 494</span></a>      qa.responsesummary,
<a name="l495"><span class="linenum"> 495</span></a>      qa.timemodified,
<a name="l496"><span class="linenum"> 496</span></a>      qas.id AS attemptstepid,
<a name="l497"><span class="linenum"> 497</span></a>      qas.sequencenumber,
<a name="l498"><span class="linenum"> 498</span></a>      qas.state,
<a name="l499"><span class="linenum"> 499</span></a>      qas.fraction,
<a name="l500"><span class="linenum"> 500</span></a>      qas.timecreated,
<a name="l501"><span class="linenum"> 501</span></a>      qas.userid,
<a name="l502"><span class="linenum"> 502</span></a>      qasd.name,
<a name="l503"><span class="linenum"> 503</span></a>      qasd.value
<a name="l504"><span class="linenum"> 504</span></a>  
<a name="l505"><span class="linenum"> 505</span></a>  FROM      {question_usages}            quba
<a name="l506"><span class="linenum"> 506</span></a>  LEFT JOIN {question_attempts}          qa   ON qa.questionusageid    = quba.id
<a name="l507"><span class="linenum"> 507</span></a>  LEFT JOIN {question_attempt_steps}     qas  ON qas.questionattemptid = qa.id
<a name="l508"><span class="linenum"> 508</span></a>  LEFT JOIN {question_attempt_step_data} qasd ON qasd.attemptstepid    = qas.id
<a name="l509"><span class="linenum"> 509</span></a>  
<a name="l510"><span class="linenum"> 510</span></a>  WHERE
<a name="l511"><span class="linenum"> 511</span></a>      quba.id {<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('usage_id_in')" href="../../_functions/usage_id_in.html" onMouseOver="funcPopup(event,'usage_id_in')">usage_id_in</a>()}
<a name="l512"><span class="linenum"> 512</span></a>  
<a name="l513"><span class="linenum"> 513</span></a>  ORDER BY
<a name="l514"><span class="linenum"> 514</span></a>      quba.id,
<a name="l515"><span class="linenum"> 515</span></a>      qa.slot,
<a name="l516"><span class="linenum"> 516</span></a>      qas.sequencenumber
<a name="l517"><span class="linenum"> 517</span></a>      &quot;, <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('usage_id_in_params')" href="../../_functions/usage_id_in_params.html" onMouseOver="funcPopup(event,'usage_id_in_params')">usage_id_in_params</a>());
<a name="l518"><span class="linenum"> 518</span></a>  
<a name="l519"><span class="linenum"> 519</span></a>          if (!<a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>-&gt;<a class="function" onClick="logFunction('valid')" href="../../_functions/valid.html" onMouseOver="funcPopup(event,'valid')">valid</a>()) {
<a name="l520"><span class="linenum"> 520</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Failed to load questions_usages_by_activity for qubaid_condition :' . <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>);
<a name="l521"><span class="linenum"> 521</span></a>          }
<a name="l522"><span class="linenum"> 522</span></a>  
<a name="l523"><span class="linenum"> 523</span></a>          <a class="var it9208" onMouseOver="hilite(9208)" onMouseOut="lolite()" onClick="logVariable('qubas')" href="../../_variables/qubas.html">$qubas</a> = array();
<a name="l524"><span class="linenum"> 524</span></a>          do {
<a name="l525"><span class="linenum"> 525</span></a>              <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a> = <a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>-&gt;<a class="phpfunction" onClick="logFunction('current')" href="../../_functions/current.html" onMouseOver="phpfuncPopup(event,'current')">current</a>();
<a name="l526"><span class="linenum"> 526</span></a>              <a class="var it9208" onMouseOver="hilite(9208)" onMouseOut="lolite()" onClick="logVariable('qubas')" href="../../_variables/qubas.html">$qubas</a>[<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('qubaid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/qubaid.html">qubaid</a>] = <a class="class" onClick="logClass('question_usage_by_activity')" href="../../_classes/question_usage_by_activity.html" onMouseOver="classPopup(event,'question_usage_by_activity')">question_usage_by_activity</a>::<a class="function" onClick="logFunction('load_from_records')" href="../../_functions/load_from_records.html" onMouseOver="funcPopup(event,'load_from_records')">load_from_records</a>(<a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>, <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('qubaid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/qubaid.html">qubaid</a>);
<a name="l527"><span class="linenum"> 527</span></a>          } while (<a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>-&gt;<a class="function" onClick="logFunction('valid')" href="../../_functions/valid.html" onMouseOver="funcPopup(event,'valid')">valid</a>());
<a name="l528"><span class="linenum"> 528</span></a>  
<a name="l529"><span class="linenum"> 529</span></a>          <a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l530"><span class="linenum"> 530</span></a>  
<a name="l531"><span class="linenum"> 531</span></a>          return <a class="var it9208" onMouseOver="hilite(9208)" onMouseOut="lolite()" onClick="logVariable('qubas')" href="../../_variables/qubas.html">$qubas</a>;
<a name="l532"><span class="linenum"> 532</span></a>      }
<a name="l533"><span class="linenum"> 533</span></a>  
<a name="l534"><span class="linenum"> 534</span></a>      <span class="comment">/**</span>
<a name="l535"><span class="linenum"> 535</span></a>  <span class="comment">     * Load information about the latest state of each question from the database.</span>
<a name="l536"><span class="linenum"> 536</span></a>  <span class="comment">     *</span>
<a name="l537"><span class="linenum"> 537</span></a>  <span class="comment">     * This method may be called publicly.</span>
<a name="l538"><span class="linenum"> 538</span></a>  <span class="comment">     *</span>
<a name="l539"><span class="linenum"> 539</span></a>  <span class="comment">     * @param qubaid_condition $qubaids used to restrict which usages are included</span>
<a name="l540"><span class="linenum"> 540</span></a>  <span class="comment">     *                                  in the query. See {@link qubaid_condition}.</span>
<a name="l541"><span class="linenum"> 541</span></a>  <span class="comment">     * @param array            $slots   A list of slots for the questions you want to know about.</span>
<a name="l542"><span class="linenum"> 542</span></a>  <span class="comment">     * @param string|null      $fields</span>
<a name="l543"><span class="linenum"> 543</span></a>  <span class="comment">     * @return array of records. See the SQL in this function to see the fields available.</span>
<a name="l544"><span class="linenum"> 544</span></a>  <span class="comment">     */</span>
<a name="l545"><span class="linenum"> 545</span></a>      public function <a class="function" onClick="logFunction('load_questions_usages_latest_steps')" href="../../_functions/load_questions_usages_latest_steps.html" onMouseOver="funcPopup(event,'load_questions_usages_latest_steps')">load_questions_usages_latest_steps</a>(qubaid_condition <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>, <a class="var it933" onMouseOver="hilite(933)" onMouseOut="lolite()" onClick="logVariable('slots')" href="../../_variables/slots.html">$slots</a>, <a class="var it89" onMouseOver="hilite(89)" onMouseOut="lolite()" onClick="logVariable('fields')" href="../../_variables/fields.html">$fields</a> = null) {
<a name="l546"><span class="linenum"> 546</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it9209" onMouseOver="hilite(9209)" onMouseOut="lolite()" onClick="logVariable('slottest')" href="../../_variables/slottest.html">$slottest</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it933" onMouseOver="hilite(933)" onMouseOut="lolite()" onClick="logVariable('slots')" href="../../_variables/slots.html">$slots</a>, <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'slot');
<a name="l547"><span class="linenum"> 547</span></a>  
<a name="l548"><span class="linenum"> 548</span></a>          if (<a class="var it89" onMouseOver="hilite(89)" onMouseOut="lolite()" onClick="logVariable('fields')" href="../../_variables/fields.html">$fields</a> === null) {
<a name="l549"><span class="linenum"> 549</span></a>              <a class="var it89" onMouseOver="hilite(89)" onMouseOut="lolite()" onClick="logVariable('fields')" href="../../_variables/fields.html">$fields</a> = &quot;qas.id,
<a name="l550"><span class="linenum"> 550</span></a>      qa.id AS questionattemptid,
<a name="l551"><span class="linenum"> 551</span></a>      qa.questionusageid,
<a name="l552"><span class="linenum"> 552</span></a>      qa.slot,
<a name="l553"><span class="linenum"> 553</span></a>      qa.behaviour,
<a name="l554"><span class="linenum"> 554</span></a>      qa.questionid,
<a name="l555"><span class="linenum"> 555</span></a>      qa.variant,
<a name="l556"><span class="linenum"> 556</span></a>      qa.maxmark,
<a name="l557"><span class="linenum"> 557</span></a>      qa.minfraction,
<a name="l558"><span class="linenum"> 558</span></a>      qa.maxfraction,
<a name="l559"><span class="linenum"> 559</span></a>      qa.flagged,
<a name="l560"><span class="linenum"> 560</span></a>      qa.questionsummary,
<a name="l561"><span class="linenum"> 561</span></a>      qa.rightanswer,
<a name="l562"><span class="linenum"> 562</span></a>      qa.responsesummary,
<a name="l563"><span class="linenum"> 563</span></a>      qa.timemodified,
<a name="l564"><span class="linenum"> 564</span></a>      qas.id AS attemptstepid,
<a name="l565"><span class="linenum"> 565</span></a>      qas.sequencenumber,
<a name="l566"><span class="linenum"> 566</span></a>      qas.state,
<a name="l567"><span class="linenum"> 567</span></a>      qas.fraction,
<a name="l568"><span class="linenum"> 568</span></a>      qas.timecreated,
<a name="l569"><span class="linenum"> 569</span></a>      qas.userid&quot;;
<a name="l570"><span class="linenum"> 570</span></a>  
<a name="l571"><span class="linenum"> 571</span></a>          }
<a name="l572"><span class="linenum"> 572</span></a>  
<a name="l573"><span class="linenum"> 573</span></a>          <a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(&quot;
<a name="l574"><span class="linenum"> 574</span></a>  SELECT
<a name="l575"><span class="linenum"> 575</span></a>      {<a class="var it89" onMouseOver="hilite(89)" onMouseOut="lolite()" onClick="logVariable('fields')" href="../../_variables/fields.html">$fields</a>}
<a name="l576"><span class="linenum"> 576</span></a>  
<a name="l577"><span class="linenum"> 577</span></a>  FROM {<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('from_question_attempts')" href="../../_functions/from_question_attempts.html" onMouseOver="funcPopup(event,'from_question_attempts')">from_question_attempts</a>('qa')}
<a name="l578"><span class="linenum"> 578</span></a>  JOIN {question_attempt_steps} qas ON qas.questionattemptid = qa.id
<a name="l579"><span class="linenum"> 579</span></a>          AND qas.sequencenumber = {<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('latest_step_for_qa_subquery')" href="../../_functions/latest_step_for_qa_subquery.html" onMouseOver="funcPopup(event,'latest_step_for_qa_subquery')">latest_step_for_qa_subquery</a>()}
<a name="l580"><span class="linenum"> 580</span></a>  
<a name="l581"><span class="linenum"> 581</span></a>  WHERE
<a name="l582"><span class="linenum"> 582</span></a>      {<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('where')" href="../../_functions/where.html" onMouseOver="funcPopup(event,'where')">where</a>()} AND
<a name="l583"><span class="linenum"> 583</span></a>      qa.slot <a class="var it9209" onMouseOver="hilite(9209)" onMouseOut="lolite()" onClick="logVariable('slottest')" href="../../_variables/slottest.html">$slottest</a>
<a name="l584"><span class="linenum"> 584</span></a>          &quot;, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> + <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('from_where_params')" href="../../_functions/from_where_params.html" onMouseOver="funcPopup(event,'from_where_params')">from_where_params</a>());
<a name="l585"><span class="linenum"> 585</span></a>  
<a name="l586"><span class="linenum"> 586</span></a>          return <a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>;
<a name="l587"><span class="linenum"> 587</span></a>      }
<a name="l588"><span class="linenum"> 588</span></a>  
<a name="l589"><span class="linenum"> 589</span></a>      <span class="comment">/**</span>
<a name="l590"><span class="linenum"> 590</span></a>  <span class="comment">     * Load summary information about the state of each question in a group of</span>
<a name="l591"><span class="linenum"> 591</span></a>  <span class="comment">     * attempts. This is used, for example, by the quiz manual grading report,</span>
<a name="l592"><span class="linenum"> 592</span></a>  <span class="comment">     * to show how many attempts at each question need to be graded.</span>
<a name="l593"><span class="linenum"> 593</span></a>  <span class="comment">     *</span>
<a name="l594"><span class="linenum"> 594</span></a>  <span class="comment">     * This method may be called publicly.</span>
<a name="l595"><span class="linenum"> 595</span></a>  <span class="comment">     *</span>
<a name="l596"><span class="linenum"> 596</span></a>  <span class="comment">     * @param qubaid_condition $qubaids used to restrict which usages are included</span>
<a name="l597"><span class="linenum"> 597</span></a>  <span class="comment">     * in the query. See {@link qubaid_condition}.</span>
<a name="l598"><span class="linenum"> 598</span></a>  <span class="comment">     * @param array $slots A list of slots for the questions you want to konw about.</span>
<a name="l599"><span class="linenum"> 599</span></a>  <span class="comment">     * @return array The array keys are slot,qestionid. The values are objects with</span>
<a name="l600"><span class="linenum"> 600</span></a>  <span class="comment">     * fields $slot, $questionid, $inprogress, $name, $needsgrading, $autograded,</span>
<a name="l601"><span class="linenum"> 601</span></a>  <span class="comment">     * $manuallygraded and $all.</span>
<a name="l602"><span class="linenum"> 602</span></a>  <span class="comment">     */</span>
<a name="l603"><span class="linenum"> 603</span></a>      public function <a class="function" onClick="logFunction('load_questions_usages_question_state_summary')" href="../../_functions/load_questions_usages_question_state_summary.html" onMouseOver="funcPopup(event,'load_questions_usages_question_state_summary')">load_questions_usages_question_state_summary</a>(
<a name="l604"><span class="linenum"> 604</span></a>              qubaid_condition <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>, <a class="var it933" onMouseOver="hilite(933)" onMouseOut="lolite()" onClick="logVariable('slots')" href="../../_variables/slots.html">$slots</a>) {
<a name="l605"><span class="linenum"> 605</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it9209" onMouseOver="hilite(9209)" onMouseOut="lolite()" onClick="logVariable('slottest')" href="../../_variables/slottest.html">$slottest</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it933" onMouseOver="hilite(933)" onMouseOut="lolite()" onClick="logVariable('slots')" href="../../_variables/slots.html">$slots</a>, <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'slot');
<a name="l606"><span class="linenum"> 606</span></a>  
<a name="l607"><span class="linenum"> 607</span></a>          <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../_variables/rs.html">$rs</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_recordset_sql')" href="../../_functions/get_recordset_sql.html" onMouseOver="funcPopup(event,'get_recordset_sql')">get_recordset_sql</a>(&quot;
<a name="l608"><span class="linenum"> 608</span></a>  SELECT
<a name="l609"><span class="linenum"> 609</span></a>      qa.slot,
<a name="l610"><span class="linenum"> 610</span></a>      qa.questionid,
<a name="l611"><span class="linenum"> 611</span></a>      q.name,
<a name="l612"><span class="linenum"> 612</span></a>      CASE qas.state
<a name="l613"><span class="linenum"> 613</span></a>          {<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('full_states_to_summary_state_sql')" href="../../_functions/full_states_to_summary_state_sql.html" onMouseOver="funcPopup(event,'full_states_to_summary_state_sql')">full_states_to_summary_state_sql</a>()}
<a name="l614"><span class="linenum"> 614</span></a>      END AS summarystate,
<a name="l615"><span class="linenum"> 615</span></a>      <a class="phpfunction" onClick="logFunction('COUNT')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">COUNT</a>(1) AS numattempts
<a name="l616"><span class="linenum"> 616</span></a>  
<a name="l617"><span class="linenum"> 617</span></a>  FROM {<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('from_question_attempts')" href="../../_functions/from_question_attempts.html" onMouseOver="funcPopup(event,'from_question_attempts')">from_question_attempts</a>('qa')}
<a name="l618"><span class="linenum"> 618</span></a>  JOIN {question_attempt_steps} qas ON qas.questionattemptid = qa.id
<a name="l619"><span class="linenum"> 619</span></a>          AND qas.sequencenumber = {<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('latest_step_for_qa_subquery')" href="../../_functions/latest_step_for_qa_subquery.html" onMouseOver="funcPopup(event,'latest_step_for_qa_subquery')">latest_step_for_qa_subquery</a>()}
<a name="l620"><span class="linenum"> 620</span></a>  JOIN {question} q ON q.id = qa.questionid
<a name="l621"><span class="linenum"> 621</span></a>  
<a name="l622"><span class="linenum"> 622</span></a>  WHERE
<a name="l623"><span class="linenum"> 623</span></a>      {<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('where')" href="../../_functions/where.html" onMouseOver="funcPopup(event,'where')">where</a>()} AND
<a name="l624"><span class="linenum"> 624</span></a>      qa.slot <a class="var it9209" onMouseOver="hilite(9209)" onMouseOut="lolite()" onClick="logVariable('slottest')" href="../../_variables/slottest.html">$slottest</a>
<a name="l625"><span class="linenum"> 625</span></a>  
<a name="l626"><span class="linenum"> 626</span></a>  GROUP BY
<a name="l627"><span class="linenum"> 627</span></a>      qa.slot,
<a name="l628"><span class="linenum"> 628</span></a>      qa.questionid,
<a name="l629"><span class="linenum"> 629</span></a>      q.name,
<a name="l630"><span class="linenum"> 630</span></a>      q.id,
<a name="l631"><span class="linenum"> 631</span></a>      CASE qas.state
<a name="l632"><span class="linenum"> 632</span></a>          {<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('full_states_to_summary_state_sql')" href="../../_functions/full_states_to_summary_state_sql.html" onMouseOver="funcPopup(event,'full_states_to_summary_state_sql')">full_states_to_summary_state_sql</a>()}
<a name="l633"><span class="linenum"> 633</span></a>      END
<a name="l634"><span class="linenum"> 634</span></a>  
<a name="l635"><span class="linenum"> 635</span></a>  ORDER BY
<a name="l636"><span class="linenum"> 636</span></a>      qa.slot,
<a name="l637"><span class="linenum"> 637</span></a>      qa.questionid,
<a name="l638"><span class="linenum"> 638</span></a>      q.name,
<a name="l639"><span class="linenum"> 639</span></a>      q.id
<a name="l640"><span class="linenum"> 640</span></a>          &quot;, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> + <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('from_where_params')" href="../../_functions/from_where_params.html" onMouseOver="funcPopup(event,'from_where_params')">from_where_params</a>());
<a name="l641"><span class="linenum"> 641</span></a>  
<a name="l642"><span class="linenum"> 642</span></a>          <a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../../_variables/results.html">$results</a> = array();
<a name="l643"><span class="linenum"> 643</span></a>          foreach (<a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../_variables/rs.html">$rs</a> as <a class="var it57" onMouseOver="hilite(57)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>) {
<a name="l644"><span class="linenum"> 644</span></a>              <a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a> = <a class="var it57" onMouseOver="hilite(57)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>-&gt;<a onClick="logVariable('slot')" class="var it42924" onMouseOver="hilite(42924)" onMouseOut="lolite()" href="../../_variables/slot.html">slot</a> . ',' . <a class="var it57" onMouseOver="hilite(57)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>-&gt;<a onClick="logVariable('questionid')" class="var it42924" onMouseOver="hilite(42924)" onMouseOut="lolite()" href="../../_variables/questionid.html">questionid</a>;
<a name="l645"><span class="linenum"> 645</span></a>  
<a name="l646"><span class="linenum"> 646</span></a>              if (!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>, <a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../../_variables/results.html">$results</a>)) {
<a name="l647"><span class="linenum"> 647</span></a>                  <a class="var it799" onMouseOver="hilite(799)" onMouseOut="lolite()" onClick="logVariable('res')" href="../../_variables/res.html">$res</a> = new stdClass();
<a name="l648"><span class="linenum"> 648</span></a>                  <a class="var it799" onMouseOver="hilite(799)" onMouseOut="lolite()" onClick="logVariable('res')" href="../../_variables/res.html">$res</a>-&gt;<a onClick="logVariable('slot')" class="var it42987" onMouseOver="hilite(42987)" onMouseOut="lolite()" href="../../_variables/slot.html">slot</a> = <a class="var it57" onMouseOver="hilite(57)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>-&gt;<a onClick="logVariable('slot')" class="var it42924" onMouseOver="hilite(42924)" onMouseOut="lolite()" href="../../_variables/slot.html">slot</a>;
<a name="l649"><span class="linenum"> 649</span></a>                  <a class="var it799" onMouseOver="hilite(799)" onMouseOut="lolite()" onClick="logVariable('res')" href="../../_variables/res.html">$res</a>-&gt;<a onClick="logVariable('questionid')" class="var it42987" onMouseOver="hilite(42987)" onMouseOut="lolite()" href="../../_variables/questionid.html">questionid</a> = <a class="var it57" onMouseOver="hilite(57)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>-&gt;<a onClick="logVariable('questionid')" class="var it42924" onMouseOver="hilite(42924)" onMouseOut="lolite()" href="../../_variables/questionid.html">questionid</a>;
<a name="l650"><span class="linenum"> 650</span></a>                  <a class="var it799" onMouseOver="hilite(799)" onMouseOut="lolite()" onClick="logVariable('res')" href="../../_variables/res.html">$res</a>-&gt;<a onClick="logVariable('name')" class="var it42987" onMouseOver="hilite(42987)" onMouseOut="lolite()" href="../../_variables/name.html">name</a> = <a class="var it57" onMouseOver="hilite(57)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>-&gt;<a onClick="logVariable('name')" class="var it42924" onMouseOver="hilite(42924)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>;
<a name="l651"><span class="linenum"> 651</span></a>                  <a class="var it799" onMouseOver="hilite(799)" onMouseOut="lolite()" onClick="logVariable('res')" href="../../_variables/res.html">$res</a>-&gt;<a onClick="logVariable('inprogress')" class="var it42987" onMouseOver="hilite(42987)" onMouseOut="lolite()" href="../../_variables/inprogress.html">inprogress</a> = 0;
<a name="l652"><span class="linenum"> 652</span></a>                  <a class="var it799" onMouseOver="hilite(799)" onMouseOut="lolite()" onClick="logVariable('res')" href="../../_variables/res.html">$res</a>-&gt;<a onClick="logVariable('needsgrading')" class="var it42987" onMouseOver="hilite(42987)" onMouseOut="lolite()" href="../../_variables/needsgrading.html">needsgrading</a> = 0;
<a name="l653"><span class="linenum"> 653</span></a>                  <a class="var it799" onMouseOver="hilite(799)" onMouseOut="lolite()" onClick="logVariable('res')" href="../../_variables/res.html">$res</a>-&gt;<a onClick="logVariable('autograded')" class="var it42987" onMouseOver="hilite(42987)" onMouseOut="lolite()" href="../../_variables/autograded.html">autograded</a> = 0;
<a name="l654"><span class="linenum"> 654</span></a>                  <a class="var it799" onMouseOver="hilite(799)" onMouseOut="lolite()" onClick="logVariable('res')" href="../../_variables/res.html">$res</a>-&gt;<a onClick="logVariable('manuallygraded')" class="var it42987" onMouseOver="hilite(42987)" onMouseOut="lolite()" href="../../_variables/manuallygraded.html">manuallygraded</a> = 0;
<a name="l655"><span class="linenum"> 655</span></a>                  <a class="var it799" onMouseOver="hilite(799)" onMouseOut="lolite()" onClick="logVariable('res')" href="../../_variables/res.html">$res</a>-&gt;<a onClick="logVariable('all')" class="var it42987" onMouseOver="hilite(42987)" onMouseOut="lolite()" href="../../_variables/all.html">all</a> = 0;
<a name="l656"><span class="linenum"> 656</span></a>                  <a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../../_variables/results.html">$results</a>[<a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>] = <a class="var it799" onMouseOver="hilite(799)" onMouseOut="lolite()" onClick="logVariable('res')" href="../../_variables/res.html">$res</a>;
<a name="l657"><span class="linenum"> 657</span></a>              }
<a name="l658"><span class="linenum"> 658</span></a>  
<a name="l659"><span class="linenum"> 659</span></a>              <a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../../_variables/results.html">$results</a>[<a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>]-&gt;{<a class="var it57" onMouseOver="hilite(57)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>-&gt;<a onClick="logVariable('summarystate')" class="var it42924" onMouseOver="hilite(42924)" onMouseOut="lolite()" href="../../_variables/summarystate.html">summarystate</a>} = <a class="var it57" onMouseOver="hilite(57)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>-&gt;<a onClick="logVariable('numattempts')" class="var it42924" onMouseOver="hilite(42924)" onMouseOut="lolite()" href="../../_variables/numattempts.html">numattempts</a>;
<a name="l660"><span class="linenum"> 660</span></a>              <a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../../_variables/results.html">$results</a>[<a class="var it290" onMouseOver="hilite(290)" onMouseOut="lolite()" onClick="logVariable('index')" href="../../_variables/index.html">$index</a>]-&gt;all += <a class="var it57" onMouseOver="hilite(57)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>-&gt;<a onClick="logVariable('numattempts')" class="var it42924" onMouseOver="hilite(42924)" onMouseOut="lolite()" href="../../_variables/numattempts.html">numattempts</a>;
<a name="l661"><span class="linenum"> 661</span></a>          }
<a name="l662"><span class="linenum"> 662</span></a>          <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('rs')" href="../../_variables/rs.html">$rs</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l663"><span class="linenum"> 663</span></a>  
<a name="l664"><span class="linenum"> 664</span></a>          return <a class="var it4821" onMouseOver="hilite(4821)" onMouseOut="lolite()" onClick="logVariable('results')" href="../../_variables/results.html">$results</a>;
<a name="l665"><span class="linenum"> 665</span></a>      }
<a name="l666"><span class="linenum"> 666</span></a>  
<a name="l667"><span class="linenum"> 667</span></a>      <span class="comment">/**</span>
<a name="l668"><span class="linenum"> 668</span></a>  <span class="comment">     * Get a list of usage ids where the question with slot $slot, and optionally</span>
<a name="l669"><span class="linenum"> 669</span></a>  <span class="comment">     * also with question id $questionid, is in summary state $summarystate. Also</span>
<a name="l670"><span class="linenum"> 670</span></a>  <span class="comment">     * return the total count of such states.</span>
<a name="l671"><span class="linenum"> 671</span></a>  <span class="comment">     *</span>
<a name="l672"><span class="linenum"> 672</span></a>  <span class="comment">     * Only a subset of the ids can be returned by using $orderby, $limitfrom and</span>
<a name="l673"><span class="linenum"> 673</span></a>  <span class="comment">     * $limitnum. A special value 'random' can be passed as $orderby, in which case</span>
<a name="l674"><span class="linenum"> 674</span></a>  <span class="comment">     * $limitfrom is ignored.</span>
<a name="l675"><span class="linenum"> 675</span></a>  <span class="comment">     *</span>
<a name="l676"><span class="linenum"> 676</span></a>  <span class="comment">     * This method may be called publicly.</span>
<a name="l677"><span class="linenum"> 677</span></a>  <span class="comment">     *</span>
<a name="l678"><span class="linenum"> 678</span></a>  <span class="comment">     * @param qubaid_condition $qubaids used to restrict which usages are included</span>
<a name="l679"><span class="linenum"> 679</span></a>  <span class="comment">     * in the query. See {@link qubaid_condition}.</span>
<a name="l680"><span class="linenum"> 680</span></a>  <span class="comment">     * @param int $slot The slot for the questions you want to konw about.</span>
<a name="l681"><span class="linenum"> 681</span></a>  <span class="comment">     * @param int $questionid (optional) Only return attempts that were of this specific question.</span>
<a name="l682"><span class="linenum"> 682</span></a>  <span class="comment">     * @param string $summarystate the summary state of interest, or 'all'.</span>
<a name="l683"><span class="linenum"> 683</span></a>  <span class="comment">     * @param string $orderby the column to order by.</span>
<a name="l684"><span class="linenum"> 684</span></a>  <span class="comment">     * @param array $params any params required by any of the SQL fragments.</span>
<a name="l685"><span class="linenum"> 685</span></a>  <span class="comment">     * @param int $limitfrom implements paging of the results.</span>
<a name="l686"><span class="linenum"> 686</span></a>  <span class="comment">     *      Ignored if $orderby = random or $limitnum is null.</span>
<a name="l687"><span class="linenum"> 687</span></a>  <span class="comment">     * @param int $limitnum implements paging of the results. null = all.</span>
<a name="l688"><span class="linenum"> 688</span></a>  <span class="comment">     * @return array with two elements, an array of usage ids, and a count of the total number.</span>
<a name="l689"><span class="linenum"> 689</span></a>  <span class="comment">     */</span>
<a name="l690"><span class="linenum"> 690</span></a>      public function <a class="function" onClick="logFunction('load_questions_usages_where_question_in_state')" href="../../_functions/load_questions_usages_where_question_in_state.html" onMouseOver="funcPopup(event,'load_questions_usages_where_question_in_state')">load_questions_usages_where_question_in_state</a>(
<a name="l691"><span class="linenum"> 691</span></a>              qubaid_condition <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>, <a class="var it9213" onMouseOver="hilite(9213)" onMouseOut="lolite()" onClick="logVariable('summarystate')" href="../../_variables/summarystate.html">$summarystate</a>, <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>, <a class="var it530" onMouseOver="hilite(530)" onMouseOut="lolite()" onClick="logVariable('questionid')" href="../../_variables/questionid.html">$questionid</a> = null,
<a name="l692"><span class="linenum"> 692</span></a>              <a class="var it5076" onMouseOver="hilite(5076)" onMouseOut="lolite()" onClick="logVariable('orderby')" href="../../_variables/orderby.html">$orderby</a> = 'random', <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array(), <a class="var it1013" onMouseOver="hilite(1013)" onMouseOut="lolite()" onClick="logVariable('limitfrom')" href="../../_variables/limitfrom.html">$limitfrom</a> = 0, <a class="var it1014" onMouseOver="hilite(1014)" onMouseOut="lolite()" onClick="logVariable('limitnum')" href="../../_variables/limitnum.html">$limitnum</a> = null) {
<a name="l693"><span class="linenum"> 693</span></a>  
<a name="l694"><span class="linenum"> 694</span></a>          <a class="var it9214" onMouseOver="hilite(9214)" onMouseOut="lolite()" onClick="logVariable('extrawhere')" href="../../_variables/extrawhere.html">$extrawhere</a> = '';
<a name="l695"><span class="linenum"> 695</span></a>          if (<a class="var it530" onMouseOver="hilite(530)" onMouseOut="lolite()" onClick="logVariable('questionid')" href="../../_variables/questionid.html">$questionid</a>) {
<a name="l696"><span class="linenum"> 696</span></a>              <a class="var it9214" onMouseOver="hilite(9214)" onMouseOut="lolite()" onClick="logVariable('extrawhere')" href="../../_variables/extrawhere.html">$extrawhere</a> .= ' AND qa.questionid = :questionid';
<a name="l697"><span class="linenum"> 697</span></a>              <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['questionid'] = <a class="var it530" onMouseOver="hilite(530)" onMouseOut="lolite()" onClick="logVariable('questionid')" href="../../_variables/questionid.html">$questionid</a>;
<a name="l698"><span class="linenum"> 698</span></a>          }
<a name="l699"><span class="linenum"> 699</span></a>          if (<a class="var it9213" onMouseOver="hilite(9213)" onMouseOut="lolite()" onClick="logVariable('summarystate')" href="../../_variables/summarystate.html">$summarystate</a> != 'all') {
<a name="l700"><span class="linenum"> 700</span></a>              <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it3797" onMouseOver="hilite(3797)" onMouseOut="lolite()" onClick="logVariable('test')" href="../../_variables/test.html">$test</a>, <a class="var it9215" onMouseOver="hilite(9215)" onMouseOut="lolite()" onClick="logVariable('sparams')" href="../../_variables/sparams.html">$sparams</a>) = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('in_summary_state_test')" href="../../_functions/in_summary_state_test.html" onMouseOver="funcPopup(event,'in_summary_state_test')">in_summary_state_test</a>(<a class="var it9213" onMouseOver="hilite(9213)" onMouseOut="lolite()" onClick="logVariable('summarystate')" href="../../_variables/summarystate.html">$summarystate</a>);
<a name="l701"><span class="linenum"> 701</span></a>              <a class="var it9214" onMouseOver="hilite(9214)" onMouseOut="lolite()" onClick="logVariable('extrawhere')" href="../../_variables/extrawhere.html">$extrawhere</a> .= ' AND qas.state ' . <a class="var it3797" onMouseOver="hilite(3797)" onMouseOut="lolite()" onClick="logVariable('test')" href="../../_variables/test.html">$test</a>;
<a name="l702"><span class="linenum"> 702</span></a>              <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> += <a class="var it9215" onMouseOver="hilite(9215)" onMouseOut="lolite()" onClick="logVariable('sparams')" href="../../_variables/sparams.html">$sparams</a>;
<a name="l703"><span class="linenum"> 703</span></a>          }
<a name="l704"><span class="linenum"> 704</span></a>  
<a name="l705"><span class="linenum"> 705</span></a>          if (<a class="var it5076" onMouseOver="hilite(5076)" onMouseOut="lolite()" onClick="logVariable('orderby')" href="../../_variables/orderby.html">$orderby</a> == 'random') {
<a name="l706"><span class="linenum"> 706</span></a>              <a class="var it9216" onMouseOver="hilite(9216)" onMouseOut="lolite()" onClick="logVariable('sqlorderby')" href="../../_variables/sqlorderby.html">$sqlorderby</a> = '';
<a name="l707"><span class="linenum"> 707</span></a>          } else if (<a class="var it5076" onMouseOver="hilite(5076)" onMouseOut="lolite()" onClick="logVariable('orderby')" href="../../_variables/orderby.html">$orderby</a>) {
<a name="l708"><span class="linenum"> 708</span></a>              <a class="var it9216" onMouseOver="hilite(9216)" onMouseOut="lolite()" onClick="logVariable('sqlorderby')" href="../../_variables/sqlorderby.html">$sqlorderby</a> = 'ORDER BY ' . <a class="var it5076" onMouseOver="hilite(5076)" onMouseOut="lolite()" onClick="logVariable('orderby')" href="../../_variables/orderby.html">$orderby</a>;
<a name="l709"><span class="linenum"> 709</span></a>          } else {
<a name="l710"><span class="linenum"> 710</span></a>              <a class="var it9216" onMouseOver="hilite(9216)" onMouseOut="lolite()" onClick="logVariable('sqlorderby')" href="../../_variables/sqlorderby.html">$sqlorderby</a> = '';
<a name="l711"><span class="linenum"> 711</span></a>          }
<a name="l712"><span class="linenum"> 712</span></a>  
<a name="l713"><span class="linenum"> 713</span></a>  <span class="comment">        // We always want the total count, as well as the partcular list of ids</span>
<a name="l714"><span class="linenum"> 714</span></a>  <span class="comment">        // based on the paging and sort order. Because the list of ids is never</span>
<a name="l715"><span class="linenum"> 715</span></a>  <span class="comment">        // going to be too ridiculously long. My worst-case scenario is</span>
<a name="l716"><span class="linenum"> 716</span></a>  <span class="comment">        // 10,000 students in the course, each doing 5 quiz attempts. That</span>
<a name="l717"><span class="linenum"> 717</span></a>  <span class="comment">        // is a 50,000 element int =&gt; int array, which PHP seems to use 5MB</span>
<a name="l718"><span class="linenum"> 718</span></a>  <span class="comment">        // memory to store on a 64 bit server.</span>
<a name="l719"><span class="linenum"> 719</span></a>          <a class="var it9217" onMouseOver="hilite(9217)" onMouseOut="lolite()" onClick="logVariable('qubaidswhere')" href="../../_variables/qubaidswhere.html">$qubaidswhere</a> = <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('where')" href="../../_functions/where.html" onMouseOver="funcPopup(event,'where')">where</a>(); <span class="comment">// Must call this before params.</span>
<a name="l720"><span class="linenum"> 720</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> += <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('from_where_params')" href="../../_functions/from_where_params.html" onMouseOver="funcPopup(event,'from_where_params')">from_where_params</a>();
<a name="l721"><span class="linenum"> 721</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['slot'] = <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>;
<a name="l722"><span class="linenum"> 722</span></a>  
<a name="l723"><span class="linenum"> 723</span></a>          <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_records_sql_menu')" href="../../_functions/get_records_sql_menu.html" onMouseOver="funcPopup(event,'get_records_sql_menu')">get_records_sql_menu</a>(&quot;
<a name="l724"><span class="linenum"> 724</span></a>  SELECT
<a name="l725"><span class="linenum"> 725</span></a>      qa.questionusageid,
<a name="l726"><span class="linenum"> 726</span></a>      1
<a name="l727"><span class="linenum"> 727</span></a>  
<a name="l728"><span class="linenum"> 728</span></a>  FROM {<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('from_question_attempts')" href="../../_functions/from_question_attempts.html" onMouseOver="funcPopup(event,'from_question_attempts')">from_question_attempts</a>('qa')}
<a name="l729"><span class="linenum"> 729</span></a>  JOIN {question_attempt_steps} qas ON qas.questionattemptid = qa.id
<a name="l730"><span class="linenum"> 730</span></a>          AND qas.sequencenumber = {<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('latest_step_for_qa_subquery')" href="../../_functions/latest_step_for_qa_subquery.html" onMouseOver="funcPopup(event,'latest_step_for_qa_subquery')">latest_step_for_qa_subquery</a>()}
<a name="l731"><span class="linenum"> 731</span></a>  JOIN {question} q ON q.id = qa.questionid
<a name="l732"><span class="linenum"> 732</span></a>  
<a name="l733"><span class="linenum"> 733</span></a>  WHERE
<a name="l734"><span class="linenum"> 734</span></a>      {<a class="var it9217" onMouseOver="hilite(9217)" onMouseOut="lolite()" onClick="logVariable('qubaidswhere')" href="../../_variables/qubaidswhere.html">$qubaidswhere</a>} AND
<a name="l735"><span class="linenum"> 735</span></a>      qa.slot = :slot
<a name="l736"><span class="linenum"> 736</span></a>      <a class="var it9214" onMouseOver="hilite(9214)" onMouseOut="lolite()" onClick="logVariable('extrawhere')" href="../../_variables/extrawhere.html">$extrawhere</a>
<a name="l737"><span class="linenum"> 737</span></a>  
<a name="l738"><span class="linenum"> 738</span></a>  <a class="var it9216" onMouseOver="hilite(9216)" onMouseOut="lolite()" onClick="logVariable('sqlorderby')" href="../../_variables/sqlorderby.html">$sqlorderby</a>
<a name="l739"><span class="linenum"> 739</span></a>          &quot;, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l740"><span class="linenum"> 740</span></a>  
<a name="l741"><span class="linenum"> 741</span></a>          <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a> = <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>);
<a name="l742"><span class="linenum"> 742</span></a>          <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a> = <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>);
<a name="l743"><span class="linenum"> 743</span></a>  
<a name="l744"><span class="linenum"> 744</span></a>          if (<a class="var it5076" onMouseOver="hilite(5076)" onMouseOut="lolite()" onClick="logVariable('orderby')" href="../../_variables/orderby.html">$orderby</a> == 'random') {
<a name="l745"><span class="linenum"> 745</span></a>              <a class="phpfunction" onClick="logFunction('shuffle')" href="../../_functions/shuffle.html" onMouseOver="phpfuncPopup(event,'shuffle')">shuffle</a>(<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>);
<a name="l746"><span class="linenum"> 746</span></a>              <a class="var it1013" onMouseOver="hilite(1013)" onMouseOut="lolite()" onClick="logVariable('limitfrom')" href="../../_variables/limitfrom.html">$limitfrom</a> = 0;
<a name="l747"><span class="linenum"> 747</span></a>          }
<a name="l748"><span class="linenum"> 748</span></a>  
<a name="l749"><span class="linenum"> 749</span></a>          if (!<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it1014" onMouseOver="hilite(1014)" onMouseOut="lolite()" onClick="logVariable('limitnum')" href="../../_variables/limitnum.html">$limitnum</a>)) {
<a name="l750"><span class="linenum"> 750</span></a>              <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a> = <a class="phpfunction" onClick="logFunction('array_slice')" href="../../_functions/array_slice.html" onMouseOver="phpfuncPopup(event,'array_slice')">array_slice</a>(<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>, <a class="var it1013" onMouseOver="hilite(1013)" onMouseOut="lolite()" onClick="logVariable('limitfrom')" href="../../_variables/limitfrom.html">$limitfrom</a>, <a class="var it1014" onMouseOver="hilite(1014)" onMouseOut="lolite()" onClick="logVariable('limitnum')" href="../../_variables/limitnum.html">$limitnum</a>);
<a name="l751"><span class="linenum"> 751</span></a>          }
<a name="l752"><span class="linenum"> 752</span></a>  
<a name="l753"><span class="linenum"> 753</span></a>          return array(<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>, <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a>);
<a name="l754"><span class="linenum"> 754</span></a>      }
<a name="l755"><span class="linenum"> 755</span></a>  
<a name="l756"><span class="linenum"> 756</span></a>      <span class="comment">/**</span>
<a name="l757"><span class="linenum"> 757</span></a>  <span class="comment">     * Load the average mark, and number of attempts, for each slot in a set of</span>
<a name="l758"><span class="linenum"> 758</span></a>  <span class="comment">     * question usages..</span>
<a name="l759"><span class="linenum"> 759</span></a>  <span class="comment">     *</span>
<a name="l760"><span class="linenum"> 760</span></a>  <span class="comment">     * This method may be called publicly.</span>
<a name="l761"><span class="linenum"> 761</span></a>  <span class="comment">     *</span>
<a name="l762"><span class="linenum"> 762</span></a>  <span class="comment">     * @param qubaid_condition $qubaids used to restrict which usages are included</span>
<a name="l763"><span class="linenum"> 763</span></a>  <span class="comment">     * in the query. See {@link qubaid_condition}.</span>
<a name="l764"><span class="linenum"> 764</span></a>  <span class="comment">     * @param array $slots if null, load info for all quesitions, otherwise only</span>
<a name="l765"><span class="linenum"> 765</span></a>  <span class="comment">     * load the averages for the specified questions.</span>
<a name="l766"><span class="linenum"> 766</span></a>  <span class="comment">     * @return array of objects with fields -&gt;slot, -&gt;averagefraction and -&gt;numaveraged.</span>
<a name="l767"><span class="linenum"> 767</span></a>  <span class="comment">     */</span>
<a name="l768"><span class="linenum"> 768</span></a>      public function <a class="function" onClick="logFunction('load_average_marks')" href="../../_functions/load_average_marks.html" onMouseOver="funcPopup(event,'load_average_marks')">load_average_marks</a>(qubaid_condition <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>, <a class="var it933" onMouseOver="hilite(933)" onMouseOut="lolite()" onClick="logVariable('slots')" href="../../_variables/slots.html">$slots</a> = null) {
<a name="l769"><span class="linenum"> 769</span></a>          if (!empty(<a class="var it933" onMouseOver="hilite(933)" onMouseOut="lolite()" onClick="logVariable('slots')" href="../../_variables/slots.html">$slots</a>)) {
<a name="l770"><span class="linenum"> 770</span></a>              <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it9209" onMouseOver="hilite(9209)" onMouseOut="lolite()" onClick="logVariable('slottest')" href="../../_variables/slottest.html">$slottest</a>, <a class="var it9218" onMouseOver="hilite(9218)" onMouseOut="lolite()" onClick="logVariable('slotsparams')" href="../../_variables/slotsparams.html">$slotsparams</a>) = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(
<a name="l771"><span class="linenum"> 771</span></a>                      <a class="var it933" onMouseOver="hilite(933)" onMouseOut="lolite()" onClick="logVariable('slots')" href="../../_variables/slots.html">$slots</a>, <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'slot');
<a name="l772"><span class="linenum"> 772</span></a>              <a class="var it9219" onMouseOver="hilite(9219)" onMouseOut="lolite()" onClick="logVariable('slotwhere')" href="../../_variables/slotwhere.html">$slotwhere</a> = &quot; AND qa.slot {<a class="var it9209" onMouseOver="hilite(9209)" onMouseOut="lolite()" onClick="logVariable('slottest')" href="../../_variables/slottest.html">$slottest</a>}&quot;;
<a name="l773"><span class="linenum"> 773</span></a>          } else {
<a name="l774"><span class="linenum"> 774</span></a>              <a class="var it9219" onMouseOver="hilite(9219)" onMouseOut="lolite()" onClick="logVariable('slotwhere')" href="../../_variables/slotwhere.html">$slotwhere</a> = '';
<a name="l775"><span class="linenum"> 775</span></a>              <a class="var it9218" onMouseOver="hilite(9218)" onMouseOut="lolite()" onClick="logVariable('slotsparams')" href="../../_variables/slotsparams.html">$slotsparams</a> = array();
<a name="l776"><span class="linenum"> 776</span></a>          }
<a name="l777"><span class="linenum"> 777</span></a>  
<a name="l778"><span class="linenum"> 778</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it9220" onMouseOver="hilite(9220)" onMouseOut="lolite()" onClick="logVariable('statetest')" href="../../_variables/statetest.html">$statetest</a>, <a class="var it4611" onMouseOver="hilite(4611)" onMouseOut="lolite()" onClick="logVariable('stateparams')" href="../../_variables/stateparams.html">$stateparams</a>) = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(array(
<a name="l779"><span class="linenum"> 779</span></a>                  (string) question_state::<a class="var it766" onMouseOver="hilite(766)" onMouseOut="lolite()" onClick="logVariable('gaveup')" href="../../_variables/gaveup.html">$gaveup</a>,
<a name="l780"><span class="linenum"> 780</span></a>                  (string) question_state::<a class="var it2528" onMouseOver="hilite(2528)" onMouseOut="lolite()" onClick="logVariable('gradedwrong')" href="../../_variables/gradedwrong.html">$gradedwrong</a>,
<a name="l781"><span class="linenum"> 781</span></a>                  (string) question_state::<a class="var it1971" onMouseOver="hilite(1971)" onMouseOut="lolite()" onClick="logVariable('gradedpartial')" href="../../_variables/gradedpartial.html">$gradedpartial</a>,
<a name="l782"><span class="linenum"> 782</span></a>                  (string) question_state::<a class="var it1970" onMouseOver="hilite(1970)" onMouseOut="lolite()" onClick="logVariable('gradedright')" href="../../_variables/gradedright.html">$gradedright</a>,
<a name="l783"><span class="linenum"> 783</span></a>                  (string) question_state::<a class="var it9221" onMouseOver="hilite(9221)" onMouseOut="lolite()" onClick="logVariable('mangaveup')" href="../../_variables/mangaveup.html">$mangaveup</a>,
<a name="l784"><span class="linenum"> 784</span></a>                  (string) question_state::<a class="var it8213" onMouseOver="hilite(8213)" onMouseOut="lolite()" onClick="logVariable('mangrwrong')" href="../../_variables/mangrwrong.html">$mangrwrong</a>,
<a name="l785"><span class="linenum"> 785</span></a>                  (string) question_state::<a class="var it8212" onMouseOver="hilite(8212)" onMouseOut="lolite()" onClick="logVariable('mangrpartial')" href="../../_variables/mangrpartial.html">$mangrpartial</a>,
<a name="l786"><span class="linenum"> 786</span></a>                  (string) question_state::<a class="var it4451" onMouseOver="hilite(4451)" onMouseOut="lolite()" onClick="logVariable('mangrright')" href="../../_variables/mangrright.html">$mangrright</a>), <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'st');
<a name="l787"><span class="linenum"> 787</span></a>  
<a name="l788"><span class="linenum"> 788</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_records_sql')" href="../../_functions/get_records_sql.html" onMouseOver="funcPopup(event,'get_records_sql')">get_records_sql</a>(&quot;
<a name="l789"><span class="linenum"> 789</span></a>  SELECT
<a name="l790"><span class="linenum"> 790</span></a>      qa.slot,
<a name="l791"><span class="linenum"> 791</span></a>      <a class="function" onClick="logFunction('AVG')" href="../../_functions/avg.html" onMouseOver="funcPopup(event,'avg')">AVG</a>(COALESCE(qas.fraction, 0)) AS averagefraction,
<a name="l792"><span class="linenum"> 792</span></a>      <a class="phpfunction" onClick="logFunction('COUNT')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">COUNT</a>(1) AS numaveraged
<a name="l793"><span class="linenum"> 793</span></a>  
<a name="l794"><span class="linenum"> 794</span></a>  FROM {<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('from_question_attempts')" href="../../_functions/from_question_attempts.html" onMouseOver="funcPopup(event,'from_question_attempts')">from_question_attempts</a>('qa')}
<a name="l795"><span class="linenum"> 795</span></a>  JOIN {question_attempt_steps} qas ON qas.questionattemptid = qa.id
<a name="l796"><span class="linenum"> 796</span></a>          AND qas.sequencenumber = {<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('latest_step_for_qa_subquery')" href="../../_functions/latest_step_for_qa_subquery.html" onMouseOver="funcPopup(event,'latest_step_for_qa_subquery')">latest_step_for_qa_subquery</a>()}
<a name="l797"><span class="linenum"> 797</span></a>  
<a name="l798"><span class="linenum"> 798</span></a>  WHERE
<a name="l799"><span class="linenum"> 799</span></a>      {<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('where')" href="../../_functions/where.html" onMouseOver="funcPopup(event,'where')">where</a>()}
<a name="l800"><span class="linenum"> 800</span></a>      <a class="var it9219" onMouseOver="hilite(9219)" onMouseOut="lolite()" onClick="logVariable('slotwhere')" href="../../_variables/slotwhere.html">$slotwhere</a>
<a name="l801"><span class="linenum"> 801</span></a>      AND qas.state <a class="var it9220" onMouseOver="hilite(9220)" onMouseOut="lolite()" onClick="logVariable('statetest')" href="../../_variables/statetest.html">$statetest</a>
<a name="l802"><span class="linenum"> 802</span></a>  
<a name="l803"><span class="linenum"> 803</span></a>  GROUP BY qa.slot
<a name="l804"><span class="linenum"> 804</span></a>  
<a name="l805"><span class="linenum"> 805</span></a>  ORDER BY qa.slot
<a name="l806"><span class="linenum"> 806</span></a>          &quot;, <a class="var it9218" onMouseOver="hilite(9218)" onMouseOut="lolite()" onClick="logVariable('slotsparams')" href="../../_variables/slotsparams.html">$slotsparams</a> + <a class="var it4611" onMouseOver="hilite(4611)" onMouseOut="lolite()" onClick="logVariable('stateparams')" href="../../_variables/stateparams.html">$stateparams</a> + <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('from_where_params')" href="../../_functions/from_where_params.html" onMouseOver="funcPopup(event,'from_where_params')">from_where_params</a>());
<a name="l807"><span class="linenum"> 807</span></a>      }
<a name="l808"><span class="linenum"> 808</span></a>  
<a name="l809"><span class="linenum"> 809</span></a>      <span class="comment">/**</span>
<a name="l810"><span class="linenum"> 810</span></a>  <span class="comment">     * Load all the attempts at a given queston from a set of question_usages.</span>
<a name="l811"><span class="linenum"> 811</span></a>  <span class="comment">     * steps.</span>
<a name="l812"><span class="linenum"> 812</span></a>  <span class="comment">     *</span>
<a name="l813"><span class="linenum"> 813</span></a>  <span class="comment">     * This method may be called publicly.</span>
<a name="l814"><span class="linenum"> 814</span></a>  <span class="comment">     *</span>
<a name="l815"><span class="linenum"> 815</span></a>  <span class="comment">     * @param int $questionid the question to load all the attempts fors.</span>
<a name="l816"><span class="linenum"> 816</span></a>  <span class="comment">     * @param qubaid_condition $qubaids used to restrict which usages are included</span>
<a name="l817"><span class="linenum"> 817</span></a>  <span class="comment">     * in the query. See {@link qubaid_condition}.</span>
<a name="l818"><span class="linenum"> 818</span></a>  <span class="comment">     * @return question_attempt[] array of question_attempts that were loaded.</span>
<a name="l819"><span class="linenum"> 819</span></a>  <span class="comment">     */</span>
<a name="l820"><span class="linenum"> 820</span></a>      public function <a class="function" onClick="logFunction('load_attempts_at_question')" href="../../_functions/load_attempts_at_question.html" onMouseOver="funcPopup(event,'load_attempts_at_question')">load_attempts_at_question</a>(<a class="var it530" onMouseOver="hilite(530)" onMouseOut="lolite()" onClick="logVariable('questionid')" href="../../_variables/questionid.html">$questionid</a>, qubaid_condition <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>) {
<a name="l821"><span class="linenum"> 821</span></a>          <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = &quot;
<a name="l822"><span class="linenum"> 822</span></a>  SELECT
<a name="l823"><span class="linenum"> 823</span></a>      quba.contextid,
<a name="l824"><span class="linenum"> 824</span></a>      quba.preferredbehaviour,
<a name="l825"><span class="linenum"> 825</span></a>      qa.id AS questionattemptid,
<a name="l826"><span class="linenum"> 826</span></a>      qa.questionusageid,
<a name="l827"><span class="linenum"> 827</span></a>      qa.slot,
<a name="l828"><span class="linenum"> 828</span></a>      qa.behaviour,
<a name="l829"><span class="linenum"> 829</span></a>      qa.questionid,
<a name="l830"><span class="linenum"> 830</span></a>      qa.variant,
<a name="l831"><span class="linenum"> 831</span></a>      qa.maxmark,
<a name="l832"><span class="linenum"> 832</span></a>      qa.minfraction,
<a name="l833"><span class="linenum"> 833</span></a>      qa.maxfraction,
<a name="l834"><span class="linenum"> 834</span></a>      qa.flagged,
<a name="l835"><span class="linenum"> 835</span></a>      qa.questionsummary,
<a name="l836"><span class="linenum"> 836</span></a>      qa.rightanswer,
<a name="l837"><span class="linenum"> 837</span></a>      qa.responsesummary,
<a name="l838"><span class="linenum"> 838</span></a>      qa.timemodified,
<a name="l839"><span class="linenum"> 839</span></a>      qas.id AS attemptstepid,
<a name="l840"><span class="linenum"> 840</span></a>      qas.sequencenumber,
<a name="l841"><span class="linenum"> 841</span></a>      qas.state,
<a name="l842"><span class="linenum"> 842</span></a>      qas.fraction,
<a name="l843"><span class="linenum"> 843</span></a>      qas.timecreated,
<a name="l844"><span class="linenum"> 844</span></a>      qas.userid,
<a name="l845"><span class="linenum"> 845</span></a>      qasd.name,
<a name="l846"><span class="linenum"> 846</span></a>      qasd.value
<a name="l847"><span class="linenum"> 847</span></a>  
<a name="l848"><span class="linenum"> 848</span></a>  FROM {<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('from_question_attempts')" href="../../_functions/from_question_attempts.html" onMouseOver="funcPopup(event,'from_question_attempts')">from_question_attempts</a>('qa')}
<a name="l849"><span class="linenum"> 849</span></a>  JOIN {question_usages} quba ON quba.id = qa.questionusageid
<a name="l850"><span class="linenum"> 850</span></a>  LEFT JOIN {question_attempt_steps} qas ON qas.questionattemptid = qa.id
<a name="l851"><span class="linenum"> 851</span></a>  LEFT JOIN {question_attempt_step_data} qasd ON qasd.attemptstepid = qas.id
<a name="l852"><span class="linenum"> 852</span></a>  
<a name="l853"><span class="linenum"> 853</span></a>  WHERE
<a name="l854"><span class="linenum"> 854</span></a>      {<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('where')" href="../../_functions/where.html" onMouseOver="funcPopup(event,'where')">where</a>()} AND
<a name="l855"><span class="linenum"> 855</span></a>      qa.questionid = :questionid
<a name="l856"><span class="linenum"> 856</span></a>  
<a name="l857"><span class="linenum"> 857</span></a>  ORDER BY
<a name="l858"><span class="linenum"> 858</span></a>      quba.id,
<a name="l859"><span class="linenum"> 859</span></a>      qa.id,
<a name="l860"><span class="linenum"> 860</span></a>      qas.sequencenumber&quot;;
<a name="l861"><span class="linenum"> 861</span></a>  
<a name="l862"><span class="linenum"> 862</span></a>  <span class="comment">        // For qubaid_list must call this after calling methods that generate sql.</span>
<a name="l863"><span class="linenum"> 863</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('from_where_params')" href="../../_functions/from_where_params.html" onMouseOver="funcPopup(event,'from_where_params')">from_where_params</a>();
<a name="l864"><span class="linenum"> 864</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['questionid'] = <a class="var it530" onMouseOver="hilite(530)" onMouseOut="lolite()" onClick="logVariable('questionid')" href="../../_variables/questionid.html">$questionid</a>;
<a name="l865"><span class="linenum"> 865</span></a>  
<a name="l866"><span class="linenum"> 866</span></a>          <a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_recordset_sql')" href="../../_functions/get_recordset_sql.html" onMouseOver="funcPopup(event,'get_recordset_sql')">get_recordset_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l867"><span class="linenum"> 867</span></a>  
<a name="l868"><span class="linenum"> 868</span></a>          <a class="var it176" onMouseOver="hilite(176)" onMouseOut="lolite()" onClick="logVariable('questionattempts')" href="../../_variables/questionattempts.html">$questionattempts</a> = array();
<a name="l869"><span class="linenum"> 869</span></a>          while (<a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>-&gt;<a class="function" onClick="logFunction('valid')" href="../../_functions/valid.html" onMouseOver="funcPopup(event,'valid')">valid</a>()) {
<a name="l870"><span class="linenum"> 870</span></a>              <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a> = <a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>-&gt;<a class="phpfunction" onClick="logFunction('current')" href="../../_functions/current.html" onMouseOver="phpfuncPopup(event,'current')">current</a>();
<a name="l871"><span class="linenum"> 871</span></a>              <a class="var it176" onMouseOver="hilite(176)" onMouseOut="lolite()" onClick="logVariable('questionattempts')" href="../../_variables/questionattempts.html">$questionattempts</a>[<a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('questionattemptid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/questionattemptid.html">questionattemptid</a>] =
<a name="l872"><span class="linenum"> 872</span></a>                      <a class="class" onClick="logClass('question_attempt')" href="../../_classes/question_attempt.html" onMouseOver="classPopup(event,'question_attempt')">question_attempt</a>::<a class="function" onClick="logFunction('load_from_records')" href="../../_functions/load_from_records.html" onMouseOver="funcPopup(event,'load_from_records')">load_from_records</a>(<a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>,
<a name="l873"><span class="linenum"> 873</span></a>                      <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('questionattemptid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/questionattemptid.html">questionattemptid</a>, <span class="keyword">new </span><a class="class" onClick="logClass('question_usage_null_observer')" href="../../_classes/question_usage_null_observer.html" onMouseOver="classPopup(event,'question_usage_null_observer')">question_usage_null_observer</a>(),
<a name="l874"><span class="linenum"> 874</span></a>                      <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('preferredbehaviour')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/preferredbehaviour.html">preferredbehaviour</a>);
<a name="l875"><span class="linenum"> 875</span></a>          }
<a name="l876"><span class="linenum"> 876</span></a>          <a class="var it988" onMouseOver="hilite(988)" onMouseOut="lolite()" onClick="logVariable('records')" href="../../_variables/records.html">$records</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l877"><span class="linenum"> 877</span></a>  
<a name="l878"><span class="linenum"> 878</span></a>          return <a class="var it176" onMouseOver="hilite(176)" onMouseOut="lolite()" onClick="logVariable('questionattempts')" href="../../_variables/questionattempts.html">$questionattempts</a>;
<a name="l879"><span class="linenum"> 879</span></a>      }
<a name="l880"><span class="linenum"> 880</span></a>  
<a name="l881"><span class="linenum"> 881</span></a>      <span class="comment">/**</span>
<a name="l882"><span class="linenum"> 882</span></a>  <span class="comment">     * Update a question_usages row to refect any changes in a usage (but not</span>
<a name="l883"><span class="linenum"> 883</span></a>  <span class="comment">     * any of its question_attempts.</span>
<a name="l884"><span class="linenum"> 884</span></a>  <span class="comment">     *</span>
<a name="l885"><span class="linenum"> 885</span></a>  <span class="comment">     * You should not call this method directly. You should use</span>
<a name="l886"><span class="linenum"> 886</span></a>  <span class="comment">     * @link question_engine::save_questions_usage_by_activity()}.</span>
<a name="l887"><span class="linenum"> 887</span></a>  <span class="comment">     *</span>
<a name="l888"><span class="linenum"> 888</span></a>  <span class="comment">     * @param question_usage_by_activity $quba the usage that has changed.</span>
<a name="l889"><span class="linenum"> 889</span></a>  <span class="comment">     */</span>
<a name="l890"><span class="linenum"> 890</span></a>      public function <a class="function" onClick="logFunction('update_questions_usage_by_activity')" href="../../_functions/update_questions_usage_by_activity.html" onMouseOver="funcPopup(event,'update_questions_usage_by_activity')">update_questions_usage_by_activity</a>(question_usage_by_activity <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>) {
<a name="l891"><span class="linenum"> 891</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a> = new stdClass();
<a name="l892"><span class="linenum"> 892</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>-&gt;<a class="function" onClick="logFunction('get_id')" href="../../_functions/get_id.html" onMouseOver="funcPopup(event,'get_id')">get_id</a>();
<a name="l893"><span class="linenum"> 893</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('contextid')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/contextid.html">contextid</a> = <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>-&gt;<a class="function" onClick="logFunction('get_owning_context')" href="../../_functions/get_owning_context.html" onMouseOver="funcPopup(event,'get_owning_context')">get_owning_context</a>()-&gt;id;
<a name="l894"><span class="linenum"> 894</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('component')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/component.html">component</a> = <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>-&gt;<a class="function" onClick="logFunction('get_owning_component')" href="../../_functions/get_owning_component.html" onMouseOver="funcPopup(event,'get_owning_component')">get_owning_component</a>();
<a name="l895"><span class="linenum"> 895</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('preferredbehaviour')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/preferredbehaviour.html">preferredbehaviour</a> = <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>-&gt;<a class="function" onClick="logFunction('get_preferred_behaviour')" href="../../_functions/get_preferred_behaviour.html" onMouseOver="funcPopup(event,'get_preferred_behaviour')">get_preferred_behaviour</a>();
<a name="l896"><span class="linenum"> 896</span></a>  
<a name="l897"><span class="linenum"> 897</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('question_usages', <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>);
<a name="l898"><span class="linenum"> 898</span></a>      }
<a name="l899"><span class="linenum"> 899</span></a>  
<a name="l900"><span class="linenum"> 900</span></a>      <span class="comment">/**</span>
<a name="l901"><span class="linenum"> 901</span></a>  <span class="comment">     * Update a question_attempts row to refect any changes in a question_attempt</span>
<a name="l902"><span class="linenum"> 902</span></a>  <span class="comment">     * (but not any of its steps).</span>
<a name="l903"><span class="linenum"> 903</span></a>  <span class="comment">     *</span>
<a name="l904"><span class="linenum"> 904</span></a>  <span class="comment">     * You should not call this method directly. You should use</span>
<a name="l905"><span class="linenum"> 905</span></a>  <span class="comment">     * @link question_engine::save_questions_usage_by_activity()}.</span>
<a name="l906"><span class="linenum"> 906</span></a>  <span class="comment">     *</span>
<a name="l907"><span class="linenum"> 907</span></a>  <span class="comment">     * @param question_attempt $qa the question attempt that has changed.</span>
<a name="l908"><span class="linenum"> 908</span></a>  <span class="comment">     */</span>
<a name="l909"><span class="linenum"> 909</span></a>      public function <a class="function" onClick="logFunction('update_question_attempt')" href="../../_functions/update_question_attempt.html" onMouseOver="funcPopup(event,'update_question_attempt')">update_question_attempt</a>(question_attempt <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>) {
<a name="l910"><span class="linenum"> 910</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a> = new stdClass();
<a name="l911"><span class="linenum"> 911</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('id')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/id.html">id</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_database_id')" href="../../_functions/get_database_id.html" onMouseOver="funcPopup(event,'get_database_id')">get_database_id</a>();
<a name="l912"><span class="linenum"> 912</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('slot')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/slot.html">slot</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_slot')" href="../../_functions/get_slot.html" onMouseOver="funcPopup(event,'get_slot')">get_slot</a>();
<a name="l913"><span class="linenum"> 913</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('variant')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/variant.html">variant</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_variant')" href="../../_functions/get_variant.html" onMouseOver="funcPopup(event,'get_variant')">get_variant</a>();
<a name="l914"><span class="linenum"> 914</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('maxmark')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/maxmark.html">maxmark</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_max_mark')" href="../../_functions/get_max_mark.html" onMouseOver="funcPopup(event,'get_max_mark')">get_max_mark</a>();
<a name="l915"><span class="linenum"> 915</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('minfraction')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/minfraction.html">minfraction</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_min_fraction')" href="../../_functions/get_min_fraction.html" onMouseOver="funcPopup(event,'get_min_fraction')">get_min_fraction</a>();
<a name="l916"><span class="linenum"> 916</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('maxfraction')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/maxfraction.html">maxfraction</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_max_fraction')" href="../../_functions/get_max_fraction.html" onMouseOver="funcPopup(event,'get_max_fraction')">get_max_fraction</a>();
<a name="l917"><span class="linenum"> 917</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('flagged')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/flagged.html">flagged</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('is_flagged')" href="../../_functions/is_flagged.html" onMouseOver="funcPopup(event,'is_flagged')">is_flagged</a>();
<a name="l918"><span class="linenum"> 918</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('questionsummary')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/questionsummary.html">questionsummary</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_question_summary')" href="../../_functions/get_question_summary.html" onMouseOver="funcPopup(event,'get_question_summary')">get_question_summary</a>();
<a name="l919"><span class="linenum"> 919</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('rightanswer')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/rightanswer.html">rightanswer</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_right_answer_summary')" href="../../_functions/get_right_answer_summary.html" onMouseOver="funcPopup(event,'get_right_answer_summary')">get_right_answer_summary</a>();
<a name="l920"><span class="linenum"> 920</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('responsesummary')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/responsesummary.html">responsesummary</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_response_summary')" href="../../_functions/get_response_summary.html" onMouseOver="funcPopup(event,'get_response_summary')">get_response_summary</a>();
<a name="l921"><span class="linenum"> 921</span></a>          <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>-&gt;<a onClick="logVariable('timemodified')" class="var it42976" onMouseOver="hilite(42976)" onMouseOut="lolite()" href="../../_variables/timemodified.html">timemodified</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l922"><span class="linenum"> 922</span></a>  
<a name="l923"><span class="linenum"> 923</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('question_attempts', <a class="var it699" onMouseOver="hilite(699)" onMouseOut="lolite()" onClick="logVariable('record')" href="../../_variables/record.html">$record</a>);
<a name="l924"><span class="linenum"> 924</span></a>      }
<a name="l925"><span class="linenum"> 925</span></a>  
<a name="l926"><span class="linenum"> 926</span></a>      <span class="comment">/**</span>
<a name="l927"><span class="linenum"> 927</span></a>  <span class="comment">     * Delete a question_usage_by_activity and all its associated</span>
<a name="l928"><span class="linenum"> 928</span></a>  <span class="comment">     *</span>
<a name="l929"><span class="linenum"> 929</span></a>  <span class="comment">     * You should not call this method directly. You should use</span>
<a name="l930"><span class="linenum"> 930</span></a>  <span class="comment">     * @link question_engine::delete_questions_usage_by_activities()}.</span>
<a name="l931"><span class="linenum"> 931</span></a>  <span class="comment">     *</span>
<a name="l932"><span class="linenum"> 932</span></a>  <span class="comment">     * {@link question_attempts} and {@link question_attempt_steps} from the</span>
<a name="l933"><span class="linenum"> 933</span></a>  <span class="comment">     * database.</span>
<a name="l934"><span class="linenum"> 934</span></a>  <span class="comment">     * @param qubaid_condition $qubaids identifies which question useages to delete.</span>
<a name="l935"><span class="linenum"> 935</span></a>  <span class="comment">     */</span>
<a name="l936"><span class="linenum"> 936</span></a>      public function <a class="function" onClick="logFunction('delete_questions_usage_by_activities')" href="../../_functions/delete_questions_usage_by_activities.html" onMouseOver="funcPopup(event,'delete_questions_usage_by_activities')">delete_questions_usage_by_activities</a>(qubaid_condition <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>) {
<a name="l937"><span class="linenum"> 937</span></a>          <a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a> = &quot;qa.questionusageid {<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('usage_id_in')" href="../../_functions/usage_id_in.html" onMouseOver="funcPopup(event,'usage_id_in')">usage_id_in</a>()}&quot;;
<a name="l938"><span class="linenum"> 938</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('usage_id_in_params')" href="../../_functions/usage_id_in_params.html" onMouseOver="funcPopup(event,'usage_id_in_params')">usage_id_in_params</a>();
<a name="l939"><span class="linenum"> 939</span></a>  
<a name="l940"><span class="linenum"> 940</span></a>          <a class="var it9222" onMouseOver="hilite(9222)" onMouseOut="lolite()" onClick="logVariable('contextids')" href="../../_variables/contextids.html">$contextids</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_records_sql_menu')" href="../../_functions/get_records_sql_menu.html" onMouseOver="funcPopup(event,'get_records_sql_menu')">get_records_sql_menu</a>(&quot;
<a name="l941"><span class="linenum"> 941</span></a>                  SELECT DISTINCT contextid, 1
<a name="l942"><span class="linenum"> 942</span></a>                  FROM {question_usages}
<a name="l943"><span class="linenum"> 943</span></a>                  WHERE id {<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('usage_id_in')" href="../../_functions/usage_id_in.html" onMouseOver="funcPopup(event,'usage_id_in')">usage_id_in</a>()}&quot;, <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('usage_id_in_params')" href="../../_functions/usage_id_in_params.html" onMouseOver="funcPopup(event,'usage_id_in_params')">usage_id_in_params</a>());
<a name="l944"><span class="linenum"> 944</span></a>          foreach (<a class="var it9222" onMouseOver="hilite(9222)" onMouseOut="lolite()" onClick="logVariable('contextids')" href="../../_variables/contextids.html">$contextids</a> as <a class="var it782" onMouseOver="hilite(782)" onMouseOut="lolite()" onClick="logVariable('contextid')" href="../../_variables/contextid.html">$contextid</a> =&gt; <a class="var it2687" onMouseOver="hilite(2687)" onMouseOut="lolite()" onClick="logVariable('notused')" href="../../_variables/notused.html">$notused</a>) {
<a name="l945"><span class="linenum"> 945</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('delete_response_files')" href="../../_functions/delete_response_files.html" onMouseOver="funcPopup(event,'delete_response_files')">delete_response_files</a>(<a class="var it782" onMouseOver="hilite(782)" onMouseOut="lolite()" onClick="logVariable('contextid')" href="../../_variables/contextid.html">$contextid</a>, &quot;IN (
<a name="l946"><span class="linenum"> 946</span></a>                      SELECT qas.id
<a name="l947"><span class="linenum"> 947</span></a>                      FROM {question_attempts} qa
<a name="l948"><span class="linenum"> 948</span></a>                      JOIN {question_attempt_steps} qas ON qas.questionattemptid = qa.id
<a name="l949"><span class="linenum"> 949</span></a>                      WHERE <a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a>)&quot;, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l950"><span class="linenum"> 950</span></a>          }
<a name="l951"><span class="linenum"> 951</span></a>  
<a name="l952"><span class="linenum"> 952</span></a>          if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_dbfamily')" href="../../_functions/get_dbfamily.html" onMouseOver="funcPopup(event,'get_dbfamily')">get_dbfamily</a>() == 'mysql') {
<a name="l953"><span class="linenum"> 953</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('delete_usage_records_for_mysql')" href="../../_functions/delete_usage_records_for_mysql.html" onMouseOver="funcPopup(event,'delete_usage_records_for_mysql')">delete_usage_records_for_mysql</a>(<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>);
<a name="l954"><span class="linenum"> 954</span></a>              return;
<a name="l955"><span class="linenum"> 955</span></a>          }
<a name="l956"><span class="linenum"> 956</span></a>  
<a name="l957"><span class="linenum"> 957</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('delete_records_select')" href="../../_functions/delete_records_select.html" onMouseOver="funcPopup(event,'delete_records_select')">delete_records_select</a>('question_attempt_step_data', &quot;attemptstepid IN (
<a name="l958"><span class="linenum"> 958</span></a>                  SELECT qas.id
<a name="l959"><span class="linenum"> 959</span></a>                  FROM {question_attempts} qa
<a name="l960"><span class="linenum"> 960</span></a>                  JOIN {question_attempt_steps} qas ON qas.questionattemptid = qa.id
<a name="l961"><span class="linenum"> 961</span></a>                  WHERE <a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a>)&quot;, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l962"><span class="linenum"> 962</span></a>  
<a name="l963"><span class="linenum"> 963</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('delete_records_select')" href="../../_functions/delete_records_select.html" onMouseOver="funcPopup(event,'delete_records_select')">delete_records_select</a>('question_attempt_steps', &quot;questionattemptid IN (
<a name="l964"><span class="linenum"> 964</span></a>                  SELECT qa.id
<a name="l965"><span class="linenum"> 965</span></a>                  FROM {question_attempts} qa
<a name="l966"><span class="linenum"> 966</span></a>                  WHERE <a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a>)&quot;, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l967"><span class="linenum"> 967</span></a>  
<a name="l968"><span class="linenum"> 968</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('delete_records_select')" href="../../_functions/delete_records_select.html" onMouseOver="funcPopup(event,'delete_records_select')">delete_records_select</a>('question_attempts',
<a name="l969"><span class="linenum"> 969</span></a>                  &quot;{question_attempts}.questionusageid {<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('usage_id_in')" href="../../_functions/usage_id_in.html" onMouseOver="funcPopup(event,'usage_id_in')">usage_id_in</a>()}&quot;,
<a name="l970"><span class="linenum"> 970</span></a>                  <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('usage_id_in_params')" href="../../_functions/usage_id_in_params.html" onMouseOver="funcPopup(event,'usage_id_in_params')">usage_id_in_params</a>());
<a name="l971"><span class="linenum"> 971</span></a>  
<a name="l972"><span class="linenum"> 972</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('delete_records_select')" href="../../_functions/delete_records_select.html" onMouseOver="funcPopup(event,'delete_records_select')">delete_records_select</a>('question_usages',
<a name="l973"><span class="linenum"> 973</span></a>                  &quot;{question_usages}.id {<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('usage_id_in')" href="../../_functions/usage_id_in.html" onMouseOver="funcPopup(event,'usage_id_in')">usage_id_in</a>()}&quot;, <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('usage_id_in_params')" href="../../_functions/usage_id_in_params.html" onMouseOver="funcPopup(event,'usage_id_in_params')">usage_id_in_params</a>());
<a name="l974"><span class="linenum"> 974</span></a>      }
<a name="l975"><span class="linenum"> 975</span></a>  
<a name="l976"><span class="linenum"> 976</span></a>      <span class="comment">/**</span>
<a name="l977"><span class="linenum"> 977</span></a>  <span class="comment">     * This function is a work-around for poor MySQL performance with</span>
<a name="l978"><span class="linenum"> 978</span></a>  <span class="comment">     * DELETE FROM x WHERE id IN (SELECT ...). We have to use a non-standard</span>
<a name="l979"><span class="linenum"> 979</span></a>  <span class="comment">     * syntax to get good performance. See MDL-29520.</span>
<a name="l980"><span class="linenum"> 980</span></a>  <span class="comment">     * @param qubaid_condition $qubaids identifies which question useages to delete.</span>
<a name="l981"><span class="linenum"> 981</span></a>  <span class="comment">     */</span>
<a name="l982"><span class="linenum"> 982</span></a>      protected function <a class="function" onClick="logFunction('delete_usage_records_for_mysql')" href="../../_functions/delete_usage_records_for_mysql.html" onMouseOver="funcPopup(event,'delete_usage_records_for_mysql')">delete_usage_records_for_mysql</a>(qubaid_condition <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>) {
<a name="l983"><span class="linenum"> 983</span></a>  <span class="comment">        // Get the list of question attempts to delete and delete them in chunks.</span>
<a name="l984"><span class="linenum"> 984</span></a>          <a class="var it9223" onMouseOver="hilite(9223)" onMouseOut="lolite()" onClick="logVariable('allids')" href="../../_variables/allids.html">$allids</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_records_sql_menu')" href="../../_functions/get_records_sql_menu.html" onMouseOver="funcPopup(event,'get_records_sql_menu')">get_records_sql_menu</a>(&quot;
<a name="l985"><span class="linenum"> 985</span></a>                  SELECT DISTINCT id, id AS id2
<a name="l986"><span class="linenum"> 986</span></a>                    FROM {question_usages}
<a name="l987"><span class="linenum"> 987</span></a>                   WHERE id &quot; . <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('usage_id_in')" href="../../_functions/usage_id_in.html" onMouseOver="funcPopup(event,'usage_id_in')">usage_id_in</a>(),
<a name="l988"><span class="linenum"> 988</span></a>                  <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('usage_id_in_params')" href="../../_functions/usage_id_in_params.html" onMouseOver="funcPopup(event,'usage_id_in_params')">usage_id_in_params</a>());
<a name="l989"><span class="linenum"> 989</span></a>  
<a name="l990"><span class="linenum"> 990</span></a>          foreach (<a class="phpfunction" onClick="logFunction('array_chunk')" href="../../_functions/array_chunk.html" onMouseOver="phpfuncPopup(event,'array_chunk')">array_chunk</a>(<a class="var it9223" onMouseOver="hilite(9223)" onMouseOut="lolite()" onClick="logVariable('allids')" href="../../_variables/allids.html">$allids</a>, 1000) as <a class="var it9224" onMouseOver="hilite(9224)" onMouseOut="lolite()" onClick="logVariable('todelete')" href="../../_variables/todelete.html">$todelete</a>) {
<a name="l991"><span class="linenum"> 991</span></a>              <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it9225" onMouseOver="hilite(9225)" onMouseOut="lolite()" onClick="logVariable('idsql')" href="../../_variables/idsql.html">$idsql</a>, <a class="var it9226" onMouseOver="hilite(9226)" onMouseOut="lolite()" onClick="logVariable('idparams')" href="../../_variables/idparams.html">$idparams</a>) = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it9224" onMouseOver="hilite(9224)" onMouseOut="lolite()" onClick="logVariable('todelete')" href="../../_variables/todelete.html">$todelete</a>);
<a name="l992"><span class="linenum"> 992</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>('
<a name="l993"><span class="linenum"> 993</span></a>                      DELETE qu, qa, qas, qasd
<a name="l994"><span class="linenum"> 994</span></a>                        FROM {question_usages}            qu
<a name="l995"><span class="linenum"> 995</span></a>                        JOIN {question_attempts}          qa   ON qa.questionusageid = qu.id
<a name="l996"><span class="linenum"> 996</span></a>                   LEFT JOIN {question_attempt_steps}     qas  ON qas.questionattemptid = qa.id
<a name="l997"><span class="linenum"> 997</span></a>                   LEFT JOIN {question_attempt_step_data} qasd ON qasd.attemptstepid = qas.id
<a name="l998"><span class="linenum"> 998</span></a>                       WHERE qu.id ' . <a class="var it9225" onMouseOver="hilite(9225)" onMouseOut="lolite()" onClick="logVariable('idsql')" href="../../_variables/idsql.html">$idsql</a>,
<a name="l999"><span class="linenum"> 999</span></a>                      <a class="var it9226" onMouseOver="hilite(9226)" onMouseOut="lolite()" onClick="logVariable('idparams')" href="../../_variables/idparams.html">$idparams</a>);
<a name="l1000"><span class="linenum">1000</span></a>          }
<a name="l1001"><span class="linenum">1001</span></a>      }
<a name="l1002"><span class="linenum">1002</span></a>  
<a name="l1003"><span class="linenum">1003</span></a>      <span class="comment">/**</span>
<a name="l1004"><span class="linenum">1004</span></a>  <span class="comment">     * Delete all the steps for a question attempt.</span>
<a name="l1005"><span class="linenum">1005</span></a>  <span class="comment">     *</span>
<a name="l1006"><span class="linenum">1006</span></a>  <span class="comment">     * Private method, only for use by other parts of the question engine.</span>
<a name="l1007"><span class="linenum">1007</span></a>  <span class="comment">     *</span>
<a name="l1008"><span class="linenum">1008</span></a>  <span class="comment">     * @param int $qaids question_attempt id.</span>
<a name="l1009"><span class="linenum">1009</span></a>  <span class="comment">     * @param context $context the context that the $quba belongs to.</span>
<a name="l1010"><span class="linenum">1010</span></a>  <span class="comment">     */</span>
<a name="l1011"><span class="linenum">1011</span></a>      public function <a class="function" onClick="logFunction('delete_steps')" href="../../_functions/delete_steps.html" onMouseOver="funcPopup(event,'delete_steps')">delete_steps</a>(<a class="var it9227" onMouseOver="hilite(9227)" onMouseOut="lolite()" onClick="logVariable('stepids')" href="../../_variables/stepids.html">$stepids</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>) {
<a name="l1012"><span class="linenum">1012</span></a>          if (empty(<a class="var it9227" onMouseOver="hilite(9227)" onMouseOut="lolite()" onClick="logVariable('stepids')" href="../../_variables/stepids.html">$stepids</a>)) {
<a name="l1013"><span class="linenum">1013</span></a>              return;
<a name="l1014"><span class="linenum">1014</span></a>          }
<a name="l1015"><span class="linenum">1015</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it3797" onMouseOver="hilite(3797)" onMouseOut="lolite()" onClick="logVariable('test')" href="../../_variables/test.html">$test</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it9227" onMouseOver="hilite(9227)" onMouseOut="lolite()" onClick="logVariable('stepids')" href="../../_variables/stepids.html">$stepids</a>, <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>);
<a name="l1016"><span class="linenum">1016</span></a>  
<a name="l1017"><span class="linenum">1017</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('delete_response_files')" href="../../_functions/delete_response_files.html" onMouseOver="funcPopup(event,'delete_response_files')">delete_response_files</a>(<a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, <a class="var it3797" onMouseOver="hilite(3797)" onMouseOut="lolite()" onClick="logVariable('test')" href="../../_variables/test.html">$test</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l1018"><span class="linenum">1018</span></a>  
<a name="l1019"><span class="linenum">1019</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('delete_records_select')" href="../../_functions/delete_records_select.html" onMouseOver="funcPopup(event,'delete_records_select')">delete_records_select</a>('question_attempt_step_data',
<a name="l1020"><span class="linenum">1020</span></a>                  &quot;attemptstepid {<a class="var it3797" onMouseOver="hilite(3797)" onMouseOut="lolite()" onClick="logVariable('test')" href="../../_variables/test.html">$test</a>}&quot;, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l1021"><span class="linenum">1021</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('delete_records_select')" href="../../_functions/delete_records_select.html" onMouseOver="funcPopup(event,'delete_records_select')">delete_records_select</a>('question_attempt_steps',
<a name="l1022"><span class="linenum">1022</span></a>                  &quot;id {<a class="var it3797" onMouseOver="hilite(3797)" onMouseOut="lolite()" onClick="logVariable('test')" href="../../_variables/test.html">$test</a>}&quot;, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l1023"><span class="linenum">1023</span></a>      }
<a name="l1024"><span class="linenum">1024</span></a>  
<a name="l1025"><span class="linenum">1025</span></a>      <span class="comment">/**</span>
<a name="l1026"><span class="linenum">1026</span></a>  <span class="comment">     * Delete all the files belonging to the response variables in the gives</span>
<a name="l1027"><span class="linenum">1027</span></a>  <span class="comment">     * question attempt steps.</span>
<a name="l1028"><span class="linenum">1028</span></a>  <span class="comment">     * @param int $contextid the context these attempts belong to.</span>
<a name="l1029"><span class="linenum">1029</span></a>  <span class="comment">     * @param string $itemidstest a bit of SQL that can be used in a</span>
<a name="l1030"><span class="linenum">1030</span></a>  <span class="comment">     *      WHERE itemid $itemidstest clause. Must use named params.</span>
<a name="l1031"><span class="linenum">1031</span></a>  <span class="comment">     * @param array $params any query parameters used in $itemidstest.</span>
<a name="l1032"><span class="linenum">1032</span></a>  <span class="comment">     */</span>
<a name="l1033"><span class="linenum">1033</span></a>      protected function <a class="function" onClick="logFunction('delete_response_files')" href="../../_functions/delete_response_files.html" onMouseOver="funcPopup(event,'delete_response_files')">delete_response_files</a>(<a class="var it782" onMouseOver="hilite(782)" onMouseOut="lolite()" onClick="logVariable('contextid')" href="../../_variables/contextid.html">$contextid</a>, <a class="var it9228" onMouseOver="hilite(9228)" onMouseOut="lolite()" onClick="logVariable('itemidstest')" href="../../_variables/itemidstest.html">$itemidstest</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) {
<a name="l1034"><span class="linenum">1034</span></a>          <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a> = <a class="function" onClick="logFunction('get_file_storage')" href="../../_functions/get_file_storage.html" onMouseOver="funcPopup(event,'get_file_storage')">get_file_storage</a>();
<a name="l1035"><span class="linenum">1035</span></a>          foreach (question_engine::<a class="function" onClick="logFunction('get_all_response_file_areas')" href="../../_functions/get_all_response_file_areas.html" onMouseOver="funcPopup(event,'get_all_response_file_areas')">get_all_response_file_areas</a>() as <a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('filearea')" href="../../_variables/filearea.html">$filearea</a>) {
<a name="l1036"><span class="linenum">1036</span></a>              <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('delete_area_files_select')" href="../../_functions/delete_area_files_select.html" onMouseOver="funcPopup(event,'delete_area_files_select')">delete_area_files_select</a>(<a class="var it782" onMouseOver="hilite(782)" onMouseOut="lolite()" onClick="logVariable('contextid')" href="../../_variables/contextid.html">$contextid</a>, 'question', <a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('filearea')" href="../../_variables/filearea.html">$filearea</a>,
<a name="l1037"><span class="linenum">1037</span></a>                      <a class="var it9228" onMouseOver="hilite(9228)" onMouseOut="lolite()" onClick="logVariable('itemidstest')" href="../../_variables/itemidstest.html">$itemidstest</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>);
<a name="l1038"><span class="linenum">1038</span></a>          }
<a name="l1039"><span class="linenum">1039</span></a>      }
<a name="l1040"><span class="linenum">1040</span></a>  
<a name="l1041"><span class="linenum">1041</span></a>      <span class="comment">/**</span>
<a name="l1042"><span class="linenum">1042</span></a>  <span class="comment">     * Delete all the previews for a given question.</span>
<a name="l1043"><span class="linenum">1043</span></a>  <span class="comment">     *</span>
<a name="l1044"><span class="linenum">1044</span></a>  <span class="comment">     * Private method, only for use by other parts of the question engine.</span>
<a name="l1045"><span class="linenum">1045</span></a>  <span class="comment">     *</span>
<a name="l1046"><span class="linenum">1046</span></a>  <span class="comment">     * @param int $questionid question id.</span>
<a name="l1047"><span class="linenum">1047</span></a>  <span class="comment">     */</span>
<a name="l1048"><span class="linenum">1048</span></a>      public function <a class="function" onClick="logFunction('delete_previews')" href="../../_functions/delete_previews.html" onMouseOver="funcPopup(event,'delete_previews')">delete_previews</a>(<a class="var it530" onMouseOver="hilite(530)" onMouseOut="lolite()" onClick="logVariable('questionid')" href="../../_variables/questionid.html">$questionid</a>) {
<a name="l1049"><span class="linenum">1049</span></a>          <a class="var it9229" onMouseOver="hilite(9229)" onMouseOut="lolite()" onClick="logVariable('previews')" href="../../_variables/previews.html">$previews</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_records_sql_menu')" href="../../_functions/get_records_sql_menu.html" onMouseOver="funcPopup(event,'get_records_sql_menu')">get_records_sql_menu</a>(&quot;
<a name="l1050"><span class="linenum">1050</span></a>                  SELECT DISTINCT quba.id, 1
<a name="l1051"><span class="linenum">1051</span></a>                  FROM {question_usages} quba
<a name="l1052"><span class="linenum">1052</span></a>                  JOIN {question_attempts} qa ON qa.questionusageid = quba.id
<a name="l1053"><span class="linenum">1053</span></a>                  WHERE quba.component = 'core_question_preview' AND
<a name="l1054"><span class="linenum">1054</span></a>                      qa.questionid = ?&quot;, array(<a class="var it530" onMouseOver="hilite(530)" onMouseOut="lolite()" onClick="logVariable('questionid')" href="../../_variables/questionid.html">$questionid</a>));
<a name="l1055"><span class="linenum">1055</span></a>          if (empty(<a class="var it9229" onMouseOver="hilite(9229)" onMouseOut="lolite()" onClick="logVariable('previews')" href="../../_variables/previews.html">$previews</a>)) {
<a name="l1056"><span class="linenum">1056</span></a>              return;
<a name="l1057"><span class="linenum">1057</span></a>          }
<a name="l1058"><span class="linenum">1058</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('delete_questions_usage_by_activities')" href="../../_functions/delete_questions_usage_by_activities.html" onMouseOver="funcPopup(event,'delete_questions_usage_by_activities')">delete_questions_usage_by_activities</a>(<span class="keyword">new </span><a class="class" onClick="logClass('qubaid_list')" href="../../_classes/qubaid_list.html" onMouseOver="classPopup(event,'qubaid_list')">qubaid_list</a>(<a class="var it9229" onMouseOver="hilite(9229)" onMouseOut="lolite()" onClick="logVariable('previews')" href="../../_variables/previews.html">$previews</a>));
<a name="l1059"><span class="linenum">1059</span></a>      }
<a name="l1060"><span class="linenum">1060</span></a>  
<a name="l1061"><span class="linenum">1061</span></a>      <span class="comment">/**</span>
<a name="l1062"><span class="linenum">1062</span></a>  <span class="comment">     * Update the flagged state of a question in the database.</span>
<a name="l1063"><span class="linenum">1063</span></a>  <span class="comment">     *</span>
<a name="l1064"><span class="linenum">1064</span></a>  <span class="comment">     * You should call {@link question_engine::update_flag()()}</span>
<a name="l1065"><span class="linenum">1065</span></a>  <span class="comment">     * rather than calling this method directly.</span>
<a name="l1066"><span class="linenum">1066</span></a>  <span class="comment">     *</span>
<a name="l1067"><span class="linenum">1067</span></a>  <span class="comment">     * @param int $qubaid the question usage id.</span>
<a name="l1068"><span class="linenum">1068</span></a>  <span class="comment">     * @param int $questionid the question id.</span>
<a name="l1069"><span class="linenum">1069</span></a>  <span class="comment">     * @param int $sessionid the question_attempt id.</span>
<a name="l1070"><span class="linenum">1070</span></a>  <span class="comment">     * @param bool $newstate the new state of the flag. true = flagged.</span>
<a name="l1071"><span class="linenum">1071</span></a>  <span class="comment">     */</span>
<a name="l1072"><span class="linenum">1072</span></a>      public function <a class="function" onClick="logFunction('update_question_attempt_flag')" href="../../_functions/update_question_attempt_flag.html" onMouseOver="funcPopup(event,'update_question_attempt_flag')">update_question_attempt_flag</a>(<a class="var it9207" onMouseOver="hilite(9207)" onMouseOut="lolite()" onClick="logVariable('qubaid')" href="../../_variables/qubaid.html">$qubaid</a>, <a class="var it530" onMouseOver="hilite(530)" onMouseOut="lolite()" onClick="logVariable('questionid')" href="../../_variables/questionid.html">$questionid</a>, <a class="var it9230" onMouseOver="hilite(9230)" onMouseOut="lolite()" onClick="logVariable('qaid')" href="../../_variables/qaid.html">$qaid</a>, <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>, <a class="var it1337" onMouseOver="hilite(1337)" onMouseOut="lolite()" onClick="logVariable('newstate')" href="../../_variables/newstate.html">$newstate</a>) {
<a name="l1073"><span class="linenum">1073</span></a>          if (!<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('record_exists')" href="../../_functions/record_exists.html" onMouseOver="funcPopup(event,'record_exists')">record_exists</a>('question_attempts', array('id' =&gt; <a class="var it9230" onMouseOver="hilite(9230)" onMouseOut="lolite()" onClick="logVariable('qaid')" href="../../_variables/qaid.html">$qaid</a>,
<a name="l1074"><span class="linenum">1074</span></a>                  'questionusageid' =&gt; <a class="var it9207" onMouseOver="hilite(9207)" onMouseOut="lolite()" onClick="logVariable('qubaid')" href="../../_variables/qubaid.html">$qubaid</a>, 'questionid' =&gt; <a class="var it530" onMouseOver="hilite(530)" onMouseOut="lolite()" onClick="logVariable('questionid')" href="../../_variables/questionid.html">$questionid</a>, 'slot' =&gt; <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>))) {
<a name="l1075"><span class="linenum">1075</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('moodle_exception')" href="../../_classes/moodle_exception.html" onMouseOver="classPopup(event,'moodle_exception')">moodle_exception</a>('errorsavingflags', 'question');
<a name="l1076"><span class="linenum">1076</span></a>          }
<a name="l1077"><span class="linenum">1077</span></a>  
<a name="l1078"><span class="linenum">1078</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('question_attempts', 'flagged', <a class="var it1337" onMouseOver="hilite(1337)" onMouseOut="lolite()" onClick="logVariable('newstate')" href="../../_variables/newstate.html">$newstate</a>, array('id' =&gt; <a class="var it9230" onMouseOver="hilite(9230)" onMouseOut="lolite()" onClick="logVariable('qaid')" href="../../_variables/qaid.html">$qaid</a>));
<a name="l1079"><span class="linenum">1079</span></a>      }
<a name="l1080"><span class="linenum">1080</span></a>  
<a name="l1081"><span class="linenum">1081</span></a>      <span class="comment">/**</span>
<a name="l1082"><span class="linenum">1082</span></a>  <span class="comment">     * Get all the WHEN 'x' THEN 'y' terms needed to convert the question_attempt_steps.state</span>
<a name="l1083"><span class="linenum">1083</span></a>  <span class="comment">     * column to a summary state. Use this like</span>
<a name="l1084"><span class="linenum">1084</span></a>  <span class="comment">     * CASE qas.state {$this-&gt;full_states_to_summary_state_sql()} END AS summarystate,</span>
<a name="l1085"><span class="linenum">1085</span></a>  <span class="comment">     * @param string SQL fragment.</span>
<a name="l1086"><span class="linenum">1086</span></a>  <span class="comment">     */</span>
<a name="l1087"><span class="linenum">1087</span></a>      protected function <a class="function" onClick="logFunction('full_states_to_summary_state_sql')" href="../../_functions/full_states_to_summary_state_sql.html" onMouseOver="funcPopup(event,'full_states_to_summary_state_sql')">full_states_to_summary_state_sql</a>() {
<a name="l1088"><span class="linenum">1088</span></a>          <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> = '';
<a name="l1089"><span class="linenum">1089</span></a>          foreach (question_state::<a class="function" onClick="logFunction('get_all')" href="../../_functions/get_all.html" onMouseOver="funcPopup(event,'get_all')">get_all</a>() as <a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>) {
<a name="l1090"><span class="linenum">1090</span></a>              <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a> .= &quot;WHEN '{<a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>}' THEN '{<a class="var it650" onMouseOver="hilite(650)" onMouseOut="lolite()" onClick="logVariable('state')" href="../../_variables/state.html">$state</a>-&gt;<a class="function" onClick="logFunction('get_summary_state')" href="../../_functions/get_summary_state.html" onMouseOver="funcPopup(event,'get_summary_state')">get_summary_state</a>()}'\n&quot;;
<a name="l1091"><span class="linenum">1091</span></a>          }
<a name="l1092"><span class="linenum">1092</span></a>          return <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../_variables/sql.html">$sql</a>;
<a name="l1093"><span class="linenum">1093</span></a>      }
<a name="l1094"><span class="linenum">1094</span></a>  
<a name="l1095"><span class="linenum">1095</span></a>      <span class="comment">/**</span>
<a name="l1096"><span class="linenum">1096</span></a>  <span class="comment">     * Get the SQL needed to test that question_attempt_steps.state is in a</span>
<a name="l1097"><span class="linenum">1097</span></a>  <span class="comment">     * state corresponding to $summarystate.</span>
<a name="l1098"><span class="linenum">1098</span></a>  <span class="comment">     *</span>
<a name="l1099"><span class="linenum">1099</span></a>  <span class="comment">     * This method may be called publicly.</span>
<a name="l1100"><span class="linenum">1100</span></a>  <span class="comment">     *</span>
<a name="l1101"><span class="linenum">1101</span></a>  <span class="comment">     * @param string $summarystate one of</span>
<a name="l1102"><span class="linenum">1102</span></a>  <span class="comment">     * inprogress, needsgrading, manuallygraded or autograded</span>
<a name="l1103"><span class="linenum">1103</span></a>  <span class="comment">     * @param bool $equal if false, do a NOT IN test. Default true.</span>
<a name="l1104"><span class="linenum">1104</span></a>  <span class="comment">     * @return string SQL fragment.</span>
<a name="l1105"><span class="linenum">1105</span></a>  <span class="comment">     */</span>
<a name="l1106"><span class="linenum">1106</span></a>      public function <a class="function" onClick="logFunction('in_summary_state_test')" href="../../_functions/in_summary_state_test.html" onMouseOver="funcPopup(event,'in_summary_state_test')">in_summary_state_test</a>(<a class="var it9213" onMouseOver="hilite(9213)" onMouseOut="lolite()" onClick="logVariable('summarystate')" href="../../_variables/summarystate.html">$summarystate</a>, <a class="var it4669" onMouseOver="hilite(4669)" onMouseOut="lolite()" onClick="logVariable('equal')" href="../../_variables/equal.html">$equal</a> = true, <a class="var it416" onMouseOver="hilite(416)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../_variables/prefix.html">$prefix</a> = 'summarystates') {
<a name="l1107"><span class="linenum">1107</span></a>          <a class="var it1335" onMouseOver="hilite(1335)" onMouseOut="lolite()" onClick="logVariable('states')" href="../../_variables/states.html">$states</a> = question_state::<a class="function" onClick="logFunction('get_all_for_summary_state')" href="../../_functions/get_all_for_summary_state.html" onMouseOver="funcPopup(event,'get_all_for_summary_state')">get_all_for_summary_state</a>(<a class="var it9213" onMouseOver="hilite(9213)" onMouseOut="lolite()" onClick="logVariable('summarystate')" href="../../_variables/summarystate.html">$summarystate</a>);
<a name="l1108"><span class="linenum">1108</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="phpfunction" onClick="logFunction('array_map')" href="../../_functions/array_map.html" onMouseOver="phpfuncPopup(event,'array_map')">array_map</a>('strval', <a class="var it1335" onMouseOver="hilite(1335)" onMouseOut="lolite()" onClick="logVariable('states')" href="../../_variables/states.html">$states</a>),
<a name="l1109"><span class="linenum">1109</span></a>                  <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, <a class="var it416" onMouseOver="hilite(416)" onMouseOut="lolite()" onClick="logVariable('prefix')" href="../../_variables/prefix.html">$prefix</a>, <a class="var it4669" onMouseOver="hilite(4669)" onMouseOut="lolite()" onClick="logVariable('equal')" href="../../_variables/equal.html">$equal</a>);
<a name="l1110"><span class="linenum">1110</span></a>      }
<a name="l1111"><span class="linenum">1111</span></a>  
<a name="l1112"><span class="linenum">1112</span></a>      <span class="comment">/**</span>
<a name="l1113"><span class="linenum">1113</span></a>  <span class="comment">     * Change the maxmark for the question_attempt with number in usage $slot</span>
<a name="l1114"><span class="linenum">1114</span></a>  <span class="comment">     * for all the specified question_attempts.</span>
<a name="l1115"><span class="linenum">1115</span></a>  <span class="comment">     *</span>
<a name="l1116"><span class="linenum">1116</span></a>  <span class="comment">     * You should call {@link question_engine::set_max_mark_in_attempts()}</span>
<a name="l1117"><span class="linenum">1117</span></a>  <span class="comment">     * rather than calling this method directly.</span>
<a name="l1118"><span class="linenum">1118</span></a>  <span class="comment">     *</span>
<a name="l1119"><span class="linenum">1119</span></a>  <span class="comment">     * @param qubaid_condition $qubaids Selects which usages are updated.</span>
<a name="l1120"><span class="linenum">1120</span></a>  <span class="comment">     * @param int $slot the number is usage to affect.</span>
<a name="l1121"><span class="linenum">1121</span></a>  <span class="comment">     * @param number $newmaxmark the new max mark to set.</span>
<a name="l1122"><span class="linenum">1122</span></a>  <span class="comment">     */</span>
<a name="l1123"><span class="linenum">1123</span></a>      public function <a class="function" onClick="logFunction('set_max_mark_in_attempts')" href="../../_functions/set_max_mark_in_attempts.html" onMouseOver="funcPopup(event,'set_max_mark_in_attempts')">set_max_mark_in_attempts</a>(qubaid_condition <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>, <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>, <a class="var it9231" onMouseOver="hilite(9231)" onMouseOut="lolite()" onClick="logVariable('newmaxmark')" href="../../_variables/newmaxmark.html">$newmaxmark</a>) {
<a name="l1124"><span class="linenum">1124</span></a>          if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_dbfamily')" href="../../_functions/get_dbfamily.html" onMouseOver="funcPopup(event,'get_dbfamily')">get_dbfamily</a>() == 'mysql') {
<a name="l1125"><span class="linenum">1125</span></a>  <span class="comment">            // MySQL's query optimiser completely fails to cope with the</span>
<a name="l1126"><span class="linenum">1126</span></a>  <span class="comment">            // set_field_select call below, so we have to give it a clue. See MDL-32616.</span>
<a name="l1127"><span class="linenum">1127</span></a>  <span class="comment">            // TODO MDL-29589 encapsulate this MySQL-specific code with a $DB method.</span>
<a name="l1128"><span class="linenum">1128</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('execute')" href="../../_functions/execute.html" onMouseOver="funcPopup(event,'execute')">execute</a>(&quot;
<a name="l1129"><span class="linenum">1129</span></a>                      UPDATE &quot; . <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('from_question_attempts')" href="../../_functions/from_question_attempts.html" onMouseOver="funcPopup(event,'from_question_attempts')">from_question_attempts</a>('qa') . &quot;
<a name="l1130"><span class="linenum">1130</span></a>                         SET qa.maxmark = :newmaxmark
<a name="l1131"><span class="linenum">1131</span></a>                       WHERE &quot; . <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('where')" href="../../_functions/where.html" onMouseOver="funcPopup(event,'where')">where</a>() . &quot;
<a name="l1132"><span class="linenum">1132</span></a>                         AND slot = :slot
<a name="l1133"><span class="linenum">1133</span></a>                      &quot;, <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('from_where_params')" href="../../_functions/from_where_params.html" onMouseOver="funcPopup(event,'from_where_params')">from_where_params</a>() + array('newmaxmark' =&gt; <a class="var it9231" onMouseOver="hilite(9231)" onMouseOut="lolite()" onClick="logVariable('newmaxmark')" href="../../_variables/newmaxmark.html">$newmaxmark</a>, 'slot' =&gt; <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>));
<a name="l1134"><span class="linenum">1134</span></a>              return;
<a name="l1135"><span class="linenum">1135</span></a>          }
<a name="l1136"><span class="linenum">1136</span></a>  
<a name="l1137"><span class="linenum">1137</span></a>  <span class="comment">        // Normal databases.</span>
<a name="l1138"><span class="linenum">1138</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('set_field_select')" href="../../_functions/set_field_select.html" onMouseOver="funcPopup(event,'set_field_select')">set_field_select</a>('question_attempts', 'maxmark', <a class="var it9231" onMouseOver="hilite(9231)" onMouseOut="lolite()" onClick="logVariable('newmaxmark')" href="../../_variables/newmaxmark.html">$newmaxmark</a>,
<a name="l1139"><span class="linenum">1139</span></a>                  &quot;questionusageid {<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('usage_id_in')" href="../../_functions/usage_id_in.html" onMouseOver="funcPopup(event,'usage_id_in')">usage_id_in</a>()} AND slot = :slot&quot;,
<a name="l1140"><span class="linenum">1140</span></a>                  <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('usage_id_in_params')" href="../../_functions/usage_id_in_params.html" onMouseOver="funcPopup(event,'usage_id_in_params')">usage_id_in_params</a>() + array('slot' =&gt; <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>));
<a name="l1141"><span class="linenum">1141</span></a>      }
<a name="l1142"><span class="linenum">1142</span></a>  
<a name="l1143"><span class="linenum">1143</span></a>      <span class="comment">/**</span>
<a name="l1144"><span class="linenum">1144</span></a>  <span class="comment">     * Return a subquery that computes the sum of the marks for all the questions</span>
<a name="l1145"><span class="linenum">1145</span></a>  <span class="comment">     * in a usage. Which useage to compute the sum for is controlled bu the $qubaid</span>
<a name="l1146"><span class="linenum">1146</span></a>  <span class="comment">     * parameter.</span>
<a name="l1147"><span class="linenum">1147</span></a>  <span class="comment">     *</span>
<a name="l1148"><span class="linenum">1148</span></a>  <span class="comment">     * See {@link quiz_update_all_attempt_sumgrades()} for an example of the usage of</span>
<a name="l1149"><span class="linenum">1149</span></a>  <span class="comment">     * this method.</span>
<a name="l1150"><span class="linenum">1150</span></a>  <span class="comment">     *</span>
<a name="l1151"><span class="linenum">1151</span></a>  <span class="comment">     * This method may be called publicly.</span>
<a name="l1152"><span class="linenum">1152</span></a>  <span class="comment">     *</span>
<a name="l1153"><span class="linenum">1153</span></a>  <span class="comment">     * @param string $qubaid SQL fragment that controls which usage is summed.</span>
<a name="l1154"><span class="linenum">1154</span></a>  <span class="comment">     * This will normally be the name of a column in the outer query. Not that this</span>
<a name="l1155"><span class="linenum">1155</span></a>  <span class="comment">     * SQL fragment must not contain any placeholders.</span>
<a name="l1156"><span class="linenum">1156</span></a>  <span class="comment">     * @return string SQL code for the subquery.</span>
<a name="l1157"><span class="linenum">1157</span></a>  <span class="comment">     */</span>
<a name="l1158"><span class="linenum">1158</span></a>      public function <a class="function" onClick="logFunction('sum_usage_marks_subquery')" href="../../_functions/sum_usage_marks_subquery.html" onMouseOver="funcPopup(event,'sum_usage_marks_subquery')">sum_usage_marks_subquery</a>(<a class="var it9207" onMouseOver="hilite(9207)" onMouseOut="lolite()" onClick="logVariable('qubaid')" href="../../_variables/qubaid.html">$qubaid</a>) {
<a name="l1159"><span class="linenum">1159</span></a>  <span class="comment">        // To explain the COALESCE in the following SQL: SUM(lots of NULLs) gives</span>
<a name="l1160"><span class="linenum">1160</span></a>  <span class="comment">        // NULL, while SUM(one 0.0 and lots of NULLS) gives 0.0. We don't want that.</span>
<a name="l1161"><span class="linenum">1161</span></a>  <span class="comment">        // We always want to return a number, so the COALESCE is there to turn the</span>
<a name="l1162"><span class="linenum">1162</span></a>  <span class="comment">        // NULL total into a 0.</span>
<a name="l1163"><span class="linenum">1163</span></a>          return &quot;SELECT COALESCE(<a class="function" onClick="logFunction('SUM')" href="../../_functions/sum.html" onMouseOver="funcPopup(event,'sum')">SUM</a>(qa.maxmark * qas.fraction), 0)
<a name="l1164"><span class="linenum">1164</span></a>              FROM {question_attempts} qa
<a name="l1165"><span class="linenum">1165</span></a>              JOIN {question_attempt_steps} qas ON qas.questionattemptid = qa.id
<a name="l1166"><span class="linenum">1166</span></a>                      AND qas.sequencenumber = (
<a name="l1167"><span class="linenum">1167</span></a>                              SELECT <a class="phpfunction" onClick="logFunction('MAX')" href="../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">MAX</a>(summarks_qas.sequencenumber)
<a name="l1168"><span class="linenum">1168</span></a>                                FROM {question_attempt_steps} summarks_qas
<a name="l1169"><span class="linenum">1169</span></a>                               WHERE summarks_qas.questionattemptid = qa.id
<a name="l1170"><span class="linenum">1170</span></a>              )
<a name="l1171"><span class="linenum">1171</span></a>              WHERE qa.questionusageid = <a class="var it9207" onMouseOver="hilite(9207)" onMouseOut="lolite()" onClick="logVariable('qubaid')" href="../../_variables/qubaid.html">$qubaid</a>
<a name="l1172"><span class="linenum">1172</span></a>              HAVING <a class="phpfunction" onClick="logFunction('COUNT')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">COUNT</a>(CASE
<a name="l1173"><span class="linenum">1173</span></a>                  WHEN qas.state = 'needsgrading' AND qa.maxmark &gt; 0 THEN 1
<a name="l1174"><span class="linenum">1174</span></a>                  ELSE NULL
<a name="l1175"><span class="linenum">1175</span></a>              END) = 0&quot;;
<a name="l1176"><span class="linenum">1176</span></a>      }
<a name="l1177"><span class="linenum">1177</span></a>  
<a name="l1178"><span class="linenum">1178</span></a>      <span class="comment">/**</span>
<a name="l1179"><span class="linenum">1179</span></a>  <span class="comment">     * Get a subquery that returns the latest step of every qa in some qubas.</span>
<a name="l1180"><span class="linenum">1180</span></a>  <span class="comment">     * Currently, this is only used by the quiz reports. See</span>
<a name="l1181"><span class="linenum">1181</span></a>  <span class="comment">     * {@link quiz_attempts_report_table::add_latest_state_join()}.</span>
<a name="l1182"><span class="linenum">1182</span></a>  <span class="comment">     *</span>
<a name="l1183"><span class="linenum">1183</span></a>  <span class="comment">     * This method may be called publicly.</span>
<a name="l1184"><span class="linenum">1184</span></a>  <span class="comment">     *</span>
<a name="l1185"><span class="linenum">1185</span></a>  <span class="comment">     * @param string $alias alias to use for this inline-view.</span>
<a name="l1186"><span class="linenum">1186</span></a>  <span class="comment">     * @param qubaid_condition $qubaids restriction on which question_usages we</span>
<a name="l1187"><span class="linenum">1187</span></a>  <span class="comment">     *      are interested in. This is important for performance.</span>
<a name="l1188"><span class="linenum">1188</span></a>  <span class="comment">     * @return array with two elements, the SQL fragment and any params requried.</span>
<a name="l1189"><span class="linenum">1189</span></a>  <span class="comment">     */</span>
<a name="l1190"><span class="linenum">1190</span></a>      public function <a class="function" onClick="logFunction('question_attempt_latest_state_view')" href="../../_functions/question_attempt_latest_state_view.html" onMouseOver="funcPopup(event,'question_attempt_latest_state_view')">question_attempt_latest_state_view</a>(<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>, qubaid_condition <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>) {
<a name="l1191"><span class="linenum">1191</span></a>          return array(&quot;(
<a name="l1192"><span class="linenum">1192</span></a>                  SELECT {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qa.id AS questionattemptid,
<a name="l1193"><span class="linenum">1193</span></a>                         {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qa.questionusageid,
<a name="l1194"><span class="linenum">1194</span></a>                         {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qa.slot,
<a name="l1195"><span class="linenum">1195</span></a>                         {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qa.behaviour,
<a name="l1196"><span class="linenum">1196</span></a>                         {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qa.questionid,
<a name="l1197"><span class="linenum">1197</span></a>                         {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qa.variant,
<a name="l1198"><span class="linenum">1198</span></a>                         {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qa.maxmark,
<a name="l1199"><span class="linenum">1199</span></a>                         {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qa.minfraction,
<a name="l1200"><span class="linenum">1200</span></a>                         {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qa.maxfraction,
<a name="l1201"><span class="linenum">1201</span></a>                         {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qa.flagged,
<a name="l1202"><span class="linenum">1202</span></a>                         {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qa.questionsummary,
<a name="l1203"><span class="linenum">1203</span></a>                         {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qa.rightanswer,
<a name="l1204"><span class="linenum">1204</span></a>                         {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qa.responsesummary,
<a name="l1205"><span class="linenum">1205</span></a>                         {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qa.timemodified,
<a name="l1206"><span class="linenum">1206</span></a>                         {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qas.id AS attemptstepid,
<a name="l1207"><span class="linenum">1207</span></a>                         {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qas.sequencenumber,
<a name="l1208"><span class="linenum">1208</span></a>                         {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qas.state,
<a name="l1209"><span class="linenum">1209</span></a>                         {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qas.fraction,
<a name="l1210"><span class="linenum">1210</span></a>                         {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qas.timecreated,
<a name="l1211"><span class="linenum">1211</span></a>                         {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qas.userid
<a name="l1212"><span class="linenum">1212</span></a>  
<a name="l1213"><span class="linenum">1213</span></a>                    FROM {<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('from_question_attempts')" href="../../_functions/from_question_attempts.html" onMouseOver="funcPopup(event,'from_question_attempts')">from_question_attempts</a>(<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a> . 'qa')}
<a name="l1214"><span class="linenum">1214</span></a>                    JOIN {question_attempt_steps} {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qas ON {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qas.questionattemptid = {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qa.id
<a name="l1215"><span class="linenum">1215</span></a>                              AND {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}qas.sequencenumber = {<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('latest_step_for_qa_subquery')" href="../../_functions/latest_step_for_qa_subquery.html" onMouseOver="funcPopup(event,'latest_step_for_qa_subquery')">latest_step_for_qa_subquery</a>(<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a> . 'qa.id')}
<a name="l1216"><span class="linenum">1216</span></a>                   WHERE {<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('where')" href="../../_functions/where.html" onMouseOver="funcPopup(event,'where')">where</a>()}
<a name="l1217"><span class="linenum">1217</span></a>              ) {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}&quot;, <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('from_where_params')" href="../../_functions/from_where_params.html" onMouseOver="funcPopup(event,'from_where_params')">from_where_params</a>());
<a name="l1218"><span class="linenum">1218</span></a>      }
<a name="l1219"><span class="linenum">1219</span></a>  
<a name="l1220"><span class="linenum">1220</span></a>      protected function <a class="function" onClick="logFunction('latest_step_for_qa_subquery')" href="../../_functions/latest_step_for_qa_subquery.html" onMouseOver="funcPopup(event,'latest_step_for_qa_subquery')">latest_step_for_qa_subquery</a>(<a class="var it9202" onMouseOver="hilite(9202)" onMouseOut="lolite()" onClick="logVariable('questionattemptid')" href="../../_variables/questionattemptid.html">$questionattemptid</a> = 'qa.id') {
<a name="l1221"><span class="linenum">1221</span></a>          return &quot;(
<a name="l1222"><span class="linenum">1222</span></a>                  SELECT <a class="phpfunction" onClick="logFunction('MAX')" href="../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">MAX</a>(sequencenumber)
<a name="l1223"><span class="linenum">1223</span></a>                  FROM {question_attempt_steps}
<a name="l1224"><span class="linenum">1224</span></a>                  WHERE questionattemptid = <a class="var it9202" onMouseOver="hilite(9202)" onMouseOut="lolite()" onClick="logVariable('questionattemptid')" href="../../_variables/questionattemptid.html">$questionattemptid</a>
<a name="l1225"><span class="linenum">1225</span></a>              )&quot;;
<a name="l1226"><span class="linenum">1226</span></a>      }
<a name="l1227"><span class="linenum">1227</span></a>  
<a name="l1228"><span class="linenum">1228</span></a>      <span class="comment">/**</span>
<a name="l1229"><span class="linenum">1229</span></a>  <span class="comment">     * Are any of these questions are currently in use?</span>
<a name="l1230"><span class="linenum">1230</span></a>  <span class="comment">     *</span>
<a name="l1231"><span class="linenum">1231</span></a>  <span class="comment">     * You should call {@link question_engine::questions_in_use()}</span>
<a name="l1232"><span class="linenum">1232</span></a>  <span class="comment">     * rather than calling this method directly.</span>
<a name="l1233"><span class="linenum">1233</span></a>  <span class="comment">     *</span>
<a name="l1234"><span class="linenum">1234</span></a>  <span class="comment">     * @param array $questionids of question ids.</span>
<a name="l1235"><span class="linenum">1235</span></a>  <span class="comment">     * @param qubaid_condition $qubaids ids of the usages to consider.</span>
<a name="l1236"><span class="linenum">1236</span></a>  <span class="comment">     * @return bool whether any of these questions are being used by any of</span>
<a name="l1237"><span class="linenum">1237</span></a>  <span class="comment">     *      those usages.</span>
<a name="l1238"><span class="linenum">1238</span></a>  <span class="comment">     */</span>
<a name="l1239"><span class="linenum">1239</span></a>      public function <a class="function" onClick="logFunction('questions_in_use')" href="../../_functions/questions_in_use.html" onMouseOver="funcPopup(event,'questions_in_use')">questions_in_use</a>(array <a class="var it5865" onMouseOver="hilite(5865)" onMouseOut="lolite()" onClick="logVariable('questionids')" href="../../_variables/questionids.html">$questionids</a>, qubaid_condition <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>) {
<a name="l1240"><span class="linenum">1240</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it3797" onMouseOver="hilite(3797)" onMouseOut="lolite()" onClick="logVariable('test')" href="../../_variables/test.html">$test</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it5865" onMouseOver="hilite(5865)" onMouseOut="lolite()" onClick="logVariable('questionids')" href="../../_variables/questionids.html">$questionids</a>);
<a name="l1241"><span class="linenum">1241</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('record_exists_select')" href="../../_functions/record_exists_select.html" onMouseOver="funcPopup(event,'record_exists_select')">record_exists_select</a>('question_attempts',
<a name="l1242"><span class="linenum">1242</span></a>                  'questionid ' . <a class="var it3797" onMouseOver="hilite(3797)" onMouseOut="lolite()" onClick="logVariable('test')" href="../../_variables/test.html">$test</a> . ' AND questionusageid ' .
<a name="l1243"><span class="linenum">1243</span></a>                  <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('usage_id_in')" href="../../_functions/usage_id_in.html" onMouseOver="funcPopup(event,'usage_id_in')">usage_id_in</a>(), <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> + <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('usage_id_in_params')" href="../../_functions/usage_id_in_params.html" onMouseOver="funcPopup(event,'usage_id_in_params')">usage_id_in_params</a>());
<a name="l1244"><span class="linenum">1244</span></a>      }
<a name="l1245"><span class="linenum">1245</span></a>  
<a name="l1246"><span class="linenum">1246</span></a>      <span class="comment">/**</span>
<a name="l1247"><span class="linenum">1247</span></a>  <span class="comment">     * Get the number of times each variant has been used for each question in a list</span>
<a name="l1248"><span class="linenum">1248</span></a>  <span class="comment">     * in a set of usages.</span>
<a name="l1249"><span class="linenum">1249</span></a>  <span class="comment">     * @param array $questionids of question ids.</span>
<a name="l1250"><span class="linenum">1250</span></a>  <span class="comment">     * @param qubaid_condition $qubaids ids of the usages to consider.</span>
<a name="l1251"><span class="linenum">1251</span></a>  <span class="comment">     * @return array questionid =&gt; variant number =&gt; num uses.</span>
<a name="l1252"><span class="linenum">1252</span></a>  <span class="comment">     */</span>
<a name="l1253"><span class="linenum">1253</span></a>      public function <a class="function" onClick="logFunction('load_used_variants')" href="../../_functions/load_used_variants.html" onMouseOver="funcPopup(event,'load_used_variants')">load_used_variants</a>(array <a class="var it5865" onMouseOver="hilite(5865)" onMouseOut="lolite()" onClick="logVariable('questionids')" href="../../_variables/questionids.html">$questionids</a>, qubaid_condition <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>) {
<a name="l1254"><span class="linenum">1254</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it3797" onMouseOver="hilite(3797)" onMouseOut="lolite()" onClick="logVariable('test')" href="../../_variables/test.html">$test</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>) = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(<a class="var it5865" onMouseOver="hilite(5865)" onMouseOut="lolite()" onClick="logVariable('questionids')" href="../../_variables/questionids.html">$questionids</a>, <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'qid');
<a name="l1255"><span class="linenum">1255</span></a>          <a class="var it2343" onMouseOver="hilite(2343)" onMouseOut="lolite()" onClick="logVariable('recordset')" href="../../_variables/recordset.html">$recordset</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('db')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/db.html">db</a>-&gt;<a class="function" onClick="logFunction('get_recordset_sql')" href="../../_functions/get_recordset_sql.html" onMouseOver="funcPopup(event,'get_recordset_sql')">get_recordset_sql</a>(&quot;
<a name="l1256"><span class="linenum">1256</span></a>                  SELECT qa.questionid, qa.variant, <a class="phpfunction" onClick="logFunction('COUNT')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">COUNT</a>(1) AS usescount
<a name="l1257"><span class="linenum">1257</span></a>                    FROM &quot; . <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('from_question_attempts')" href="../../_functions/from_question_attempts.html" onMouseOver="funcPopup(event,'from_question_attempts')">from_question_attempts</a>('qa') . &quot;
<a name="l1258"><span class="linenum">1258</span></a>                   WHERE qa.questionid <a class="var it3797" onMouseOver="hilite(3797)" onMouseOut="lolite()" onClick="logVariable('test')" href="../../_variables/test.html">$test</a>
<a name="l1259"><span class="linenum">1259</span></a>                     AND &quot; . <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('where')" href="../../_functions/where.html" onMouseOver="funcPopup(event,'where')">where</a>() . &quot;
<a name="l1260"><span class="linenum">1260</span></a>                GROUP BY qa.questionid, qa.variant
<a name="l1261"><span class="linenum">1261</span></a>                ORDER BY <a class="phpfunction" onClick="logFunction('COUNT')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">COUNT</a>(1) ASC
<a name="l1262"><span class="linenum">1262</span></a>                  &quot;, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> + <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>-&gt;<a class="function" onClick="logFunction('from_where_params')" href="../../_functions/from_where_params.html" onMouseOver="funcPopup(event,'from_where_params')">from_where_params</a>());
<a name="l1263"><span class="linenum">1263</span></a>  
<a name="l1264"><span class="linenum">1264</span></a>          <a class="var it9232" onMouseOver="hilite(9232)" onMouseOut="lolite()" onClick="logVariable('usedvariants')" href="../../_variables/usedvariants.html">$usedvariants</a> = <a class="phpfunction" onClick="logFunction('array_combine')" href="../../_functions/array_combine.html" onMouseOver="phpfuncPopup(event,'array_combine')">array_combine</a>(<a class="var it5865" onMouseOver="hilite(5865)" onMouseOut="lolite()" onClick="logVariable('questionids')" href="../../_variables/questionids.html">$questionids</a>, <a class="phpfunction" onClick="logFunction('array_fill')" href="../../_functions/array_fill.html" onMouseOver="phpfuncPopup(event,'array_fill')">array_fill</a>(0, <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it5865" onMouseOver="hilite(5865)" onMouseOut="lolite()" onClick="logVariable('questionids')" href="../../_variables/questionids.html">$questionids</a>), array()));
<a name="l1265"><span class="linenum">1265</span></a>          foreach (<a class="var it2343" onMouseOver="hilite(2343)" onMouseOut="lolite()" onClick="logVariable('recordset')" href="../../_variables/recordset.html">$recordset</a> as <a class="var it57" onMouseOver="hilite(57)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>) {
<a name="l1266"><span class="linenum">1266</span></a>              <a class="var it9232" onMouseOver="hilite(9232)" onMouseOut="lolite()" onClick="logVariable('usedvariants')" href="../../_variables/usedvariants.html">$usedvariants</a>[<a class="var it57" onMouseOver="hilite(57)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>-&gt;<a onClick="logVariable('questionid')" class="var it42924" onMouseOver="hilite(42924)" onMouseOut="lolite()" href="../../_variables/questionid.html">questionid</a>][<a class="var it57" onMouseOver="hilite(57)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>-&gt;<a onClick="logVariable('variant')" class="var it42924" onMouseOver="hilite(42924)" onMouseOut="lolite()" href="../../_variables/variant.html">variant</a>] = <a class="var it57" onMouseOver="hilite(57)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>-&gt;<a onClick="logVariable('usescount')" class="var it42924" onMouseOver="hilite(42924)" onMouseOut="lolite()" href="../../_variables/usescount.html">usescount</a>;
<a name="l1267"><span class="linenum">1267</span></a>          }
<a name="l1268"><span class="linenum">1268</span></a>          <a class="var it2343" onMouseOver="hilite(2343)" onMouseOut="lolite()" onClick="logVariable('recordset')" href="../../_variables/recordset.html">$recordset</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l1269"><span class="linenum">1269</span></a>          return <a class="var it9232" onMouseOver="hilite(9232)" onMouseOut="lolite()" onClick="logVariable('usedvariants')" href="../../_variables/usedvariants.html">$usedvariants</a>;
<a name="l1270"><span class="linenum">1270</span></a>      }
<a name="l1271"><span class="linenum">1271</span></a>  }
<a name="l1272"><span class="linenum">1272</span></a>  
<a name="l1273"><span class="linenum">1273</span></a>  
<a name="l1274"><span class="linenum">1274</span></a>  <span class="comment">/**</span>
<a name="l1275"><span class="linenum">1275</span></a>  <span class="comment"> * Implementation of the unit of work pattern for the question engine.</span>
<a name="l1276"><span class="linenum">1276</span></a>  <span class="comment"> *</span>
<a name="l1277"><span class="linenum">1277</span></a>  <span class="comment"> * See http://martinfowler.com/eaaCatalog/unitOfWork.html. This tracks all the</span>
<a name="l1278"><span class="linenum">1278</span></a>  <span class="comment"> * changes to a {@link question_usage_by_activity}, and its constituent parts,</span>
<a name="l1279"><span class="linenum">1279</span></a>  <span class="comment"> * so that the changes can be saved to the database when {@link save()} is called.</span>
<a name="l1280"><span class="linenum">1280</span></a>  <span class="comment"> *</span>
<a name="l1281"><span class="linenum">1281</span></a>  <span class="comment"> * @copyright  2009 The Open University</span>
<a name="l1282"><span class="linenum">1282</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l1283"><span class="linenum">1283</span></a>  <span class="comment"> */</span>
<a name="l1284"><span class="linenum">1284</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('question_engine_unit_of_work')" href="../../_classes/question_engine_unit_of_work.html" onMouseOver="classPopup(event,'question_engine_unit_of_work')">question_engine_unit_of_work</a> <span class="keyword">implements</span> <a class="class" onClick="logClass('question_usage_observer')" href="../../_classes/question_usage_observer.html" onMouseOver="classPopup(event,'question_usage_observer')">question_usage_observer</a> {
<a name="l1285"><span class="linenum">1285</span></a>  <span class="comment">    /** @var question_usage_by_activity the usage being tracked. */</span>
<a name="l1286"><span class="linenum">1286</span></a>      protected <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>;
<a name="l1287"><span class="linenum">1287</span></a>  
<a name="l1288"><span class="linenum">1288</span></a>  <span class="comment">    /** @var boolean whether any of the fields of the usage have been changed. */</span>
<a name="l1289"><span class="linenum">1289</span></a>      protected <a class="var it793" onMouseOver="hilite(793)" onMouseOut="lolite()" onClick="logVariable('modified')" href="../../_variables/modified.html">$modified</a> = false;
<a name="l1290"><span class="linenum">1290</span></a>  
<a name="l1291"><span class="linenum">1291</span></a>      <span class="comment">/**</span>
<a name="l1292"><span class="linenum">1292</span></a>  <span class="comment">     * @var array list of slot =&gt; {@link question_attempt}s that</span>
<a name="l1293"><span class="linenum">1293</span></a>  <span class="comment">     * have been added to the usage.</span>
<a name="l1294"><span class="linenum">1294</span></a>  <span class="comment">     */</span>
<a name="l1295"><span class="linenum">1295</span></a>      protected <a class="var it9234" onMouseOver="hilite(9234)" onMouseOut="lolite()" onClick="logVariable('attemptsadded')" href="../../_variables/attemptsadded.html">$attemptsadded</a> = array();
<a name="l1296"><span class="linenum">1296</span></a>  
<a name="l1297"><span class="linenum">1297</span></a>      <span class="comment">/**</span>
<a name="l1298"><span class="linenum">1298</span></a>  <span class="comment">     * @var array list of slot =&gt; {@link question_attempt}s that</span>
<a name="l1299"><span class="linenum">1299</span></a>  <span class="comment">     * were already in the usage, and which have been modified.</span>
<a name="l1300"><span class="linenum">1300</span></a>  <span class="comment">     */</span>
<a name="l1301"><span class="linenum">1301</span></a>      protected <a class="var it9235" onMouseOver="hilite(9235)" onMouseOut="lolite()" onClick="logVariable('attemptsmodified')" href="../../_variables/attemptsmodified.html">$attemptsmodified</a> = array();
<a name="l1302"><span class="linenum">1302</span></a>  
<a name="l1303"><span class="linenum">1303</span></a>      <span class="comment">/**</span>
<a name="l1304"><span class="linenum">1304</span></a>  <span class="comment">     * @var array of array(question_attempt_step, question_attempt id, seq number)</span>
<a name="l1305"><span class="linenum">1305</span></a>  <span class="comment">     * of steps that have been added to question attempts in this usage.</span>
<a name="l1306"><span class="linenum">1306</span></a>  <span class="comment">     */</span>
<a name="l1307"><span class="linenum">1307</span></a>      protected <a class="var it9236" onMouseOver="hilite(9236)" onMouseOut="lolite()" onClick="logVariable('stepsadded')" href="../../_variables/stepsadded.html">$stepsadded</a> = array();
<a name="l1308"><span class="linenum">1308</span></a>  
<a name="l1309"><span class="linenum">1309</span></a>      <span class="comment">/**</span>
<a name="l1310"><span class="linenum">1310</span></a>  <span class="comment">     * @var array of array(question_attempt_step, question_attempt id, seq number)</span>
<a name="l1311"><span class="linenum">1311</span></a>  <span class="comment">     * of steps that have been modified in their attempt.</span>
<a name="l1312"><span class="linenum">1312</span></a>  <span class="comment">     */</span>
<a name="l1313"><span class="linenum">1313</span></a>      protected <a class="var it9237" onMouseOver="hilite(9237)" onMouseOut="lolite()" onClick="logVariable('stepsmodified')" href="../../_variables/stepsmodified.html">$stepsmodified</a> = array();
<a name="l1314"><span class="linenum">1314</span></a>  
<a name="l1315"><span class="linenum">1315</span></a>      <span class="comment">/**</span>
<a name="l1316"><span class="linenum">1316</span></a>  <span class="comment">     * @var array list of question_attempt_step.id =&gt; question_attempt_step of steps</span>
<a name="l1317"><span class="linenum">1317</span></a>  <span class="comment">     * that were previously stored in the database, but which are no longer required.</span>
<a name="l1318"><span class="linenum">1318</span></a>  <span class="comment">     */</span>
<a name="l1319"><span class="linenum">1319</span></a>      protected <a class="var it9238" onMouseOver="hilite(9238)" onMouseOut="lolite()" onClick="logVariable('stepsdeleted')" href="../../_variables/stepsdeleted.html">$stepsdeleted</a> = array();
<a name="l1320"><span class="linenum">1320</span></a>  
<a name="l1321"><span class="linenum">1321</span></a>      <span class="comment">/**</span>
<a name="l1322"><span class="linenum">1322</span></a>  <span class="comment">     * @var array int slot =&gt; string name =&gt; question_attempt.</span>
<a name="l1323"><span class="linenum">1323</span></a>  <span class="comment">     */</span>
<a name="l1324"><span class="linenum">1324</span></a>      protected <a class="var it9239" onMouseOver="hilite(9239)" onMouseOut="lolite()" onClick="logVariable('metadataadded')" href="../../_variables/metadataadded.html">$metadataadded</a> = array();
<a name="l1325"><span class="linenum">1325</span></a>  
<a name="l1326"><span class="linenum">1326</span></a>      <span class="comment">/**</span>
<a name="l1327"><span class="linenum">1327</span></a>  <span class="comment">     * @var array int slot =&gt; string name =&gt; question_attempt.</span>
<a name="l1328"><span class="linenum">1328</span></a>  <span class="comment">     */</span>
<a name="l1329"><span class="linenum">1329</span></a>      protected <a class="var it9240" onMouseOver="hilite(9240)" onMouseOut="lolite()" onClick="logVariable('metadatamodified')" href="../../_variables/metadatamodified.html">$metadatamodified</a> = array();
<a name="l1330"><span class="linenum">1330</span></a>  
<a name="l1331"><span class="linenum">1331</span></a>      <span class="comment">/**</span>
<a name="l1332"><span class="linenum">1332</span></a>  <span class="comment">     * Constructor.</span>
<a name="l1333"><span class="linenum">1333</span></a>  <span class="comment">     * @param question_usage_by_activity $quba the usage to track.</span>
<a name="l1334"><span class="linenum">1334</span></a>  <span class="comment">     */</span>
<a name="l1335"><span class="linenum">1335</span></a>      public function <a class="function" onClick="logFunction('__construct')" href="../../_functions/__construct.html" onMouseOver="funcPopup(event,'__construct')">__construct</a>(question_usage_by_activity <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>) {
<a name="l1336"><span class="linenum">1336</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('quba')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/quba.html">quba</a> = <a class="var it4294" onMouseOver="hilite(4294)" onMouseOut="lolite()" onClick="logVariable('quba')" href="../../_variables/quba.html">$quba</a>;
<a name="l1337"><span class="linenum">1337</span></a>      }
<a name="l1338"><span class="linenum">1338</span></a>  
<a name="l1339"><span class="linenum">1339</span></a>      public function <a class="function" onClick="logFunction('notify_modified')" href="../../_functions/notify_modified.html" onMouseOver="funcPopup(event,'notify_modified')">notify_modified</a>() {
<a name="l1340"><span class="linenum">1340</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('modified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/modified.html">modified</a> = true;
<a name="l1341"><span class="linenum">1341</span></a>      }
<a name="l1342"><span class="linenum">1342</span></a>  
<a name="l1343"><span class="linenum">1343</span></a>      public function <a class="function" onClick="logFunction('notify_attempt_added')" href="../../_functions/notify_attempt_added.html" onMouseOver="funcPopup(event,'notify_attempt_added')">notify_attempt_added</a>(question_attempt <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>) {
<a name="l1344"><span class="linenum">1344</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('attemptsadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/attemptsadded.html">attemptsadded</a>[<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_slot')" href="../../_functions/get_slot.html" onMouseOver="funcPopup(event,'get_slot')">get_slot</a>()] = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>;
<a name="l1345"><span class="linenum">1345</span></a>      }
<a name="l1346"><span class="linenum">1346</span></a>  
<a name="l1347"><span class="linenum">1347</span></a>      public function <a class="function" onClick="logFunction('notify_attempt_modified')" href="../../_functions/notify_attempt_modified.html" onMouseOver="funcPopup(event,'notify_attempt_modified')">notify_attempt_modified</a>(question_attempt <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>) {
<a name="l1348"><span class="linenum">1348</span></a>          <a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_slot')" href="../../_functions/get_slot.html" onMouseOver="funcPopup(event,'get_slot')">get_slot</a>();
<a name="l1349"><span class="linenum">1349</span></a>          if (!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('attemptsadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/attemptsadded.html">attemptsadded</a>)) {
<a name="l1350"><span class="linenum">1350</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('attemptsmodified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/attemptsmodified.html">attemptsmodified</a>[<a class="var it935" onMouseOver="hilite(935)" onMouseOut="lolite()" onClick="logVariable('slot')" href="../../_variables/slot.html">$slot</a>] = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>;
<a name="l1351"><span class="linenum">1351</span></a>          }
<a name="l1352"><span class="linenum">1352</span></a>      }
<a name="l1353"><span class="linenum">1353</span></a>  
<a name="l1354"><span class="linenum">1354</span></a>      public function <a class="function" onClick="logFunction('notify_attempt_moved')" href="../../_functions/notify_attempt_moved.html" onMouseOver="funcPopup(event,'notify_attempt_moved')">notify_attempt_moved</a>(question_attempt <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>, <a class="var it9241" onMouseOver="hilite(9241)" onMouseOut="lolite()" onClick="logVariable('oldslot')" href="../../_variables/oldslot.html">$oldslot</a>) {
<a name="l1355"><span class="linenum">1355</span></a>          <a class="var it9242" onMouseOver="hilite(9242)" onMouseOut="lolite()" onClick="logVariable('newslot')" href="../../_variables/newslot.html">$newslot</a> = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_slot')" href="../../_functions/get_slot.html" onMouseOver="funcPopup(event,'get_slot')">get_slot</a>();
<a name="l1356"><span class="linenum">1356</span></a>  
<a name="l1357"><span class="linenum">1357</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it9241" onMouseOver="hilite(9241)" onMouseOut="lolite()" onClick="logVariable('oldslot')" href="../../_variables/oldslot.html">$oldslot</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('attemptsadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/attemptsadded.html">attemptsadded</a>)) {
<a name="l1358"><span class="linenum">1358</span></a>              unset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('attemptsadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/attemptsadded.html">attemptsadded</a>[<a class="var it9241" onMouseOver="hilite(9241)" onMouseOut="lolite()" onClick="logVariable('oldslot')" href="../../_variables/oldslot.html">$oldslot</a>]);
<a name="l1359"><span class="linenum">1359</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('attemptsadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/attemptsadded.html">attemptsadded</a>[<a class="var it9242" onMouseOver="hilite(9242)" onMouseOut="lolite()" onClick="logVariable('newslot')" href="../../_variables/newslot.html">$newslot</a>] = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>;
<a name="l1360"><span class="linenum">1360</span></a>              return;
<a name="l1361"><span class="linenum">1361</span></a>          }
<a name="l1362"><span class="linenum">1362</span></a>  
<a name="l1363"><span class="linenum">1363</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it9241" onMouseOver="hilite(9241)" onMouseOut="lolite()" onClick="logVariable('oldslot')" href="../../_variables/oldslot.html">$oldslot</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('attemptsmodified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/attemptsmodified.html">attemptsmodified</a>)) {
<a name="l1364"><span class="linenum">1364</span></a>              unset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('attemptsmodified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/attemptsmodified.html">attemptsmodified</a>[<a class="var it9241" onMouseOver="hilite(9241)" onMouseOut="lolite()" onClick="logVariable('oldslot')" href="../../_variables/oldslot.html">$oldslot</a>]);
<a name="l1365"><span class="linenum">1365</span></a>          }
<a name="l1366"><span class="linenum">1366</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('attemptsmodified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/attemptsmodified.html">attemptsmodified</a>[<a class="var it9242" onMouseOver="hilite(9242)" onMouseOut="lolite()" onClick="logVariable('newslot')" href="../../_variables/newslot.html">$newslot</a>] = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>;
<a name="l1367"><span class="linenum">1367</span></a>  
<a name="l1368"><span class="linenum">1368</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it9241" onMouseOver="hilite(9241)" onMouseOut="lolite()" onClick="logVariable('oldslot')" href="../../_variables/oldslot.html">$oldslot</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('metadataadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/metadataadded.html">metadataadded</a>)) {
<a name="l1369"><span class="linenum">1369</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('metadataadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/metadataadded.html">metadataadded</a>[<a class="var it9242" onMouseOver="hilite(9242)" onMouseOut="lolite()" onClick="logVariable('newslot')" href="../../_variables/newslot.html">$newslot</a>] = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('metadataadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/metadataadded.html">metadataadded</a>[<a class="var it9241" onMouseOver="hilite(9241)" onMouseOut="lolite()" onClick="logVariable('oldslot')" href="../../_variables/oldslot.html">$oldslot</a>];
<a name="l1370"><span class="linenum">1370</span></a>              unset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('metadataadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/metadataadded.html">metadataadded</a>[<a class="var it9241" onMouseOver="hilite(9241)" onMouseOut="lolite()" onClick="logVariable('oldslot')" href="../../_variables/oldslot.html">$oldslot</a>]);
<a name="l1371"><span class="linenum">1371</span></a>          }
<a name="l1372"><span class="linenum">1372</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it9241" onMouseOver="hilite(9241)" onMouseOut="lolite()" onClick="logVariable('oldslot')" href="../../_variables/oldslot.html">$oldslot</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('metadatamodified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/metadatamodified.html">metadatamodified</a>)) {
<a name="l1373"><span class="linenum">1373</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('metadatamodified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/metadatamodified.html">metadatamodified</a>[<a class="var it9242" onMouseOver="hilite(9242)" onMouseOut="lolite()" onClick="logVariable('newslot')" href="../../_variables/newslot.html">$newslot</a>] = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('metadatamodified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/metadatamodified.html">metadatamodified</a>[<a class="var it9241" onMouseOver="hilite(9241)" onMouseOut="lolite()" onClick="logVariable('oldslot')" href="../../_variables/oldslot.html">$oldslot</a>];
<a name="l1374"><span class="linenum">1374</span></a>              unset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('metadatamodified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/metadatamodified.html">metadatamodified</a>[<a class="var it9241" onMouseOver="hilite(9241)" onMouseOut="lolite()" onClick="logVariable('oldslot')" href="../../_variables/oldslot.html">$oldslot</a>]);
<a name="l1375"><span class="linenum">1375</span></a>          }
<a name="l1376"><span class="linenum">1376</span></a>      }
<a name="l1377"><span class="linenum">1377</span></a>  
<a name="l1378"><span class="linenum">1378</span></a>      public function <a class="function" onClick="logFunction('notify_step_added')" href="../../_functions/notify_step_added.html" onMouseOver="funcPopup(event,'notify_step_added')">notify_step_added</a>(question_attempt_step <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>, question_attempt <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>, <a class="var it3067" onMouseOver="hilite(3067)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../_variables/seq.html">$seq</a>) {
<a name="l1379"><span class="linenum">1379</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_slot')" href="../../_functions/get_slot.html" onMouseOver="funcPopup(event,'get_slot')">get_slot</a>(), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('attemptsadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/attemptsadded.html">attemptsadded</a>)) {
<a name="l1380"><span class="linenum">1380</span></a>              return;
<a name="l1381"><span class="linenum">1381</span></a>          }
<a name="l1382"><span class="linenum">1382</span></a>  
<a name="l1383"><span class="linenum">1383</span></a>          if ((<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_step_added')" href="../../_functions/is_step_added.html" onMouseOver="funcPopup(event,'is_step_added')">is_step_added</a>(<a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>)) !== false) {
<a name="l1384"><span class="linenum">1384</span></a>              return;
<a name="l1385"><span class="linenum">1385</span></a>          }
<a name="l1386"><span class="linenum">1386</span></a>  
<a name="l1387"><span class="linenum">1387</span></a>          if ((<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_step_modified')" href="../../_functions/is_step_modified.html" onMouseOver="funcPopup(event,'is_step_modified')">is_step_modified</a>(<a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>)) !== false) {
<a name="l1388"><span class="linenum">1388</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Cannot add a step that has already been modified.');
<a name="l1389"><span class="linenum">1389</span></a>          }
<a name="l1390"><span class="linenum">1390</span></a>  
<a name="l1391"><span class="linenum">1391</span></a>          if ((<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_step_deleted')" href="../../_functions/is_step_deleted.html" onMouseOver="funcPopup(event,'is_step_deleted')">is_step_deleted</a>(<a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>)) !== false) {
<a name="l1392"><span class="linenum">1392</span></a>              unset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stepsdeleted')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/stepsdeleted.html">stepsdeleted</a>[<a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>-&gt;<a class="function" onClick="logFunction('get_id')" href="../../_functions/get_id.html" onMouseOver="funcPopup(event,'get_id')">get_id</a>()]);
<a name="l1393"><span class="linenum">1393</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stepsmodified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/stepsmodified.html">stepsmodified</a>[] = array(<a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>, <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_database_id')" href="../../_functions/get_database_id.html" onMouseOver="funcPopup(event,'get_database_id')">get_database_id</a>(), <a class="var it3067" onMouseOver="hilite(3067)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../_variables/seq.html">$seq</a>);
<a name="l1394"><span class="linenum">1394</span></a>              return;
<a name="l1395"><span class="linenum">1395</span></a>          }
<a name="l1396"><span class="linenum">1396</span></a>  
<a name="l1397"><span class="linenum">1397</span></a>          <a class="var it9204" onMouseOver="hilite(9204)" onMouseOut="lolite()" onClick="logVariable('stepid')" href="../../_variables/stepid.html">$stepid</a> = <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>-&gt;<a class="function" onClick="logFunction('get_id')" href="../../_functions/get_id.html" onMouseOver="funcPopup(event,'get_id')">get_id</a>();
<a name="l1398"><span class="linenum">1398</span></a>          if (<a class="var it9204" onMouseOver="hilite(9204)" onMouseOut="lolite()" onClick="logVariable('stepid')" href="../../_variables/stepid.html">$stepid</a>) {
<a name="l1399"><span class="linenum">1399</span></a>              if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it9204" onMouseOver="hilite(9204)" onMouseOut="lolite()" onClick="logVariable('stepid')" href="../../_variables/stepid.html">$stepid</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stepsdeleted')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/stepsdeleted.html">stepsdeleted</a>)) {
<a name="l1400"><span class="linenum">1400</span></a>                  unset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stepsdeleted')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/stepsdeleted.html">stepsdeleted</a>[<a class="var it9204" onMouseOver="hilite(9204)" onMouseOut="lolite()" onClick="logVariable('stepid')" href="../../_variables/stepid.html">$stepid</a>]);
<a name="l1401"><span class="linenum">1401</span></a>              }
<a name="l1402"><span class="linenum">1402</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stepsmodified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/stepsmodified.html">stepsmodified</a>[] = array(<a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>, <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_database_id')" href="../../_functions/get_database_id.html" onMouseOver="funcPopup(event,'get_database_id')">get_database_id</a>(), <a class="var it3067" onMouseOver="hilite(3067)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../_variables/seq.html">$seq</a>);
<a name="l1403"><span class="linenum">1403</span></a>  
<a name="l1404"><span class="linenum">1404</span></a>          } else {
<a name="l1405"><span class="linenum">1405</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stepsadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/stepsadded.html">stepsadded</a>[] = array(<a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>, <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_database_id')" href="../../_functions/get_database_id.html" onMouseOver="funcPopup(event,'get_database_id')">get_database_id</a>(), <a class="var it3067" onMouseOver="hilite(3067)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../_variables/seq.html">$seq</a>);
<a name="l1406"><span class="linenum">1406</span></a>          }
<a name="l1407"><span class="linenum">1407</span></a>      }
<a name="l1408"><span class="linenum">1408</span></a>  
<a name="l1409"><span class="linenum">1409</span></a>      public function <a class="function" onClick="logFunction('notify_step_modified')" href="../../_functions/notify_step_modified.html" onMouseOver="funcPopup(event,'notify_step_modified')">notify_step_modified</a>(question_attempt_step <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>, question_attempt <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>, <a class="var it3067" onMouseOver="hilite(3067)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../_variables/seq.html">$seq</a>) {
<a name="l1410"><span class="linenum">1410</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_slot')" href="../../_functions/get_slot.html" onMouseOver="funcPopup(event,'get_slot')">get_slot</a>(), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('attemptsadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/attemptsadded.html">attemptsadded</a>)) {
<a name="l1411"><span class="linenum">1411</span></a>              return;
<a name="l1412"><span class="linenum">1412</span></a>          }
<a name="l1413"><span class="linenum">1413</span></a>  
<a name="l1414"><span class="linenum">1414</span></a>          if ((<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_step_added')" href="../../_functions/is_step_added.html" onMouseOver="funcPopup(event,'is_step_added')">is_step_added</a>(<a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>)) !== false) {
<a name="l1415"><span class="linenum">1415</span></a>              return;
<a name="l1416"><span class="linenum">1416</span></a>          }
<a name="l1417"><span class="linenum">1417</span></a>  
<a name="l1418"><span class="linenum">1418</span></a>          if ((<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_step_deleted')" href="../../_functions/is_step_deleted.html" onMouseOver="funcPopup(event,'is_step_deleted')">is_step_deleted</a>(<a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>)) !== false) {
<a name="l1419"><span class="linenum">1419</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Cannot modify a step after it has been deleted.');
<a name="l1420"><span class="linenum">1420</span></a>          }
<a name="l1421"><span class="linenum">1421</span></a>  
<a name="l1422"><span class="linenum">1422</span></a>          <a class="var it9204" onMouseOver="hilite(9204)" onMouseOut="lolite()" onClick="logVariable('stepid')" href="../../_variables/stepid.html">$stepid</a> = <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>-&gt;<a class="function" onClick="logFunction('get_id')" href="../../_functions/get_id.html" onMouseOver="funcPopup(event,'get_id')">get_id</a>();
<a name="l1423"><span class="linenum">1423</span></a>          if (empty(<a class="var it9204" onMouseOver="hilite(9204)" onMouseOut="lolite()" onClick="logVariable('stepid')" href="../../_variables/stepid.html">$stepid</a>)) {
<a name="l1424"><span class="linenum">1424</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Cannot modify a step that has never been stored in the database.');
<a name="l1425"><span class="linenum">1425</span></a>          }
<a name="l1426"><span class="linenum">1426</span></a>  
<a name="l1427"><span class="linenum">1427</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stepsmodified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/stepsmodified.html">stepsmodified</a>[] = array(<a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>, <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_database_id')" href="../../_functions/get_database_id.html" onMouseOver="funcPopup(event,'get_database_id')">get_database_id</a>(), <a class="var it3067" onMouseOver="hilite(3067)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../_variables/seq.html">$seq</a>);
<a name="l1428"><span class="linenum">1428</span></a>      }
<a name="l1429"><span class="linenum">1429</span></a>  
<a name="l1430"><span class="linenum">1430</span></a>      public function <a class="function" onClick="logFunction('notify_step_deleted')" href="../../_functions/notify_step_deleted.html" onMouseOver="funcPopup(event,'notify_step_deleted')">notify_step_deleted</a>(question_attempt_step <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>, question_attempt <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>) {
<a name="l1431"><span class="linenum">1431</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_slot')" href="../../_functions/get_slot.html" onMouseOver="funcPopup(event,'get_slot')">get_slot</a>(), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('attemptsadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/attemptsadded.html">attemptsadded</a>)) {
<a name="l1432"><span class="linenum">1432</span></a>              return;
<a name="l1433"><span class="linenum">1433</span></a>          }
<a name="l1434"><span class="linenum">1434</span></a>  
<a name="l1435"><span class="linenum">1435</span></a>          if ((<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_step_added')" href="../../_functions/is_step_added.html" onMouseOver="funcPopup(event,'is_step_added')">is_step_added</a>(<a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>)) !== false) {
<a name="l1436"><span class="linenum">1436</span></a>              unset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stepsadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/stepsadded.html">stepsadded</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>]);
<a name="l1437"><span class="linenum">1437</span></a>              return;
<a name="l1438"><span class="linenum">1438</span></a>          }
<a name="l1439"><span class="linenum">1439</span></a>  
<a name="l1440"><span class="linenum">1440</span></a>          if ((<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_step_modified')" href="../../_functions/is_step_modified.html" onMouseOver="funcPopup(event,'is_step_modified')">is_step_modified</a>(<a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>)) !== false) {
<a name="l1441"><span class="linenum">1441</span></a>              unset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stepsmodified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/stepsmodified.html">stepsmodified</a>[<a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>]);
<a name="l1442"><span class="linenum">1442</span></a>          }
<a name="l1443"><span class="linenum">1443</span></a>  
<a name="l1444"><span class="linenum">1444</span></a>          <a class="var it9204" onMouseOver="hilite(9204)" onMouseOut="lolite()" onClick="logVariable('stepid')" href="../../_variables/stepid.html">$stepid</a> = <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>-&gt;<a class="function" onClick="logFunction('get_id')" href="../../_functions/get_id.html" onMouseOver="funcPopup(event,'get_id')">get_id</a>();
<a name="l1445"><span class="linenum">1445</span></a>          if (empty(<a class="var it9204" onMouseOver="hilite(9204)" onMouseOut="lolite()" onClick="logVariable('stepid')" href="../../_variables/stepid.html">$stepid</a>)) {
<a name="l1446"><span class="linenum">1446</span></a>              return; <span class="comment">// Was never in the database.</span>
<a name="l1447"><span class="linenum">1447</span></a>          }
<a name="l1448"><span class="linenum">1448</span></a>  
<a name="l1449"><span class="linenum">1449</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stepsdeleted')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/stepsdeleted.html">stepsdeleted</a>[<a class="var it9204" onMouseOver="hilite(9204)" onMouseOut="lolite()" onClick="logVariable('stepid')" href="../../_variables/stepid.html">$stepid</a>] = <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>;
<a name="l1450"><span class="linenum">1450</span></a>      }
<a name="l1451"><span class="linenum">1451</span></a>  
<a name="l1452"><span class="linenum">1452</span></a>      public function <a class="function" onClick="logFunction('notify_metadata_added')" href="../../_functions/notify_metadata_added.html" onMouseOver="funcPopup(event,'notify_metadata_added')">notify_metadata_added</a>(question_attempt <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>, <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>) {
<a name="l1453"><span class="linenum">1453</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_slot')" href="../../_functions/get_slot.html" onMouseOver="funcPopup(event,'get_slot')">get_slot</a>(), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('attemptsadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/attemptsadded.html">attemptsadded</a>)) {
<a name="l1454"><span class="linenum">1454</span></a>              return;
<a name="l1455"><span class="linenum">1455</span></a>          }
<a name="l1456"><span class="linenum">1456</span></a>  
<a name="l1457"><span class="linenum">1457</span></a>          if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_step_added')" href="../../_functions/is_step_added.html" onMouseOver="funcPopup(event,'is_step_added')">is_step_added</a>(<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_step')" href="../../_functions/get_step.html" onMouseOver="funcPopup(event,'get_step')">get_step</a>(0)) !== false) {
<a name="l1458"><span class="linenum">1458</span></a>              return;
<a name="l1459"><span class="linenum">1459</span></a>          }
<a name="l1460"><span class="linenum">1460</span></a>  
<a name="l1461"><span class="linenum">1461</span></a>          if (isset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('metadataadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/metadataadded.html">metadataadded</a>[<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_slot')" href="../../_functions/get_slot.html" onMouseOver="funcPopup(event,'get_slot')">get_slot</a>()][<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>])) {
<a name="l1462"><span class="linenum">1462</span></a>              return;
<a name="l1463"><span class="linenum">1463</span></a>          }
<a name="l1464"><span class="linenum">1464</span></a>  
<a name="l1465"><span class="linenum">1465</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('metadataadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/metadataadded.html">metadataadded</a>[<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_slot')" href="../../_functions/get_slot.html" onMouseOver="funcPopup(event,'get_slot')">get_slot</a>()][<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>] = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>;
<a name="l1466"><span class="linenum">1466</span></a>      }
<a name="l1467"><span class="linenum">1467</span></a>  
<a name="l1468"><span class="linenum">1468</span></a>      public function <a class="function" onClick="logFunction('notify_metadata_modified')" href="../../_functions/notify_metadata_modified.html" onMouseOver="funcPopup(event,'notify_metadata_modified')">notify_metadata_modified</a>(question_attempt <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>, <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>) {
<a name="l1469"><span class="linenum">1469</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_slot')" href="../../_functions/get_slot.html" onMouseOver="funcPopup(event,'get_slot')">get_slot</a>(), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('attemptsadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/attemptsadded.html">attemptsadded</a>)) {
<a name="l1470"><span class="linenum">1470</span></a>              return;
<a name="l1471"><span class="linenum">1471</span></a>          }
<a name="l1472"><span class="linenum">1472</span></a>  
<a name="l1473"><span class="linenum">1473</span></a>          if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_step_added')" href="../../_functions/is_step_added.html" onMouseOver="funcPopup(event,'is_step_added')">is_step_added</a>(<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_step')" href="../../_functions/get_step.html" onMouseOver="funcPopup(event,'get_step')">get_step</a>(0)) !== false) {
<a name="l1474"><span class="linenum">1474</span></a>              return;
<a name="l1475"><span class="linenum">1475</span></a>          }
<a name="l1476"><span class="linenum">1476</span></a>  
<a name="l1477"><span class="linenum">1477</span></a>          if (isset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('metadataadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/metadataadded.html">metadataadded</a>[<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_slot')" href="../../_functions/get_slot.html" onMouseOver="funcPopup(event,'get_slot')">get_slot</a>()][<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>])) {
<a name="l1478"><span class="linenum">1478</span></a>              return;
<a name="l1479"><span class="linenum">1479</span></a>          }
<a name="l1480"><span class="linenum">1480</span></a>  
<a name="l1481"><span class="linenum">1481</span></a>          if (isset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('metadatamodified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/metadatamodified.html">metadatamodified</a>[<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_slot')" href="../../_functions/get_slot.html" onMouseOver="funcPopup(event,'get_slot')">get_slot</a>()][<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>])) {
<a name="l1482"><span class="linenum">1482</span></a>              return;
<a name="l1483"><span class="linenum">1483</span></a>          }
<a name="l1484"><span class="linenum">1484</span></a>  
<a name="l1485"><span class="linenum">1485</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('metadatamodified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/metadatamodified.html">metadatamodified</a>[<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>-&gt;<a class="function" onClick="logFunction('get_slot')" href="../../_functions/get_slot.html" onMouseOver="funcPopup(event,'get_slot')">get_slot</a>()][<a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>] = <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>;
<a name="l1486"><span class="linenum">1486</span></a>      }
<a name="l1487"><span class="linenum">1487</span></a>  
<a name="l1488"><span class="linenum">1488</span></a>      <span class="comment">/**</span>
<a name="l1489"><span class="linenum">1489</span></a>  <span class="comment">     * @param question_attempt_step $step a step</span>
<a name="l1490"><span class="linenum">1490</span></a>  <span class="comment">     * @return int|false if the step is in the list of steps to be added, return</span>
<a name="l1491"><span class="linenum">1491</span></a>  <span class="comment">     *      the key, otherwise return false.</span>
<a name="l1492"><span class="linenum">1492</span></a>  <span class="comment">     */</span>
<a name="l1493"><span class="linenum">1493</span></a>      protected function <a class="function" onClick="logFunction('is_step_added')" href="../../_functions/is_step_added.html" onMouseOver="funcPopup(event,'is_step_added')">is_step_added</a>(question_attempt_step <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>) {
<a name="l1494"><span class="linenum">1494</span></a>          foreach (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stepsadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/stepsadded.html">stepsadded</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>) {
<a name="l1495"><span class="linenum">1495</span></a>              <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it9243" onMouseOver="hilite(9243)" onMouseOut="lolite()" onClick="logVariable('addedstep')" href="../../_variables/addedstep.html">$addedstep</a>, <a class="var it9230" onMouseOver="hilite(9230)" onMouseOut="lolite()" onClick="logVariable('qaid')" href="../../_variables/qaid.html">$qaid</a>, <a class="var it3067" onMouseOver="hilite(3067)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../_variables/seq.html">$seq</a>) = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>;
<a name="l1496"><span class="linenum">1496</span></a>              if (<a class="var it9243" onMouseOver="hilite(9243)" onMouseOut="lolite()" onClick="logVariable('addedstep')" href="../../_variables/addedstep.html">$addedstep</a> === <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>) {
<a name="l1497"><span class="linenum">1497</span></a>                  return <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>;
<a name="l1498"><span class="linenum">1498</span></a>              }
<a name="l1499"><span class="linenum">1499</span></a>          }
<a name="l1500"><span class="linenum">1500</span></a>          return false;
<a name="l1501"><span class="linenum">1501</span></a>      }
<a name="l1502"><span class="linenum">1502</span></a>  
<a name="l1503"><span class="linenum">1503</span></a>      <span class="comment">/**</span>
<a name="l1504"><span class="linenum">1504</span></a>  <span class="comment">     * @param question_attempt_step $step a step</span>
<a name="l1505"><span class="linenum">1505</span></a>  <span class="comment">     * @return int|false if the step is in the list of steps to be modified, return</span>
<a name="l1506"><span class="linenum">1506</span></a>  <span class="comment">     *      the key, otherwise return false.</span>
<a name="l1507"><span class="linenum">1507</span></a>  <span class="comment">     */</span>
<a name="l1508"><span class="linenum">1508</span></a>      protected function <a class="function" onClick="logFunction('is_step_modified')" href="../../_functions/is_step_modified.html" onMouseOver="funcPopup(event,'is_step_modified')">is_step_modified</a>(question_attempt_step <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>) {
<a name="l1509"><span class="linenum">1509</span></a>          foreach (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stepsmodified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/stepsmodified.html">stepsmodified</a> as <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>) {
<a name="l1510"><span class="linenum">1510</span></a>              <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it9244" onMouseOver="hilite(9244)" onMouseOut="lolite()" onClick="logVariable('modifiedstep')" href="../../_variables/modifiedstep.html">$modifiedstep</a>, <a class="var it9230" onMouseOver="hilite(9230)" onMouseOut="lolite()" onClick="logVariable('qaid')" href="../../_variables/qaid.html">$qaid</a>, <a class="var it3067" onMouseOver="hilite(3067)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../_variables/seq.html">$seq</a>) = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../../_variables/data.html">$data</a>;
<a name="l1511"><span class="linenum">1511</span></a>              if (<a class="var it9244" onMouseOver="hilite(9244)" onMouseOut="lolite()" onClick="logVariable('modifiedstep')" href="../../_variables/modifiedstep.html">$modifiedstep</a> === <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>) {
<a name="l1512"><span class="linenum">1512</span></a>                  return <a class="var it118" onMouseOver="hilite(118)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>;
<a name="l1513"><span class="linenum">1513</span></a>              }
<a name="l1514"><span class="linenum">1514</span></a>          }
<a name="l1515"><span class="linenum">1515</span></a>          return false;
<a name="l1516"><span class="linenum">1516</span></a>      }
<a name="l1517"><span class="linenum">1517</span></a>  
<a name="l1518"><span class="linenum">1518</span></a>      <span class="comment">/**</span>
<a name="l1519"><span class="linenum">1519</span></a>  <span class="comment">     * @param question_attempt_step $step a step</span>
<a name="l1520"><span class="linenum">1520</span></a>  <span class="comment">     * @return bool whether the step is in the list of steps to be deleted.</span>
<a name="l1521"><span class="linenum">1521</span></a>  <span class="comment">     */</span>
<a name="l1522"><span class="linenum">1522</span></a>      protected function <a class="function" onClick="logFunction('is_step_deleted')" href="../../_functions/is_step_deleted.html" onMouseOver="funcPopup(event,'is_step_deleted')">is_step_deleted</a>(question_attempt_step <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>) {
<a name="l1523"><span class="linenum">1523</span></a>          foreach (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stepsdeleted')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/stepsdeleted.html">stepsdeleted</a> as <a class="var it9245" onMouseOver="hilite(9245)" onMouseOut="lolite()" onClick="logVariable('deletedstep')" href="../../_variables/deletedstep.html">$deletedstep</a>) {
<a name="l1524"><span class="linenum">1524</span></a>              if (<a class="var it9245" onMouseOver="hilite(9245)" onMouseOut="lolite()" onClick="logVariable('deletedstep')" href="../../_variables/deletedstep.html">$deletedstep</a> === <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>) {
<a name="l1525"><span class="linenum">1525</span></a>                  return true;
<a name="l1526"><span class="linenum">1526</span></a>              }
<a name="l1527"><span class="linenum">1527</span></a>          }
<a name="l1528"><span class="linenum">1528</span></a>          return false;
<a name="l1529"><span class="linenum">1529</span></a>      }
<a name="l1530"><span class="linenum">1530</span></a>  
<a name="l1531"><span class="linenum">1531</span></a>      <span class="comment">/**</span>
<a name="l1532"><span class="linenum">1532</span></a>  <span class="comment">     * Write all the changes we have recorded to the database.</span>
<a name="l1533"><span class="linenum">1533</span></a>  <span class="comment">     * @param question_engine_data_mapper $dm the mapper to use to update the database.</span>
<a name="l1534"><span class="linenum">1534</span></a>  <span class="comment">     */</span>
<a name="l1535"><span class="linenum">1535</span></a>      public function <a class="function" onClick="logFunction('save')" href="../../_functions/save.html" onMouseOver="funcPopup(event,'save')">save</a>(question_engine_data_mapper <a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('dm')" href="../../_variables/dm.html">$dm</a>) {
<a name="l1536"><span class="linenum">1536</span></a>          <a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('dm')" href="../../_variables/dm.html">$dm</a>-&gt;<a class="function" onClick="logFunction('delete_steps')" href="../../_functions/delete_steps.html" onMouseOver="funcPopup(event,'delete_steps')">delete_steps</a>(<a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stepsdeleted')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/stepsdeleted.html">stepsdeleted</a>), <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('quba')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/quba.html">quba</a>-&gt;<a class="function" onClick="logFunction('get_owning_context')" href="../../_functions/get_owning_context.html" onMouseOver="funcPopup(event,'get_owning_context')">get_owning_context</a>());
<a name="l1537"><span class="linenum">1537</span></a>  
<a name="l1538"><span class="linenum">1538</span></a>  <span class="comment">        // Initially an array of array of question_attempt_step_objects.</span>
<a name="l1539"><span class="linenum">1539</span></a>  <span class="comment">        // Built as a nested array for efficiency, then flattened.</span>
<a name="l1540"><span class="linenum">1540</span></a>          <a class="var it4603" onMouseOver="hilite(4603)" onMouseOut="lolite()" onClick="logVariable('stepdata')" href="../../_variables/stepdata.html">$stepdata</a> = array();
<a name="l1541"><span class="linenum">1541</span></a>  
<a name="l1542"><span class="linenum">1542</span></a>          foreach (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stepsmodified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/stepsmodified.html">stepsmodified</a> as <a class="var it9246" onMouseOver="hilite(9246)" onMouseOut="lolite()" onClick="logVariable('stepinfo')" href="../../_variables/stepinfo.html">$stepinfo</a>) {
<a name="l1543"><span class="linenum">1543</span></a>              <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>, <a class="var it9202" onMouseOver="hilite(9202)" onMouseOut="lolite()" onClick="logVariable('questionattemptid')" href="../../_variables/questionattemptid.html">$questionattemptid</a>, <a class="var it3067" onMouseOver="hilite(3067)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../_variables/seq.html">$seq</a>) = <a class="var it9246" onMouseOver="hilite(9246)" onMouseOut="lolite()" onClick="logVariable('stepinfo')" href="../../_variables/stepinfo.html">$stepinfo</a>;
<a name="l1544"><span class="linenum">1544</span></a>              <a class="var it4603" onMouseOver="hilite(4603)" onMouseOut="lolite()" onClick="logVariable('stepdata')" href="../../_variables/stepdata.html">$stepdata</a>[] = <a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('dm')" href="../../_variables/dm.html">$dm</a>-&gt;<a class="function" onClick="logFunction('update_question_attempt_step')" href="../../_functions/update_question_attempt_step.html" onMouseOver="funcPopup(event,'update_question_attempt_step')">update_question_attempt_step</a>(
<a name="l1545"><span class="linenum">1545</span></a>                      <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>, <a class="var it9202" onMouseOver="hilite(9202)" onMouseOut="lolite()" onClick="logVariable('questionattemptid')" href="../../_variables/questionattemptid.html">$questionattemptid</a>, <a class="var it3067" onMouseOver="hilite(3067)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../_variables/seq.html">$seq</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('quba')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/quba.html">quba</a>-&gt;<a class="function" onClick="logFunction('get_owning_context')" href="../../_functions/get_owning_context.html" onMouseOver="funcPopup(event,'get_owning_context')">get_owning_context</a>());
<a name="l1546"><span class="linenum">1546</span></a>          }
<a name="l1547"><span class="linenum">1547</span></a>  
<a name="l1548"><span class="linenum">1548</span></a>          foreach (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stepsadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/stepsadded.html">stepsadded</a> as <a class="var it9246" onMouseOver="hilite(9246)" onMouseOut="lolite()" onClick="logVariable('stepinfo')" href="../../_variables/stepinfo.html">$stepinfo</a>) {
<a name="l1549"><span class="linenum">1549</span></a>              <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>, <a class="var it9202" onMouseOver="hilite(9202)" onMouseOut="lolite()" onClick="logVariable('questionattemptid')" href="../../_variables/questionattemptid.html">$questionattemptid</a>, <a class="var it3067" onMouseOver="hilite(3067)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../_variables/seq.html">$seq</a>) = <a class="var it9246" onMouseOver="hilite(9246)" onMouseOut="lolite()" onClick="logVariable('stepinfo')" href="../../_variables/stepinfo.html">$stepinfo</a>;
<a name="l1550"><span class="linenum">1550</span></a>              <a class="var it4603" onMouseOver="hilite(4603)" onMouseOut="lolite()" onClick="logVariable('stepdata')" href="../../_variables/stepdata.html">$stepdata</a>[] = <a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('dm')" href="../../_variables/dm.html">$dm</a>-&gt;<a class="function" onClick="logFunction('insert_question_attempt_step')" href="../../_functions/insert_question_attempt_step.html" onMouseOver="funcPopup(event,'insert_question_attempt_step')">insert_question_attempt_step</a>(
<a name="l1551"><span class="linenum">1551</span></a>                      <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>, <a class="var it9202" onMouseOver="hilite(9202)" onMouseOut="lolite()" onClick="logVariable('questionattemptid')" href="../../_variables/questionattemptid.html">$questionattemptid</a>, <a class="var it3067" onMouseOver="hilite(3067)" onMouseOut="lolite()" onClick="logVariable('seq')" href="../../_variables/seq.html">$seq</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('quba')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/quba.html">quba</a>-&gt;<a class="function" onClick="logFunction('get_owning_context')" href="../../_functions/get_owning_context.html" onMouseOver="funcPopup(event,'get_owning_context')">get_owning_context</a>());
<a name="l1552"><span class="linenum">1552</span></a>          }
<a name="l1553"><span class="linenum">1553</span></a>  
<a name="l1554"><span class="linenum">1554</span></a>          foreach (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('attemptsmodified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/attemptsmodified.html">attemptsmodified</a> as <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>) {
<a name="l1555"><span class="linenum">1555</span></a>              <a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('dm')" href="../../_variables/dm.html">$dm</a>-&gt;<a class="function" onClick="logFunction('update_question_attempt')" href="../../_functions/update_question_attempt.html" onMouseOver="funcPopup(event,'update_question_attempt')">update_question_attempt</a>(<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>);
<a name="l1556"><span class="linenum">1556</span></a>          }
<a name="l1557"><span class="linenum">1557</span></a>  
<a name="l1558"><span class="linenum">1558</span></a>          foreach (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('attemptsadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/attemptsadded.html">attemptsadded</a> as <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>) {
<a name="l1559"><span class="linenum">1559</span></a>              <a class="var it4603" onMouseOver="hilite(4603)" onMouseOut="lolite()" onClick="logVariable('stepdata')" href="../../_variables/stepdata.html">$stepdata</a>[] = <a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('dm')" href="../../_variables/dm.html">$dm</a>-&gt;<a class="function" onClick="logFunction('insert_question_attempt')" href="../../_functions/insert_question_attempt.html" onMouseOver="funcPopup(event,'insert_question_attempt')">insert_question_attempt</a>(
<a name="l1560"><span class="linenum">1560</span></a>                      <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('quba')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/quba.html">quba</a>-&gt;<a class="function" onClick="logFunction('get_owning_context')" href="../../_functions/get_owning_context.html" onMouseOver="funcPopup(event,'get_owning_context')">get_owning_context</a>());
<a name="l1561"><span class="linenum">1561</span></a>          }
<a name="l1562"><span class="linenum">1562</span></a>  
<a name="l1563"><span class="linenum">1563</span></a>          foreach (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('metadataadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/metadataadded.html">metadataadded</a> as <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>) {
<a name="l1564"><span class="linenum">1564</span></a>              <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>);
<a name="l1565"><span class="linenum">1565</span></a>              <a class="var it4603" onMouseOver="hilite(4603)" onMouseOut="lolite()" onClick="logVariable('stepdata')" href="../../_variables/stepdata.html">$stepdata</a>[] = <a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('dm')" href="../../_variables/dm.html">$dm</a>-&gt;<a class="function" onClick="logFunction('insert_question_attempt_metadata')" href="../../_functions/insert_question_attempt_metadata.html" onMouseOver="funcPopup(event,'insert_question_attempt_metadata')">insert_question_attempt_metadata</a>(<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>, <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>));
<a name="l1566"><span class="linenum">1566</span></a>          }
<a name="l1567"><span class="linenum">1567</span></a>  
<a name="l1568"><span class="linenum">1568</span></a>          foreach (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('metadatamodified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/metadatamodified.html">metadatamodified</a> as <a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>) {
<a name="l1569"><span class="linenum">1569</span></a>              <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a> = <a class="phpfunction" onClick="logFunction('reset')" href="../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>(<a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>);
<a name="l1570"><span class="linenum">1570</span></a>              <a class="var it4603" onMouseOver="hilite(4603)" onMouseOut="lolite()" onClick="logVariable('stepdata')" href="../../_variables/stepdata.html">$stepdata</a>[] = <a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('dm')" href="../../_variables/dm.html">$dm</a>-&gt;<a class="function" onClick="logFunction('update_question_attempt_metadata')" href="../../_functions/update_question_attempt_metadata.html" onMouseOver="funcPopup(event,'update_question_attempt_metadata')">update_question_attempt_metadata</a>(<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('qa')" href="../../_variables/qa.html">$qa</a>, <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it506" onMouseOver="hilite(506)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>));
<a name="l1571"><span class="linenum">1571</span></a>          }
<a name="l1572"><span class="linenum">1572</span></a>  
<a name="l1573"><span class="linenum">1573</span></a>          if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('modified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/modified.html">modified</a>) {
<a name="l1574"><span class="linenum">1574</span></a>              <a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('dm')" href="../../_variables/dm.html">$dm</a>-&gt;<a class="function" onClick="logFunction('update_questions_usage_by_activity')" href="../../_functions/update_questions_usage_by_activity.html" onMouseOver="funcPopup(event,'update_questions_usage_by_activity')">update_questions_usage_by_activity</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('quba')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/quba.html">quba</a>);
<a name="l1575"><span class="linenum">1575</span></a>          }
<a name="l1576"><span class="linenum">1576</span></a>  
<a name="l1577"><span class="linenum">1577</span></a>          if (<a class="var it4603" onMouseOver="hilite(4603)" onMouseOut="lolite()" onClick="logVariable('stepdata')" href="../../_variables/stepdata.html">$stepdata</a>) {
<a name="l1578"><span class="linenum">1578</span></a>              <a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('dm')" href="../../_variables/dm.html">$dm</a>-&gt;<a class="function" onClick="logFunction('insert_all_step_data')" href="../../_functions/insert_all_step_data.html" onMouseOver="funcPopup(event,'insert_all_step_data')">insert_all_step_data</a>(<a class="phpfunction" onClick="logFunction('call_user_func_array')" href="../../_functions/call_user_func_array.html" onMouseOver="phpfuncPopup(event,'call_user_func_array')">call_user_func_array</a>('array_merge', <a class="var it4603" onMouseOver="hilite(4603)" onMouseOut="lolite()" onClick="logVariable('stepdata')" href="../../_variables/stepdata.html">$stepdata</a>));
<a name="l1579"><span class="linenum">1579</span></a>          }
<a name="l1580"><span class="linenum">1580</span></a>  
<a name="l1581"><span class="linenum">1581</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stepsdeleted')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/stepsdeleted.html">stepsdeleted</a> = array();
<a name="l1582"><span class="linenum">1582</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stepsmodified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/stepsmodified.html">stepsmodified</a> = array();
<a name="l1583"><span class="linenum">1583</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('stepsadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/stepsadded.html">stepsadded</a> = array();
<a name="l1584"><span class="linenum">1584</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('attemptsdeleted')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/attemptsdeleted.html">attemptsdeleted</a> = array();
<a name="l1585"><span class="linenum">1585</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('attemptsadded')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/attemptsadded.html">attemptsadded</a> = array();
<a name="l1586"><span class="linenum">1586</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('attemptsmodified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/attemptsmodified.html">attemptsmodified</a> = array();
<a name="l1587"><span class="linenum">1587</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('modified')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/modified.html">modified</a> = false;
<a name="l1588"><span class="linenum">1588</span></a>      }
<a name="l1589"><span class="linenum">1589</span></a>  }
<a name="l1590"><span class="linenum">1590</span></a>  
<a name="l1591"><span class="linenum">1591</span></a>  
<a name="l1592"><span class="linenum">1592</span></a>  <span class="comment">/**</span>
<a name="l1593"><span class="linenum">1593</span></a>  <span class="comment"> * The interface implemented by {@link question_file_saver} and {@link question_file_loader}.</span>
<a name="l1594"><span class="linenum">1594</span></a>  <span class="comment"> *</span>
<a name="l1595"><span class="linenum">1595</span></a>  <span class="comment"> * @copyright  2012 The Open University</span>
<a name="l1596"><span class="linenum">1596</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l1597"><span class="linenum">1597</span></a>  <span class="comment"> */</span>
<a name="l1598"><span class="linenum">1598</span></a>  <span class="keyword">interface </span><a class="class" onClick="logClass('question_response_files')" href="../../_classes/question_response_files.html" onMouseOver="classPopup(event,'question_response_files')">question_response_files</a> {
<a name="l1599"><span class="linenum">1599</span></a>      <span class="comment">/**</span>
<a name="l1600"><span class="linenum">1600</span></a>  <span class="comment">     * Get the files that were submitted.</span>
<a name="l1601"><span class="linenum">1601</span></a>  <span class="comment">     * @return array of stored_files objects.</span>
<a name="l1602"><span class="linenum">1602</span></a>  <span class="comment">     */</span>
<a name="l1603"><span class="linenum">1603</span></a>      public function <a class="function" onClick="logFunction('get_files')" href="../../_functions/get_files.html" onMouseOver="funcPopup(event,'get_files')">get_files</a>();
<a name="l1604"><span class="linenum">1604</span></a>  }
<a name="l1605"><span class="linenum">1605</span></a>  
<a name="l1606"><span class="linenum">1606</span></a>  
<a name="l1607"><span class="linenum">1607</span></a>  <span class="comment">/**</span>
<a name="l1608"><span class="linenum">1608</span></a>  <span class="comment"> * This class represents the promise to save some files from a particular draft</span>
<a name="l1609"><span class="linenum">1609</span></a>  <span class="comment"> * file area into a particular file area. It is used beause the necessary</span>
<a name="l1610"><span class="linenum">1610</span></a>  <span class="comment"> * information about what to save is to hand in the</span>
<a name="l1611"><span class="linenum">1611</span></a>  <span class="comment"> * {@link question_attempt::process_response_files()} method, but we don't know</span>
<a name="l1612"><span class="linenum">1612</span></a>  <span class="comment"> * if this question attempt will actually be saved in the database until later,</span>
<a name="l1613"><span class="linenum">1613</span></a>  <span class="comment"> * when the {@link question_engine_unit_of_work} is saved, if it is.</span>
<a name="l1614"><span class="linenum">1614</span></a>  <span class="comment"> *</span>
<a name="l1615"><span class="linenum">1615</span></a>  <span class="comment"> * @copyright  2011 The Open University</span>
<a name="l1616"><span class="linenum">1616</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l1617"><span class="linenum">1617</span></a>  <span class="comment"> */</span>
<a name="l1618"><span class="linenum">1618</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('question_file_saver')" href="../../_classes/question_file_saver.html" onMouseOver="classPopup(event,'question_file_saver')">question_file_saver</a> <span class="keyword">implements</span> <a class="class" onClick="logClass('question_response_files')" href="../../_classes/question_response_files.html" onMouseOver="classPopup(event,'question_response_files')">question_response_files</a> {
<a name="l1619"><span class="linenum">1619</span></a>  <span class="comment">    /** @var int the id of the draft file area to save files from. */</span>
<a name="l1620"><span class="linenum">1620</span></a>      protected <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('draftitemid')" href="../../_variables/draftitemid.html">$draftitemid</a>;
<a name="l1621"><span class="linenum">1621</span></a>  <span class="comment">    /** @var string the owning component name. */</span>
<a name="l1622"><span class="linenum">1622</span></a>      protected <a class="var it227" onMouseOver="hilite(227)" onMouseOut="lolite()" onClick="logVariable('component')" href="../../_variables/component.html">$component</a>;
<a name="l1623"><span class="linenum">1623</span></a>  <span class="comment">    /** @var string the file area name. */</span>
<a name="l1624"><span class="linenum">1624</span></a>      protected <a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('filearea')" href="../../_variables/filearea.html">$filearea</a>;
<a name="l1625"><span class="linenum">1625</span></a>  
<a name="l1626"><span class="linenum">1626</span></a>      <span class="comment">/**</span>
<a name="l1627"><span class="linenum">1627</span></a>  <span class="comment">     * @var string the value to store in the question_attempt_step_data to</span>
<a name="l1628"><span class="linenum">1628</span></a>  <span class="comment">     * represent these files.</span>
<a name="l1629"><span class="linenum">1629</span></a>  <span class="comment">     */</span>
<a name="l1630"><span class="linenum">1630</span></a>      protected <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = null;
<a name="l1631"><span class="linenum">1631</span></a>  
<a name="l1632"><span class="linenum">1632</span></a>      <span class="comment">/**</span>
<a name="l1633"><span class="linenum">1633</span></a>  <span class="comment">     * Constuctor.</span>
<a name="l1634"><span class="linenum">1634</span></a>  <span class="comment">     * @param int $draftitemid the draft area to save the files from.</span>
<a name="l1635"><span class="linenum">1635</span></a>  <span class="comment">     * @param string $component the component for the file area to save into.</span>
<a name="l1636"><span class="linenum">1636</span></a>  <span class="comment">     * @param string $filearea the name of the file area to save into.</span>
<a name="l1637"><span class="linenum">1637</span></a>  <span class="comment">     */</span>
<a name="l1638"><span class="linenum">1638</span></a>      public function <a class="function" onClick="logFunction('__construct')" href="../../_functions/__construct.html" onMouseOver="funcPopup(event,'__construct')">__construct</a>(<a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('draftitemid')" href="../../_variables/draftitemid.html">$draftitemid</a>, <a class="var it227" onMouseOver="hilite(227)" onMouseOut="lolite()" onClick="logVariable('component')" href="../../_variables/component.html">$component</a>, <a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('filearea')" href="../../_variables/filearea.html">$filearea</a>, <a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = null) {
<a name="l1639"><span class="linenum">1639</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('draftitemid')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/draftitemid.html">draftitemid</a> = <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('draftitemid')" href="../../_variables/draftitemid.html">$draftitemid</a>;
<a name="l1640"><span class="linenum">1640</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('component')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/component.html">component</a> = <a class="var it227" onMouseOver="hilite(227)" onMouseOut="lolite()" onClick="logVariable('component')" href="../../_variables/component.html">$component</a>;
<a name="l1641"><span class="linenum">1641</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('filearea')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/filearea.html">filearea</a> = <a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('filearea')" href="../../_variables/filearea.html">$filearea</a>;
<a name="l1642"><span class="linenum">1642</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('value')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/value.html">value</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('compute_value')" href="../../_functions/compute_value.html" onMouseOver="funcPopup(event,'compute_value')">compute_value</a>(<a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('draftitemid')" href="../../_variables/draftitemid.html">$draftitemid</a>, <a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l1643"><span class="linenum">1643</span></a>      }
<a name="l1644"><span class="linenum">1644</span></a>  
<a name="l1645"><span class="linenum">1645</span></a>      <span class="comment">/**</span>
<a name="l1646"><span class="linenum">1646</span></a>  <span class="comment">     * Compute the value that should be stored in the question_attempt_step_data</span>
<a name="l1647"><span class="linenum">1647</span></a>  <span class="comment">     * table. Contains a hash that (almost) uniquely encodes all the files.</span>
<a name="l1648"><span class="linenum">1648</span></a>  <span class="comment">     * @param int $draftitemid the draft file area itemid.</span>
<a name="l1649"><span class="linenum">1649</span></a>  <span class="comment">     * @param string $text optional content containing file links.</span>
<a name="l1650"><span class="linenum">1650</span></a>  <span class="comment">     */</span>
<a name="l1651"><span class="linenum">1651</span></a>      protected function <a class="function" onClick="logFunction('compute_value')" href="../../_functions/compute_value.html" onMouseOver="funcPopup(event,'compute_value')">compute_value</a>(<a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('draftitemid')" href="../../_variables/draftitemid.html">$draftitemid</a>, <a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) {
<a name="l1652"><span class="linenum">1652</span></a>          global <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>;
<a name="l1653"><span class="linenum">1653</span></a>  
<a name="l1654"><span class="linenum">1654</span></a>          <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a> = <a class="function" onClick="logFunction('get_file_storage')" href="../../_functions/get_file_storage.html" onMouseOver="funcPopup(event,'get_file_storage')">get_file_storage</a>();
<a name="l1655"><span class="linenum">1655</span></a>          <a class="var it639" onMouseOver="hilite(639)" onMouseOut="lolite()" onClick="logVariable('usercontext')" href="../../_variables/usercontext.html">$usercontext</a> = <a class="class" onClick="logClass('context_user')" href="../../_classes/context_user.html" onMouseOver="classPopup(event,'context_user')">context_user</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l1656"><span class="linenum">1656</span></a>  
<a name="l1657"><span class="linenum">1657</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('files')" href="../../_variables/files.html">$files</a> = <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('get_area_files')" href="../../_functions/get_area_files.html" onMouseOver="funcPopup(event,'get_area_files')">get_area_files</a>(<a class="var it639" onMouseOver="hilite(639)" onMouseOut="lolite()" onClick="logVariable('usercontext')" href="../../_variables/usercontext.html">$usercontext</a>-&gt;<a onClick="logVariable('id')" class="var it43024" onMouseOver="hilite(43024)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'user', 'draft',
<a name="l1658"><span class="linenum">1658</span></a>                  <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('draftitemid')" href="../../_variables/draftitemid.html">$draftitemid</a>, 'sortorder, filepath, filename', false);
<a name="l1659"><span class="linenum">1659</span></a>  
<a name="l1660"><span class="linenum">1660</span></a>          <a class="var it126" onMouseOver="hilite(126)" onMouseOut="lolite()" onClick="logVariable('string')" href="../../_variables/string.html">$string</a> = '';
<a name="l1661"><span class="linenum">1661</span></a>          foreach (<a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('files')" href="../../_variables/files.html">$files</a> as <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a>) {
<a name="l1662"><span class="linenum">1662</span></a>              <a class="var it126" onMouseOver="hilite(126)" onMouseOut="lolite()" onClick="logVariable('string')" href="../../_variables/string.html">$string</a> .= <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a>-&gt;<a class="function" onClick="logFunction('get_filepath')" href="../../_functions/get_filepath.html" onMouseOver="funcPopup(event,'get_filepath')">get_filepath</a>() . <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a>-&gt;<a class="function" onClick="logFunction('get_filename')" href="../../_functions/get_filename.html" onMouseOver="funcPopup(event,'get_filename')">get_filename</a>() . '|' .
<a name="l1663"><span class="linenum">1663</span></a>                      <a class="var it297" onMouseOver="hilite(297)" onMouseOut="lolite()" onClick="logVariable('file')" href="../../_variables/file.html">$file</a>-&gt;<a class="function" onClick="logFunction('get_contenthash')" href="../../_functions/get_contenthash.html" onMouseOver="funcPopup(event,'get_contenthash')">get_contenthash</a>() . '|';
<a name="l1664"><span class="linenum">1664</span></a>          }
<a name="l1665"><span class="linenum">1665</span></a>          <a class="var it928" onMouseOver="hilite(928)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../../_variables/hash.html">$hash</a> = md5(<a class="var it126" onMouseOver="hilite(126)" onMouseOut="lolite()" onClick="logVariable('string')" href="../../_variables/string.html">$string</a>);
<a name="l1666"><span class="linenum">1666</span></a>  
<a name="l1667"><span class="linenum">1667</span></a>          if (<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>)) {
<a name="l1668"><span class="linenum">1668</span></a>              if (<a class="var it126" onMouseOver="hilite(126)" onMouseOut="lolite()" onClick="logVariable('string')" href="../../_variables/string.html">$string</a>) {
<a name="l1669"><span class="linenum">1669</span></a>                  return <a class="var it928" onMouseOver="hilite(928)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../../_variables/hash.html">$hash</a>;
<a name="l1670"><span class="linenum">1670</span></a>              } else {
<a name="l1671"><span class="linenum">1671</span></a>                  return '';
<a name="l1672"><span class="linenum">1672</span></a>              }
<a name="l1673"><span class="linenum">1673</span></a>          }
<a name="l1674"><span class="linenum">1674</span></a>  
<a name="l1675"><span class="linenum">1675</span></a>  <span class="comment">        // We add the file hash so a simple string comparison will say if the</span>
<a name="l1676"><span class="linenum">1676</span></a>  <span class="comment">        // files have been changed. First strip off any existing file hash.</span>
<a name="l1677"><span class="linenum">1677</span></a>          if (<a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> !== '') {
<a name="l1678"><span class="linenum">1678</span></a>              <a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/\s*&lt;!-- File hash: \w+ --&gt;\s*$/', '', <a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l1679"><span class="linenum">1679</span></a>              <a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="function" onClick="logFunction('file_rewrite_urls_to_pluginfile')" href="../../_functions/file_rewrite_urls_to_pluginfile.html" onMouseOver="funcPopup(event,'file_rewrite_urls_to_pluginfile')">file_rewrite_urls_to_pluginfile</a>(<a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, <a class="var it637" onMouseOver="hilite(637)" onMouseOut="lolite()" onClick="logVariable('draftitemid')" href="../../_variables/draftitemid.html">$draftitemid</a>);
<a name="l1680"><span class="linenum">1680</span></a>              if (<a class="var it126" onMouseOver="hilite(126)" onMouseOut="lolite()" onClick="logVariable('string')" href="../../_variables/string.html">$string</a>) {
<a name="l1681"><span class="linenum">1681</span></a>                  <a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= '&lt;!-- File hash: ' . <a class="var it928" onMouseOver="hilite(928)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../../_variables/hash.html">$hash</a> . ' --&gt;';
<a name="l1682"><span class="linenum">1682</span></a>              }
<a name="l1683"><span class="linenum">1683</span></a>          }
<a name="l1684"><span class="linenum">1684</span></a>          return <a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l1685"><span class="linenum">1685</span></a>      }
<a name="l1686"><span class="linenum">1686</span></a>  
<a name="l1687"><span class="linenum">1687</span></a>      public function <a class="function" onClick="logFunction('__toString')" href="../../_functions/__tostring.html" onMouseOver="funcPopup(event,'__tostring')">__toString</a>() {
<a name="l1688"><span class="linenum">1688</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('value')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/value.html">value</a>;
<a name="l1689"><span class="linenum">1689</span></a>      }
<a name="l1690"><span class="linenum">1690</span></a>  
<a name="l1691"><span class="linenum">1691</span></a>      <span class="comment">/**</span>
<a name="l1692"><span class="linenum">1692</span></a>  <span class="comment">     * Actually save the files.</span>
<a name="l1693"><span class="linenum">1693</span></a>  <span class="comment">     * @param integer $itemid the item id for the file area to save into.</span>
<a name="l1694"><span class="linenum">1694</span></a>  <span class="comment">     */</span>
<a name="l1695"><span class="linenum">1695</span></a>      public function <a class="function" onClick="logFunction('save_files')" href="../../_functions/save_files.html" onMouseOver="funcPopup(event,'save_files')">save_files</a>(<a class="var it868" onMouseOver="hilite(868)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>) {
<a name="l1696"><span class="linenum">1696</span></a>          <a class="function" onClick="logFunction('file_save_draft_area_files')" href="../../_functions/file_save_draft_area_files.html" onMouseOver="funcPopup(event,'file_save_draft_area_files')">file_save_draft_area_files</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('draftitemid')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/draftitemid.html">draftitemid</a>, <a class="var it23" onMouseOver="hilite(23)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../_variables/context.html">$context</a>-&gt;<a onClick="logVariable('id')" class="var it42918" onMouseOver="hilite(42918)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>,
<a name="l1697"><span class="linenum">1697</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('component')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/component.html">component</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('filearea')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/filearea.html">filearea</a>, <a class="var it868" onMouseOver="hilite(868)" onMouseOut="lolite()" onClick="logVariable('itemid')" href="../../_variables/itemid.html">$itemid</a>);
<a name="l1698"><span class="linenum">1698</span></a>      }
<a name="l1699"><span class="linenum">1699</span></a>  
<a name="l1700"><span class="linenum">1700</span></a>      <span class="comment">/**</span>
<a name="l1701"><span class="linenum">1701</span></a>  <span class="comment">     * Get the files that were submitted.</span>
<a name="l1702"><span class="linenum">1702</span></a>  <span class="comment">     * @return array of stored_files objects.</span>
<a name="l1703"><span class="linenum">1703</span></a>  <span class="comment">     */</span>
<a name="l1704"><span class="linenum">1704</span></a>      public function <a class="function" onClick="logFunction('get_files')" href="../../_functions/get_files.html" onMouseOver="funcPopup(event,'get_files')">get_files</a>() {
<a name="l1705"><span class="linenum">1705</span></a>          global <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>;
<a name="l1706"><span class="linenum">1706</span></a>  
<a name="l1707"><span class="linenum">1707</span></a>          <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a> = <a class="function" onClick="logFunction('get_file_storage')" href="../../_functions/get_file_storage.html" onMouseOver="funcPopup(event,'get_file_storage')">get_file_storage</a>();
<a name="l1708"><span class="linenum">1708</span></a>          <a class="var it639" onMouseOver="hilite(639)" onMouseOut="lolite()" onClick="logVariable('usercontext')" href="../../_variables/usercontext.html">$usercontext</a> = <a class="class" onClick="logClass('context_user')" href="../../_classes/context_user.html" onMouseOver="classPopup(event,'context_user')">context_user</a>::<a class="function" onClick="logFunction('instance')" href="../../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../../_variables/USER.html">$USER</a>-&gt;<a onClick="logVariable('id')" class="var it42989" onMouseOver="hilite(42989)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>);
<a name="l1709"><span class="linenum">1709</span></a>  
<a name="l1710"><span class="linenum">1710</span></a>          return <a class="var it640" onMouseOver="hilite(640)" onMouseOut="lolite()" onClick="logVariable('fs')" href="../../_variables/fs.html">$fs</a>-&gt;<a class="function" onClick="logFunction('get_area_files')" href="../../_functions/get_area_files.html" onMouseOver="funcPopup(event,'get_area_files')">get_area_files</a>(<a class="var it639" onMouseOver="hilite(639)" onMouseOut="lolite()" onClick="logVariable('usercontext')" href="../../_variables/usercontext.html">$usercontext</a>-&gt;<a onClick="logVariable('id')" class="var it43024" onMouseOver="hilite(43024)" onMouseOut="lolite()" href="../../_variables/id.html">id</a>, 'user', 'draft',
<a name="l1711"><span class="linenum">1711</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('draftitemid')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/draftitemid.html">draftitemid</a>, 'sortorder, filepath, filename', false);
<a name="l1712"><span class="linenum">1712</span></a>      }
<a name="l1713"><span class="linenum">1713</span></a>  }
<a name="l1714"><span class="linenum">1714</span></a>  
<a name="l1715"><span class="linenum">1715</span></a>  
<a name="l1716"><span class="linenum">1716</span></a>  <span class="comment">/**</span>
<a name="l1717"><span class="linenum">1717</span></a>  <span class="comment"> * This class is the mirror image of {@link question_file_saver}. It allows</span>
<a name="l1718"><span class="linenum">1718</span></a>  <span class="comment"> * files to be accessed again later (e.g. when re-grading) using that same</span>
<a name="l1719"><span class="linenum">1719</span></a>  <span class="comment"> * API as when doing the original grading.</span>
<a name="l1720"><span class="linenum">1720</span></a>  <span class="comment"> *</span>
<a name="l1721"><span class="linenum">1721</span></a>  <span class="comment"> * @copyright  2012 The Open University</span>
<a name="l1722"><span class="linenum">1722</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l1723"><span class="linenum">1723</span></a>  <span class="comment"> */</span>
<a name="l1724"><span class="linenum">1724</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('question_file_loader')" href="../../_classes/question_file_loader.html" onMouseOver="classPopup(event,'question_file_loader')">question_file_loader</a> <span class="keyword">implements</span> <a class="class" onClick="logClass('question_response_files')" href="../../_classes/question_response_files.html" onMouseOver="classPopup(event,'question_response_files')">question_response_files</a> {
<a name="l1725"><span class="linenum">1725</span></a>  <span class="comment">    /** @var question_attempt_step the step that these files belong to. */</span>
<a name="l1726"><span class="linenum">1726</span></a>      protected <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>;
<a name="l1727"><span class="linenum">1727</span></a>  
<a name="l1728"><span class="linenum">1728</span></a>  <span class="comment">    /** @var string the field name for these files - which is used to construct the file area name. */</span>
<a name="l1729"><span class="linenum">1729</span></a>      protected <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>;
<a name="l1730"><span class="linenum">1730</span></a>  
<a name="l1731"><span class="linenum">1731</span></a>      <span class="comment">/**</span>
<a name="l1732"><span class="linenum">1732</span></a>  <span class="comment">     * @var string the value to stored in the question_attempt_step_data to</span>
<a name="l1733"><span class="linenum">1733</span></a>  <span class="comment">     * represent these files.</span>
<a name="l1734"><span class="linenum">1734</span></a>  <span class="comment">     */</span>
<a name="l1735"><span class="linenum">1735</span></a>      protected <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l1736"><span class="linenum">1736</span></a>  
<a name="l1737"><span class="linenum">1737</span></a>  <span class="comment">    /** @var int the context id that the files belong to. */</span>
<a name="l1738"><span class="linenum">1738</span></a>      protected <a class="var it782" onMouseOver="hilite(782)" onMouseOut="lolite()" onClick="logVariable('contextid')" href="../../_variables/contextid.html">$contextid</a>;
<a name="l1739"><span class="linenum">1739</span></a>  
<a name="l1740"><span class="linenum">1740</span></a>      <span class="comment">/**</span>
<a name="l1741"><span class="linenum">1741</span></a>  <span class="comment">     * Constuctor.</span>
<a name="l1742"><span class="linenum">1742</span></a>  <span class="comment">     * @param question_attempt_step $step the step that these files belong to.</span>
<a name="l1743"><span class="linenum">1743</span></a>  <span class="comment">     * @param string $name string the field name for these files - which is used to construct the file area name.</span>
<a name="l1744"><span class="linenum">1744</span></a>  <span class="comment">     * @param string $value the value to stored in the question_attempt_step_data to</span>
<a name="l1745"><span class="linenum">1745</span></a>  <span class="comment">     *      represent these files.</span>
<a name="l1746"><span class="linenum">1746</span></a>  <span class="comment">     * @param int $contextid the context id that the files belong to.</span>
<a name="l1747"><span class="linenum">1747</span></a>  <span class="comment">     */</span>
<a name="l1748"><span class="linenum">1748</span></a>      public function <a class="function" onClick="logFunction('__construct')" href="../../_functions/__construct.html" onMouseOver="funcPopup(event,'__construct')">__construct</a>(question_attempt_step <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>, <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>, <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>, <a class="var it782" onMouseOver="hilite(782)" onMouseOut="lolite()" onClick="logVariable('contextid')" href="../../_variables/contextid.html">$contextid</a>) {
<a name="l1749"><span class="linenum">1749</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('step')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/step.html">step</a> = <a class="var it763" onMouseOver="hilite(763)" onMouseOut="lolite()" onClick="logVariable('step')" href="../../_variables/step.html">$step</a>;
<a name="l1750"><span class="linenum">1750</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('name')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/name.html">name</a> = <a class="var it88" onMouseOver="hilite(88)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>;
<a name="l1751"><span class="linenum">1751</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('value')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/value.html">value</a> = <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l1752"><span class="linenum">1752</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('contextid')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/contextid.html">contextid</a> = <a class="var it782" onMouseOver="hilite(782)" onMouseOut="lolite()" onClick="logVariable('contextid')" href="../../_variables/contextid.html">$contextid</a>;
<a name="l1753"><span class="linenum">1753</span></a>      }
<a name="l1754"><span class="linenum">1754</span></a>  
<a name="l1755"><span class="linenum">1755</span></a>      public function <a class="function" onClick="logFunction('__toString')" href="../../_functions/__tostring.html" onMouseOver="funcPopup(event,'__tostring')">__toString</a>() {
<a name="l1756"><span class="linenum">1756</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('value')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/value.html">value</a>;
<a name="l1757"><span class="linenum">1757</span></a>      }
<a name="l1758"><span class="linenum">1758</span></a>  
<a name="l1759"><span class="linenum">1759</span></a>      <span class="comment">/**</span>
<a name="l1760"><span class="linenum">1760</span></a>  <span class="comment">     * Get the files that were submitted.</span>
<a name="l1761"><span class="linenum">1761</span></a>  <span class="comment">     * @return array of stored_files objects.</span>
<a name="l1762"><span class="linenum">1762</span></a>  <span class="comment">     */</span>
<a name="l1763"><span class="linenum">1763</span></a>      public function <a class="function" onClick="logFunction('get_files')" href="../../_functions/get_files.html" onMouseOver="funcPopup(event,'get_files')">get_files</a>() {
<a name="l1764"><span class="linenum">1764</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('step')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/step.html">step</a>-&gt;<a class="function" onClick="logFunction('get_qt_files')" href="../../_functions/get_qt_files.html" onMouseOver="funcPopup(event,'get_qt_files')">get_qt_files</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('name')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('contextid')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/contextid.html">contextid</a>);
<a name="l1765"><span class="linenum">1765</span></a>      }
<a name="l1766"><span class="linenum">1766</span></a>  
<a name="l1767"><span class="linenum">1767</span></a>      <span class="comment">/**</span>
<a name="l1768"><span class="linenum">1768</span></a>  <span class="comment">     * Copy these files into a draft area, and return the corresponding</span>
<a name="l1769"><span class="linenum">1769</span></a>  <span class="comment">     * {@link question_file_saver} that can save them again.</span>
<a name="l1770"><span class="linenum">1770</span></a>  <span class="comment">     *</span>
<a name="l1771"><span class="linenum">1771</span></a>  <span class="comment">     * This is used by {@link question_attempt::start_based_on()}, which is used</span>
<a name="l1772"><span class="linenum">1772</span></a>  <span class="comment">     * (for example) by the quizzes 'Each attempt builds on last' feature.</span>
<a name="l1773"><span class="linenum">1773</span></a>  <span class="comment">     *</span>
<a name="l1774"><span class="linenum">1774</span></a>  <span class="comment">     * @return question_file_saver that can re-save these files again.</span>
<a name="l1775"><span class="linenum">1775</span></a>  <span class="comment">     */</span>
<a name="l1776"><span class="linenum">1776</span></a>      public function <a class="function" onClick="logFunction('get_question_file_saver')" href="../../_functions/get_question_file_saver.html" onMouseOver="funcPopup(event,'get_question_file_saver')">get_question_file_saver</a>() {
<a name="l1777"><span class="linenum">1777</span></a>  
<a name="l1778"><span class="linenum">1778</span></a>  <span class="comment">        // There are three possibilities here for what $value will look like:</span>
<a name="l1779"><span class="linenum">1779</span></a>  <span class="comment">        // 1) some HTML content followed by an MD5 hash in a HTML comment;</span>
<a name="l1780"><span class="linenum">1780</span></a>  <span class="comment">        // 2) a plain MD5 hash;</span>
<a name="l1781"><span class="linenum">1781</span></a>  <span class="comment">        // 3) or some real content, without any hash.</span>
<a name="l1782"><span class="linenum">1782</span></a>  <span class="comment">        // The problem is that 3) is ambiguous in the case where a student writes</span>
<a name="l1783"><span class="linenum">1783</span></a>  <span class="comment">        // a response that looks exactly like an MD5 hash. For attempts made now,</span>
<a name="l1784"><span class="linenum">1784</span></a>  <span class="comment">        // we avoid case 3) by always going for case 1) or 2) (except when the</span>
<a name="l1785"><span class="linenum">1785</span></a>  <span class="comment">        // response is blank. However, there may be case 3) data in the database</span>
<a name="l1786"><span class="linenum">1786</span></a>  <span class="comment">        // so we need to handle it as best we can.</span>
<a name="l1787"><span class="linenum">1787</span></a>          if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/\s*&lt;!-- File hash: [0-9a-zA-Z]{32} --&gt;\s*$/', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('value')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/value.html">value</a>)) {
<a name="l1788"><span class="linenum">1788</span></a>              <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/\s*&lt;!-- File hash: [0-9a-zA-Z]{32} --&gt;\s*$/', '', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('value')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/value.html">value</a>);
<a name="l1789"><span class="linenum">1789</span></a>  
<a name="l1790"><span class="linenum">1790</span></a>          } else if (<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('/^[0-9a-zA-Z]{32}$/', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('value')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/value.html">value</a>)) {
<a name="l1791"><span class="linenum">1791</span></a>              <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = null;
<a name="l1792"><span class="linenum">1792</span></a>  
<a name="l1793"><span class="linenum">1793</span></a>          } else {
<a name="l1794"><span class="linenum">1794</span></a>              <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('value')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/value.html">value</a>;
<a name="l1795"><span class="linenum">1795</span></a>          }
<a name="l1796"><span class="linenum">1796</span></a>  
<a name="l1797"><span class="linenum">1797</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it2102" onMouseOver="hilite(2102)" onMouseOut="lolite()" onClick="logVariable('draftid')" href="../../_variables/draftid.html">$draftid</a>, <a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>) = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('step')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/step.html">step</a>-&gt;<a class="function" onClick="logFunction('prepare_response_files_draft_itemid_with_text')" href="../../_functions/prepare_response_files_draft_itemid_with_text.html" onMouseOver="funcPopup(event,'prepare_response_files_draft_itemid_with_text')">prepare_response_files_draft_itemid_with_text</a>(
<a name="l1798"><span class="linenum">1798</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('name')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('contextid')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/contextid.html">contextid</a>, <a class="var it394" onMouseOver="hilite(394)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>);
<a name="l1799"><span class="linenum">1799</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('question_file_saver')" href="../../_classes/question_file_saver.html" onMouseOver="classPopup(event,'question_file_saver')">question_file_saver</a>(<a class="var it2102" onMouseOver="hilite(2102)" onMouseOut="lolite()" onClick="logVariable('draftid')" href="../../_variables/draftid.html">$draftid</a>, 'question', 'response_' . <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('name')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/name.html">name</a>, <a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>);
<a name="l1800"><span class="linenum">1800</span></a>      }
<a name="l1801"><span class="linenum">1801</span></a>  }
<a name="l1802"><span class="linenum">1802</span></a>  
<a name="l1803"><span class="linenum">1803</span></a>  
<a name="l1804"><span class="linenum">1804</span></a>  <span class="comment">/**</span>
<a name="l1805"><span class="linenum">1805</span></a>  <span class="comment"> * This class represents a restriction on the set of question_usage ids to include</span>
<a name="l1806"><span class="linenum">1806</span></a>  <span class="comment"> * in a larger database query. Depending of the how you are going to restrict the</span>
<a name="l1807"><span class="linenum">1807</span></a>  <span class="comment"> * list of usages, construct an appropriate subclass.</span>
<a name="l1808"><span class="linenum">1808</span></a>  <span class="comment"> *</span>
<a name="l1809"><span class="linenum">1809</span></a>  <span class="comment"> * If $qubaids is an instance of this class, example usage might be</span>
<a name="l1810"><span class="linenum">1810</span></a>  <span class="comment"> *</span>
<a name="l1811"><span class="linenum">1811</span></a>  <span class="comment"> * SELECT qa.id, qa.maxmark</span>
<a name="l1812"><span class="linenum">1812</span></a>  <span class="comment"> * FROM $qubaids-&gt;from_question_attempts('qa')</span>
<a name="l1813"><span class="linenum">1813</span></a>  <span class="comment"> * WHERE $qubaids-&gt;where() AND qa.slot = 1</span>
<a name="l1814"><span class="linenum">1814</span></a>  <span class="comment"> *</span>
<a name="l1815"><span class="linenum">1815</span></a>  <span class="comment"> * @copyright  2010 The Open University</span>
<a name="l1816"><span class="linenum">1816</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l1817"><span class="linenum">1817</span></a>  <span class="comment"> */</span>
<a name="l1818"><span class="linenum">1818</span></a>  abstract class qubaid_condition {
<a name="l1819"><span class="linenum">1819</span></a>  
<a name="l1820"><span class="linenum">1820</span></a>      <span class="comment">/**</span>
<a name="l1821"><span class="linenum">1821</span></a>  <span class="comment">     * @return string the SQL that needs to go in the FROM clause when trying</span>
<a name="l1822"><span class="linenum">1822</span></a>  <span class="comment">     * to select records from the 'question_attempts' table based on the</span>
<a name="l1823"><span class="linenum">1823</span></a>  <span class="comment">     * qubaid_condition.</span>
<a name="l1824"><span class="linenum">1824</span></a>  <span class="comment">     */</span>
<a name="l1825"><span class="linenum">1825</span></a>      public abstract function <a class="function" onClick="logFunction('from_question_attempts')" href="../../_functions/from_question_attempts.html" onMouseOver="funcPopup(event,'from_question_attempts')">from_question_attempts</a>(<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>);
<a name="l1826"><span class="linenum">1826</span></a>  
<a name="l1827"><span class="linenum">1827</span></a>  <span class="comment">    /** @return string the SQL that needs to go in the where clause. */</span>
<a name="l1828"><span class="linenum">1828</span></a>      public abstract function <a class="function" onClick="logFunction('where')" href="../../_functions/where.html" onMouseOver="funcPopup(event,'where')">where</a>();
<a name="l1829"><span class="linenum">1829</span></a>  
<a name="l1830"><span class="linenum">1830</span></a>      <span class="comment">/**</span>
<a name="l1831"><span class="linenum">1831</span></a>  <span class="comment">     * @return the params needed by a query that uses</span>
<a name="l1832"><span class="linenum">1832</span></a>  <span class="comment">     * {@link from_question_attempts()} and {@link where()}.</span>
<a name="l1833"><span class="linenum">1833</span></a>  <span class="comment">     */</span>
<a name="l1834"><span class="linenum">1834</span></a>      public abstract function <a class="function" onClick="logFunction('from_where_params')" href="../../_functions/from_where_params.html" onMouseOver="funcPopup(event,'from_where_params')">from_where_params</a>();
<a name="l1835"><span class="linenum">1835</span></a>  
<a name="l1836"><span class="linenum">1836</span></a>      <span class="comment">/**</span>
<a name="l1837"><span class="linenum">1837</span></a>  <span class="comment">     * @return string SQL that can use used in a WHERE qubaid IN (...) query.</span>
<a name="l1838"><span class="linenum">1838</span></a>  <span class="comment">     * This method returns the &quot;IN (...)&quot; part.</span>
<a name="l1839"><span class="linenum">1839</span></a>  <span class="comment">     */</span>
<a name="l1840"><span class="linenum">1840</span></a>      public abstract function <a class="function" onClick="logFunction('usage_id_in')" href="../../_functions/usage_id_in.html" onMouseOver="funcPopup(event,'usage_id_in')">usage_id_in</a>();
<a name="l1841"><span class="linenum">1841</span></a>  
<a name="l1842"><span class="linenum">1842</span></a>      <span class="comment">/**</span>
<a name="l1843"><span class="linenum">1843</span></a>  <span class="comment">     * @return the params needed by a query that uses {@link usage_id_in()}.</span>
<a name="l1844"><span class="linenum">1844</span></a>  <span class="comment">     */</span>
<a name="l1845"><span class="linenum">1845</span></a>      public abstract function <a class="function" onClick="logFunction('usage_id_in_params')" href="../../_functions/usage_id_in_params.html" onMouseOver="funcPopup(event,'usage_id_in_params')">usage_id_in_params</a>();
<a name="l1846"><span class="linenum">1846</span></a>  
<a name="l1847"><span class="linenum">1847</span></a>      <span class="comment">/**</span>
<a name="l1848"><span class="linenum">1848</span></a>  <span class="comment">     * @return string 40-character hash code that uniquely identifies the combination of properties and class name of this qubaid</span>
<a name="l1849"><span class="linenum">1849</span></a>  <span class="comment">     *                  condition.</span>
<a name="l1850"><span class="linenum">1850</span></a>  <span class="comment">     */</span>
<a name="l1851"><span class="linenum">1851</span></a>      public function <a class="function" onClick="logFunction('get_hash_code')" href="../../_functions/get_hash_code.html" onMouseOver="funcPopup(event,'get_hash_code')">get_hash_code</a>() {
<a name="l1852"><span class="linenum">1852</span></a>          return <a class="phpfunction" onClick="logFunction('sha1')" href="../../_functions/sha1.html" onMouseOver="phpfuncPopup(event,'sha1')">sha1</a>(<a class="phpfunction" onClick="logFunction('serialize')" href="../../_functions/serialize.html" onMouseOver="phpfuncPopup(event,'serialize')">serialize</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>));
<a name="l1853"><span class="linenum">1853</span></a>      }
<a name="l1854"><span class="linenum">1854</span></a>  }
<a name="l1855"><span class="linenum">1855</span></a>  
<a name="l1856"><span class="linenum">1856</span></a>  
<a name="l1857"><span class="linenum">1857</span></a>  <span class="comment">/**</span>
<a name="l1858"><span class="linenum">1858</span></a>  <span class="comment"> * This class represents a restriction on the set of question_usage ids to include</span>
<a name="l1859"><span class="linenum">1859</span></a>  <span class="comment"> * in a larger database query based on an explicit list of ids.</span>
<a name="l1860"><span class="linenum">1860</span></a>  <span class="comment"> *</span>
<a name="l1861"><span class="linenum">1861</span></a>  <span class="comment"> * @copyright  2010 The Open University</span>
<a name="l1862"><span class="linenum">1862</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l1863"><span class="linenum">1863</span></a>  <span class="comment"> */</span>
<a name="l1864"><span class="linenum">1864</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('qubaid_list')" href="../../_classes/qubaid_list.html" onMouseOver="classPopup(event,'qubaid_list')">qubaid_list</a> extends qubaid_condition {
<a name="l1865"><span class="linenum">1865</span></a>  <span class="comment">    /** @var array of ids. */</span>
<a name="l1866"><span class="linenum">1866</span></a>      protected <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>;
<a name="l1867"><span class="linenum">1867</span></a>      protected <a class="var it9248" onMouseOver="hilite(9248)" onMouseOut="lolite()" onClick="logVariable('columntotest')" href="../../_variables/columntotest.html">$columntotest</a> = null;
<a name="l1868"><span class="linenum">1868</span></a>      protected <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>;
<a name="l1869"><span class="linenum">1869</span></a>  
<a name="l1870"><span class="linenum">1870</span></a>      <span class="comment">/**</span>
<a name="l1871"><span class="linenum">1871</span></a>  <span class="comment">     * Constructor.</span>
<a name="l1872"><span class="linenum">1872</span></a>  <span class="comment">     * @param array $qubaids of question usage ids.</span>
<a name="l1873"><span class="linenum">1873</span></a>  <span class="comment">     */</span>
<a name="l1874"><span class="linenum">1874</span></a>      public function <a class="function" onClick="logFunction('__construct')" href="../../_functions/__construct.html" onMouseOver="funcPopup(event,'__construct')">__construct</a>(array <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>) {
<a name="l1875"><span class="linenum">1875</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('qubaids')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/qubaids.html">qubaids</a> = <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('qubaids')" href="../../_variables/qubaids.html">$qubaids</a>;
<a name="l1876"><span class="linenum">1876</span></a>      }
<a name="l1877"><span class="linenum">1877</span></a>  
<a name="l1878"><span class="linenum">1878</span></a>      public function <a class="function" onClick="logFunction('from_question_attempts')" href="../../_functions/from_question_attempts.html" onMouseOver="funcPopup(event,'from_question_attempts')">from_question_attempts</a>(<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>) {
<a name="l1879"><span class="linenum">1879</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('columntotest')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/columntotest.html">columntotest</a> = <a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a> . '.questionusageid';
<a name="l1880"><span class="linenum">1880</span></a>          return '{question_attempts} ' . <a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>;
<a name="l1881"><span class="linenum">1881</span></a>      }
<a name="l1882"><span class="linenum">1882</span></a>  
<a name="l1883"><span class="linenum">1883</span></a>      public function <a class="function" onClick="logFunction('where')" href="../../_functions/where.html" onMouseOver="funcPopup(event,'where')">where</a>() {
<a name="l1884"><span class="linenum">1884</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1885"><span class="linenum">1885</span></a>  
<a name="l1886"><span class="linenum">1886</span></a>          if (<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('columntotest')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/columntotest.html">columntotest</a>)) {
<a name="l1887"><span class="linenum">1887</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('coding_exception')" href="../../_classes/coding_exception.html" onMouseOver="classPopup(event,'coding_exception')">coding_exception</a>('Must call from_question_attempts before <a class="function" onClick="logFunction('where')" href="../../_functions/where.html" onMouseOver="funcPopup(event,'where')">where</a>().');
<a name="l1888"><span class="linenum">1888</span></a>          }
<a name="l1889"><span class="linenum">1889</span></a>          if (empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('qubaids')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/qubaids.html">qubaids</a>)) {
<a name="l1890"><span class="linenum">1890</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('params')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/params.html">params</a> = array();
<a name="l1891"><span class="linenum">1891</span></a>              return '1 = 0';
<a name="l1892"><span class="linenum">1892</span></a>          }
<a name="l1893"><span class="linenum">1893</span></a>  
<a name="l1894"><span class="linenum">1894</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('columntotest')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/columntotest.html">columntotest</a> . ' ' . <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('usage_id_in')" href="../../_functions/usage_id_in.html" onMouseOver="funcPopup(event,'usage_id_in')">usage_id_in</a>();
<a name="l1895"><span class="linenum">1895</span></a>      }
<a name="l1896"><span class="linenum">1896</span></a>  
<a name="l1897"><span class="linenum">1897</span></a>      public function <a class="function" onClick="logFunction('from_where_params')" href="../../_functions/from_where_params.html" onMouseOver="funcPopup(event,'from_where_params')">from_where_params</a>() {
<a name="l1898"><span class="linenum">1898</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('params')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/params.html">params</a>;
<a name="l1899"><span class="linenum">1899</span></a>      }
<a name="l1900"><span class="linenum">1900</span></a>  
<a name="l1901"><span class="linenum">1901</span></a>      public function <a class="function" onClick="logFunction('usage_id_in')" href="../../_functions/usage_id_in.html" onMouseOver="funcPopup(event,'usage_id_in')">usage_id_in</a>() {
<a name="l1902"><span class="linenum">1902</span></a>          global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l1903"><span class="linenum">1903</span></a>  
<a name="l1904"><span class="linenum">1904</span></a>          if (empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('qubaids')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/qubaids.html">qubaids</a>)) {
<a name="l1905"><span class="linenum">1905</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('params')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/params.html">params</a> = array();
<a name="l1906"><span class="linenum">1906</span></a>              return '= 0';
<a name="l1907"><span class="linenum">1907</span></a>          }
<a name="l1908"><span class="linenum">1908</span></a>          <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('params')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/params.html">params</a>) = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_in_or_equal')" href="../../_functions/get_in_or_equal.html" onMouseOver="funcPopup(event,'get_in_or_equal')">get_in_or_equal</a>(
<a name="l1909"><span class="linenum">1909</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('qubaids')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/qubaids.html">qubaids</a>, <a class="constant" onClick="logConstant('SQL_PARAMS_NAMED')" href="../../_constants/SQL_PARAMS_NAMED.html" onMouseOver="constPopup(event,'SQL_PARAMS_NAMED')">SQL_PARAMS_NAMED</a>, 'qubaid');
<a name="l1910"><span class="linenum">1910</span></a>          return <a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a>;
<a name="l1911"><span class="linenum">1911</span></a>      }
<a name="l1912"><span class="linenum">1912</span></a>  
<a name="l1913"><span class="linenum">1913</span></a>      public function <a class="function" onClick="logFunction('usage_id_in_params')" href="../../_functions/usage_id_in_params.html" onMouseOver="funcPopup(event,'usage_id_in_params')">usage_id_in_params</a>() {
<a name="l1914"><span class="linenum">1914</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('params')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/params.html">params</a>;
<a name="l1915"><span class="linenum">1915</span></a>      }
<a name="l1916"><span class="linenum">1916</span></a>  }
<a name="l1917"><span class="linenum">1917</span></a>  
<a name="l1918"><span class="linenum">1918</span></a>  
<a name="l1919"><span class="linenum">1919</span></a>  <span class="comment">/**</span>
<a name="l1920"><span class="linenum">1920</span></a>  <span class="comment"> * This class represents a restriction on the set of question_usage ids to include</span>
<a name="l1921"><span class="linenum">1921</span></a>  <span class="comment"> * in a larger database query based on JOINing to some other tables.</span>
<a name="l1922"><span class="linenum">1922</span></a>  <span class="comment"> *</span>
<a name="l1923"><span class="linenum">1923</span></a>  <span class="comment"> * The general form of the query is something like</span>
<a name="l1924"><span class="linenum">1924</span></a>  <span class="comment"> *</span>
<a name="l1925"><span class="linenum">1925</span></a>  <span class="comment"> * SELECT qa.id, qa.maxmark</span>
<a name="l1926"><span class="linenum">1926</span></a>  <span class="comment"> * FROM $from</span>
<a name="l1927"><span class="linenum">1927</span></a>  <span class="comment"> * JOIN {question_attempts} qa ON qa.questionusageid = $usageidcolumn</span>
<a name="l1928"><span class="linenum">1928</span></a>  <span class="comment"> * WHERE $where AND qa.slot = 1</span>
<a name="l1929"><span class="linenum">1929</span></a>  <span class="comment"> *</span>
<a name="l1930"><span class="linenum">1930</span></a>  <span class="comment"> * where $from, $usageidcolumn and $where are the arguments to the constructor.</span>
<a name="l1931"><span class="linenum">1931</span></a>  <span class="comment"> *</span>
<a name="l1932"><span class="linenum">1932</span></a>  <span class="comment"> * @copyright  2010 The Open University</span>
<a name="l1933"><span class="linenum">1933</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l1934"><span class="linenum">1934</span></a>  <span class="comment"> */</span>
<a name="l1935"><span class="linenum">1935</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('qubaid_join')" href="../../_classes/qubaid_join.html" onMouseOver="classPopup(event,'qubaid_join')">qubaid_join</a> extends qubaid_condition {
<a name="l1936"><span class="linenum">1936</span></a>      public <a class="var it114" onMouseOver="hilite(114)" onMouseOut="lolite()" onClick="logVariable('from')" href="../../_variables/from.html">$from</a>;
<a name="l1937"><span class="linenum">1937</span></a>      public <a class="var it9249" onMouseOver="hilite(9249)" onMouseOut="lolite()" onClick="logVariable('usageidcolumn')" href="../../_variables/usageidcolumn.html">$usageidcolumn</a>;
<a name="l1938"><span class="linenum">1938</span></a>      public <a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a>;
<a name="l1939"><span class="linenum">1939</span></a>      public <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>;
<a name="l1940"><span class="linenum">1940</span></a>  
<a name="l1941"><span class="linenum">1941</span></a>      <span class="comment">/**</span>
<a name="l1942"><span class="linenum">1942</span></a>  <span class="comment">     * Constructor. The meaning of the arguments is explained in the class comment.</span>
<a name="l1943"><span class="linenum">1943</span></a>  <span class="comment">     * @param string $from SQL fragemnt to go in the FROM clause.</span>
<a name="l1944"><span class="linenum">1944</span></a>  <span class="comment">     * @param string $usageidcolumn the column in $from that should be</span>
<a name="l1945"><span class="linenum">1945</span></a>  <span class="comment">     * made equal to the usageid column in the JOIN clause.</span>
<a name="l1946"><span class="linenum">1946</span></a>  <span class="comment">     * @param string $where SQL fragment to go in the where clause.</span>
<a name="l1947"><span class="linenum">1947</span></a>  <span class="comment">     * @param array $params required by the SQL. You must use named parameters.</span>
<a name="l1948"><span class="linenum">1948</span></a>  <span class="comment">     */</span>
<a name="l1949"><span class="linenum">1949</span></a>      public function <a class="function" onClick="logFunction('__construct')" href="../../_functions/__construct.html" onMouseOver="funcPopup(event,'__construct')">__construct</a>(<a class="var it114" onMouseOver="hilite(114)" onMouseOut="lolite()" onClick="logVariable('from')" href="../../_variables/from.html">$from</a>, <a class="var it9249" onMouseOver="hilite(9249)" onMouseOut="lolite()" onClick="logVariable('usageidcolumn')" href="../../_variables/usageidcolumn.html">$usageidcolumn</a>, <a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a> = '', <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = array()) {
<a name="l1950"><span class="linenum">1950</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('from')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/from.html">from</a> = <a class="var it114" onMouseOver="hilite(114)" onMouseOut="lolite()" onClick="logVariable('from')" href="../../_variables/from.html">$from</a>;
<a name="l1951"><span class="linenum">1951</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('usageidcolumn')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/usageidcolumn.html">usageidcolumn</a> = <a class="var it9249" onMouseOver="hilite(9249)" onMouseOut="lolite()" onClick="logVariable('usageidcolumn')" href="../../_variables/usageidcolumn.html">$usageidcolumn</a>;
<a name="l1952"><span class="linenum">1952</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('params')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/params.html">params</a> = <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>;
<a name="l1953"><span class="linenum">1953</span></a>          if (empty(<a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a>)) {
<a name="l1954"><span class="linenum">1954</span></a>              <a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a> = '1 = 1';
<a name="l1955"><span class="linenum">1955</span></a>          }
<a name="l1956"><span class="linenum">1956</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('where')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/where.html">where</a> = <a class="var it3091" onMouseOver="hilite(3091)" onMouseOut="lolite()" onClick="logVariable('where')" href="../../_variables/where.html">$where</a>;
<a name="l1957"><span class="linenum">1957</span></a>      }
<a name="l1958"><span class="linenum">1958</span></a>  
<a name="l1959"><span class="linenum">1959</span></a>      public function <a class="function" onClick="logFunction('from_question_attempts')" href="../../_functions/from_question_attempts.html" onMouseOver="funcPopup(event,'from_question_attempts')">from_question_attempts</a>(<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>) {
<a name="l1960"><span class="linenum">1960</span></a>          return &quot;{<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('from')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/from.html">from</a>}
<a name="l1961"><span class="linenum">1961</span></a>                  JOIN {question_attempts} {<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>} ON &quot; .
<a name="l1962"><span class="linenum">1962</span></a>                          &quot;{<a class="var it779" onMouseOver="hilite(779)" onMouseOut="lolite()" onClick="logVariable('alias')" href="../../_variables/alias.html">$alias</a>}.questionusageid = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('usageidcolumn')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/usageidcolumn.html">usageidcolumn</a>&quot;;
<a name="l1963"><span class="linenum">1963</span></a>      }
<a name="l1964"><span class="linenum">1964</span></a>  
<a name="l1965"><span class="linenum">1965</span></a>      public function <a class="function" onClick="logFunction('where')" href="../../_functions/where.html" onMouseOver="funcPopup(event,'where')">where</a>() {
<a name="l1966"><span class="linenum">1966</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('where')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/where.html">where</a>;
<a name="l1967"><span class="linenum">1967</span></a>      }
<a name="l1968"><span class="linenum">1968</span></a>  
<a name="l1969"><span class="linenum">1969</span></a>      public function <a class="function" onClick="logFunction('from_where_params')" href="../../_functions/from_where_params.html" onMouseOver="funcPopup(event,'from_where_params')">from_where_params</a>() {
<a name="l1970"><span class="linenum">1970</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('params')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/params.html">params</a>;
<a name="l1971"><span class="linenum">1971</span></a>      }
<a name="l1972"><span class="linenum">1972</span></a>  
<a name="l1973"><span class="linenum">1973</span></a>      public function <a class="function" onClick="logFunction('usage_id_in')" href="../../_functions/usage_id_in.html" onMouseOver="funcPopup(event,'usage_id_in')">usage_id_in</a>() {
<a name="l1974"><span class="linenum">1974</span></a>          return &quot;IN (SELECT {<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('usageidcolumn')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/usageidcolumn.html">usageidcolumn</a>} FROM {<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('from')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/from.html">from</a>} WHERE {<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('where')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/where.html">where</a>})&quot;;
<a name="l1975"><span class="linenum">1975</span></a>      }
<a name="l1976"><span class="linenum">1976</span></a>  
<a name="l1977"><span class="linenum">1977</span></a>      public function <a class="function" onClick="logFunction('usage_id_in_params')" href="../../_functions/usage_id_in_params.html" onMouseOver="funcPopup(event,'usage_id_in_params')">usage_id_in_params</a>() {
<a name="l1978"><span class="linenum">1978</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('params')" class="var it42912" onMouseOver="hilite(42912)" onMouseOut="lolite()" href="../../_variables/params.html">params</a>;
<a name="l1979"><span class="linenum">1979</span></a>      }
<a name="l1980"><span class="linenum">1980</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'get_step_iterator': ['get_step_iterator', '', [['question/engine','questionattempt.php',423]], 10],
'insert_question_attempt_step': ['insert_question_attempt_step', 'Store a {@link question_attempt_step} in the database. ', [['question/engine','datalib.php',212]], 2],
'instance': ['instance', 'Returns an instance of the cache_factor method. ', [['cache','disabledlib.php',171],['cache','disabledlib.php',296],['lib/classes','useragent.php',101],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',80],['lib/htmlpurifier/HTMLPurifier','URISchemeRegistry.php',9],['search/classes','manager.php',109],['cache','locallib.php',52],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',53],['lib/classes','plugin_manager.php',103],['lib/htmlpurifier','HTMLPurifier.php',251],['course/format','lib.php',156],['lib/classes/update','checker.php',62],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',31],['admin/tool/installaddon/classes','installer.php',40],['lib','modinfolib.php',373],['cache/classes','helper.php',76],['lib/tests','string_manager_standard_test.php',124],['lib/portfolio','exporter.php',251],['lib/classes/update','validator.php',88],['search/classes','document_factory.php',49],['lib','accesslib.php',6235],['lib','accesslib.php',6487],['lib','accesslib.php',6665],['lib','accesslib.php',6919],['lib','accesslib.php',7180],['lib','accesslib.php',7392],['backup/cc/cc_lib','cc_utils.php',387],['backup/cc/cc_lib','cc_utils.php',443],['lib','filterlib.php',80],['search/tests/fixtures','testable_core_search.php',43],['lib/tests/fixtures','testable_update_checker.php',45],['backup/cc','validator.php',35],['cache/classes','config.php',87],['cache/classes','factory.php',114],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',29]], 4647],
'latest_step_for_qa_subquery': ['latest_step_for_qa_subquery', '', [['question/engine','datalib.php',1220]], 5],
'get_owning_context': ['get_owning_context', '', [['question/engine','questionusage.php',108]], 9],
'delete_usage_records_for_mysql': ['delete_usage_records_for_mysql', 'This function is a work-around for poor MySQL performance with DELETE FROM x WHERE id IN (SELECT ...). We have to use a non-standard syntax to get good performance. See MDL-29520. ', [['question/engine','datalib.php',976]], 1],
'prepare_step_data': ['prepare_step_data', 'Helper method used by insert_question_attempt_step and update_question_attempt_step ', [['question/engine','datalib.php',172]], 2],
'load_attempts_at_question': ['load_attempts_at_question', 'Load all the attempts at a given queston from a set of question_usages. steps. ', [['question/engine','datalib.php',809]], 1],
'get_all_response_file_areas': ['get_all_response_file_areas', '', [['question/engine','lib.php',432]], 3],
'get_preferred_behaviour': ['get_preferred_behaviour', '', [['question/engine','questionusage.php',103]], 9],
'save': ['save', 'Save PHPExcel to file ', [['lib/phpexcel/PHPExcel/Writer','CSV.php',89],['lib/phpexcel/PHPExcel/Writer/PDF','DomPDF.php',48],['question/engine','datalib.php',1531],['lib/adodb','adodb-active-record.inc.php',834],['backup/cc/cc_lib','xmlbase.php',168],['lib/phpexcel/PHPExcel/Writer','HTML.php',139],['availability/condition/grouping/classes','condition.php',71],['availability/tests/fixtures','mock_condition.php',67],['lib/phpexcel/PHPExcel/Writer/PDF','tcPDF.php',49],['lib/simplepie/library/SimplePie/Cache','File.php',97],['availability/condition/group/classes','condition.php',60],['completion','completion_aggregation.php',106],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Cache.php',111],['lib','badgeslib.php',208],['lib/portfolio','exporter.php',638],['mod/assign/submission/file','locallib.php',189],['mod/assign/feedback/comments','locallib.php',323],['lib/phpexcel/PHPExcel/Writer','PDF.php',82],['lib/adodb','adodb-active-recordx.inc.php',943],['lib/simplepie/library/SimplePie/Cache','Base.php',79],['lib/simplepie/library/SimplePie/Cache','MySQL.php',147],['lib/phpexcel/PHPExcel/Writer/PDF','mPDF.php',48],['lib/phpexcel/PHPExcel/Writer','IWriter.php',30],['badges/criteria','award_criteria_overall.php',171],['lib/phpexcel/PHPExcel/Writer','Excel2007.php',175],['availability/classes','tree.php',618],['mod/assign','assignmentplugin.php',190],['availability/condition/completion/classes','condition.php',72],['availability/condition/date/classes','condition.php',75],['lib/lessphp','Parser.php',654],['lib/simplepie/library/SimplePie/Cache','Memcache.php',108],['lib/phpexcel/PHPExcel/Shared/OLE/PPS','Root.php',50],['availability/condition/profile/classes','condition.php',127],['lib/xhprof/xhprof_html/jquery','jquery.tooltip.js',137],['mod/assign/submission/onlinetext','locallib.php',182],['mod/assign/feedback/file','locallib.php',257],['mod/assign/feedback/editpdf','locallib.php',252],['lib/phpexcel/PHPExcel/Writer','OpenDocument.php',83],['availability/condition/grade/classes','condition.php',77],['badges/criteria','award_criteria.php',354],['lib/portfolio','plugin.php',670],['lib/htmlpurifier/HTMLPurifier/Lexer','PH5P.php',476],['lib/htmlpurifier/HTMLPurifier/Lexer','PH5P.php',4783],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Hashtable.php',270]], 212],
'get_qt_files': ['get_qt_files', 'Get the latest set of files for a particular question type variable of type question_attempt::PARAM_FILES. ', [['question/engine','questionattemptstep.php',212],['question/engine','questionattemptstep.php',730]], 2],
'get_records_sql_menu': ['get_records_sql_menu', 'Get the first two columns from a number of records as an associative array using a SQL statement. ', [['lib/dml','moodle_database.php',1436]], 30],
'get_response_summary': ['get_response_summary', '', [['question/engine','questionusage.php',405],['question/engine','questionattempt.php',1202]], 38],
'is_flagged': ['is_flagged', '', [['mod/quiz/report','attemptsreport_table.php',280],['mod/quiz/report/responses','first_or_all_responses_table.php',148],['question/engine','questionattempt.php',293]], 12],
'notify_metadata_modified': ['notify_metadata_modified', '', [['question/engine','datalib.php',1468],['question/engine','questionusage.php',1085],['question/engine','questionusage.php',1118]], 1],
'delete_response_files': ['delete_response_files', 'Delete all the files belonging to the response variables in the gives question attempt steps. ', [['question/engine','datalib.php',1025]], 2],
'get_timecreated': ['get_timecreated', 'Returns time created unix timestamp if known ', [['lib/filebrowser','file_info.php',286],['lib/filebrowser','virtual_root_file.php',263],['lib/filebrowser','file_info_stored.php',249],['lib/filestorage','stored_file.php',747],['question/engine','questionattemptstep.php',176],['question/engine','questionattemptstep.php',686]], 54],
'sum': ['sum', 'SUM ', [['lib/phpexcel/PHPExcel/Calculation','MathTrig.php',1152],['lib/evalmath','evalmath.class.php',530]], 91],
'get_filename': ['get_filename', 'Returns file name ', [['lib/filebrowser','virtual_root_file.php',227],['lib/filestorage','stored_file.php',699],['lib','medialib.php',169]], 248],
'from_question_attempts': ['from_question_attempts', '', [['question/engine','datalib.php',1878],['question/engine','datalib.php',1959]], 11],
'delete_records_select': ['delete_records_select', '', [['lib/dml','pdo_moodle_database.php',208],['lib/dml','oci_native_moodle_database.php',1495],['lib/dml','pgsql_native_moodle_database.php',1162],['lib/dml','mssql_native_moodle_database.php',1146],['lib/dml','mysqli_native_moodle_database.php',1477],['lib/dml','sqlsrv_native_moodle_database.php',1220],['lib/dml/tests','dml_test.php',5553]], 163],
'get_min_fraction': ['get_min_fraction', '', [['question/behaviour/immediatefeedback','behaviour.php',53],['question/type/multichoice','question.php',160],['question/type/multichoice','question.php',282],['question/behaviour','behaviourbase.php',170],['question/behaviour/deferredcbm','behaviour.php',48],['question/type','questionbase.php',228],['question/behaviour/immediatecbm','behaviour.php',46],['question/behaviour/missing','behaviour.php',67],['question/behaviour/deferredfeedback','behaviour.php',45],['question/type/multianswer','question.php',106],['question/engine','questionattempt.php',687]], 14],
'get_files': ['get_files', 'Returns the array of attached files. ', [['search/classes','document.php',221],['question/engine','datalib.php',1599],['question/engine','datalib.php',1700],['question/engine','datalib.php',1759],['files','externallib.php',64],['mod/assign/submission/file','locallib.php',288],['mod/assign','assignmentplugin.php',443],['competency/classes','user_evidence.php',122],['mod/assign/submission/onlinetext','locallib.php',378]], 14],
'save_files': ['save_files', 'Actually save the files. ', [['question/engine','datalib.php',1691],['lib','formslib.php',654]], 1],
'set_max_mark_in_attempts': ['set_max_mark_in_attempts', 'Change the maxmark for the question_attempt with number in usage $slot for all the specified question_attempts. ', [['question/engine','datalib.php',1112],['question/engine','lib.php',121]], 5],
'load_from_records': ['load_from_records', 'Create a question_usage_by_activity from records loaded from the database. ', [['question/engine','questionusage.php',902],['question/engine','questionattemptstep.php',415],['question/engine','questionattempt.php',1408]], 19],
'close': ['close', 'Close archive, write changes to disk. ', [['lib/filestorage','zip_archive.php',183],['lib/dml','mssql_native_moodle_recordset.php',87],['auth/fc','fcFPP.php',78],['lib/dml','mysqli_native_moodle_recordset.php',86],['lib/spout/src/Spout/Reader','ReaderInterface.php',30],['lib/spout/src/Spout/Writer/ODS/Internal','Workbook.php',81],['lib/dml','pdo_moodle_recordset.php',79],['lib','csvlib.class.php',256],['lib/horde/framework/Horde/Socket','Client.php',135],['backup/util/helper','backup_null_iterator.class.php',53],['admin/tool/uploaduser','locallib.php',149],['lib/tcpdf','tcpdf.php',2943],['lib/phpunit/classes','phpmailer_sink.php',41],['lib/phpmailer','class.smtp.php',582],['lib/dml','sqlsrv_native_moodle_recordset.php',133],['lib/classes/dml','recordset_walk.php',153],['lib/spout/src/Spout/Writer/XLSX/Helper','SharedStringsHelper.php',84],['grade/export','lib.php',689],['lib','excellib.class.php',93],['backup/util/loggers','file_logger.class.php',69],['grade','lib.php',324],['backup/util/helper','backup_array_iterator.class.php',63],['lib/horde/framework/Horde/Imap/Client','Base.php',1846],['mod/assign/feedback/offline','importgradeslib.php',204],['lib/dml','oci_native_moodle_recordset.php',80],['lib/adodb','adodb.inc.php',2361],['lib/adodb','adodb.inc.php',3090],['lib/adodb','adodb.inc.php',3870],['lib/google/src/Google/Logger','File.php',132],['lib/phpunit/classes','event_sink.php',39],['lib/horde/framework/Horde','Stream.php',585],['backup/util/loggers','base_logger.class.php',89],['lib/phpexcel/PHPExcel/Shared','ZipArchive.php',71],['question/engine/tests','helpers.php',1241],['lib/spout/src/Spout/Writer','AbstractWriter.php',312],['lib','odslib.class.php',71],['lib/spout/src/Spout/Writer/Common/Internal','WorksheetInterface.php',34],['lib/spout/src/Spout/Writer/ODS/Internal','Worksheet.php',214],['lib/spout/src/Spout/Writer','WriterInterface.php',84],['lib/spout/src/Spout/Writer/XLSX/Internal','Worksheet.php',174],['lib/spout/src/Spout/Reader','AbstractReader.php',183],['lib/phpunit/classes','message_sink.php',39],['lib/spout/src/Spout/Writer/Common/Internal','WorkbookInterface.php',65],['lib/spout/src/Spout/Writer/XLSX/Internal','Workbook.php',95],['lib/pear/Net','GeoIP.php',556],['lib/tests','completionlib_test.php',907],['lib/pear/Auth','RADIUS.php',550],['lib/pear/Auth','RADIUS.php',710],['lib/pear/Auth','RADIUS.php',829],['lib','webdavlib.php',176],['lib/dml','pgsql_native_moodle_recordset.php',107]], 1128],
'notify_modified': ['notify_modified', '', [['question/engine','datalib.php',1339],['question/engine','questionusage.php',1034],['question/engine','questionusage.php',1102]], 1],
'get_database_id': ['get_database_id', '', [['question/engine','questionattempt.php',234]], 11],
'get_right_answer_summary': ['get_right_answer_summary', '', [['question/behaviour/immediatefeedback','behaviour.php',75],['question/behaviour/adaptive','behaviour.php',68],['question/behaviour/interactive','behaviour.php',61],['question/behaviour','behaviourbase.php',260],['question/behaviour/deferredcbm','behaviour.php',63],['question/type','questionbase.php',595],['question/type','questionbase.php',658],['question/type/ddmarker','question.php',367],['question/behaviour/immediatecbm','behaviour.php',64],['question/engine','questionusage.php',412],['question/behaviour/deferredfeedback','behaviour.php',49],['question/type/missingtype','question.php',68],['question/engine','questionattempt.php',1209]], 20],
'notify_step_modified': ['notify_step_modified', '', [['question/engine','datalib.php',1409],['question/engine','questionusage.php',1063],['question/engine','questionusage.php',1112]], 1],
'update_question_attempt_flag': ['update_question_attempt_flag', 'Update the flagged state of a question in the database. ', [['question/engine','datalib.php',1061]], 1],
'load_question_attempt_step': ['load_question_attempt_step', 'Load a {@link question_attempt_step} from the database. ', [['question/engine','datalib.php',297]], 0],
'notify_attempt_modified': ['notify_attempt_modified', '', [['question/engine','datalib.php',1347],['question/engine','questionusage.php',1042],['question/engine','questionusage.php',1106]], 12],
'update_question_attempt': ['update_question_attempt', 'Update a question_attempts row to refect any changes in a question_attempt (but not any of its steps). ', [['question/engine','datalib.php',900]], 1],
'delete_previews': ['delete_previews', 'Delete all the previews for a given question. ', [['question/engine','datalib.php',1041]], 1],
'delete_area_files_select': ['delete_area_files_select', 'Delete all the files from certain areas where itemid is limited by an arbitrary bit of SQL. ', [['lib/filestorage','file_storage.php',1023]], 2],
'compute_value': ['compute_value', 'Compute the value that should be stored in the question_attempt_step_data table. Contains a hash that (almost) uniquely encodes all the files. ', [['question/engine','datalib.php',1645]], 1],
'file_rewrite_urls_to_pluginfile': ['file_rewrite_urls_to_pluginfile', 'Convert the draft file area URLs in some content to @@PLUGINFILE@@ tokens ready to be saved in the database. Normally, this is done automatically by {@link file_save_draft_area_files()}. ', [['lib','filelib.php',976]], 3],
'valid': ['valid', 'Did we reach the end? ', [['lib/filestorage','zip_archive.php',514],['lib/spout/src/Spout/Reader/XLSX','SheetIterator.php',51],['lib/dml','mssql_native_moodle_recordset.php',83],['lib/phpexcel/PHPExcel/Worksheet','RowCellIterator.php',191],['lib/phpexcel/PHPExcel/Worksheet','ColumnIterator.php',184],['lib/horde/framework/Horde/Imap/Client','Tokenize.php',329],['lib/dml','mysqli_native_moodle_recordset.php',82],['lib/phpexcel/PHPExcel/Worksheet','RowIterator.php',175],['lib/horde/framework/Horde/Mail/Rfc822','List.php',439],['lib/dml','pdo_moodle_recordset.php',75],['lib/spout/src/Spout/Reader/CSV','RowIterator.php',104],['lib/phpexcel/PHPExcel','WorksheetIterator.php',99],['backup/util/helper','backup_null_iterator.class.php',49],['lib/horde/framework/Horde','Domhtml.php',331],['lib/dml','sqlsrv_native_moodle_recordset.php',129],['lib/classes/dml','recordset_walk.php',127],['lib/horde/framework/Horde/Imap/Client','Ids.php',419],['backup/util/helper','backup_array_iterator.class.php',59],['lib/spout/src/Spout/Reader/CSV','SheetIterator.php',44],['lib/dml','oci_native_moodle_recordset.php',76],['lib/adodb','adodb.inc.php',3041],['lib/adodb','adodb.inc.php',3168],['lib/phpexcel/PHPExcel/Worksheet','ColumnCellIterator.php',182],['lib/spout/src/Spout/Reader/XLSX','RowIterator.php',110],['question/engine','questionusage.php',999],['question/engine/tests','helpers.php',1237],['backup/cc/cc_lib','cc_version11.php',47],['lib/spout/src/Spout/Reader/ODS','SheetIterator.php',75],['backup/cc/cc_lib','cc_version1.php',47],['backup/cc/cc_lib','cc_asssesment.php',58],['lib/spout/src/Spout/Reader/ODS','RowIterator.php',80],['lib/google/src/Google','Collection.php',45],['lib/horde/framework/Horde/Imap/Client/Data','AclRights.php',182],['lib/horde/framework/Horde/Imap/Client/Fetch','Query.php',378],['question/engine','questionattempt.php',1643],['question/engine','questionattempt.php',1762],['lib/tests','completionlib_test.php',903],['lib/dml','pgsql_native_moodle_recordset.php',103]], 81],
'strlen': ['strlen', 'Counts the number of characters. Unit-tested by Kasper (single byte charsets only) ', [['lib/typo3','class.t3lib_cs.php',1520],['lib/classes','text.php',305]], 1649],
'__construct': ['__construct', '', [['lib/adodb/drivers','adodb-odbc_mssql.inc.php',50],['lib/adodb/drivers','adodb-odbc_mssql.inc.php',359],['question/classes/statistics/responses','analyser.php',69],['auth/radius','auth.php',38],['lib/xmldb','xmldb_file.php',43],['lib/lessphp/Tree/Mixin','Definition.php',18],['cache/stores/static','lib.php',127],['lib/classes/session','file.php',40],['lib/htmlpurifier/HTMLPurifier/Lexer','DOMLex.php',35],['backup/util/ui','base_moodleform.class.php',68],['lib/simplepie/library/SimplePie','Author.php',81],['lib/filestorage','zip_archive.php',66],['backup/util/structure','restore_path_element.class.php',47],['backup/util/structure','restore_path_element.class.php',128],['lib/htmlpurifier/HTMLPurifier/ChildDef','Chameleon.php',36],['lib/phpexcel/PHPExcel','HashTable.php',44],['mod/quiz/tests','repaginate_test.php',39],['lib/form','modvisible.php',43],['lib/phpexcel/PHPExcel/Worksheet','Row.php',44],['cache','disabledlib.php',44],['lib/phpexcel/PHPExcel/Worksheet','Dimension.php',58],['lib/mustache/src/Mustache/Cache','FilesystemCache.php',27],['question/type/ddwtos','question.php',61],['mnet/xmlrpc','client.php',25],['lib/horde/framework/Horde/Imap/Client','Url.php',112],['lib/classes','useragent.php',115],['lib/pear/HTML/QuickForm','advcheckbox.php',66],['lib/classes/update','checker_exception.php',37],['lib/phpexcel/PHPExcel/Reader','Excel2007.php',53],['lib/jabber/XMPP','XMPP.php',101],['lib/form','radio.php',44],['lib/spout/src/Spout/Reader/XLSX/Helper','StyleHelper.php',45],['auth/cas/CAS/CAS/ProxiedService/Http','Abstract.php',58],['lib/phpexcel/PHPExcel/Style','Border.php',67],['lib/htmlpurifier/HTMLPurifier','HTMLDefinition.php',182],['lib/adodb/drivers','adodb-oci8quercus.inc.php',31],['lib/adodb/drivers','adodb-oci8quercus.inc.php',45],['lib/spout/src/Spout/Reader/XLSX','SheetIterator.php',29],['lib/horde/framework/Horde/Imap/Client/Interaction','Server.php',91],['lib/phpexcel/PHPExcel','DocumentProperties.php',123],['lib/typo3','class.t3lib_cs.php',509],['mod/workshop/allocation/scheduled','lib.php',48],['lib/adodb/drivers','adodb-netezza.inc.php',53],['lib/adodb/drivers','adodb-netezza.inc.php',144],['mod/feedback/classes','complete_form.php',58],['search/classes','document.php',188],['webservice/rest','locallib.php',40],['lib/dml','mssql_native_moodle_recordset.php',34],['mod/assign/feedback/editpdf/fpdi','fpdi_pdf_parser.php',57],['lib/htmlpurifier/HTMLPurifier','TokenFactory.php',43],['backup/moodle2','backup_block_task.class.php',43],['lib/lessphp/Tree','Negative.php',14],['lib/minify/lib/Minify/Cache','APC.php',19],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',54],['lib/pear/HTML/QuickForm','header.php',33],['lib/spout/src/Spout/Reader/XLSX/Helper/SharedStringsCaching','InMemoryStrategy.php',26],['lib/phpexcel/PHPExcel/Worksheet','RowCellIterator.php',51],['lib/simplepie/library/SimplePie/XML/Declaration','Parser.php',110],['lib/phpexcel/PHPExcel/Worksheet','ColumnIterator.php',60],['lib/spout/src/Spout/Reader/ODS','Sheet.php',33],['question/type/calculated/tests','helper.php',205],['lib/adodb/drivers','adodb-odbtp.inc.php',38],['lib/adodb/drivers','adodb-odbtp.inc.php',673],['lib/adodb/drivers','adodb-odbtp.inc.php',796],['lib/adodb/drivers','adodb-odbtp.inc.php',806],['lib/adodb/drivers','adodb-odbtp.inc.php',816],['lib/adodb/drivers','adodb-odbtp.inc.php',826],['lib/adodb/drivers','adodb-odbtp.inc.php',836],['enrol/lti/ims-blti','blti.php',28],['backup/cc','cc2moodle.php',105],['mod/chat','locallib.php',181],['mod/chat','locallib.php',229],['user/filters','simpleselect.php',45],['lib/phpexcel/PHPExcel/CachedObjectStorage','Memcache.php',244],['lib/dml','pdo_moodle_database.php',42],['lib/adodb/drivers','adodb-sqlite3.inc.php',36],['lib/adodb/drivers','adodb-sqlite3.inc.php',350],['lib/pear/HTML/QuickForm','static.php',44],['competency/classes/external','comment_area_exporter.php',48],['lib/lessphp/Tree','Selector.php',31],['auth/cas/CAS/CAS','TypeMismatchException.php',43],['auth/fc','fcFPP.php',33],['lib/xmldb','xmldb_key.php',43],['grade/grading/form/rubric','rubriceditor.php',56],['lib/google/src/Google/Service','Cloudlatencytest.php',40],['course','moodleform_mod.php',69],['auth/nntp','auth.php',35],['grade/report/grader','lib.php',111],['admin/tool/generator/classes','course_backend.php',116],['lib/minify/lib','FirePHP.php',189],['lib/adodb/drivers','adodb-sqlitepo.inc.php',38],['lib/horde/framework/Horde/Imap/Client','Tokenize.php',67],['lib/phpexcel/PHPExcel/CachedObjectStorage','CacheBase.php',66],['lib/lessphp/Tree','Rule.php',24],['lib/behat/features/bootstrap','behat_init_context.php',45],['lib','dmllib.php',69],['lib','dmllib.php',84],['lib','dmllib.php',104],['lib','dmllib.php',129],['lib','dmllib.php',159],['lib','dmllib.php',187],['lib','dmllib.php',240],['lib','dmllib.php',270],['lib/google/src/Google/Service','DataTransfer.php',44],['lib/google/src/Google/Http','Batch.php',42],['backup/util/structure','base_processor.class.php',49],['admin/tool/lpmigrate/classes','framework_mapper.php',50],['lib/phpexcel/PHPExcel/Reader','OOCalc.php',46],['lib/lessphp/Tree','NameValue.php',22],['mod/quiz/classes','admin_review_setting.php',82],['lib/htmlpurifier/HTMLPurifier','Generator.php',67],['mod/quiz/report','attemptsreport_table.php',76],['blocks/lp/classes/output','summary.php',59],['lib/google/src/Google/IO','Stream.php',45],['lib/google/src/Google/Service','Freebase.php',38],['grade/tests','reportlib_test.php',36],['search/classes','manager.php',100],['question/behaviour/adaptive','behaviour.php',310],['admin/tool/lp/classes/form','framework_autocomplete.php',48],['lib/minify/lib','JSMinPlus.php',193],['lib/minify/lib','JSMinPlus.php',726],['lib/minify/lib','JSMinPlus.php',1638],['lib/minify/lib','JSMinPlus.php',1656],['lib/minify/lib','JSMinPlus.php',1748],['lib/simplepie/library/SimplePie','Copyright.php',73],['lib/phpexcel/PHPExcel/Style','Conditional.php',93],['lib/google/src/Google/Task','Runner.php',76],['backup/util/settings/root','root_backup_setting.class.php',34],['lib','componentlib.class.php',179],['lib','componentlib.class.php',610],['lib','componentlib.class.php',834],['lib/google/src/Google/Service','AdSense.php',68],['lib/htmlpurifier/HTMLPurifier/AttrDef','Clone.php',18],['lib/spout/src/Spout/Reader/CSV','Sheet.php',24],['lib/filebrowser','file_info_context_system.php',37],['lib/grade','grade_item.php',260],['lib/horde/framework/Horde/Imap/Client/Data/Format','Nstring.php',27],['repository/boxnet','lib.php',56],['auth/email','auth.php',34],['mod/wiki/editors','wikifiletable.php',40],['lib/google/src/Google/Service','Replicapool.php',51],['lib/dtl','database_exporter.php',55],['lib/horde/framework/Horde/Imap/Client/Namespace','List.php',34],['lib/phpexcel/PHPExcel/Writer','CSV.php',79],['lib/google/src/Google/Service','Tasks.php',44],['lib/dml','mysqli_native_moodle_recordset.php',42],['lib/google/src/Google/Service','GamesManagement.php',50],['lib/minify/lib/Minify','Source.php',43],['lib/jabber/XMPP','Roster.php',48],['lib/lessphp/Tree','Element.php',19],['lib/classes','string_manager_install.php',43],['question/type','questiontypebase.php',55],['question/type','questiontypebase.php',1442],['lib/form','filemanager.php',54],['lib/form','filemanager.php',316],['lib/htmlpurifier/HTMLPurifier/ChildDef','Custom.php',36],['backup/util/ui','renderer.php',813],['lib/simplepie/library/SimplePie','Rating.php',73],['lib/phpexcel/PHPExcel/Cell','Hyperlink.php',44],['question/classes/statistics/questions','calculator.php',66],['backup/moodle2','backup_xml_transformer.class.php',50],['lib/google/src/Google/Service','Resource.php',62],['lib/form','autocomplete.php',56],['lib/phpexcel/PHPExcel/Worksheet','RowIterator.php',60],['mod/lesson/classes','file_info.php',45],['question/type/tests','question_first_matching_answer_grading_strategy_test.php',40],['lib/google/src/Google/Service','Partners.php',43],['cache','lib.php',66],['cache','lib.php',109],['cache','lib.php',138],['cache','lib.php',183],['grade/edit/tree','lib.php',57],['grade/edit/tree','lib.php',635],['grade/edit/tree','lib.php',668],['grade/edit/tree','lib.php',834],['lib/simplepie/library/SimplePie','Cache.php',69],['mod/wiki/diff','difflib.php',277],['mod/wiki/diff','difflib.php',381],['mod/wiki/diff','difflib.php',478],['lib/pear/HTML/QuickForm','select.php',58],['lib/classes/output','mustache_javascript_helper.php',40],['lib/phpexcel/PHPExcel/Reader/Excel2007','Theme.php',68],['mod/data','export_form.php',16],['lib/pear/HTML/QuickForm','autocomplete.php',67],['question/type/shortanswer','question.php',44],['lib/google/src/Google/Service','AndroidPublisher.php',52],['lib/google/src/Google/Verifier','Pem.php',31],['lib/classes/antivirus','scanner.php',41],['lib/phpexcel/PHPExcel/Reader','Excel5.php',414],['lib/horde/framework/Horde/Imap/Client/Auth','DigestMD5.php',69],['lib/classes/output','mustache_filesystem_loader.php',39],['lib/classes/output','inplace_editable.php',107],['lib/adodb/drivers','adodb-informix.inc.php',37],['competency/classes','competency_rule.php',45],['lib/phpexcel/PHPExcel','RichText.php',37],['lib/phpexcel/PHPExcel/Shared/JAMA','Matrix.php',59],['lib/pear/HTML/QuickForm','input.php',38],['repository/picasa','lib.php',41],['mod/feedback/classes','structure.php',48],['backup/util/plan','backup_structure_step.class.php',38],['question/classes/bank','random_question_loader.php',61],['mod/quiz/report/statistics/classes','calculated.php',43],['lib/horde/framework/Horde/Stream','String.php',27],['backup/util/helper','restore_decode_content.class.php',50],['backup/util/helper','restore_decode_content.class.php',125],['mod/workshop/backup/moodle1','lib.php',308],['lib/google/src/Google/Service','YouTubeReporting.php',47],['grade/export/txt','grade_export_txt.php',27],['lib/mustache/src/Mustache/Exception','SyntaxException.php',23],['lib/tcpdf','tcpdf_barcodes_2d.php',58],['mod/imscp','locallib.php',289],['lib/form','selectyesno.php',42],['lib/horde/framework/Horde/Mail/Transport','Smtphorde.php',62],['mod/lti/service/toolsettings/classes/local/service','toolsettings.php',41],['mod/lti/service/profile/classes/local/service','profile.php',41],['repository/flickr_public','lib.php',49],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','BackgroundPosition.php',57],['admin/tool/lp/classes/output','template_cohorts_table.php',53],['lib/simplepie/library','SimplePie.php',611],['lib/horde/framework/Horde/Imap/Client/Base','Debug.php',55],['lib/google/src/Google/Service','Reseller.php',44],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Border.php',18],['lib/testing/generator','component_generator_base.php',45],['lib/horde/framework/Horde/Translation/Handler','Gettext.php',34],['lib/phpexcel/PHPExcel/Worksheet','HeaderFooter.php',175],['lib/classes','plugin_manager.php',91],['lib/horde/framework/Horde/Imap/Client/Data/Format','List.php',28],['lib/horde/framework/Horde/Support','CombineStream.php',29],['lib/xmldb','xmldb_field.php',84],['lib/adodb/drivers','adodb-ibase.inc.php',59],['lib/adodb/drivers','adodb-ibase.inc.php',764],['lib/htmlpurifier/HTMLPurifier/AttrDef','URI.php',23],['admin/roles/classes','view_role_definition_table.php',28],['lib/google/src/Google/Cache','Memcache.php',44],['lib/pear/HTML/QuickForm','radio.php',48],['lib/filebrowser','file_info_context_coursecat.php',39],['lib/spout/src/Spout/Writer/ODS/Internal','Workbook.php',37],['mod/workshop/eval/best','lib.php',44],['lib/phpexcel/PHPExcel/Writer/PDF','DomPDF.php',38],['grade/report','lib.php',156],['lib','csslib.php',1501],['lib','csslib.php',1587],['lib','csslib.php',2068],['lib','csslib.php',2136],['lib','csslib.php',2242],['availability/classes','info_module.php',40],['mod/book','locallib.php',414],['question/engine','datalib.php',68],['question/engine','datalib.php',1331],['question/engine','datalib.php',1632],['question/engine','datalib.php',1740],['question/engine','datalib.php',1870],['question/engine','datalib.php',1941],['webservice','lib.php',745],['webservice','lib.php',841],['lib/adodb/drivers','adodb-informix72.inc.php',59],['lib/adodb/drivers','adodb-informix72.inc.php',399],['lib/adodb','adodb-pager.inc.php',60],['user/classes/output/myprofile','category.php',68],['lib/lessphp/Visitor','extendFinder.php',15],['backup/util/settings','base_setting.class.php',89],['backup/util/settings','base_setting.class.php',556],['lib','filelib.php',2720],['lib','filelib.php',3601],['lib/phpunit/classes','database_driver_testcase.php',55],['lib/phpexcel/PHPExcel/Shared/OLE/PPS','File.php',32],['report/competency/classes/output','report.php',56],['lib/google/src/Google/Service','Computeaccounts.php',49],['question/type','edit_question_form.php',96],['lib/filebrowser','file_info_context_user.php',39],['admin/tool/lp/classes/output','template_plans_page.php',37],['lib/phpexcel/PHPExcel','Style.php',93],['lib/minify/lib/Minify','HTML.php',49],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','ListStyle.php',20],['lib/form','password.php',44],['backup','backup.class.php',146],['mod/feedback/classes','course_select_form.php',39],['lib/google/src/Google/Auth','AppIdentity.php',39],['lib/adodb','adodb-active-record.inc.php',121],['lib/phpexcel/PHPExcel','Chart.php',169],['lib/horde/framework/Horde/Mail/Rfc822','List.php',61],['admin/roles/classes','allow_switch_page.php',33],['lib/grade','grade_object.php',80],['lib/google/src/Google/IO','Exception.php',29],['auth/lti','auth.php',38],['mod/quiz/report/statistics/classes','calculator.php',39],['lib/htmlpurifier','HTMLPurifier.php',104],['admin/tool/lp/classes/output','user_competency_summary_in_plan.php',47],['mod/assign/feedback/editpdf/classes','widget.php',53],['lib/evalmath','evalmath.class.php',120],['lib/form','url.php',46],['lib/dml','pdo_moodle_recordset.php',41],['lib/htmlpurifier/HTMLPurifier/TagTransform','Simple.php',19],['backup/cc/cc_lib','xmlbase.php',52],['badges/lib','bakerlib.php',52],['lib/google/src/Google/Signer','P12.php',35],['availability/classes','info_section.php',40],['lib/form','static.php',47],['backup/converter','convertlib.php',52],['backup/converter','convertlib.php',277],['lib/google/src/Google/Service','YouTubeAnalytics.php',56],['admin/roles/classes','check_capability_table.php',40],['lib/htmlpurifier/HTMLPurifier','AttrTypes.php',14],['lib/adodb/drivers','adodb-postgres64.inc.php',127],['lib/adodb/drivers','adodb-postgres64.inc.php',919],['backup/util/helper','restore_prechecks_helper.class.php',213],['user/profile','lib.php',59],['lib/google/src/Google/Service','Admin.php',40],['lib/spout/src/Spout/Reader/CSV','RowIterator.php',62],['lib/google/src/Google/Service','MapsEngine.php',66],['lib','listlib.php',82],['lib','listlib.php',485],['lib/phpexcel/PHPExcel/Writer','HTML.php',128],['backup/moodle2','restore_activity_task.class.php',48],['lib/htmlpurifier/HTMLPurifier','HTMLModuleManager.php',68],['lib/simplepie/library/SimplePie','Source.php',61],['completion','data_object.php',68],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','ID.php',28],['grade/report/singleview/classes/local/ui','dropdown_attribute.php',49],['lib/horde/framework/Horde/Support','Stack.php',18],['lib/google/src/Google/Cache','File.php',41],['lib/horde/framework/Horde/Mail/Transport','Mock.php',76],['backup/util/ui','backup_moodleform.class.php',41],['availability/condition/grouping/classes','condition.php',46],['lib/classes/session','memcache.php',50],['cache/classes','dummystore.php',62],['badges/classes','assertion.php',49],['lib/xhprof/xhprof_lib/utils','xhprof_runs.php',87],['availability/tests/fixtures','mock_condition.php',52],['lib/mustache/src/Mustache/Loader','FilesystemLoader.php',33],['mod/quiz/report','attemptsreport_options.php',95],['lib/phpexcel/PHPExcel/Writer/PDF','tcPDF.php',39],['lib/minify/lib/Minify/CSS','Compressor.php',51],['lib/google/src/Google/Service','Dns.php',53],['question/type/calculatedmulti','edit_calculatedmulti_form.php',47],['backup/moodle2','restore_block_task.class.php',45],['lib/phpexcel/PHPExcel/Worksheet','AutoFilter.php',54],['lib/form','recaptcha.php',48],['lib','csvlib.class.php',64],['lib','csvlib.class.php',398],['lib/simplepie/library/SimplePie/Cache','File.php',82],['lib/phpexcel/PHPExcel/Chart','Legend.php',75],['lib/phpexcel/PHPExcel','WorksheetIterator.php',44],['cache/classes','loaders.php',196],['cache/classes','loaders.php',1189],['cache/classes','loaders.php',1586],['lib/google/src/Google/Service','Appengine.php',44],['admin/tool/lp/classes/output','template_cohorts_page.php',37],['search/classes','engine.php',77],['backup/cc/cc_lib','cc_assesment_essay.php',25],['lib/classes/progress','display.php',48],['lib/lessphp/Tree','Call.php',19],['course/format','lib.php',78],['question/type/calculated','datasetdefinitions_form.php',53],['lib/google/src/Google/Service','Translate.php',40],['enrol/database','settingslib.php',34],['lib/lessphp/Tree/Mixin','Call.php',14],['admin/tool/log/store/standard/classes/log','store.php',37],['lib/google/src/Google/Service','Urlshortener.php',40],['lib/horde/framework/Horde/Imap/Client','Socket.php',168],['lib/tests','collator_test.php',310],['lib/google/src/Google/Auth','Simple.php',31],['backup/cc/cc_lib','cc_manifest.php',45],['lib/bennu','iCalendar_properties.php',28],['lib/bennu','iCalendar_properties.php',220],['lib/bennu','iCalendar_properties.php',238],['lib/bennu','iCalendar_properties.php',259],['lib/bennu','iCalendar_properties.php',275],['lib/bennu','iCalendar_properties.php',296],['lib/bennu','iCalendar_properties.php',343],['lib/bennu','iCalendar_properties.php',358],['lib/bennu','iCalendar_properties.php',376],['lib/bennu','iCalendar_properties.php',391],['lib/bennu','iCalendar_properties.php',406],['lib/bennu','iCalendar_properties.php',447],['lib/bennu','iCalendar_properties.php',462],['lib/bennu','iCalendar_properties.php',485],['lib/bennu','iCalendar_properties.php',509],['lib/bennu','iCalendar_properties.php',524],['lib/bennu','iCalendar_properties.php',555],['lib/bennu','iCalendar_properties.php',573],['lib/bennu','iCalendar_properties.php',594],['lib/bennu','iCalendar_properties.php',637],['lib/bennu','iCalendar_properties.php',680],['lib/bennu','iCalendar_properties.php',724],['lib/bennu','iCalendar_properties.php',747],['lib/bennu','iCalendar_properties.php',782],['lib/bennu','iCalendar_properties.php',808],['lib/bennu','iCalendar_properties.php',849],['lib/bennu','iCalendar_properties.php',864],['lib/bennu','iCalendar_properties.php',905],['lib/bennu','iCalendar_properties.php',938],['lib/bennu','iCalendar_properties.php',952],['lib/bennu','iCalendar_properties.php',965],['lib/bennu','iCalendar_properties.php',987],['lib/bennu','iCalendar_properties.php',1017],['lib/bennu','iCalendar_properties.php',1031],['lib/bennu','iCalendar_properties.php',1061],['lib/bennu','iCalendar_properties.php',1075],['lib/bennu','iCalendar_properties.php',1098],['lib/bennu','iCalendar_properties.php',1110],['lib/bennu','iCalendar_properties.php',1139],['lib/bennu','iCalendar_properties.php',1160],['lib/bennu','iCalendar_properties.php',1181],['lib/bennu','iCalendar_properties.php',1203],['lib/bennu','iCalendar_properties.php',1227],['lib/bennu','iCalendar_properties.php',1260],['lib/bennu','iCalendar_properties.php',1386],['lib/bennu','iCalendar_properties.php',1407],['lib/bennu','iCalendar_properties.php',1429],['lib/bennu','iCalendar_properties.php',1450],['lib/mustache/src/Mustache/Exception','UnknownTemplateException.php',22],['lib/phpmailer','moodle_phpmailer.php',47],['availability/tests/fixtures','mock_info.php',40],['lib/horde/framework/Horde/Mail/Transport','Smtpmx.php',138],['admin/tool/lp/classes/form','persistent.php',68],['lib/adodb/drivers','adodb-mysqlt.inc.php',32],['lib/adodb/drivers','adodb-mysqlt.inc.php',96],['webservice/tests','lib_test.php',213],['lib/horde/framework/Horde/Imap/Client/Data/Format','Mailbox.php',35],['filter','local_settings_form.php',33],['mod/quiz/accessrule','accessrulebase.php',52],['lib/horde/framework/Horde/Exception','Wrapped.php',16],['mod/assign/feedback/editpdf/fpdi','pdf_parser.php',170],['lib/lessphp/Tree','Dimension.php',15],['lib/minify/lib/HTTP','ConditionalGet.php',109],['lib/adodb/perf','perf-oci8.inc.php',203],['lib/phpexcel','PHPExcel.php',361],['backup/util/helper','restore_questions_parser_processor.class.php',42],['backup/moodle2','backup_plugin.class.php',44],['lib/classes/antivirus','scanner_exception.php',38],['webservice/xmlrpc','lib.php',43],['report/loglive/classes','renderable.php',73],['course','dnduploadlib.php',109],['course','dnduploadlib.php',407],['lib/filebrowser','file_info.php',43],['lib/adodb/drivers','adodb-access.inc.php',34],['lib/adodb/drivers','adodb-access.inc.php',83],['mod/feedback/classes','responses_table.php',54],['lib/editor/tinymce','adminlib.php',36],['admin/tool/monitor/classes','rule.php',44],['lib/google/src/Google/Service','AdExchangeBuyer.php',55],['lib/filebrowser','virtual_root_file.php',45],['lib/phpexcel/PHPExcel/RichText','Run.php',35],['admin/tool/monitor/classes/output/managesubs','subs.php',51],['auth/cas/CAS/CAS','ProxyChain.php',48],['lib/htmlpurifier/HTMLPurifier','DefinitionCache.php',22],['lib/google/src/Google/Service','CivicInfo.php',40],['mod/feedback/classes/output','summary.php',52],['lib/minify/lib/Minify','Build.php',77],['lib/adodb/drivers','adodb-ado_mssql.inc.php',146],['lib/adodb/drivers','adodb-odbc.inc.php',44],['lib/adodb/drivers','adodb-odbc.inc.php',611],['lib','moodlelib.php',9421],['lib','moodlelib.php',9632],['user/selector','lib.php',85],['user/selector','lib.php',674],['admin/tool/lp/classes/output','plan_page.php',49],['repository/dropbox','lib.php',49],['lib/horde/framework/Horde/Mime','Part.php',261],['lib/spout/src/Spout/Reader/XLSX/Helper/SharedStringsCaching','CachingStrategyFactory.php',56],['lib/phpexcel/PHPExcel/Chart','Layout.php',143],['lib/mustache/src/Mustache/Loader','CascadingLoader.php',20],['lib/phpexcel/PHPExcel/Shared/JAMA','EigenvalueDecomposition.php',777],['lib/google/src/Google/Service','Books.php',60],['lib/google/src/Google/Service','Oauth2.php',50],['admin/tool/log/classes/log','store.php',30],['admin/tool/recyclebin/classes','category_bin.php',45],['lib/phpexcel/PHPExcel/Style','Color.php',64],['lib/phpexcel/PHPExcel/Worksheet','SheetView.php',69],['lib/htmlpurifier/HTMLPurifier/Token','Text.php',34],['lib/classes/update','checker.php',50],['lib/horde/framework/Horde/Socket','Client.php',52],['lib/phpexcel/PHPExcel/CachedObjectStorage','APC.php',243],['lib/horde/framework/Horde/Imap/Client/Cache','Backend.php',33],['lib/phpexcel/PHPExcel/Chart','Title.php',45],['lib/horde/framework/Horde/Imap/Client/Data','Format.php',32],['lib/adodb/drivers','adodb-text.inc.php',93],['lib/adodb/drivers','adodb-text.inc.php',379],['lib/phpexcel/PHPExcel','Calculation.php',2071],['lib/adodb/drivers','adodb-sqlite.inc.php',36],['lib/adodb/drivers','adodb-sqlite.inc.php',367],['lib/google/src/Google/Service','Analytics.php',77],['blocks/lp/classes/output','plans_to_review_page.php',48],['lib/google/src/Google/Service','Coordinate.php',48],['availability/condition/group/classes','condition.php',43],['lib/lessphp/Exception','Chunk.php',19],['lib/htmlpurifier/HTMLPurifier','PropertyListIterator.php',22],['backup/cc/cc_lib','cc_resources.php',102],['lib/horde/framework/Horde/Mail/Rfc822','Group.php',45],['backup/util/structure','base_optigroup.class.php',35],['backup/util/structure','base_optigroup.class.php',169],['question/classes/statistics/questions','calculated.php',181],['lib/horde/framework/Horde/Imap/Client/Interaction','Command.php',72],['lib/htmlpurifier/HTMLPurifier/Strategy','Core.php',8],['lib/htmlpurifier/HTMLPurifier/Filter','ExtractStyleBlocks.php',57],['backup/cc/cc_lib','cc_converter_url.php',29],['lib/xmldb','xmldb_structure.php',40],['lib/ddl','sqlite_sql_generator.php',73],['lib/pear/HTML/QuickForm','Renderer.php',31],['backup/util/helper','restore_moodlexml_parser_processor.class.php',38],['lib/pear/HTML/QuickForm','file.php',54],['lib/minify/lib/Minify/Cache','File.php',9],['lib/pear/HTML/QuickForm','xbutton.php',39],['lib/htmlpurifier','locallib.php',134],['admin/tool/recyclebin/classes','course_bin.php',45],['backup/util/plan','backup_task.class.php',32],['backup/util/plan','backup_task.class.php',56],['lib/phpexcel/PHPExcel/CachedObjectStorage','PHPTemp.php',174],['backup/util/helper','backup_helper.class.php',381],['lib/form','htmleditor.php',48],['lib','oauthlib.php',65],['lib','oauthlib.php',409],['auth/cas/CAS/CAS/PGTStorage','File.php',105],['auth/cas/CAS/CAS/ProxiedService','Imap.php',51],['repository/skydrive','lib.php',42],['lib/htmlpurifier/HTMLPurifier','ErrorCollector.php',57],['lib/classes/lock','postgres_lock_factory.php',81],['lib/phpexcel/PHPExcel/CachedObjectStorage','SQLite.php',260],['lib/horde/framework/Horde/Support','ConsistentHash.php',56],['lib/horde/framework/Horde/Exception','Pear.php',22],['lib/portfolio','exceptions.php',50],['backup/moodle2','restore_plugin.class.php',43],['lib/phpexcel/PHPExcel/CachedObjectStorage','DiscISAM.php',177],['lib/google/src/Google/Service','DoubleClickBidManager.php',40],['lib/minify/lib/Minify/JS','ClosureCompiler.php',101],['lib/horde/framework/Horde/Imap/Client/Data/Format','String.php',38],['lib/form','dateselector.php',70],['lib/spout/src/Spout/Common/Helper','EncodingHelper.php',38],['report/competency/classes/output','user_course_navigation.php',51],['lib/adodb/drivers','adodb-postgres7.inc.php',98],['lib/adodb/drivers','adodb-postgres7.inc.php',311],['lib/adodb/drivers','adodb-postgres7.inc.php',342],['lib/lessphp/Tree','Alpha.php',13],['mod/lti/service/memberships/classes/local/resource','linkmemberships.php',46],['lib/tcpdf','tcpdf.php',1822],['lib/adodb/drivers','adodb-sybase.inc.php',47],['lib/adodb/drivers','adodb-sybase.inc.php',313],['lib/adodb/drivers','adodb-sybase.inc.php',394],['lib/phpexcel/PHPExcel/Chart','PlotArea.php',44],['lib/phpexcel/PHPExcel/Chart','DataSeries.php',136],['mod/lesson','editpage_form.php',41],['question/classes/statistics/responses','analysis_for_question.php',58],['lib/horde/framework/Horde','Domhtml.php',53],['lib','formslib.php',142],['lib','formslib.php',1442],['lib','formslib.php',2653],['rating','lib.php',114],['rating','lib.php',1070],['lib/phpexcel/PHPExcel/Worksheet','Column.php',44],['lib/google/src/Google/Service','Script.php',67],['lib/adodb','adodb-xmlschema.inc.php',118],['lib/adodb','adodb-xmlschema.inc.php',245],['lib/adodb','adodb-xmlschema.inc.php',637],['lib/adodb','adodb-xmlschema.inc.php',781],['lib/adodb','adodb-xmlschema.inc.php',982],['lib/adodb','adodb-xmlschema.inc.php',1295],['lib/google/src/Google/Service','DeploymentManager.php',54],['mod/quiz','attemptlib.php',41],['mod/quiz','attemptlib.php',82],['mod/quiz','attemptlib.php',546],['mod/quiz','attemptlib.php',2337],['mod/quiz','attemptlib.php',2392],['backup/cc/cc_lib','cc_converter_forum.php',29],['lib','boxlib.php',264],['lib/simplepie/library/SimplePie','Restriction.php',81],['admin/roles/classes','allow_assign_page.php',31],['lib/adodb/drivers','adodb-pdo.inc.php',90],['lib/adodb/drivers','adodb-pdo.inc.php',553],['lib/adodb/drivers','adodb-pdo.inc.php',630],['tag/classes/output','tagareacollection.php',40],['admin/tool/lp/classes','template_statistics.php',62],['lib','weblib.php',313],['lib','weblib.php',3183],['lib','weblib.php',3483],['lib','weblib.php',3518],['lib','weblib.php',3593],['backup/cc/cc_lib','cc_converter_basiclti.php',29],['lib/html2text','Html2Text.php',232],['mod/assign/feedback/editpdf/classes','annotation.php',66],['lib/pear/HTML/QuickForm/Renderer','Array.php',143],['question/engine','lib.php',774],['question/engine','lib.php',1011],['question/engine','lib.php',1059],['lib/jabber/XMPP','XMLObj.php',76],['lib/horde/framework/Horde/Exception','PermissionDenied.php',15],['lib/editor/atto','adminlib.php',109],['lib/pear/HTML/QuickForm/Renderer','Tableless.php',116],['grade/report/history/classes/output','tablelog.php',72],['lib/google/src/Google/IO','Curl.php',38],['lib/editor/tinymce/plugins/spellchecker/classes/utils','Logger.php',31],['lib/pear/HTML/QuickForm','hiddenselect.php',41],['backup/util/ui','backup_ui_setting.class.php',70],['backup/util/ui','backup_ui_setting.class.php',200],['backup/util/ui','backup_ui_setting.class.php',398],['backup/util/ui','backup_ui_setting.class.php',504],['backup/util/ui','backup_ui_setting.class.php',583],['lib/adodb/drivers','adodb-mysqlpo.inc.php',35],['lib/adodb/drivers','adodb-mysqlpo.inc.php',82],['lib/adodb/drivers','adodb-mysqlpo.inc.php',119],['lib/google/src/Google/Service','Blogger.php',50],['backup/util/xml/output','file_xml_output.class.php',37],['lib/form','tags.php',75],['admin/tool/installaddon/classes','installer.php',219],['lib/htmlpurifier/HTMLPurifier/AttrDef','Enum.php',30],['lib/simplepie/library/SimplePie','IRI.php',252],['comment','locallib.php',39],['question/engine','states.php',61],['lib/spout/src/Spout/Reader/XLSX/Helper','CellValueFormatter.php',52],['lib/google/src/Google/Service','Dataflow.php',45],['mod/data','locallib.php',66],['mod/data','locallib.php',433],['lib/horde/framework/Horde','Variables.php',60],['backup/util/ui','base_ui.class.php',84],['lib/simplepie/library/SimplePie','Registry.php',99],['cache/locks/file','lib.php',66],['question/classes/statistics/responses','analysis_for_class.php',68],['lib/filebrowser','file_info_stored.php',51],['tag/classes/output','tagcollname.php',42],['competency/classes','persistent.php',54],['admin/tool/lp/classes/output','competency_plan_navigation.php',54],['lib/phpexcel/PHPExcel/Cell','DataValidation.php',146],['lib/pear/HTML/QuickForm','textarea.php',48],['lib/lessphp','Visitor.php',14],['lib/google/src/Google/Service','CloudUserAccounts.php',52],['question/classes/bank','column_base.php',44],['lib/minify/lib/MrClay','Cli.php',74],['lib','outputcomponents.php',80],['lib','outputcomponents.php',204],['lib','outputcomponents.php',469],['lib','outputcomponents.php',523],['lib','outputcomponents.php',589],['lib','outputcomponents.php',665],['lib','outputcomponents.php',783],['lib','outputcomponents.php',925],['lib','outputcomponents.php',1009],['lib','outputcomponents.php',2183],['lib','outputcomponents.php',2222],['lib','outputcomponents.php',2295],['lib','outputcomponents.php',2376],['lib','outputcomponents.php',2579],['lib','outputcomponents.php',2627],['lib','outputcomponents.php',2687],['lib','outputcomponents.php',2860],['lib','outputcomponents.php',3030],['lib','outputcomponents.php',3134],['lib','outputcomponents.php',3201],['lib','outputcomponents.php',3329],['lib','outputcomponents.php',3613],['lib','outputcomponents.php',3642],['lib','outputcomponents.php',3668],['lib','outputcomponents.php',3690],['lib','outputcomponents.php',3719],['lib','outputcomponents.php',3751],['lib/google/src/Google/Service','Pagespeedonline.php',39],['lib/phpexcel/PHPExcel','Cell.php',114],['lib/dml','sqlsrv_native_moodle_recordset.php',40],['repository/wikimedia','wikimedia.php',35],['lib/phpexcel/PHPExcel/Style','Fill.php',81],['lib/google/src/Google/Service','Cloudresourcemanager.php',42],['lib/editor/tinymce/classes','plugin.php',49],['mod/wiki/parser/markups','html.php',21],['lib/simplepie/library/SimplePie/Parse','Date.php',536],['lib/horde/framework/Horde/Support','Inflector.php',115],['question/type/gapselect','question.php',55],['lib/google/src/Google','Config.php',33],['badges/criteria','award_criteria_activity.php',45],['backup/util/xml/output','xml_output.class.php',52],['backup/util/xml/output','xml_output.class.php',158],['course/format/topics','renderer.php',38],['lib/adodb/drivers','adodb-oci8po.inc.php',33],['lib/adodb/drivers','adodb-oci8po.inc.php',99],['mod/workshop/allocation/random','lib.php',52],['mod/workshop/allocation/random','lib.php',727],['backup/util/structure','base_final_element.class.php',38],['backup/util/structure','base_final_element.class.php',239],['backup/util/structure','base_final_element.class.php',256],['lib/htmlpurifier/HTMLPurifier','Zipper.php',25],['lib/horde/framework/Horde/Imap/Client/Data','Thread.php',41],['lib/mustache/src/Mustache/Exception','UnknownHelperException.php',22],['backup/util/settings/activity','activity_backup_setting.class.php',25],['lib/filestorage','tgz_packer.php',749],['lib/filestorage','tgz_packer.php',831],['tag/classes','index_builder.php',96],['lib/pear/HTML/QuickForm','reset.php',37],['lib/classes/lock','lock.php',55],['admin/roles/classes','assign_user_selector_base.php',40],['backup/util/output','output_controller.class.php',44],['question/type/randomsamatch','question.php',114],['lib/google/src/Google/Service','Customsearch.php',38],['lib/lessphp/Tree','Extend.php',28],['lib/phpexcel/PHPExcel/Shared/PCLZip','pclzip.lib.php',215],['lib/google/src/Google/Service','TagManager.php',67],['question/type/gapselect/tests','edit_form_test.php',41],['mod/lesson','locallib.php',2004],['mod/lesson','locallib.php',2611],['backup/util/helper','restore_structure_parser_processor.class.php',41],['course','renderer.php',52],['backup/util/xml/parser/processors','selective_exact_parser_processor.class.php',35],['lib','modinfolib.php',429],['lib','modinfolib.php',1665],['lib','modinfolib.php',2492],['lib','tablelib.php',128],['lib','tablelib.php',1468],['lib','tablelib.php',1633],['lib','tablelib.php',1698],['user/filters','cohort.php',36],['user/filters','text.php',37],['lib','outputrenderers.php',120],['lib','outputrenderers.php',285],['lib','outputrenderers.php',408],['lib','outputrenderers.php',4578],['lib','outputrenderers.php',4831],['repository','lib.php',116],['repository','lib.php',533],['lib','adminlib.php',791],['lib','adminlib.php',1138],['lib','adminlib.php',1212],['lib','adminlib.php',1355],['lib','adminlib.php',1556],['lib','adminlib.php',1928],['lib','adminlib.php',2040],['lib','adminlib.php',2106],['lib','adminlib.php',2199],['lib','adminlib.php',2260],['lib','adminlib.php',2302],['lib','adminlib.php',2341],['lib','adminlib.php',2429],['lib','adminlib.php',2463],['lib','adminlib.php',2621],['lib','adminlib.php',2706],['lib','adminlib.php',2935],['lib','adminlib.php',3091],['lib','adminlib.php',3233],['lib','adminlib.php',3324],['lib','adminlib.php',3488],['lib','adminlib.php',3571],['lib','adminlib.php',3682],['lib','adminlib.php',3833],['lib','adminlib.php',4067],['lib','adminlib.php',4134],['lib','adminlib.php',4352],['lib','adminlib.php',4381],['lib','adminlib.php',4410],['lib','adminlib.php',4434],['lib','adminlib.php',4464],['lib','adminlib.php',4500],['lib','adminlib.php',4535],['lib','adminlib.php',4567],['lib','adminlib.php',4657],['lib','adminlib.php',4690],['lib','adminlib.php',4748],['lib','adminlib.php',4790],['lib','adminlib.php',4814],['lib','adminlib.php',4840],['lib','adminlib.php',4863],['lib','adminlib.php',4880],['lib','adminlib.php',4925],['lib','adminlib.php',4943],['lib','adminlib.php',5002],['lib','adminlib.php',5045],['lib','adminlib.php',5080],['lib','adminlib.php',5123],['lib','adminlib.php',5206],['lib','adminlib.php',5336],['lib','adminlib.php',5378],['lib','adminlib.php',5423],['lib','adminlib.php',5480],['lib','adminlib.php',5496],['lib','adminlib.php',5552],['lib','adminlib.php',5777],['lib','adminlib.php',5831],['lib','adminlib.php',5885],['lib','adminlib.php',5902],['lib','adminlib.php',5950],['lib','adminlib.php',5992],['lib','adminlib.php',6043],['lib','adminlib.php',6099],['lib','adminlib.php',6328],['lib','adminlib.php',6508],['lib','adminlib.php',6688],['lib','adminlib.php',6782],['lib','adminlib.php',6931],['lib','adminlib.php',7088],['lib','adminlib.php',7712],['lib','adminlib.php',8147],['lib','adminlib.php',8330],['lib','adminlib.php',8617],['lib','adminlib.php',8764],['lib','adminlib.php',8924],['lib','adminlib.php',9071],['lib','adminlib.php',9235],['lib','adminlib.php',9428],['lib','adminlib.php',9482],['lib','adminlib.php',9544],['lib','adminlib.php',9589],['lib','adminlib.php',9626],['backup/cc/cc_lib','cc_organization.php',47],['backup/cc/cc_lib','cc_organization.php',145],['lib/phpexcel/PHPExcel/Chart','DataSeriesValues.php',81],['lib/horde/framework/Horde/Mail/Rfc822','Identification.php',34],['question/type/numerical','questiontype.php',507],['auth/mnet','auth.php',35],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Cache.php',68],['lib/htmlpurifier/HTMLPurifier','PropertyList.php',29],['auth/imap','auth.php',35],['tag/classes/output','taglist.php',54],['lib','pdflib.php',161],['lib/phpexcel/PHPExcel/RichText','TextElement.php',35],['lib/dml','database_column_info.php',112],['lib/horde/framework/Horde/Imap/Client/Exception','NoSupportExtension.php',33],['mod/wiki/editors','wikieditor.php',36],['lib/lessphp/SourceMap','Base64VLQ.php',67],['repository/s3','lib.php',44],['admin/tool/uploadcourse/classes','course.php',111],['lib/google/src/Google/Service','Replicapoolupdater.php',51],['lib/horde/framework/Horde/Imap/Client/Data/Format','Date.php',25],['lib/bennu','iCalendar_components.php',21],['lib/bennu','iCalendar_components.php',333],['lib/bennu','iCalendar_components.php',355],['lib/bennu','iCalendar_components.php',433],['lib/bennu','iCalendar_components.php',513],['lib/bennu','iCalendar_components.php',551],['lib/bennu','iCalendar_components.php',602],['lib/bennu','iCalendar_components.php',659],['lib/bennu','iCalendar_components.php',679],['lib/phpexcel/PHPExcel/Calculation','FormulaToken.php',102],['mod/feedback/item','feedback_item_class.php',28],['lib/adodb/drivers','adodb-mssql_n.inc.php',245],['lib','badgeslib.php',133],['lib/pear/HTML/QuickForm','text.php',38],['lib/simplepie/library/SimplePie','Enclosure.php',219],['calendar/classes','rrule_manager.php',182],['auth/webservice','auth.php',35],['lib','outputrequirementslib.php',171],['mod/lti/service/toolsettings/classes/local/resource','contextsettings.php',44],['lib','questionlib.php',1261],['lib','questionlib.php',1505],['lib','uploadlib.php',40],['lib/spout/src/Spout/Writer/Common/Helper','ZipHelper.php',28],['lib/google/src/Google/Service','Cloudsearch.php',40],['backup/util/structure','backup_nested_element.class.php',44],['lib/spout/src/Spout/Writer/Common','Sheet.php',39],['question/behaviour','behaviourbase.php',50],['blocks/rss_client/classes/output','footer.php',47],['lib/dtl','file_xml_database_importer.php',34],['admin/roles/classes','capability_table_with_risks.php',45],['lib/adodb/drivers','adodb-mssql.inc.php',110],['lib/adodb/drivers','adodb-mssql.inc.php',870],['lib/adodb/drivers','adodb-mssql.inc.php',1077],['lib/google/src/Google/Service','Bigquery.php',62],['lib/google/src/Google/Service','ShoppingContent.php',50],['mod/lti','OAuth.php',73],['mod/lti','OAuth.php',89],['mod/lti','OAuth.php',244],['mod/lti','OAuth.php',499],['repository/equella','lib.php',42],['lib/phpexcel/PHPExcel/Worksheet','PageMargins.php',80],['backup/cc/cc_lib','cc_converter_quiz.php',33],['lib/horde/framework/Horde/Imap/Client/Interaction','Pipeline.php',60],['lib/phpexcel/PHPExcel/Shared/trend','polynomialBestFitClass.php',199],['backup/util/helper','restore_decode_processor.class.php',47],['backup/util/helper','restore_decode_processor.class.php',182],['cache/classes','helper.php',90],['lib/simplepie/library/SimplePie','Credit.php',81],['lib/classes','chart_series.php',62],['lib/classes/dml','recordset_walk.php',64],['lib/google/src/Google/Service','Webmasters.php',47],['lib/tcpdf/include/barcodes','qrcode.php',631],['backup/moodle2','backup_settingslib.php',42],['backup/moodle2','backup_settingslib.php',138],['lib/spout/src/Spout/Writer/XLSX/Helper','SharedStringsHelper.php',40],['course/tests/fixtures','course_capability_assignment.php',60],['mod/forum/classes','subscriber_selector_base.php',53],['lib','blocklib.php',54],['lib','blocklib.php',152],['report/loglive/classes','table_log.php',50],['lib','navigationlib.php',147],['lib','navigationlib.php',1015],['lib','navigationlib.php',2825],['lib','navigationlib.php',3086],['lib','navigationlib.php',3412],['lib','navigationlib.php',3459],['lib','navigationlib.php',4888],['lib','navigationlib.php',5070],['lib/phpexcel/PHPExcel/Shared/JAMA','CholeskyDecomposition.php',41],['grade/report/history/classes/output','user_button.php',40],['user/filters','courserole.php',34],['lib/phpexcel/PHPExcel','IOFactory.php',69],['lib/lessphp/Tree','Color.php',15],['lib/phpexcel/PHPExcel/Worksheet','MemoryDrawing.php',70],['lib/adodb/drivers','adodb-vfp.inc.php',72],['lib/horde/framework/Horde/Support','Backtrace.php',20],['lib/google/src/Google/Service','Clouddebugger.php',50],['lib/horde/framework/Horde/Exception','NotFound.php',15],['admin/tool/lp/classes/output','user_competency_course_navigation.php',55],['lib/lessphp/Tree','UnicodeDescriptor.php',14],['lib/phpexcel/PHPExcel/Worksheet','PageSetup.php',277],['grade/report/singleview/classes/local/ui','bulk_insert.php',40],['lib','mathslib.php',45],['lib/filestorage','tgz_extractor.php',119],['lib/horde/framework/Horde/Imap/Client/Interaction/Command','Continuation.php',42],['lib/horde/framework/Horde/Imap/Client','Exception.php',247],['filter/emoticon/tests','filter_test.php',68],['mnet/xmlrpc','xmlparser.php',15],['lib/spout/src/Spout/Reader/XLSX','Sheet.php',31],['admin/roles/classes','capability_table_base.php',51],['lib/simplepie/library/SimplePie','Item.php',82],['lib/form','selectgroups.php',57],['auth/shibboleth','auth.php',38],['admin/tool/langimport/classes','controller.php',48],['lib/form','warning.php',49],['lib/filestorage','stored_file.php',63],['grade/grading/form/guide','guideeditor.php',49],['lib/pear/HTML/QuickForm','group.php',80],['backup/moodle2','restore_subplugin.class.php',45],['grade/export','lib.php',60],['grade/export','lib.php',625],['lib/phpexcel/PHPExcel/Style','NumberFormat.php',98],['backup/moodle2','backup_section_task.class.php',40],['lib/htmlpurifier/HTMLPurifier','Config.php',100],['lib','flickrlib.php',53],['mod/assign/classes/output','grading_app.php',59],['grade/report/singleview/classes/local/ui','grade_attribute_format.php',47],['user/profile/field/menu','field.class.php',39],['lib/spout/src/Spout/Writer/Common/Internal','AbstractWorkbook.php',30],['lib/portfolio','exporter.php',113],['lib','ddllib.php',80],['lib','ddllib.php',93],['lib','ddllib.php',107],['lib','ddllib.php',126],['lib','ddllib.php',140],['lib/horde/framework/Horde/Crypt','Blowfish.php',54],['lib/horde/framework/Horde','Secret.php',48],['lib/htmlpurifier/HTMLPurifier/AttrDef','Integer.php',36],['lib/classes/update','info.php',48],['lib/htmlpurifier/HTMLPurifier/ConfigSchema','ValidatorAtom.php',31],['lib/lessphp/Tree','Anonymous.php',21],['admin/tool/lp/classes','course_competencies_form_element.php',43],['lib/lessphp/Tree','Comment.php',17],['auth/cas/CAS/CAS','OutOfSequenceBeforeAuthenticationCallException.php',47],['question/type/calculatedsimple','edit_calculatedsimple_form.php',72],['lib/adodb/drivers','adodb-mysql.inc.php',54],['lib/adodb/drivers','adodb-mysql.inc.php',717],['lib/adodb/drivers','adodb-mysql.inc.php',880],['enrol/ldap','lib.php',43],['mod/quiz/report/statistics','statistics_table.php',45],['lib/form','listing.php',68],['lib/google/src/Google/Service','Container.php',43],['mod/quiz','accessmanager.php',45],['lib/classes/message/inbound','processing_failed_exception.php',36],['blocks/online_users/classes','fetcher.php',45],['lib/pear/HTML/QuickForm','checkbox.php',48],['auth/cas/CAS/CAS','OutOfSequenceBeforeProxyException.php',48],['mod/lti/service/toolproxy/classes/local/service','toolproxy.php',41],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','URI.php',15],['lib/classes','chart_axis.php',65],['mod/glossary/classes','entry_query_builder.php',83],['mod/feedback/item/label','lib.php',26],['lib/adodb/drivers','adodb-mssqlnative.inc.php',131],['lib/adodb/drivers','adodb-mssqlnative.inc.php',847],['lib/adodb/drivers','adodb-mssqlnative.inc.php',1099],['lib/horde/framework/Horde/Imap/Client','Ids.php',78],['lib/form','editor.php',62],['lib','environmentlib.php',1258],['mod/workshop','fileinfolib.php',43],['mod/workshop','fileinfolib.php',198],['mod/feedback/classes','templates_table.php',39],['tag/classes','manage_table.php',44],['lib/adodb/drivers','adodb-odbc_db2.inc.php',115],['lib/adodb/drivers','adodb-odbc_db2.inc.php',309],['backup/cc/cc_lib/gral_lib','cssparser.php',21],['lib/horde/framework/Horde/Support','Array.php',21],['lib/google/src/Google/Service','GroupsMigration.php',40],['admin/tool/lp/classes/output','user_evidence_list_page.php',61],['lib/google/src/Google/Service','Audit.php',39],['lib/simplepie/library/SimplePie','File.php',68],['lib/horde/framework/Horde/Imap/Client','Mailbox.php',62],['enrol/lti/classes','manage_table.php',62],['lib/simplepie/library/SimplePie/Content/Type','Sniffer.php',69],['question/type','questionbase.php',124],['question/type','questionbase.php',438],['question/type','questionbase.php',531],['question/type','questionbase.php',750],['question/type','questionbase.php',835],['question/type','questionbase.php',868],['question/type','questionbase.php',914],['question/type','questionbase.php',1013],['question/type/ddimageortext','question.php',64],['question/type/ddimageortext','question.php',122],['lib','excellib.class.php',47],['lib','excellib.class.php',155],['lib','excellib.class.php',456],['lib/minify/lib','CSSmin.php',43],['lib/dml','moodle_temptables.php',51],['lib/minify/lib/Minify/Cache','ZendPlatform.php',23],['backup/util/xml/parser','progressive_parser.class.php',79],['backup/util/xml/parser','progressive_parser.class.php',305],['blocks/rss_client/classes/output','block.php',47],['question/type/ddmarker','question.php',417],['question/type/ddmarker','question.php',469],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Percentage.php',18],['admin/tool/lp/classes/output','user_competency_summary_in_course.php',51],['backup/util/helper','convert_helper.class.php',378],['lib/classes/update','validator.php',265],['lib/lessphp/Tree','Attribute.php',16],['admin/tool/generator/classes','backend.php',84],['backup/util/loggers','file_logger.class.php',35],['lib/adodb','adodb-exceptions.inc.php',30],['lib/google/src/Google','Client.php',70],['user/filters','profilefield.php',36],['backup/util/helper','restore_inforef_parser_processor.class.php',37],['cache/tests/fixtures','lib.php',326],['mod/lti/service/profile/classes/local/resource','profile.php',43],['competency/classes','invalid_persistent_exception.php',38],['backup/util/plan','backup_plan.class.php',36],['backup/util/plan','backup_plan.class.php',130],['lib/phpexcel/PHPExcel/Writer/Excel2007','WriterPart.php',63],['backup/util/settings','setting_dependency.class.php',68],['backup/util/settings','setting_dependency.class.php',175],['backup/util/settings','setting_dependency.class.php',328],['backup/util/settings','setting_dependency.class.php',439],['backup/util/settings','setting_dependency.class.php',465],['backup/util/settings','setting_dependency.class.php',491],['backup/util/settings','setting_dependency.class.php',556],['backup/util/xml','xml_writer.class.php',57],['backup/util/xml','xml_writer.class.php',284],['enrol/imsenterprise','locallib.php',38],['enrol/imsenterprise','locallib.php',115],['lib/dml','moodle_database.php',139],['search/classes','base.php',69],['admin/tool/lp/classes/output','competency_summary.php',54],['lib','upgradelib.php',45],['lib','upgradelib.php',61],['lib','upgradelib.php',76],['lib','upgradelib.php',94],['lib','upgradelib.php',111],['lib/htmlpurifier/HTMLPurifier/AttrTransform','NameSync.php',11],['mod/workshop/form/rubric','lib.php',105],['grade','lib.php',103],['grade','lib.php',927],['grade','lib.php',1089],['grade','lib.php',2053],['grade','lib.php',2213],['lib/horde/framework/Horde/Imap/Client/Data','Acl.php',32],['lib/phpexcel/PHPExcel/Reader/Excel5','RC4.php',35],['lib/google/src/Google/Service','Datastore.php',46],['admin/tool/lpmigrate/classes','framework_processor.php',98],['lib/dtl','database_importer.php',61],['lib/horde/framework/Horde/Imap/Client/Password','Xoauth2.php',44],['badges/lib','awardlib.php',55],['backup/util/helper','backup_array_iterator.class.php',39],['admin/tool/monitor/classes','subscription.php',43],['question/type/calculated','edit_calculated_form.php',51],['lib/spout/src/Spout/Reader/XLSX/Helper/SharedStringsCaching','FileBasedStrategy.php',57],['lib/form','datetimeselector.php',72],['lib/horde/framework/Horde/Imap/Client','Base.php',153],['lib/classes','collator.php',58],['admin/tool/lp/classes','course_competency_statistics.php',48],['lib/google/src/Google/Service','Storage.php',57],['lib/spout/src/Spout/Reader/CSV','SheetIterator.php',28],['lib/lessphp/Tree','Paren.php',14],['mod/lti/classes','service_exception_handler.php',63],['lib/tcpdf/include/barcodes','pdf417.php',523],['mod/assign/feedback/offline','importgradeslib.php',66],['lib/filestorage','file_exceptions.php',36],['lib/filestorage','file_exceptions.php',57],['lib/filestorage','file_exceptions.php',89],['lib/filestorage','file_exceptions.php',108],['lib/filestorage','file_exceptions.php',129],['lib/horde/framework/Horde/Mail/Transport','Smtp.php',100],['lib/htmlpurifier/HTMLPurifier/ConfigSchema/Interchange','Id.php',17],['question/engine/upgrade','upgradelib.php',283],['question/engine/upgrade','upgradelib.php',384],['question/type/numerical','question.php',323],['lib/pear/PEAR','Exception.php',107],['course/format','renderer.php',44],['lib/dml','oci_native_moodle_recordset.php',34],['question/behaviour','behaviourtypebase.php',133],['lib/pear/HTML','QuickForm.php',246],['lib/pear/HTML','QuickForm.php',1979],['backup/util/structure','base_atom.class.php',41],['backup/util/structure','base_atom.class.php',114],['backup/util/structure','base_atom.class.php',135],['backup/util/structure','base_atom.class.php',156],['lib/horde/framework/Horde/Imap/Client/Data','BaseSubject.php',39],['lib/google/src/Google/Auth','LoginTicket.php',37],['lib/adodb/drivers','adodb-csv.inc.php',41],['lib/adodb/drivers','adodb-csv.inc.php',196],['user/filters','yesno.php',33],['mod/wiki/parser','parser.php',98],['lib/htmlpurifier/HTMLPurifier/Token','Comment.php',19],['lib/phpexcel/PHPExcel/Calculation','FormulaParser.php',87],['backup/cc/cc_lib','cc_assesment_truefalse.php',27],['lib/htmlpurifier/HTMLPurifier','Encoder.php',10],['admin/tool/lpmigrate/classes/form','migrate_framework.php',45],['backup/util/xml/parser/tests','parser_test.php',797],['lib/htmlpurifier/HTMLPurifier/AttrTransform','EnumToCSS.php',34],['lib/tests','medialib_test.php',644],['lib/google/src/Google/Service','QPXExpress.php',39],['tag/classes/output','tagname.php',41],['lib/mustache/src/Mustache','Context.php',20],['lib/adodb/drivers','adodb-oracle.inc.php',32],['lib/adodb/drivers','adodb-oracle.inc.php',224],['backup/moodle2','restore_section_task.class.php',42],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Composite.php',25],['lib/htmlpurifier/HTMLPurifier/AttrTransform','Nofollow.php',16],['mod/forum/classes/output','forum_post.php',110],['admin/tool/assignmentupgrade','locallib.php',50],['admin/tool/assignmentupgrade','locallib.php',93],['repository/googledocs','lib.php',65],['cache/stores/memcache','lib.php',120],['lib/filestorage','file_storage.php',78],['admin/tool/monitor/classes/output/managerules','renderable.php',56],['mod/lti/service/toolsettings/classes/local/resource','linksettings.php',45],['lib/form','duration.php',55],['lib','outputlib.php',480],['lib','outputlib.php',2038],['filter/tex','latex.php',13],['backup/moodle2','backup_course_task.class.php',39],['lib/adodb','adodb.inc.php',310],['lib/adodb','adodb.inc.php',3035],['lib/adodb','adodb.inc.php',3160],['lib/adodb','adodb.inc.php',3242],['lib/adodb','adodb.inc.php',4353],['lib/horde/framework/Horde/Support','Randomid.php',26],['lib/google/src/Google/Logger','File.php',51],['admin/roles/classes','allow_role_page.php',37],['mod/quiz/report/overview','overview_table.php',41],['lib/lessphp/Tree','Keyword.php',17],['lib/htmlpurifier/HTMLPurifier/Node','Comment.php',19],['question/type/ddmarker','questiontype.php',48],['mod/folder','renderer.php',159],['lib','portfoliolib.php',101],['tag/classes/output','tagcollsearchable.php',40],['webservice/soap/classes','wsdl.php',88],['lib/lessphp/Exception','Parser.php',30],['badges','renderer.php',973],['badges','renderer.php',1014],['badges','renderer.php',1078],['badges','renderer.php',1111],['badges','renderer.php',1137],['competency/classes/external','exporter.php',56],['mod/lti/service/toolproxy/classes/local/resource','toolproxy.php',47],['lib/google/src/Google/Service','Genomics.php',63],['lib/phpexcel/PHPExcel/Writer','PDF.php',38],['lib/phpexcel/PHPExcel/Shared/trend','exponentialBestFitClass.php',125],['lib/google/src/Google/Service','Games.php',60],['backup/converter/moodle1','lib.php',725],['backup/converter/moodle1','lib.php',865],['backup/converter/moodle1','lib.php',1145],['backup/converter/moodle1','lib.php',1190],['backup/converter/moodle1','lib.php',1480],['backup/util/helper','restore_logs_processor.class.php',45],['backup/util/helper','restore_logs_processor.class.php',141],['lib/htmlpurifier/HTMLPurifier/AttrTransform','Input.php',14],['lib/google/src/Google/Service','Licensing.php',40],['mod/workshop/form/comments','lib.php',99],['backup/util/settings/section','section_backup_setting.class.php',25],['lib/htmlpurifier/HTMLPurifier','Doctype.php',48],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Font.php',22],['lib/google/src/Google/Service','Fitness.php',58],['blocks/private_files','renderer.php',83],['lib/phpexcel/PHPExcel/Worksheet','ColumnCellIterator.php',51],['enrol/flatfile','adminlib.php',35],['lib/xmldb','xmldb_object.php',55],['lib/google/src/Google/Service','Reports.php',47],['question/classes/statistics/responses','analysis_for_actual_response.php',70],['auth/pam','auth.php',53],['lib/horde/framework/Horde','Stream.php',50],['comment','lib.php',100],['lib/htmlpurifier/HTMLPurifier','URIParser.php',10],['lib/htmlpurifier/HTMLPurifier/Node','Text.php',35],['lib/phpexcel/PHPExcel/Worksheet','RowDimension.php',53],['lib/google/src/Google/Service','Gmail.php',64],['lib/google/src/Google/Service','Taskqueue.php',44],['lib/minify/lib/Minify','ImportProcessor.php',48],['lib/horde/framework/Horde/Mime','Related.php',32],['blocks','moodleblock.class.php',111],['lib/tcpdf','tcpdf_parser.php',92],['backup/util/plan','restore_structure_step.class.php',46],['blocks/rss_client/classes/output','channel_image.php',61],['lib/pear/HTML/QuickForm','hierselect.php',105],['question/type/numerical/tests','form_test.php',40],['badges/lib','backpacklib.php',40],['mod/workshop/allocation/manual','lib.php',51],['mod/quiz/report/responses','last_responses_table.php',39],['lib/simplepie','autoloader.php',62],['lib/spout/src/Spout/Common/Helper','StringHelper.php',21],['lib/phpexcel/PHPExcel/Worksheet','BaseDrawing.php',121],['lib/pear/Crypt','CHAP.php',82],['lib/pear/Crypt','CHAP.php',170],['lib/pear/Crypt','CHAP.php',424],['lib/spout/src/Spout/Writer/Common/Helper','AbstractStyleHelper.php',22],['backup/util/xml/parser/processors','progressive_parser_processor.class.php',57],['mod/quiz/classes/question','qubaids_for_users_attempts.php',37],['lib/spout/src/Spout/Reader/XLSX','RowIterator.php',63],['lib/phpexcel/PHPExcel/Reader/Excel5','Escher.php',77],['lib/simplepie/library/SimplePie','gzdecode.php',186],['mod/wiki','renderer.php',540],['lib/adodb','adodb-active-recordx.inc.php',138],['availability/classes','result.php',46],['lib','accesslib.php',5352],['lib','accesslib.php',5897],['lib','accesslib.php',6167],['lib','accesslib.php',6408],['lib','accesslib.php',6595],['lib','accesslib.php',6827],['lib','accesslib.php',7049],['lib','accesslib.php',7291],['lib/phpexcel/PHPExcel/Shared/OLE','PPS.php',110],['grade/grading/form','lib.php',82],['grade/grading/form','lib.php',766],['question/engine','questionusage.php',78],['question/engine','questionusage.php',973],['auth/manual','auth.php',46],['question/engine/upgrade','behaviourconverters.php',78],['mod/wiki/diff','diff_nwiki.php',35],['mod/wiki/diff','diff_nwiki.php',50],['mod/wiki/diff','diff_nwiki.php',63],['mod/wiki/diff','diff_nwiki.php',76],['mod/wiki/diff','diff_nwiki.php',495],['mod/wiki/diff','diff_nwiki.php',640],['mod/wiki/diff','diff_nwiki.php',850],['mod/wiki/diff','diff_nwiki.php',901],['mod/wiki/diff','diff_nwiki.php',953],['lib/adodb/drivers','adodb-proxy.inc.php',28],['lib/classes/lock','file_lock_factory.php',57],['lib/google/src/Google/Auth','OAuth2.php',55],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','Pixels.php',17],['lib/filebrowser','file_info_context_module.php',47],['auth/none','auth.php',34],['lib/simplepie/library/SimplePie/Cache','Base.php',70],['lib/htmlpurifier/HTMLPurifier','Queue.php',24],['lib/horde/framework/Horde/Text','Flowed.php',75],['admin/tool/log/store/legacy/classes/log','store.php',33],['lib/mustache/src/Mustache','HelperCollection.php',19],['backup/util/structure','backup_structure_processor.class.php',45],['backup/util/structure','backup_structure_processor.class.php',133],['admin/tool/lp/classes/output','related_competencies.php',47],['mod/quiz/classes/question/bank','custom_view.php',44],['files','renderer.php',1083],['lib/form','text.php',47],['lib/phpexcel/PHPExcel/Shared/trend','bestFitClass.php',398],['backup/cc','cc112moodle.php',59],['admin/tool/cohortroles/classes/output','cohort_role_assignments_table.php',45],['lib/horde/framework/Horde/Imap/Client/Data','Envelope.php',46],['lib/google/src/Google/Service','Logging.php',39],['lib/lessphp/Tree','Expression.php',16],['mod/lti/classes/local/ltiservice','service_base.php',63],['lib/phpexcel/PHPExcel/Reader','HTML.php',118],['search/engine/solr/classes','schema.php',60],['backup/util/xml/parser/processors','simplified_parser_processor.class.php',46],['lib/htmlpurifier/HTMLPurifier','UnitConverter.php',50],['lib/adodb/drivers','adodb-ado5.inc.php',42],['lib/adodb/drivers','adodb-ado5.inc.php',380],['mod/assign/feedback/editpdf/classes','comment.php',58],['cache/classes','interfaces.php',473],['lib/phpexcel/PHPExcel/Worksheet','Protection.php',157],['repository/merlot','lib.php',37],['lib/adodb/drivers','adodb-firebird.inc.php',69],['backup/util/settings','backup_setting.class.php',43],['lib/adodb/drivers','adodb-fbsql.inc.php',28],['lib/adodb/drivers','adodb-fbsql.inc.php',167],['mnet/xmlrpc','serverlib.php',674],['webservice/soap','lib.php',45],['admin/tool/log/store/database/classes/log','store.php',47],['lib/google/src/Google/Service','Doubleclicksearch.php',43],['lib/form','passwordunmask.php',46],['lib/lessphp/Tree','Variable.php',20],['report/log/classes','renderable.php',96],['mod/lti/service/toolsettings/classes/local/resource','systemsettings.php',43],['question/classes/bank','view.php',70],['grade/report/singleview/classes/local/ui','range.php',38],['lib/simplepie/library/SimplePie/Cache','MySQL.php',80],['admin/roles/classes','define_role_table_basic.php',31],['backup/cc/cc_lib','cc_converter_resource.php',28],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Mongo.php',78],['blocks/rss_client','editfeed.php',36],['admin/tool/lpmigrate/classes/output','migrate_framework_results.php',55],['blocks/lp/classes/output','competencies_to_review_page.php',49],['lib/horde/framework/Horde/Crypt/Blowfish/Php','Base.php',318],['backup/util/loggers','base_logger.class.php',42],['backup/util/loggers','base_logger.class.php',187],['mod/assign/feedback/file','renderable.php',44],['backup/cc/cc_lib','cc_utils.php',313],['backup/cc/cc_lib','cc_utils.php',381],['backup/cc/cc_lib','cc_utils.php',437],['lib/adodb/drivers','adodb-db2.inc.php',66],['lib/adodb/drivers','adodb-db2.inc.php',731],['lib/adodb','adodb-xmlschema03.inc.php',136],['lib/adodb','adodb-xmlschema03.inc.php',270],['lib/adodb','adodb-xmlschema03.inc.php',678],['lib/adodb','adodb-xmlschema03.inc.php',823],['lib/adodb','adodb-xmlschema03.inc.php',1081],['lib/adodb','adodb-xmlschema03.inc.php',1399],['repository/youtube','lib.php',58],['lib/phpexcel/PHPExcel/Writer/PDF','mPDF.php',38],['auth/cas/CAS/CAS','GracefullTerminationException.php',48],['lib/adodb/drivers','adodb-sybase_ase.inc.php',25],['lib/adodb/drivers','adodb-sybase_ase.inc.php',115],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Background.php',20],['lib/adodb','adodb-memcache.lib.inc.php',53],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','FrameTarget.php',19],['lib/phpexcel/PHPExcel/Writer','Excel2007.php',118],['lib/minify/lib/MrClay/Cli','Arg.php',82],['lib/phpexcel/PHPExcel/Worksheet/AutoFilter','Column.php',117],['lib/simplepie','moodle_simplepie.php',50],['lib/simplepie','moodle_simplepie.php',121],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','FontFamily.php',11],['lib/simplepie/library/SimplePie/Decode/HTML','Entities.php',80],['lib/spout/src/Spout/Common/Helper','FileSystemHelper.php',22],['lib/pear/HTML/QuickForm','button.php',37],['lib/google/src/Google/Service','Autoscaler.php',46],['lib/mustache/src/Mustache','Engine.php',63],['lib/google/src/Google/Http','MediaFileUpload.php',75],['lib/phpexcel/PHPExcel','Worksheet.php',327],['mod/assign','gradingtable.php',68],['lib/google/src/Google/Service','AdExchangeSeller.php',53],['question/engine/tests','helpers.php',582],['question/engine/tests','helpers.php',594],['question/engine/tests','helpers.php',608],['question/engine/tests','helpers.php',623],['question/engine/tests','helpers.php',637],['question/engine/tests','helpers.php',652],['question/engine/tests','helpers.php',665],['question/engine/tests','helpers.php',676],['question/engine/tests','helpers.php',1196],['repository/webdav','lib.php',38],['tag/classes/output','tagisstandard.php',39],['lib/google/src/Google/Service','Appsactivity.php',52],['badges/criteria','award_criteria_course.php',47],['lib','searchlib.php',53],['lib','searchlib.php',95],['lib/lessphp/Output','Mapped.php',39],['availability/classes','tree.php',118],['lib/lessphp/Tree','Javascript.php',20],['lib/horde/framework/Horde/Imap/Client','Cache.php',53],['lib/htmlpurifier/HTMLPurifier','AttrCollections.php',16],['lib/mustache/src/Mustache/Loader','InlineLoader.php',56],['repository/url','lib.php',46],['lib/phpexcel/PHPExcel/CachedObjectStorage','SQLite3.php',293],['lib/lessphp/Tree','Ruleset.php',45],['tag/classes/output','tagindex.php',52],['backup/util/ui','backup_ui_stage.class.php',43],['backup/util/ui','backup_ui_stage.class.php',79],['backup/util/ui','backup_ui_stage.class.php',234],['backup/util/ui','backup_ui_stage.class.php',387],['backup/util/ui','backup_ui_stage.class.php',516],['backup/util/ui','backup_ui_stage.class.php',575],['grade/report/singleview/classes/local/screen','screen.php',67],['lib/tcpdf/include/barcodes','datamatrix.php',229],['lib/horde/framework/Horde/Imap/Client/Socket','Catenate.php',37],['lib/google/src/Google/Service','Prediction.php',51],['lib/classes/output','notification.php',101],['lib/lessphp/Tree','Unit.php',16],['backup/util/settings/course','course_backup_setting.class.php',25],['lib/spout/src/Spout/Writer','AbstractWriter.php',68],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','DenyElementDecorator.php',21],['lib','outputfactories.php',120],['lib','outputfactories.php',367],['lib','dtllib.php',66],['mod/assign','assignmentplugin.php',50],['mnet/service/enrol','locallib.php',48],['mnet/service/enrol','locallib.php',466],['mnet/service/enrol','locallib.php',537],['backup/cc/cc_lib','cc_version11.php',57],['availability/condition/completion/classes','condition.php',48],['admin/roles/classes','allow_override_page.php',31],['mod/workshop/allocation','lib.php',103],['lib/htmlpurifier/HTMLPurifier/AttrTransform','BoolToCSS.php',24],['lib/horde/framework/Horde/Imap/Client/Base','Mailbox.php',59],['lib/spout/src/Spout/Reader/Wrapper','SimpleXMLElement.php',23],['lib/google/src/Google/Service','SiteVerification.php',43],['lib/phpexcel/PHPExcel/Calculation','Function.php',64],['availability/classes','capability_checker.php',49],['lib/google/src/Google/Service','Drive.php',76],['lib/htmlpurifier/HTMLPurifier/DefinitionCache','Decorator.php',12],['lib/phpexcel/PHPExcel/Shared/JAMA','LUDecomposition.php',56],['lib','setuplib.php',67],['lib','setuplib.php',113],['lib','setuplib.php',165],['lib','setuplib.php',184],['lib','setuplib.php',199],['lib','setuplib.php',219],['lib','setuplib.php',249],['lib','setuplib.php',271],['lib','setuplib.php',287],['lib','setuplib.php',309],['lib','setuplib.php',328],['lib','setuplib.php',346],['lib/form','textarea.php',50],['webservice/soap','locallib.php',57],['availability/classes','info.php',55],['lib/tcpdf','tcpdf_barcodes_1d.php',58],['lib/spout/src/Spout/Reader/XLSX/Helper','SheetHelper.php',49],['filter/urltolink/tests','filter_test.php',209],['lib/simplepie/library/SimplePie','Category.php',81],['admin/tool/lp/classes/output','manage_competencies_page.php',65],['lib/markdown','Markdown.php',99],['mod/assign','locallib.php',160],['mod/assign','locallib.php',8131],['lib/adodb/drivers','adodb-ldap.inc.php',48],['lib/adodb/drivers','adodb-ldap.inc.php',297],['lib/editor/tinymce/plugins/spellchecker/classes/utils','JSON.php',32],['lib/editor/tinymce/plugins/spellchecker/classes/utils','JSON.php',373],['lib','odslib.class.php',42],['lib','odslib.class.php',124],['lib','odslib.class.php',422],['lib','odslib.class.php',827],['lib/horde/framework/Horde/Crypt/Blowfish','Base.php',56],['lib/phpexcel/PHPExcel/Reader/Excel5','MD5.php',36],['grade/report/singleview/classes/local/ui','checkbox_attribute.php',42],['lib/lessphp/Tree','Quoted.php',20],['mod/lesson','mod_form.php',36],['blocks/rss_client/classes/output','item.php',89],['lib/google/src/Google/Service','IdentityToolkit.php',38],['lib/horde/framework/Horde/Stream','Temp.php',25],['tag/classes/output','tagflag.php',39],['admin/tool/monitor/classes/output/managesubs','rules.php',56],['lib/htmlpurifier/HTMLPurifier/ChildDef','Table.php',57],['lib/behat/form_field','behat_form_field.php',59],['lib/phpexcel/PHPExcel/Worksheet/Drawing','Shadow.php',93],['lib/spout/src/Spout/Reader/ODS/Helper','CellValueFormatter.php',42],['tag/classes','collections_table.php',36],['lib/google/src/Google/Service','Spectrum.php',38],['lib/htmlpurifier/HTMLPurifier/AttrTransform','Length.php',19],['admin/tool/lp/classes/output','user_competency_summary.php',49],['lib/phpexcel/PHPExcel','NamedRange.php',65],['lib/pear/HTML/QuickForm','image.php',36],['lib/htmlpurifier/HTMLPurifier/AttrDef/URI','Host.php',15],['lib/form','searchableselector.php',44],['lib/phpexcel/PHPExcel/Shared/JAMA','SingularValueDecomposition.php',52],['lib/adodb/drivers','adodb-oci805.inc.php',51],['lib/google/src/Google','Service.php',28],['lib/google/src/Google/IO','Abstract.php',50],['lib/spout/src/Spout/Writer/ODS/Internal','Worksheet.php',46],['lib/form','header.php',45],['question/type/randomsamatch/tests','helper.php',121],['mod/workshop/form/accumulative','lib.php',99],['lib/phpexcel/PHPExcel/Shared/trend','linearBestFitClass.php',89],['lib/form','submit.php',41],['report/log/classes','table_log.php',45],['admin/roles/classes','admins_potential_selector.php',30],['question/classes/engine/variants','least_used_strategy.php',51],['question/engine/upgrade','logger.php',42],['question/engine/upgrade','logger.php',87],['mod/data','lib.php',68],['mod/data','lib.php',2278],['mod/data','lib.php',2552],['mod/data','lib.php',2573],['backup/util/xml/parser/processors','grouped_parser_processor.class.php',67],['lib/horde/framework/Horde/Imap/Client/Exception','NoSupportPop3.php',26],['mod/scorm','renderer.php',129],['lib/phpunit/classes','advanced_testcase.php',45],['lib/spout/src/Spout/Reader/ODS','SheetIterator.php',41],['backup/cc/cc_lib','cc_version1.php',57],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','LinkTypes.php',21],['tag/classes','areas_table.php',36],['lib/phpexcel/PHPExcel/Shared/trend','powerBestFitClass.php',125],['lib/portfolio/formats/leap2a','lib.php',62],['lib/portfolio/formats/leap2a','lib.php',258],['lib/portfolio/formats/leap2a','lib.php',503],['lib/google/src/Google/Service','Proximitybeacon.php',42],['lib/pear','PEAR.php',139],['lib/pear','PEAR.php',818],['competency/classes/external','persistent_exporter.php',42],['lib/google/src/Google/Service','Groupssettings.php',40],['lib/phpexcel/PHPExcel/Reader','CSV.php',87],['lib/horde/framework/Horde/Exception','LastError.php',16],['lib/google/src/Google/Service','Directory.php',134],['lib/google/src/Google/Service','Fusiontables.php',48],['question/type/missingtype','edit_missingtype_form.php',38],['lib/google/src/Google/Service','AdSenseHost.php',49],['lib/lessphp/Tree','Directive.php',20],['auth/ldap','auth.php',119],['auth/cas/CAS/CAS','CookieJar.php',46],['lib/phpexcel/PHPExcel/CachedObjectStorage','Wincache.php',245],['availability/condition/date/classes','condition.php',52],['lib/horde/framework/Horde/Mime','Mail.php',93],['lib','outputactions.php',60],['lib','outputactions.php',91],['lib','outputactions.php',148],['lib/horde/framework/Horde/Crypt/Blowfish','Mcrypt.php',47],['lib/classes','string_manager_standard.php',53],['repository/skydrive','microsoftliveapi.php',50],['user/filters','globalrole.php',35],['enrol/lti/ims-blti','OAuth.php',16],['enrol/lti/ims-blti','OAuth.php',32],['enrol/lti/ims-blti','OAuth.php',187],['enrol/lti/ims-blti','OAuth.php',451],['course/classes/output','course_module_name.php',46],['lib/google/src/Google/Service','Plus.php',52],['lib/horde/framework/Horde/Mime','Mdn.php',35],['lib/pear/HTML/QuickForm','html.php',36],['repository/s3','S3.php',193],['repository/s3','S3.php',2018],['repository/s3','S3.php',2374],['lib/spout/src/Spout/Reader/XLSX/Helper','SharedStringsHelper.php',39],['question/classes/bank/search','hidden_condition.php',42],['lib/htmlpurifier/HTMLPurifier/ChildDef','Empty.php',22],['lib/pear/HTML/QuickForm','element.php',73],['question/classes/statistics/responses','analysis_for_subpart.php',50],['admin/tool/log/classes','setting_managestores.php',30],['lib/google/src/Google/Service','Mirror.php',49],['lib/adodb/drivers','adodb-db2ora.inc.php',80],['lib/minify/lib/HTTP','Encoder.php',75],['mod/feedback/classes','completion.php',47],['admin/tool/uploadcourse/classes','processor.php',122],['lib/lessphp','Parser.php',78],['lib/adodb/drivers','adodb-sapdb.inc.php',36],['lib/adodb/drivers','adodb-sapdb.inc.php',179],['lib/ddl','sql_generator.php',175],['lib/google/src/Google/Service','AndroidEnterprise.php',51],['admin/tool/lp/classes/output','template_competencies_page.php',70],['lib/horde/framework/Horde/Support','ObjectStub.php',29],['mod/assignment/backup/moodle1','lib.php',223],['blocks','edit_form.php',47],['lib/simplepie/library/SimplePie/Cache','Memcache.php',81],['mod/quiz/report/statistics','statistics_question_table.php',49],['mod/workshop/form/numerrors','lib.php',102],['mod/quiz/classes','repaginate.php',49],['lib/classes/session','memcached.php',51],['lib/phpexcel/PHPExcel/Shared/OLE/PPS','Root.php',43],['lib/phpexcel/PHPExcel/Writer/PDF','Core.php',206],['mod/workshop','mod_form.php',43],['mod/assign/feedback/editpdf/fpdi','pdf_context.php',48],['availability/condition/profile/classes','condition.php',73],['lib/horde/framework/Horde/Imap/Client','DateTime.php',29],['auth/cas/CAS/CAS','Client.php',862],['lib/xhprof','xhprof_moodle.php',788],['lib/dtl','file_xml_database_exporter.php',36],['course','lib.php',3061],['lib/adodb/drivers','adodb-mssqlpo.inc.php',54],['lib/xmldb','xmldb_table.php',49],['lib/adodb/perf','perf-postgres.inc.php',92],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Filter.php',15],['question/type/ddmarker','shapes.php',40],['question/type/ddmarker','shapes.php',203],['question/type/ddmarker','shapes.php',267],['question/type/ddmarker','shapes.php',332],['question/type/ddmarker','shapes.php',470],['mod/lti/classes/local/ltiservice','response.php',58],['backup/util/helper','restore_users_parser_processor.class.php',43],['lib/pear/HTML','Common.php',79],['mod/glossary','locallib.php',481],['lib/adodb/perf','perf-mssqlnative.inc.php',70],['lib/adodb/perf','perf-mssql.inc.php',70],['backup/util/plan','base_plan.class.php',39],['backup/util/plan','base_plan.class.php',215],['backup/util/plan','restore_task.class.php',32],['backup/util/plan','restore_task.class.php',121],['lib/classes/event','base.php',124],['lib/form','checkbox.php',46],['admin/roles/classes','permissions_table.php',38],['lib/pear/HTML/QuickForm','submit.php',37],['auth/fc','auth.php',37],['enrol/ldap','settingslib.php',32],['enrol/ldap','settingslib.php',90],['enrol/ldap','settingslib.php',204],['lib/minify/lib/Minify/Cache','Memcache.php',22],['lib/lessphp/Tree','Condition.php',18],['admin/tool/lp/classes/output','plans_page.php',59],['lib/mustache/src/Mustache','Autoloader.php',19],['lib/spout/src/Spout/Writer/XLSX/Internal','Worksheet.php',52],['lib/phpexcel/PHPExcel','Comment.php',93],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','AlphaValue.php',6],['lib/lessphp/Tree','Url.php',17],['mod/lesson','override_form.php',58],['lib/form','button.php',45],['admin/tool/lp/classes/output','manage_templates_page.php',56],['lib/google/src/Google/Service','Playmoviespartner.php',44],['backup/util/ui','base_ui_stage.class.php',67],['backup/cc/cc_lib','cc_converters.php',75],['lib/dtl','database_mover.php',33],['enrol','locallib.php',125],['enrol','locallib.php',1256],['enrol','locallib.php',1379],['enrol','locallib.php',1430],['enrol','locallib.php',1463],['lib/htmlpurifier/HTMLPurifier','URI.php',58],['backup/moodle2','restore_course_task.class.php',41],['lib/htmlpurifier/HTMLPurifier/Printer','ConfigForm.php',40],['lib/htmlpurifier/HTMLPurifier/Printer','ConfigForm.php',221],['lib','xmlize.php',31],['lib','googleapi.php',52],['lib','googleapi.php',243],['grade/report/singleview/classes/local/ui','element.php',47],['lib/html2text','lib.php',43],['user/filters','lib.php',52],['user/filters','lib.php',272],['auth/cas/CAS/CAS/PGTStorage','Db.php',122],['lib/classes/lock','db_record_lock_factory.php',61],['lib/pear/HTML/QuickForm','link.php',47],['backup/cc/cc_lib','cc_asssesment.php',290],['backup/cc/cc_lib','cc_asssesment.php',345],['backup/cc/cc_lib','cc_asssesment.php',364],['backup/cc/cc_lib','cc_asssesment.php',415],['backup/cc/cc_lib','cc_asssesment.php',476],['backup/cc/cc_lib','cc_asssesment.php',486],['backup/cc/cc_lib','cc_asssesment.php',561],['backup/cc/cc_lib','cc_asssesment.php',585],['backup/cc/cc_lib','cc_asssesment.php',635],['backup/cc/cc_lib','cc_asssesment.php',668],['backup/cc/cc_lib','cc_asssesment.php',693],['backup/cc/cc_lib','cc_asssesment.php',788],['backup/cc/cc_lib','cc_asssesment.php',814],['backup/cc/cc_lib','cc_asssesment.php',838],['backup/cc/cc_lib','cc_asssesment.php',965],['backup/cc/cc_lib','cc_asssesment.php',971],['backup/cc/cc_lib','cc_asssesment.php',986],['backup/cc/cc_lib','cc_asssesment.php',1003],['backup/cc/cc_lib','cc_asssesment.php',1017],['backup/cc/cc_lib','cc_asssesment.php',1045],['backup/cc/cc_lib','cc_asssesment.php',1186],['backup/cc/cc_lib','cc_asssesment.php',1263],['backup/cc/cc_lib','cc_asssesment.php',1317],['backup/cc/cc_lib','cc_asssesment.php',1389],['backup/cc/cc_lib','cc_asssesment.php',1451],['backup/cc/cc_lib','cc_asssesment.php',1558],['backup/cc/cc_lib','cc_asssesment.php',1620],['backup/cc/cc_lib','cc_asssesment.php',1648],['backup/cc/cc_lib','cc_asssesment.php',1716],['backup/cc/cc_lib','cc_asssesment.php',2155],['backup/cc/cc_lib','cc_asssesment.php',2264],['backup/cc/cc_lib','cc_asssesment.php',2469],['lib/phpunit/classes','hint_resultprinter.php',37],['lib/horde/framework/Horde/Mail/Transport','Mail.php',53],['auth/pop3','auth.php',35],['lib/adodb/drivers','adodb-oci8.inc.php',106],['lib/adodb/drivers','adodb-oci8.inc.php',1539],['lib/adodb/drivers','adodb-oci8.inc.php',1805],['lib/classes/session','database.php',52],['backup/util/ui','restore_ui_components.php',81],['backup/util/ui','restore_ui_components.php',287],['backup/util/ui','restore_ui_components.php',382],['question/classes/bank/search','category_condition.php',60],['lib/google/src/Google/Auth','AssertionCredentials.php',53],['backup/util/plan','restore_plan.class.php',43],['backup/util/plan','restore_plan.class.php',203],['backup/util/xml/parser/processors','findpaths_parser_processor.class.php',35],['lib/phpexcel/PHPExcel/CalcEngine','Logger.php',63],['lib/jabber/XMPP','Log.php',67],['lib/horde/framework/Horde/Imap/Client/Exception','ServerResponse.php',44],['lib/lessphp/Tree','Assignment.php',15],['lib/dtl','string_xml_database_importer.php',34],['admin/tool/lp/classes/output','manage_competency_frameworks_page.php',62],['question/type/calculated','question.php',188],['question/type/calculated','question.php',303],['repository/recent','lib.php',39],['grade/report/singleview/classes/local/ui','text_attribute.php',42],['admin/webservice','lib.php',38],['lib','coursecatlib.php',194],['lib','coursecatlib.php',2782],['lib/google/src/Google/Service','Cloudtrace.php',43],['lib','filterlib.php',73],['lib','filterlib.php',377],['lib','filterlib.php',456],['lib/classes/lock','lock_factory.php',39],['lib/filebrowser','file_info_context_course.php',39],['lib/filebrowser','file_info_context_course.php',492],['lib/filebrowser','file_info_context_course.php',596],['lib/filebrowser','file_info_context_course.php',745],['enrol','renderer.php',426],['enrol','renderer.php',723],['question/classes/statistics/questions','calculated_for_subquestion.php',57],['backup/moodle2','backup_format_plugin.class.php',40],['admin/tool/lp/classes','course_competency_rule_form_element.php',45],['auth/cas/CAS/CAS','ProxyTicketException.php',46],['lib/phpunit/classes','basic_testcase.php',39],['lib/spout/src/Spout/Reader/ODS','RowIterator.php',49],['backup/util/dbops','backup_dbops.class.php',37],['admin/tool/customlang','locallib.php',44],['admin/tool/customlang','locallib.php',405],['admin/tool/customlang','locallib.php',471],['backup/util/structure','backup_optigroup_element.class.php',51],['mod/quiz/report/grading','gradingsettings_form.php',44],['backup/util/plan','restore_step.class.php',32],['backup/util/plan','restore_step.class.php',104],['lib/form','hidden.php',44],['repository/filesystem','lib.php',48],['backup/controller','backup_controller.class.php',68],['backup/controller','backup_controller.class.php',409],['backup/util/helper','restore_log_rule.class.php',62],['tag/classes','tag.php',77],['lib/htmlpurifier/HTMLPurifier/AttrTransform','SafeParam.php',27],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Db.php',38],['lib/spout/src/Spout/Writer/Style','StyleBuilder.php',19],['lib/dml','sqlsrv_native_moodle_database.php',53],['user/filters','date.php',40],['auth/nologin','auth.php',35],['lib/google/src/Google','Model.php',35],['lib/horde/framework/Horde/Imap/Client/Socket','ClientSort.php',37],['lib/horde/framework/Horde/Imap/Client/Exception','SearchCharset.php',34],['lib/horde/framework/Horde/Support','StringStream.php',30],['lib/adodb/drivers','adodb-mysqli.inc.php',66],['lib/adodb/drivers','adodb-mysqli.inc.php',887],['lib/adodb/drivers','adodb-mysqli.inc.php',1193],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','ImportantDecorator.php',21],['lib/form','questioncategory.php',46],['lib/mustache/src/Mustache','Template.php',29],['backup/util/structure','base_nested_element.class.php',44],['backup/util/structure','base_nested_element.class.php',258],['lib/google/src/Google/Logger','Abstract.php',123],['backup/cc/cc_lib','cc_general.php',38],['lib/phpexcel/PHPExcel','ReferenceHelper.php',58],['lib/pear/HTML/QuickForm','password.php',37],['lib/dml','moodle_transaction.php',40],['lib/phpexcel/PHPExcel/Reader','Excel2003XML.php',53],['lib/htmlpurifier/HTMLPurifier/AttrDef','Switch.php',29],['repository/flickr','lib.php',51],['lib/form','grading.php',57],['lib/classes/update','api.php',71],['backup/cc/cc_lib','cc_converter_lti.php',29],['backup/moodle2','backup_subplugin.class.php',44],['lib/portfolio','caller.php',67],['lib/classes/progress','display_if_slow.php',60],['lib/adodb/perf','perf-informix.inc.php',66],['lib/classes','chart_base.php',52],['lib/lessphp/Tree','Media.php',18],['lib/spout/src/Spout/Common/Escaper','XLSX.php',19],['grade/export/ods','grade_export_ods.php',24],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Length.php',23],['lib/google/src/Google/Service','Calendar.php',50],['lib/form','group.php',44],['lib/phpexcel/PHPExcel/Writer','OpenDocument.php',44],['lib/pear/HTML/QuickForm/Renderer','Object.php',75],['admin/tool/lp/classes/output','user_evidence_page.php',48],['lib/horde/framework/Horde/Imap/Client/Fetch','Results.php',54],['grade/export/xls','grade_export_xls.php',24],['lib/classes/output','mustache_pix_helper.php',43],['lib/horde/framework/Horde/Imap/Client/Mailbox','List.php',46],['lib/google/src/Google/Auth','ComputeEngine.php',35],['cache/stores/session','lib.php',131],['lib/mustache/src/Mustache/Logger','StreamLogger.php',44],['admin/tool/log/store/database/backup/moodle2','backup_logstore_database_nested_element.php',43],['user','renderer.php',220],['lib/htmlpurifier/HTMLPurifier/ChildDef','Required.php',23],['availability/condition/grade/classes','condition.php',46],['lib/lessphp/Tree','RulesetCall.php',14],['blocks/rss_client/classes/output','feed.php',75],['lib/form','select.php',47],['lib/htmlpurifier/HTMLPurifier','ContentSets.php',33],['lib/lessphp/Visitor','toCSS.php',13],['lib','outputfragmentrequirementslib.php',40],['backup/util/ui','restore_moodleform.class.php',34],['lib/google/src/Google/Service','Cloudbilling.php',43],['lib/google/src/Google/Service','PlusDomains.php',72],['lib','externallib.php',37],['lib','externallib.php',531],['lib','externallib.php',562],['lib','externallib.php',593],['lib','externallib.php',622],['lib','externallib.php',648],['lib','externallib.php',778],['lib','externallib.php',813],['lib','externallib.php',984],['lib','externallib.php',1177],['blog','locallib.php',71],['blog','locallib.php',564],['blog','locallib.php',847],['blog','locallib.php',892],['blog','locallib.php',965],['blog','locallib.php',1016],['blog','locallib.php',1041],['blog','locallib.php',1051],['blog','locallib.php',1063],['blog','locallib.php',1084],['lib/phpexcel/PHPExcel/Worksheet','ColumnDimension.php',53],['auth/cas','auth.php',39],['lib','lexer.php',41],['lib','lexer.php',145],['lib','lexer.php',217],['lib/phpexcel/PHPExcel/Shared/JAMA','QRDecomposition.php',48],['lib/google/src/Google/Service','Exception.php',34],['lib/htmlpurifier/HTMLPurifier','Printer.php',21],['tag/classes/output','tagcloud.php',49],['lib/google/src/Google/Service','Storagetransfer.php',44],['user/filters','select.php',46],['cache/stores/mongodb','lib.php',116],['admin/tool/lp/classes/output','course_competencies_page.php',73],['lib/google/src/Google/Cache','Null.php',28],['lib','graphlib.php',1176],['lib/phpexcel/PHPExcel/Style','Protection.php',49],['lib/google/src/Google/Service','GamesConfiguration.php',42],['repository/dropbox','locallib.php',46],['lib/phpexcel/PHPExcel/Style','Alignment.php',100],['lib/htmlpurifier/HTMLPurifier','Language.php',63],['cache/stores/file','lib.php',117],['tag/classes/output','tagareashowstandard.php',41],['question/type/multianswer','edit_multianswer_form.php',63],['lib/htmlpurifier/HTMLPurifier/AttrDef/HTML','Bool.php',22],['mod/assign','renderable.php',41],['mod/assign','renderable.php',71],['mod/assign','renderable.php',103],['mod/assign','renderable.php',139],['mod/assign','renderable.php',191],['mod/assign','renderable.php',242],['mod/assign','renderable.php',291],['mod/assign','renderable.php',395],['mod/assign','renderable.php',531],['mod/assign','renderable.php',586],['mod/assign','renderable.php',670],['mod/assign','renderable.php',707],['mod/assign','renderable.php',747],['mod/assign','renderable.php',800],['mod/assign','renderable.php',854],['lib/form','selectwithlink.php',56],['backup/moodle2','backup_activity_task.class.php',45],['lib/phpmailer','class.phpmailer.php',633],['lib/horde/framework/Horde/Imap/Client/Data','AclRights.php',39],['auth/db','auth.php',36],['lib/lessphp/Tree','Value.php',14],['lib/form','course.php',62],['question/engine','questionattemptstep.php',97],['question/engine','questionattemptstep.php',608],['cohort','locallib.php',37],['cohort','locallib.php',101],['badges/criteria','award_criteria.php',127],['lib/adodb/perf','perf-mysql.inc.php',86],['cache/stores/memcached','lib.php',133],['grade/report/singleview/classes/local/ui','empty_element.php',38],['lib/google/src/Google/Service','AppState.php',40],['lib/adodb/drivers','adodb-odbc_oracle.inc.php',107],['lib/pear/HTML/QuickForm/Renderer','Default.php',139],['tag/classes/output','tag.php',46],['question','previewlib.php',122],['backup/util/loggers','database_logger.class.php',40],['mod/forum/classes','potential_subscriber_selector.php',47],['lib/htmlpurifier/HTMLPurifier/ConfigSchema','InterchangeBuilder.php',15],['lib/phpexcel/PHPExcel/Reader','SYLK.php',67],['lib/form','submitlink.php',47],['backup/util/dbops','restore_dbops.class.php',1788],['lib/xmldb','xmldb_index.php',56],['question','category_class.php',58],['question','category_class.php',160],['lib/google/src/Google/Service','Webfonts.php',38],['webservice/xmlrpc','locallib.php',41],['admin/roles/classes','check_users_selector.php',38],['lib/htmlpurifier/HTMLPurifier/AttrTransform','ImgSpace.php',24],['user/profile/field/checkbox','field.class.php',33],['lib/form','cancel.php',47],['lib/google/src/Google/Service','Resourceviews.php',57],['lib/phpexcel/PHPExcel/Style','Font.php',100],['lib/portfolio','plugin.php',445],['calendar','lib.php',2003],['calendar','lib.php',2774],['mod/wiki','pagelib.php',93],['mod/wiki','pagelib.php',380],['mod/wiki','pagelib.php',981],['mod/wiki','pagelib.php',1190],['mod/wiki','pagelib.php',2194],['mod/wiki','pagelib.php',2422],['tag/classes/output','tagfeed.php',43],['tag/classes/output','tagareaenabled.php',38],['backup/util/xml/parser/processors','selective_like_parser_processor.class.php',35],['mod/workshop','locallib.php',183],['mod/workshop','locallib.php',2976],['mod/workshop','locallib.php',3411],['mod/workshop','locallib.php',3647],['mod/workshop','locallib.php',3889],['mod/workshop','locallib.php',3975],['mod/workshop','locallib.php',4060],['mod/workshop','locallib.php',4079],['lib/form','advcheckbox.php',48],['backup/cc/cc_lib','cc_assesment_sfib.php',27],['cohort/classes/output','cohortidnumber.php',37],['lib/adodb/drivers','adodb-ado.inc.php',42],['lib/adodb/drivers','adodb-ado.inc.php',346],['lib/form','filepicker.php',53],['mod/assign','adminlib.php',41],['mod/assign','adminlib.php',102],['lib/tests/fixtures','test_renderer_factory.php',41],['backup/cc/cc_lib','cc_converter_label.php',28],['lib/htmlpurifier/HTMLPurifier','Lexer.php',152],['grade/report/singleview','lib.php',69],['backup/cc/cc_lib','cc_converter_page.php',28],['lib/google/src/Google/Logger','Psr.php',39],['lib/simplepie/library/SimplePie/HTTP','Parser.php',131],['backup/util/plan','backup_step.class.php',32],['backup/util/plan','backup_step.class.php',55],['lib/lessphp/Tree','Import.php',30],['lib/jabber/XMPP','XMPP_Old.php',45],['lib/phpexcel/PHPExcel/Worksheet','Drawing.php',37],['lib/google/src/Google/Service','Classroom.php',60],['lib/phpexcel/PHPExcel/Chart/Renderer','jpgraph.php',875],['admin/tool/lp/classes/external','competency_path_exporter.php',38],['cohort/classes/output','cohortname.php',37],['grade/report/overview','lib.php',76],['lib/horde/framework/Horde/Mail/Rfc822','Address.php',66],['admin/roles/classes','admins_existing_selector.php',30],['lib/phpunit/classes','arraydataset.php',45],['question/engine','questionattempt.php',166],['question/engine','questionattempt.php',1532],['question/engine','questionattempt.php',1618],['question/engine','questionattempt.php',1703],['lib/horde/framework/Horde/Support','Uuid.php',23],['lib/horde/framework/Horde/Imap/Client/Data/Format','Nil.php',27],['webservice/rest','lib.php',47],['lib/phpexcel/PHPExcel/Worksheet','HeaderFooterDrawing.php',79],['backup/util/xml/output','memory_xml_output.class.php',37],['repository/flickr_public','image.php',34],['mod/lti/classes/local/ltiservice','resource_base.php',62],['admin/tool/lp/classes/output','template_plans_table.php',53],['mod/quiz','mod_form.php',48],['lib/simplepie/library/SimplePie','Caption.php',98],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Multiple.php',33],['lib/htmlpurifier/HTMLPurifier','PercentEncoder.php',20],['lib/phpexcel/PHPExcel/Calculation','ExceptionHandler.php',30],['lib/htmlpurifier/HTMLPurifier/Token','Tag.php',33],['backup/moodle2','backup_theme_plugin.class.php',61],['mod/chat','chatd.php',78],['mod/chat','chatd.php',103],['lib/phpexcel/PHPExcel','DocumentSecurity.php',65],['lib/htmlpurifier/HTMLPurifier','URIDefinition.php',21],['lib/spout/src/Spout/Writer/XLSX/Internal','Workbook.php',45],['lib/phpexcel/PHPExcel/Shared','XMLWriter.php',49],['lib/lessphp/Tree','Operation.php',19],['lib/htmlpurifier/HTMLPurifier/Lexer','PH5P.php',461],['lib/htmlpurifier/HTMLPurifier/Lexer','PH5P.php',1699],['backup/cc/cc_lib','cc_converter_folder.php',28],['backup/util/helper','restore_roles_parser_processor.class.php',39],['lib/simplepie/library/SimplePie','Locator.php',68],['lib/google/src/Google/Service','SQLAdmin.php',50],['lib/lessphp/Tree','DetachedRuleset.php',15],['admin/tool/assignmentupgrade','upgradableassignmentstable.php',49],['backup/cc','validator.php',30],['backup/cc','validator.php',116],['backup/cc','validator.php',202],['backup/cc','validator.php',230],['backup/cc','validator.php',236],['backup/cc','validator.php',242],['backup/cc','validator.php',248],['backup/cc','validator.php',254],['backup/cc','validator.php',260],['lib/horde/framework/Horde/Imap/Client/Interaction','Client.php',34],['mod/quiz','override_form.php',58],['auth/cas/CAS/CAS/PGTStorage','AbstractStorage.php',57],['lib/htmlpurifier/HTMLPurifier','Length.php',41],['backup/util/helper','restore_decode_rule.class.php',47],['backup/util/helper','restore_decode_rule.class.php',192],['lib/horde/framework/Horde/Imap/Client/Data','Sync.php',133],['lib/phpexcel/PHPExcel/Shared/trend','logarithmicBestFitClass.php',97],['lib/adodb/perf','perf-db2.inc.php',61],['lib/phpexcel/PHPExcel/Style','Supervisor.php',44],['lib/htmlpurifier/HTMLPurifier/AttrTransform','TargetBlank.php',17],['lib/ddl','database_manager.php',48],['lib/mustache/src/Mustache/Exception','UnknownFilterException.php',22],['admin/roles/classes','define_role_table_advanced.php',46],['lib/dml','oci_native_moodle_temptables.php',40],['lib/horde/framework/Horde/Stream','Existing.php',28],['enrol/manual','locallib.php',37],['enrol/manual','locallib.php',102],['availability/classes','multiple_messages.php',56],['lib/phpexcel/PHPExcel/Reader','Gnumeric.php',55],['admin/roles/classes','override_permissions_table_advanced.php',31],['lib/pear/Net','GeoIP.php',323],['lib/mustache/src/Mustache/Loader','ArrayLoader.php',31],['lib/form','modgrade.php',78],['admin/tool/log/store/database/backup/moodle2','restore_logstore_database_subplugin.class.php',40],['cache/classes','config.php',80],['lib/pear/HTML/QuickForm','hidden.php',37],['question/type/calculated','datasetitems_form.php',72],['lib/tests','navigationlib_test.php',554],['lib/tests','navigationlib_test.php',612],['lib/tests','navigationlib_test.php',639],['lib/htmlpurifier/HTMLPurifier/AttrDef/CSS','Number.php',18],['lib/tests','completionlib_test.php',882],['admin/tool/generator/classes','site_backend.php',58],['lib/jabber/XMPP','XMLStream.php',171],['lib/simplepie/library/SimplePie','Sanitize.php',75],['cache/classes','factory.php',149],['lib/minify/lib/Minify/Cache','WinCache.php',20],['user/classes/output/myprofile','node.php',82],['lib/horde/framework/Horde/Stream','TempString.php',40],['lib/adodb/drivers','adodb-borland_ibase.inc.php',83],['mod/forum','locallib.php',55],['mod/forum','locallib.php',419],['mod/lti/service/memberships/classes/local/resource','contextmemberships.php',44],['lib/phpexcel/PHPExcel/Worksheet/AutoFilter/Column','Rule.php',262],['lib/classes/update','code_manager.php',57],['search/engine/solr/classes','engine.php',103],['lib/horde/framework/Horde/Imap/Client/Interaction/Server','Tagged.php',36],['lib/google/src/Google/Service','Compute.php',89],['lib/phpexcel/PHPExcel/Style','Borders.php',113],['lib','completionlib.php',243],['lib/google/src/Google/Service','Pubsub.php',44],['lib/adodb/drivers','adodb-ads.inc.php',69],['lib/adodb/drivers','adodb-ads.inc.php',657],['lib/markdown','MarkdownExtra.php',56],['lib/minify/lib/Minify/Cache','XCache.php',22],['lib/google/src/Google/Service','YouTube.php',75],['lib/lessphp','Functions.php',15],['auth/cas/CAS/CAS','AuthenticationException.php',53],['mod/quiz','locallib.php',1923],['competency/classes/external','stored_file_exporter.php',45],['user/filters','checkbox.php',51],['backup/moodle2','restore_settingslib.php',86],['backup/moodle2','restore_settingslib.php',149],['lib/htmlpurifier/HTMLPurifier/Node','Element.php',39],['lib/pear/HTML/QuickForm','date.php',260],['lib/lessphp/SourceMap','Generator.php',82],['backup/util/plan','base_step.class.php',35],['backup/util/plan','base_step.class.php',127],['mod/lti/service/memberships/classes/local/service','memberships.php',50],['lib/google/src/Google/Cache','Apc.php',37],['backup/util/ui','restore_ui_stage.class.php',42],['backup/util/ui','restore_ui_stage.class.php',265],['backup/util/ui','restore_ui_stage.class.php',452],['backup/util/ui','restore_ui_stage.class.php',592],['backup/util/ui','restore_ui_stage.class.php',704],['backup/util/ui','restore_ui_stage.class.php',852],['backup/util/ui','restore_ui_stage.class.php',959],['backup/util/ui','restore_ui_stage.class.php',1100],['lib/pear/Auth','RADIUS.php',120],['lib/pear/Auth','RADIUS.php',579],['lib/pear/Auth','RADIUS.php',672],['lib/pear/Auth','RADIUS.php',879],['lib/adodb/drivers','adodb-ado_access.inc.php',46],['admin/tool/xmldb/actions','XMLDBAction.class.php',56],['backup/converter/moodle1','handlerlib.php',120],['backup/converter/moodle1','handlerlib.php',1710],['backup/converter/moodle1','handlerlib.php',1902],['backup/converter/moodle1','handlerlib.php',2155],['backup/controller','restore_controller.class.php',63],['backup/controller','restore_controller.class.php',519],['lib/google/src/Google/Http','Request.php',58],['lib/google/src/Google/Service','Dfareporting.php',99],['lib/google/src/Google/Service','Manager.php',60],['lib/horde/framework/Horde/Imap/Client/Cache/Backend','Hashtable.php',73],['lib/htmlpurifier/HTMLPurifier/ConfigSchema','Validator.php',30],['lib/google/src/Google/Service','CloudMonitoring.php',45],['lib/editor/tinymce/plugins/spellchecker/classes','SpellChecker.php',11],['lib/horde/framework/Horde/Imap/Client/Ids','Map.php',44],['lib/horde/framework/Horde/Mail/Transport','Sendmail.php',65],['lib','webdavlib.php',84],['lib/dml','pgsql_native_moodle_recordset.php',43],['lib/horde/framework/Horde/Support','Guid.php',24],['lib/mustache/src/Mustache','LambdaHelper.php',25],['question/engine/upgrade/tests','helper.php',45],['admin/tool/uploadcourse/classes','tracker.php',72],['grade/report/user','lib.php',188],['lib/adodb/drivers','adodb-sqlanywhere.inc.php',156],['auth/cas/CAS/CAS','OutOfSequenceBeforeClientException.php',47],['backup/util/plan','base_task.class.php',40],['backup/util/plan','base_task.class.php',277],['lib/adodb/drivers','adodb-db2oci.inc.php',220]], 1102],
'get_max_fraction': ['get_max_fraction', 'Return the maximum possible fraction that can be scored for this question. Normally this will be based on $this->question->get_max_fraction(), but may be modified in some way by the behaviour. ', [['question/behaviour','behaviourbase.php',182],['question/behaviour/deferredcbm','behaviour.php',52],['question/type','questionbase.php',240],['question/behaviour/immediatecbm','behaviour.php',50],['question/behaviour/missing','behaviour.php',72],['question/type/multianswer','question.php',116],['question/engine','questionattempt.php',695]], 13],
'get_in_or_equal': ['get_in_or_equal', 'Constructs \'IN()\' or \'=\' sql fragment ', [['lib/dml','oci_native_moodle_database.php',1635],['lib/dml','moodle_database.php',711]], 438],
'execute': ['execute', 'Run langpack update ', [['admin/tool/langimport/classes/task','update_langpacks_task.php',44],['backup/converter/imscc1','lib.php',84],['lib/classes/task','blog_cron_task.php',40],['mod/workshop/allocation/scheduled','lib.php',128],['lib/classes/task','send_new_user_passwords_task.php',40],['admin/tool/log/store/standard/classes/task','cleanup_task.php',40],['lib/dml','pdo_moodle_database.php',227],['lib/classes/task','tag_cron_task.php',42],['enrol/imsenterprise/classes/task','cron_task.php',43],['lib/classes/task','completion_daily_task.php',42],['lib/google/src/Google/Http','Batch.php',61],['lib/dml','oci_native_moodle_database.php',1048],['lib/classes/task','context_cleanup_task.php',41],['backup/util/plan','backup_structure_step.class.php',50],['backup/util/ui','restore_ui.class.php',206],['webservice','lib.php',1319],['lib/classes/task','stats_cron_task.php',40],['lib/htmlpurifier/HTMLPurifier/Strategy','ValidateAttributes.php',16],['lib/htmlpurifier/HTMLPurifier/Strategy','RemoveForeignElements.php',20],['lib/classes/task','legacy_plugin_cron_task.php',42],['backup/moodle2','restore_activity_task.class.php',189],['lib/classes/task','portfolio_cron_task.php',40],['lib/google/src/Google/Http','REST.php',27],['lib/htmlpurifier/HTMLPurifier/Strategy','MakeWellFormed.php',66],['backup/converter/imscc11','backuplib.php',42],['lib/classes/task','question_cron_task.php',40],['lib/classes/task','cache_cron_task.php',40],['admin/tool/log/store/legacy/classes/task','cleanup_task.php',40],['mod/lti/service/memberships/classes/local/resource','linkmemberships.php',62],['admin/tool/messageinbound/classes/task','cleanup_task.php',47],['lib/adodb/drivers','adodb-pdo.inc.php',559],['lib/editor/atto/classes/task','autosave_cleanup_task.php',42],['admin/tool/recyclebin/classes/task','cleanup_category_bin.php',43],['lib/classes/task','completion_regular_task.php',42],['lib/adodb/drivers','adodb-oci8po.inc.php',54],['lib/classes/task','events_cron_task.php',40],['mod/workshop/allocation/random','lib.php',83],['mod/assign/feedback/editpdf/classes/task','convert_submissions.php',47],['auth/cas/classes/task','sync_task.php',43],['admin/tool/recyclebin/classes/task','cleanup_course_bin.php',43],['mod/lti/service/toolsettings/classes/local/resource','contextsettings.php',62],['backup/util/helper','restore_decode_processor.class.php',73],['lib/behat','behat_base.php',840],['enrol/flatfile/classes/task','flatfile_sync_task.php',46],['lib/classes/task','registration_cron_task.php',40],['backup/moodle2','backup_section_task.class.php',97],['lib/classes/task','check_for_updates_task.php',40],['backup/util/plan/tests/fixtures','plan_fixtures.php',48],['backup/util/plan/tests/fixtures','plan_fixtures.php',56],['mod/forum/classes/task','cron_task.php',39],['lib/classes/task','send_failed_login_notifications_task.php',43],['enrol/lti/classes/task','sync_grades.php',45],['lib/dml','pgsql_native_moodle_database.php',665],['lib/htmlpurifier/HTMLPurifier/Strategy','Composite.php',21],['lib/classes/update','validator.php',117],['lib/google/src/Google','Client.php',574],['lib/dml','mssql_native_moodle_database.php',711],['mod/lti/service/profile/classes/local/resource','profile.php',76],['backup/util/plan','backup_plan.class.php',112],['lib/dml','mysqli_native_moodle_database.php',963],['backup/util/ui','backup_ui.class.php',122],['admin/tool/monitor/classes/task','clean_events.php',41],['backup/converter/moodle1','backuplib.php',10],['backup/converter/imscc11','lib.php',85],['lib/classes/task','grade_cron_task.php',40],['lib/classes/task','file_temp_cleanup_task.php',40],['backup/moodle2','restore_section_task.class.php',87],['mod/lti/service/toolsettings/classes/local/resource','linksettings.php',63],['filter/tex','latex.php',70],['lib/adodb','adodb.inc.php',1088],['lib/classes/task','plagiarism_cron_task.php',40],['mod/lti/service/toolproxy/classes/local/resource','toolproxy.php',62],['backup/converter/moodle1','lib.php',142],['backup/util/plan','restore_structure_step.class.php',62],['lib/classes/task','search_index_task.php',44],['enrol/lti/classes/task','sync_members.php',55],['lib/classes/task','session_cleanup_task.php',40],['mod/lti/service/toolsettings/classes/local/resource','systemsettings.php',61],['lib/classes/task','backup_cleanup_task.php',40],['lib/classes/task','delete_unconfirmed_users_task.php',40],['backup/converter/imscc1','backuplib.php',10],['lib/classes/task','badges_cron_task.php',40],['admin/tool/uploadcourse/classes','processor.php',174],['lib/classes/task','calendar_cron_task.php',40],['backup/util/plan','base_plan.class.php',158],['auth/ldap/classes/task','sync_task.php',43],['lib/adodb/drivers','adodb-oci8.inc.php',920],['backup/util/plan','restore_plan.class.php',159],['lib/tests/fixtures','task_fixtures.php',30],['lib/tests/fixtures','task_fixtures.php',39],['lib/tests/fixtures','task_fixtures.php',48],['lib/tests/fixtures','task_fixtures.php',57],['lib/dml','sqlsrv_native_moodle_database.php',795],['lib/classes/task','create_contexts_task.php',40],['lib/classes/task','file_trash_cleanup_task.php',40],['admin/tool/cohortroles/classes/task','cohort_role_sync.php',46],['lib/classes/task','complete_plans_task.php',52],['lib/classes/task','messaging_cleanup_task.php',40],['backup/util/plan','backup_execution_step.class.php',25],['lib/classes/task','cache_cleanup_task.php',40],['backup/moodle2','backup_activity_task.class.php',211],['filter/tex','texdebug.php',287],['lib/classes/task','password_reset_cleanup_task.php',40],['lib/classes/task','search_optimize_task.php',47],['mod/assign','adminlib.php',342],['lib/classes/task','delete_incomplete_users_task.php',40],['lib/classes/task','automated_backup_task.php',40],['admin/tool/messageinbound/classes/task','pickup_task.php',47],['backup/util/plan','restore_execution_step.class.php',25],['lib/classes/task','sync_plans_from_template_cohorts_task.php',50],['admin/tool/monitor/classes','notification_task.php',39],['lib/dml/tests','dml_test.php',5543],['lib/htmlpurifier/HTMLPurifier/Strategy','FixNesting.php',41],['mod/lti/service/memberships/classes/local/resource','contextmemberships.php',60],['admin/tool/monitor/classes/task','check_subscriptions.php',60],['backup/util/interfaces','executable.class.php',32],['backup/util/plan','base_task.class.php',162]], 1058],
'get_area_files': ['get_area_files', 'Returns all area files (optionally limited by itemid) ', [['lib/filestorage','file_storage.php',782],['lib','externallib.php',1134]], 216],
'notify_attempt_moved': ['notify_attempt_moved', '', [['question/engine','datalib.php',1354],['question/engine','questionusage.php',1048],['question/engine','questionusage.php',1108]], 1],
'get_metadata_var': ['get_metadata_var', 'Get a metadata variable. ', [['question/engine','questionattemptstep.php',399]], 3],
'questions_in_use': ['questions_in_use', 'Are any of these questions are currently in use? ', [['question/engine','datalib.php',1228],['question/engine','lib.php',157],['lib','questionlib.php',121]], 7],
'where': ['where', '', [['question/engine','datalib.php',1883],['question/engine','datalib.php',1965],['mod/glossary/classes','entry_query_builder.php',448],['question/classes/bank/search','hidden_condition.php',53],['question/classes/bank/search','category_condition.php',96]], 64],
'record_exists': ['record_exists', 'Check if a record exists by ID. ', [['competency/classes','persistent.php',842],['lib/dml','moodle_database.php',1817]], 901],
'delete_steps': ['delete_steps', 'Delete all the steps for a question attempt. ', [['question/engine','datalib.php',1003]], 1],
'usage_id_in_params': ['usage_id_in_params', '', [['question/engine','datalib.php',1913],['question/engine','datalib.php',1977]], 11],
'get_hash_code': ['get_hash_code', '', [['question/engine','datalib.php',1851]], 13],
'get_question_summary': ['get_question_summary', '', [['question/type/gapselect','questionbase.php',115],['question/type/multichoice','question.php',88],['question/behaviour','behaviourbase.php',244],['question/type','questionbase.php',200],['question/type','questionbase.php',457],['question/engine','questionusage.php',398],['question/type/match','question.php',108],['question/type/multianswer','question.php',81],['question/engine','questionattempt.php',1195],['question/type/ddimageortext','questionbase.php',152]], 32],
'avg': ['avg', 'Average grade for the attempts selected by $this->whichattempts ', [['mod/quiz/report/statistics/classes','calculated.php',100]], 19],
'get_recordset_sql': ['get_recordset_sql', 'Get a number of records as an moodle_recordset.  $sql must be a complete SQL query. Since this method is a little less readable, use of it should be restricted to code where it\'s possible there might be large datasets being returned.  For known small datasets use get_records_sql - it leads to simpler code. ', [['lib/dml','pdo_moodle_database.php',252],['lib/dml','oci_native_moodle_database.php',1106],['lib/dml','pgsql_native_moodle_database.php',688],['lib/dml','mssql_native_moodle_database.php',736],['lib/dml','mysqli_native_moodle_database.php',993],['lib/dml','sqlsrv_native_moodle_database.php',811],['lib/dml/tests','dml_test.php',5544]], 283],
'get_all_for_summary_state': ['get_all_for_summary_state', 'Get all the states in an array. ', [['question/engine','states.php',86]], 1],
'get_max_mark': ['get_max_mark', '', [['question/engine','questionattempt.php',682]], 26],
'get_contenthash': ['get_contenthash', 'Returns sha1 hash code ', [['lib/filebrowser','virtual_root_file.php',299],['lib/filestorage','stored_file.php',795]], 78],
'get_question_file_saver': ['get_question_file_saver', 'Copy these files into a draft area, and return the corresponding {@link question_file_saver} that can save them again. ', [['question/engine','datalib.php',1767]], 1],
'update_questions_usage_by_activity': ['update_questions_usage_by_activity', 'Update a question_usages row to refect any changes in a usage (but not any of its question_attempts. ', [['question/engine','datalib.php',881]], 1],
'is_step_deleted': ['is_step_deleted', '', [['question/engine','datalib.php',1522]], 2],
'get_all_data': ['get_all_data', 'Get all the data. behaviour variables have the - at the start of their name. This is only intended for internal use, for example by {@link question_engine_data_mapper::insert_question_attempt_step()}, however, it can occasionally be useful in test code. It should not be considered part of the public API of this class. ', [['question/engine','questionattemptstep.php',361],['question/engine','questionattemptstep.php',726]], 30],
'get_user_id': ['get_user_id', '', [['lib','modinfolib.php',202],['grade/report/grader/tests/behat','behat_gradereport_grader.php',174],['question/engine','questionattemptstep.php',171],['question/engine','questionattemptstep.php',682],['lib/tests/behat','behat_data_generators.php',607]], 36],
'get_fraction': ['get_fraction', '', [['question/engine','questionattemptstep.php',158],['question/engine','questionattemptstep.php',588],['question/engine','questionattemptstep.php',674],['question/engine','questionattempt.php',627]], 51],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required, Some conversions and safety checks are carried out. Lobs are supported. If the return ID isn\'t required, then this just reports success as true/false. $data is an object containing needed data ', [['lib/dml','pdo_moodle_database.php',387],['lib/dml','oci_native_moodle_database.php',1297],['lib/dml','pgsql_native_moodle_database.php',889],['lib/dml','mssql_native_moodle_database.php',962],['lib/dml','mysqli_native_moodle_database.php',1185],['question/engine/upgrade','upgradelib.php',124],['lib/dml','sqlsrv_native_moodle_database.php',1045],['lib/dml/tests','dml_test.php',5548]], 1611],
'get_filepath': ['get_filepath', 'Returns file path ', [['lib/filebrowser','virtual_root_file.php',218],['lib/filestorage','stored_file.php',690],['backup/util/ui','restore_ui_stage.class.php',547]], 147],
'is_step_added': ['is_step_added', '', [['question/engine','datalib.php',1493]], 5],
'insert_records': ['insert_records', 'Insert multiple records into database as fast as possible. ', [['lib/dml','pgsql_native_moodle_database.php',926],['lib/dml','mysqli_native_moodle_database.php',1221],['lib/dml','moodle_database.php',1662]], 26],
'load_questions_usages_by_activity': ['load_questions_usages_by_activity', 'Load all {@link question_usage_by_activity} from the database for one qubaid_condition Include all its {@link question_attempt}s and all their steps. ', [['question/engine','datalib.php',466]], 1],
'get_summary_state': ['get_summary_state', 'Each state can be categorised into one of four categories: inprogress, needsgrading, manuallygraded or autograded. ', [['question/engine','states.php',186]], 2],
'question_attempt_latest_state_view': ['question_attempt_latest_state_view', 'Get a subquery that returns the latest step of every qa in some qubas. Currently, this is only used by the quiz reports. See {@link quiz_attempts_report_table::add_latest_state_join()}. ', [['question/engine','datalib.php',1178]], 2],
'get_file_storage': ['get_file_storage', 'Returns local file storage instance ', [['lib','moodlelib.php',6144]], 546],
'load_average_marks': ['load_average_marks', 'Load the average mark, and number of attempts, for each slot in a set of question usages.. ', [['question/engine','datalib.php',756]], 2],
'load_questions_usages_question_state_summary': ['load_questions_usages_question_state_summary', 'Load summary information about the state of each question in a group of attempts. This is used, for example, by the quiz manual grading report, to show how many attempts at each question need to be graded. ', [['question/engine','datalib.php',589]], 2],
'notify_metadata_added': ['notify_metadata_added', '', [['question/engine','datalib.php',1452],['question/engine','questionusage.php',1078],['question/engine','questionusage.php',1116]], 1],
'get_behaviour_name': ['get_behaviour_name', 'Get the translated name of a behaviour, for display in the UI. ', [['question/engine','lib.php',420],['question/engine','questionattempt.php',271]], 27],
'set_database_id': ['set_database_id', 'For internal use only. Set the id of the corresponding database row. ', [['question/engine','questionattempt.php',238],['question/engine','questionattempt.php',1585]], 3],
'get_variant': ['get_variant', 'Get the variant of the question being used in a given slot. ', [['question/engine','questionusage.php',531],['question/engine','questionattempt.php',208]], 14],
'get_slot': ['get_slot', '', [['question/engine','questionattempt.php',226]], 35],
'load_questions_usage_by_activity': ['load_questions_usage_by_activity', 'Load a {@link question_usage_by_activity} from the database, including all its {@link question_attempt}s and all their steps. ', [['question/engine','datalib.php',403],['question/engine','lib.php',76]], 14],
'notify_step_deleted': ['notify_step_deleted', '', [['question/engine','datalib.php',1430],['question/engine','questionusage.php',1071],['question/engine','questionusage.php',1114]], 4],
'is_step_modified': ['is_step_modified', '', [['question/engine','datalib.php',1508]], 2],
'get_usage_id': ['get_usage_id', '', [['question/engine','questionattempt.php',257]], 5],
'load_used_variants': ['load_used_variants', 'Get the number of times each variant has been used for each question in a list in a set of usages. ', [['question/engine','datalib.php',1246],['question/engine','lib.php',165]], 3],
'sum_usage_marks_subquery': ['sum_usage_marks_subquery', 'Return a subquery that computes the sum of the marks for all the questions in a usage. Which useage to compute the sum for is controlled bu the $qubaid parameter. ', [['question/engine','datalib.php',1143]], 2],
'set_field': ['set_field', 'Set a single field in every table record where all the given conditions met. ', [['lib/dml','moodle_database.php',1737],['availability/condition/profile/tests','condition_test.php',349]], 485],
'delete_questions_usage_by_activities': ['delete_questions_usage_by_activities', 'Delete a question_usage_by_activity and all its associated ', [['question/engine','datalib.php',926],['question/engine','lib.php',112]], 6],
'get_all': ['get_all', 'Get all the states in an array. ', [['question/engine','states.php',73]], 2],
'get_id': ['get_id', 'Getter for $id. ', [['lib/classes/task','adhoc_task.php',51],['backup/converter','convertlib.php',100],['lib/filebrowser','virtual_root_file.php',290],['lib','adminlib.php',1719],['admin/tool/uploadcourse/classes','course.php',335],['lib/simplepie/library/SimplePie','Item.php',199],['lib/filestorage','stored_file.php',786],['cache/classes','definition.php',613],['grade/grading/form','lib.php',854],['question/engine','questionusage.php',120],['mod/lti/classes/local/ltiservice','service_base.php',76],['blocks/rss_client/classes/output','item.php',152],['backup/controller','backup_controller.class.php',263],['question/engine','questionattemptstep.php',136],['mod/lti/classes/local/ltiservice','resource_base.php',81]], 2250],
'insert_questions_usage_by_activity': ['insert_questions_usage_by_activity', 'Store an entire {@link question_usage_by_activity} in the database, including all the question_attempts that comprise it. ', [['question/engine','datalib.php',77]], 1],
'get_attempt_iterator': ['get_attempt_iterator', 'Note the part of the {@link question_usage_by_activity} comment that explains that {@link question_attempt} objects should be considered part of the inner workings of the question engine, and should not, if possible, be accessed directly. ', [['question/engine','questionusage.php',243]], 7],
'insert_question_attempt': ['insert_question_attempt', 'Store an entire {@link question_attempt} in the database, including all the question_attempt_steps that comprise it. ', [['question/engine','datalib.php',109]], 2],
'notify_step_added': ['notify_step_added', '', [['question/engine','datalib.php',1378],['question/engine','questionusage.php',1055],['question/engine','questionusage.php',1110]], 2],
'record_exists_select': ['record_exists_select', 'Check if a records exists. ', [['competency/classes','persistent.php',853],['lib/dml','moodle_database.php',1830]], 85],
'notify_attempt_added': ['notify_attempt_added', '', [['question/engine','datalib.php',1343],['question/engine','questionusage.php',1036],['question/engine','questionusage.php',1104]], 2],
'__tostring': ['__tostring', 'String-ified version ', [['lib/simplepie/library/SimplePie','Author.php',95],['lib/horde/framework/Horde/Imap/Client','Url.php',132],['lib/horde/framework/Horde/Imap/Client/Interaction','Server.php',139],['lib/horde/framework/Horde/Imap/Client','Tokenize.php',101],['lib/simplepie/library/SimplePie','Copyright.php',85],['lib/horde/framework/Horde/Imap/Client/Data/Format','Nstring.php',39],['lib/horde/framework/Horde/Imap/Client/Search','Query.php',60],['lib/simplepie/library/SimplePie','Rating.php',85],['lib/horde/framework/Horde/Imap/Client/Auth','DigestMD5.php',107],['lib/phpexcel/PHPExcel','RichText.php',122],['lib/simplepie/library','SimplePie.php',655],['lib/horde/framework/Horde/Imap/Client/Data/Format','List.php',68],['question/engine','datalib.php',1687],['question/engine','datalib.php',1755],['lib/simplepie/library/SimplePie','Source.php',72],['lib/phpexcel/PHPExcel/Worksheet','AutoFilter.php',838],['lib/horde/framework/Horde/Imap/Client/Data/Format','Mailbox.php',44],['lib/lessphp/Tree','Dimension.php',74],['lib','moodlelib.php',9747],['lib/horde/framework/Horde/Imap/Client/Data','Format.php',44],['lib/classes/output','mustache_uniqid_helper.php',41],['lib/horde/framework/Horde/Imap/Client/Data/Format','String.php',81],['lib/simplepie/library/SimplePie','Restriction.php',94],['lib','weblib.php',536],['lib/simplepie/library/SimplePie','IRI.php',133],['question/engine','states.php',108],['lib/phpexcel/PHPExcel','Cell.php',1023],['lib/horde/framework/Horde/Imap/Client/Data/Format','Date.php',44],['lib/simplepie/library/SimplePie','Enclosure.php',264],['mod/lti','OAuth.php',79],['mod/lti','OAuth.php',109],['mod/lti','OAuth.php',460],['lib/simplepie/library/SimplePie','Credit.php',94],['lib/horde/framework/Horde/Support','Backtrace.php',121],['lib/simplepie/library/SimplePie','Item.php',110],['lib/horde/framework/Horde/Imap/Client','Ids.php',150],['lib/horde/framework/Horde/Imap/Client','Mailbox.php',116],['lib/horde/framework/Horde/Imap/Client/Data','Acl.php',43],['lib/pear/PEAR','Exception.php',315],['lib/horde/framework/Horde/Imap/Client/Data','BaseSubject.php',84],['lib/adodb','adodb.inc.php',3261],['lib/horde/framework/Horde/Support','Randomid.php',65],['lib/horde/framework/Horde','Stream.php',103],['lib/horde/framework/Horde/Mail/Rfc822','Object.php',25],['availability/classes','tree.php',91],['availability/classes','condition.php',93],['lib/horde/framework/Horde/Imap/Client/Data/Format','Number.php',27],['lib/lessphp/Tree','Unit.php',48],['lib/spout/src/Spout/Reader/Wrapper','SimpleXMLElement.php',173],['lib/simplepie/library/SimplePie','Category.php',95],['lib/pear','PEAR.php',1024],['lib/horde/framework/Horde/Imap/Client/Data','Namespace.php',122],['enrol/lti/ims-blti','OAuth.php',22],['enrol/lti/ims-blti','OAuth.php',52],['enrol/lti/ims-blti','OAuth.php',406],['lib/horde/framework/Horde/Imap/Client','DateTime.php',59],['lib/phpexcel/PHPExcel','Comment.php',329],['lib/horde/framework/Horde/Imap/Client/Data','AclRights.php',59],['lib/horde/framework/Horde/Support','Uuid.php',75],['lib/horde/framework/Horde/Imap/Client/Data/Format','Nil.php',34],['lib/dml/tests','dml_test.php',5567],['lib/simplepie/library/SimplePie','Caption.php',113],['backup/cc','validator.php',97],['grade/report/singleview/classes/local/ui','attribute_format.php',44],['lib/horde/framework/Horde/Imap/Client/Data/Format','DateTime.php',27],['lib/horde/framework/Horde/Stream','TempString.php',109],['lib/horde/framework/Horde/Support','Stub.php',21],['lib/horde/framework/Horde/Support','Guid.php',63],['lib/pear/Net/GeoIP','Location.php',176]], 11],
'from_where_params': ['from_where_params', '', [['question/engine','datalib.php',1897],['question/engine','datalib.php',1969]], 11],
'prepare_response_files_draft_itemid_with_text': ['prepare_response_files_draft_itemid_with_text', 'Prepare a draft file are for the files belonging the a response variable of this step, while rewriting the URLs in some text. ', [['question/engine','questionattemptstep.php',250],['question/engine','questionattemptstep.php',740]], 3],
'in_summary_state_test': ['in_summary_state_test', 'Get the SQL needed to test that question_attempt_steps.state is in a state corresponding to $summarystate. ', [['question/engine','datalib.php',1095]], 2],
'get_dbfamily': ['get_dbfamily', 'Returns database family type - describes SQL dialect Note: can be used before connect() ', [['lib/dml','oci_native_moodle_database.php',67],['lib/dml','sqlite3_pdo_moodle_database.php',50],['lib/dml','pgsql_native_moodle_database.php',60],['lib/dml','mssql_native_moodle_database.php',61],['lib/dml','mysqli_native_moodle_database.php',117],['lib/dml','sqlsrv_native_moodle_database.php',81],['lib/dml/tests','dml_test.php',5527]], 54],
'get_owning_component': ['get_owning_component', '', [['question/engine','questionusage.php',113]], 6],
'delete_records': ['delete_records', 'Delete the records from a table where all the given conditions met. If conditions not specified, table is truncated. ', [['lib/dml','sqlite3_pdo_moodle_database.php',345],['lib/dml','moodle_database.php',1864]], 773],
'load_question_attempt': ['load_question_attempt', 'Load a {@link question_attempt} from the database, including all its steps. ', [['question/engine','datalib.php',340]], 0],
'get_step': ['get_step', '', [['question/engine/tests','helpers.php',911],['question/engine','questionattempt.php',362]], 52],
'full_states_to_summary_state_sql': ['full_states_to_summary_state_sql', 'Get all the WHEN \'x\' THEN \'y\' terms needed to convert the question_attempt_steps.state column to a summary state. Use this like CASE qas.state {$this->full_states_to_summary_state_sql()} END AS summarystate, ', [['question/engine','datalib.php',1081]], 2],
'list': ['list', '', [['mod/data/preset/imagegallery','jstemplate.js',9]], 2229],
'load_questions_usages_where_question_in_state': ['load_questions_usages_where_question_in_state', 'Get a list of usage ids where the question with slot $slot, and optionally also with question id $questionid, is in summary state $summarystate. Also return the total count of such states. ', [['question/engine','datalib.php',667]], 4],
'usage_id_in': ['usage_id_in', '', [['question/engine','datalib.php',1901],['question/engine','datalib.php',1973]], 12],
'make_step_record': ['make_step_record', 'Helper method used by insert_question_attempt_step and update_question_attempt_step ', [['question/engine','datalib.php',154]], 2],
'get_records_sql': ['get_records_sql', 'Get a number of records as an array of objects. ', [['lib/dml','pdo_moodle_database.php',309],['lib/dml','oci_native_moodle_database.php',1145],['lib/dml','pgsql_native_moodle_database.php',732],['lib/dml','mssql_native_moodle_database.php',805],['lib/dml','mysqli_native_moodle_database.php',1057],['lib/dml','sqlsrv_native_moodle_database.php',890],['lib/dml/tests','dml_test.php',5545]], 700],
'set_field_select': ['set_field_select', 'Set a single field in every table row where the select statement evaluates to true. ', [['lib/dml','pdo_moodle_database.php',492],['lib/dml','oci_native_moodle_database.php',1436],['lib/dml','pgsql_native_moodle_database.php',1121],['lib/dml','mssql_native_moodle_database.php',1097],['lib/dml','mysqli_native_moodle_database.php',1435],['lib/dml','sqlsrv_native_moodle_database.php',1178],['lib/dml/tests','dml_test.php',5552]], 67],
'get_state': ['get_state', '', [['mod/quiz','attemptlib.php',799],['question/engine','questionattemptstep.php',141],['question/engine','questionattemptstep.php',580],['question/engine','questionattemptstep.php',666],['question/engine','questionattempt.php',589],['cache/classes','factory.php',495]], 113],
'update_question_attempt_step': ['update_question_attempt_step', 'Update a {@link question_attempt_step} in the database. ', [['question/engine','datalib.php',232]], 1],
'get_question': ['get_question', '', [['mod/quiz','attemptlib.php',249],['question/engine/upgrade','upgradelib.php',326],['question/engine','questionusage.php',218],['question/engine','questionattempt.php',204]], 89],
'file_save_draft_area_files': ['file_save_draft_area_files', 'Saves files from a draft file area to a real one (merging the list of files). Can rewrite URLs in some content at the same time if desired. ', [['lib','filelib.php',778]], 61],
'insert_all_step_data': ['insert_all_step_data', 'Insert a lot of records into question_attempt_step_data in one go. ', [['question/engine','datalib.php',198]], 2],
'update_record': ['update_record', 'Update a record in a table ', [['lib/dml','pdo_moodle_database.php',461],['lib/dml','oci_native_moodle_database.php',1404],['lib/dml','pgsql_native_moodle_database.php',1089],['lib/dml','mssql_native_moodle_database.php',1067],['lib/dml','mysqli_native_moodle_database.php',1405],['lib/dml','sqlsrv_native_moodle_database.php',1148],['lib/dml/tests','dml_test.php',5551]], 650],
'update_question_attempt_metadata': ['update_question_attempt_metadata', 'Updates existing metadata for an existing {@link question_attempt} in the database. ', [['question/engine','datalib.php',279]], 1],
'set_id_from_database': ['set_id_from_database', 'For internal use only. Used by {@link question_engine_data_mapper} to set the id when a usage is saved to the database. ', [['question/engine','questionusage.php',127]], 3],
'insert_question_attempt_metadata': ['insert_question_attempt_metadata', 'Store new metadata for an existing {@link question_attempt} in the database. ', [['question/engine','datalib.php',255]], 2],
'load_questions_usages_latest_steps': ['load_questions_usages_latest_steps', 'Load information about the latest state of each question from the database. ', [['question/engine','datalib.php',534]], 3],
'defined': ['defined', '', [], 4731],
'array_fill': ['array_fill', '', [], 60],
'array_slice': ['array_slice', '', [], 165],
'array_combine': ['array_combine', '', [], 135],
'call_user_func_array': ['call_user_func_array', '', [], 94],
'time': ['time', '', [], 1959],
'count': ['count', '', [], 4095],
'is_null': ['is_null', '', [], 2003],
'shuffle': ['shuffle', '', [], 27],
'array_map': ['array_map', '', [], 169],
'array_keys': ['array_keys', '', [], 1256],
'substr': ['substr', '', [], 2823],
'serialize': ['serialize', '', [], 282],
'array_chunk': ['array_chunk', '', [], 14],
'preg_match': ['preg_match', '', [], 1286],
'preg_replace': ['preg_replace', '', [], 917],
'max': ['max', '', [], 1266],
'sha1': ['sha1', '', [], 186],
'array_key_exists': ['array_key_exists', '', [], 1445],
'reset': ['reset', '', [], 1213],
'current': ['current', '', [], 155]};
CLASS_DATA={
'question_attempt': ['question_attempt', 'Tracks an attempt at one particular question in a {@link question_usage_by_activity}. ', [['question/engine','questionattempt.php',30]], 98],
'qubaid_list': ['qubaid_list', 'This class represents a restriction on the set of question_usage ids to include in a larger database query based on an explicit list of ids. ', [['question/engine','datalib.php',1857]], 30],
'qubaid_join': ['qubaid_join', 'This class represents a restriction on the set of question_usage ids to include in a larger database query based on JOINing to some other tables. ', [['question/engine','datalib.php',1919]], 15],
'question_response_files': ['question_response_files', 'The interface implemented by {@link question_file_saver} and {@link question_file_loader}. ', [['question/engine','datalib.php',1592]], 2],
'question_engine_data_mapper': ['question_engine_data_mapper', 'This class controls the loading and saving of question engine data to and from the database. ', [['question/engine','datalib.php',51]], 17],
'context_user': ['context_user', 'User context class ', [['lib','accesslib.php',6398]], 414],
'question_usage_by_activity': ['question_usage_by_activity', 'This class keeps track of a group of questions that are being attempted, and which state, and so on, each one is currently in. ', [['question/engine','questionusage.php',30]], 8],
'question_file_loader': ['question_file_loader', 'This class is the mirror image of {@link question_file_saver}. It allows files to be accessed again later (e.g. when re-grading) using that same API as when doing the original grading. ', [['question/engine','datalib.php',1716]], 1],
'question_engine_unit_of_work': ['question_engine_unit_of_work', 'Implementation of the unit of work pattern for the question engine. ', [['question/engine','datalib.php',1274]], 2],
'moodle_exception': ['moodle_exception', 'Base Moodle Exception class ', [['lib','setuplib.php',75]], 606],
'core_text': ['core_text', 'defines string api\'s for manipulating strings ', [['lib/classes','text.php',27]], 566],
'question_usage_null_observer': ['question_usage_null_observer', 'Null implmentation of the {@link question_usage_watcher} interface. Does nothing. ', [['question/engine','questionusage.php',1094]], 9],
'coding_exception': ['coding_exception', 'Exception indicating programming error, must be fixed by a programer. For example a core API might throw this type of exception if a plugin calls it incorrectly. ', [['lib','setuplib.php',239]], 1200],
'question_file_saver': ['question_file_saver', 'This class represents the promise to save some files from a particular draft file area into a particular file area. It is used beause the necessary information about what to save is to hand in the {@link question_attempt::process_response_files()} method, but we don\'t know if this question attempt will actually be saved in the database until later, when the {@link question_engine_unit_of_work} is saved, if it is. ', [['question/engine','datalib.php',1607]], 3],
'question_usage_observer': ['question_usage_observer', 'Interface for things that want to be notified of signficant changes to a {@link question_usage_by_activity}. ', [['question/engine','questionusage.php',1022]], 2],
'question_attempt_step': ['question_attempt_step', 'Stores one step in a {@link question_attempt}. ', [['question/engine','questionattemptstep.php',30]], 166]};
CONST_DATA={
'SQL_PARAMS_NAMED': ['SQL_PARAMS_NAMED', '', [['lib/dml','moodle_database.php',32]], 315],
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',140],['','install.php',93],['lib','setup.php',391]], 4153]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Aug 11 10:00:09 2016</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
