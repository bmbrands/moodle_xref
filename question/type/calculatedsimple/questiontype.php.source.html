<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /question/type/calculatedsimple/questiontype.php source</title>
    <link rel="stylesheet" href="../../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu May 28 19:17:31 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../../';
subdir='question/type/calculatedsimple';
filename='questiontype.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/question/type/calculatedsimple/</a> -> <a href="questiontype.php.html">questiontype.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="questiontype.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="questiontype.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * Question type class for the simple calculated question type.</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * @package    qtype</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @subpackage calculatedsimple</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @copyright  2009 Pierre Pichet</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> */</span>
<a name="l25"><span class="linenum">  25</span></a>  
<a name="l26"><span class="linenum">  26</span></a>  
<a name="l27"><span class="linenum">  27</span></a>  <a class="phpfunction" onClick="logFunction('defined')" href="../../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('MOODLE_INTERNAL')" href="../../../_constants/MOODLE_INTERNAL.html" onMouseOver="constPopup(event,'MOODLE_INTERNAL')">MOODLE_INTERNAL</a>') || die();
<a name="l28"><span class="linenum">  28</span></a>  
<a name="l29"><span class="linenum">  29</span></a>  require_once(<a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it39440" onMouseOver="hilite(39440)" onMouseOut="lolite()" href="../../../_variables/dirroot.html">dirroot</a> . '<a class="filename" href="../../../question/type/calculated/questiontype.php.html">/question/type/calculated/questiontype.php</a>');
<a name="l30"><span class="linenum">  30</span></a>  
<a name="l31"><span class="linenum">  31</span></a>  
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment">/**</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> * The simple calculated question type.</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> *</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> * @copyright  2009 Pierre Pichet</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment"> */</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('qtype_calculatedsimple')" href="../../../_classes/qtype_calculatedsimple.html" onMouseOver="classPopup(event,'qtype_calculatedsimple')">qtype_calculatedsimple</a> <span class="keyword">extends</span> <a class="class" onClick="logClass('qtype_calculated')" href="../../../_classes/qtype_calculated.html" onMouseOver="classPopup(event,'qtype_calculated')">qtype_calculated</a> {
<a name="l39"><span class="linenum">  39</span></a>  
<a name="l40"><span class="linenum">  40</span></a>  <span class="comment">    // Used by the function custom_generator_tools.</span>
<a name="l41"><span class="linenum">  41</span></a>      public <a class="var it31183" onMouseOver="hilite(31183)" onMouseOut="lolite()" onClick="logVariable('wizard_pages_number')" href="../../../_variables/wizard_pages_number.html">$wizard_pages_number</a> = 1;
<a name="l42"><span class="linenum">  42</span></a>  
<a name="l43"><span class="linenum">  43</span></a>      public function <a class="function" onClick="logFunction('save_question_options')" href="../../../_functions/save_question_options.html" onMouseOver="funcPopup(event,'save_question_options')">save_question_options</a>(<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>) {
<a name="l44"><span class="linenum">  44</span></a>          global <a class="var it1" onMouseOver="hilite(1)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../../../_variables/CFG.html">$CFG</a>, <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l45"><span class="linenum">  45</span></a>          <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../_variables/context.html">$context</a> = <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('context')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/context.html">context</a>;
<a name="l46"><span class="linenum">  46</span></a>  
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment">        // Make it impossible to save bad formulas anywhere.</span>
<a name="l48"><span class="linenum">  48</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('validate_question_data')" href="../../../_functions/validate_question_data.html" onMouseOver="funcPopup(event,'validate_question_data')">validate_question_data</a>(<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>);
<a name="l49"><span class="linenum">  49</span></a>  
<a name="l50"><span class="linenum">  50</span></a>  <span class="comment">        // Get old versions of the objects.</span>
<a name="l51"><span class="linenum">  51</span></a>          if (!<a class="var it7591" onMouseOver="hilite(7591)" onMouseOut="lolite()" onClick="logVariable('oldanswers')" href="../../../_variables/oldanswers.html">$oldanswers</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('question_answers',
<a name="l52"><span class="linenum">  52</span></a>                  array('question' =&gt; <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>), 'id ASC')) {
<a name="l53"><span class="linenum">  53</span></a>              <a class="var it7591" onMouseOver="hilite(7591)" onMouseOut="lolite()" onClick="logVariable('oldanswers')" href="../../../_variables/oldanswers.html">$oldanswers</a> = array();
<a name="l54"><span class="linenum">  54</span></a>          }
<a name="l55"><span class="linenum">  55</span></a>  
<a name="l56"><span class="linenum">  56</span></a>          if (!<a class="var it14728" onMouseOver="hilite(14728)" onMouseOut="lolite()" onClick="logVariable('oldoptions')" href="../../../_variables/oldoptions.html">$oldoptions</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_records')" href="../../../_functions/get_records.html" onMouseOver="funcPopup(event,'get_records')">get_records</a>('question_calculated',
<a name="l57"><span class="linenum">  57</span></a>                  array('question' =&gt; <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>), 'answer ASC')) {
<a name="l58"><span class="linenum">  58</span></a>              <a class="var it14728" onMouseOver="hilite(14728)" onMouseOut="lolite()" onClick="logVariable('oldoptions')" href="../../../_variables/oldoptions.html">$oldoptions</a> = array();
<a name="l59"><span class="linenum">  59</span></a>          }
<a name="l60"><span class="linenum">  60</span></a>  
<a name="l61"><span class="linenum">  61</span></a>  <span class="comment">        // Save the units.</span>
<a name="l62"><span class="linenum">  62</span></a>          <a class="var it20657" onMouseOver="hilite(20657)" onMouseOut="lolite()" onClick="logVariable('virtualqtype')" href="../../../_variables/virtualqtype.html">$virtualqtype</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_virtual_qtype')" href="../../../_functions/get_virtual_qtype.html" onMouseOver="funcPopup(event,'get_virtual_qtype')">get_virtual_qtype</a>();
<a name="l63"><span class="linenum">  63</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a> = <a class="var it20657" onMouseOver="hilite(20657)" onMouseOut="lolite()" onClick="logVariable('virtualqtype')" href="../../../_variables/virtualqtype.html">$virtualqtype</a>-&gt;<a class="function" onClick="logFunction('save_units')" href="../../../_functions/save_units.html" onMouseOver="funcPopup(event,'save_units')">save_units</a>(<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>);
<a name="l64"><span class="linenum">  64</span></a>          if (isset(<a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('error')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../../_variables/error.html">error</a>)) {
<a name="l65"><span class="linenum">  65</span></a>              return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a>;
<a name="l66"><span class="linenum">  66</span></a>          } else {
<a name="l67"><span class="linenum">  67</span></a>              <a class="var it4744" onMouseOver="hilite(4744)" onMouseOut="lolite()" onClick="logVariable('units')" href="../../../_variables/units.html">$units</a> = &amp;<a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('units')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../../_variables/units.html">units</a>;
<a name="l68"><span class="linenum">  68</span></a>          }
<a name="l69"><span class="linenum">  69</span></a>  <span class="comment">        // Insert all the new answers.</span>
<a name="l70"><span class="linenum">  70</span></a>          foreach (<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('answer')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/answer.html">answer</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> =&gt; <a class="var it1792" onMouseOver="hilite(1792)" onMouseOut="lolite()" onClick="logVariable('answerdata')" href="../../../_variables/answerdata.html">$answerdata</a>) {
<a name="l71"><span class="linenum">  71</span></a>              if (<a class="phpfunction" onClick="logFunction('is_array')" href="../../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it1792" onMouseOver="hilite(1792)" onMouseOut="lolite()" onClick="logVariable('answerdata')" href="../../../_variables/answerdata.html">$answerdata</a>)) {
<a name="l72"><span class="linenum">  72</span></a>                  <a class="var it1792" onMouseOver="hilite(1792)" onMouseOut="lolite()" onClick="logVariable('answerdata')" href="../../../_variables/answerdata.html">$answerdata</a> = <a class="var it1792" onMouseOver="hilite(1792)" onMouseOut="lolite()" onClick="logVariable('answerdata')" href="../../../_variables/answerdata.html">$answerdata</a>['text'];
<a name="l73"><span class="linenum">  73</span></a>              }
<a name="l74"><span class="linenum">  74</span></a>              if (<a class="phpfunction" onClick="logFunction('trim')" href="../../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it1792" onMouseOver="hilite(1792)" onMouseOut="lolite()" onClick="logVariable('answerdata')" href="../../../_variables/answerdata.html">$answerdata</a>) == '') {
<a name="l75"><span class="linenum">  75</span></a>                  continue;
<a name="l76"><span class="linenum">  76</span></a>              }
<a name="l77"><span class="linenum">  77</span></a>  
<a name="l78"><span class="linenum">  78</span></a>  <span class="comment">            // Update an existing answer if possible.</span>
<a name="l79"><span class="linenum">  79</span></a>              <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../../_variables/answer.html">$answer</a> = <a class="phpfunction" onClick="logFunction('array_shift')" href="../../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it7591" onMouseOver="hilite(7591)" onMouseOut="lolite()" onClick="logVariable('oldanswers')" href="../../../_variables/oldanswers.html">$oldanswers</a>);
<a name="l80"><span class="linenum">  80</span></a>              if (!<a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../../_variables/answer.html">$answer</a>) {
<a name="l81"><span class="linenum">  81</span></a>                  <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../../_variables/answer.html">$answer</a> = new stdClass();
<a name="l82"><span class="linenum">  82</span></a>                  <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../../_variables/answer.html">$answer</a>-&gt;<a onClick="logVariable('question')" class="var it39604" onMouseOver="hilite(39604)" onMouseOut="lolite()" href="../../../_variables/question.html">question</a> = <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>;
<a name="l83"><span class="linenum">  83</span></a>                  <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../../_variables/answer.html">$answer</a>-&gt;<a onClick="logVariable('answer')" class="var it39604" onMouseOver="hilite(39604)" onMouseOut="lolite()" href="../../../_variables/answer.html">answer</a>   = '';
<a name="l84"><span class="linenum">  84</span></a>                  <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../../_variables/answer.html">$answer</a>-&gt;<a onClick="logVariable('feedback')" class="var it39604" onMouseOver="hilite(39604)" onMouseOut="lolite()" href="../../../_variables/feedback.html">feedback</a> = '';
<a name="l85"><span class="linenum">  85</span></a>                  <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../../_variables/answer.html">$answer</a>-&gt;<a onClick="logVariable('id')" class="var it39604" onMouseOver="hilite(39604)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>       = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('question_answers', <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../../_variables/answer.html">$answer</a>);
<a name="l86"><span class="linenum">  86</span></a>              }
<a name="l87"><span class="linenum">  87</span></a>  
<a name="l88"><span class="linenum">  88</span></a>              <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../../_variables/answer.html">$answer</a>-&gt;<a onClick="logVariable('answer')" class="var it39604" onMouseOver="hilite(39604)" onMouseOut="lolite()" href="../../../_variables/answer.html">answer</a>   = <a class="phpfunction" onClick="logFunction('trim')" href="../../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it1792" onMouseOver="hilite(1792)" onMouseOut="lolite()" onClick="logVariable('answerdata')" href="../../../_variables/answerdata.html">$answerdata</a>);
<a name="l89"><span class="linenum">  89</span></a>              <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../../_variables/answer.html">$answer</a>-&gt;<a onClick="logVariable('fraction')" class="var it39604" onMouseOver="hilite(39604)" onMouseOut="lolite()" href="../../../_variables/fraction.html">fraction</a> = <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('fraction')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/fraction.html">fraction</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>];
<a name="l90"><span class="linenum">  90</span></a>              <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../../_variables/answer.html">$answer</a>-&gt;<a onClick="logVariable('feedback')" class="var it39604" onMouseOver="hilite(39604)" onMouseOut="lolite()" href="../../../_variables/feedback.html">feedback</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('import_or_save_files')" href="../../../_functions/import_or_save_files.html" onMouseOver="funcPopup(event,'import_or_save_files')">import_or_save_files</a>(<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('feedback')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/feedback.html">feedback</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>],
<a name="l91"><span class="linenum">  91</span></a>                      <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('context')" href="../../../_variables/context.html">$context</a>, 'question', 'answerfeedback', <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../../_variables/answer.html">$answer</a>-&gt;<a onClick="logVariable('id')" class="var it39604" onMouseOver="hilite(39604)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>);
<a name="l92"><span class="linenum">  92</span></a>              <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../../_variables/answer.html">$answer</a>-&gt;<a onClick="logVariable('feedbackformat')" class="var it39604" onMouseOver="hilite(39604)" onMouseOut="lolite()" href="../../../_variables/feedbackformat.html">feedbackformat</a> = <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('feedback')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/feedback.html">feedback</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>]['format'];
<a name="l93"><span class="linenum">  93</span></a>  
<a name="l94"><span class="linenum">  94</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>(&quot;question_answers&quot;, <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../../_variables/answer.html">$answer</a>);
<a name="l95"><span class="linenum">  95</span></a>  
<a name="l96"><span class="linenum">  96</span></a>  <span class="comment">            // Set up the options object.</span>
<a name="l97"><span class="linenum">  97</span></a>              if (!<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../_variables/options.html">$options</a> = <a class="phpfunction" onClick="logFunction('array_shift')" href="../../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it14728" onMouseOver="hilite(14728)" onMouseOut="lolite()" onClick="logVariable('oldoptions')" href="../../../_variables/oldoptions.html">$oldoptions</a>)) {
<a name="l98"><span class="linenum">  98</span></a>                  <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../_variables/options.html">$options</a> = new stdClass();
<a name="l99"><span class="linenum">  99</span></a>              }
<a name="l100"><span class="linenum"> 100</span></a>              <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('question')" class="var it39524" onMouseOver="hilite(39524)" onMouseOut="lolite()" href="../../../_variables/question.html">question</a>            = <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>;
<a name="l101"><span class="linenum"> 101</span></a>              <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('answer')" class="var it39524" onMouseOver="hilite(39524)" onMouseOut="lolite()" href="../../../_variables/answer.html">answer</a>              = <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../../_variables/answer.html">$answer</a>-&gt;<a onClick="logVariable('id')" class="var it39604" onMouseOver="hilite(39604)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>;
<a name="l102"><span class="linenum"> 102</span></a>              <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('tolerance')" class="var it39524" onMouseOver="hilite(39524)" onMouseOut="lolite()" href="../../../_variables/tolerance.html">tolerance</a>           = <a class="phpfunction" onClick="logFunction('trim')" href="../../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('tolerance')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/tolerance.html">tolerance</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>]);
<a name="l103"><span class="linenum"> 103</span></a>              <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('tolerancetype')" class="var it39524" onMouseOver="hilite(39524)" onMouseOut="lolite()" href="../../../_variables/tolerancetype.html">tolerancetype</a>       = <a class="phpfunction" onClick="logFunction('trim')" href="../../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('tolerancetype')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/tolerancetype.html">tolerancetype</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>]);
<a name="l104"><span class="linenum"> 104</span></a>              <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('correctanswerlength')" class="var it39524" onMouseOver="hilite(39524)" onMouseOut="lolite()" href="../../../_variables/correctanswerlength.html">correctanswerlength</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('correctanswerlength')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/correctanswerlength.html">correctanswerlength</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>]);
<a name="l105"><span class="linenum"> 105</span></a>              <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('correctanswerformat')" class="var it39524" onMouseOver="hilite(39524)" onMouseOut="lolite()" href="../../../_variables/correctanswerformat.html">correctanswerformat</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('correctanswerformat')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/correctanswerformat.html">correctanswerformat</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>]);
<a name="l106"><span class="linenum"> 106</span></a>  
<a name="l107"><span class="linenum"> 107</span></a>  <span class="comment">            // Save options.</span>
<a name="l108"><span class="linenum"> 108</span></a>              if (isset(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../_variables/options.html">$options</a>-&gt;<a onClick="logVariable('id')" class="var it39524" onMouseOver="hilite(39524)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>)) {
<a name="l109"><span class="linenum"> 109</span></a>  <span class="comment">                // Reusing existing record.</span>
<a name="l110"><span class="linenum"> 110</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('question_calculated', <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../_variables/options.html">$options</a>);
<a name="l111"><span class="linenum"> 111</span></a>              } else {
<a name="l112"><span class="linenum"> 112</span></a>  <span class="comment">                // New options.</span>
<a name="l113"><span class="linenum"> 113</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('question_calculated', <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../_variables/options.html">$options</a>);
<a name="l114"><span class="linenum"> 114</span></a>              }
<a name="l115"><span class="linenum"> 115</span></a>          }
<a name="l116"><span class="linenum"> 116</span></a>  
<a name="l117"><span class="linenum"> 117</span></a>  <span class="comment">        // Delete old answer records.</span>
<a name="l118"><span class="linenum"> 118</span></a>          if (!empty(<a class="var it7591" onMouseOver="hilite(7591)" onMouseOut="lolite()" onClick="logVariable('oldanswers')" href="../../../_variables/oldanswers.html">$oldanswers</a>)) {
<a name="l119"><span class="linenum"> 119</span></a>              foreach (<a class="var it7591" onMouseOver="hilite(7591)" onMouseOut="lolite()" onClick="logVariable('oldanswers')" href="../../../_variables/oldanswers.html">$oldanswers</a> as <a class="var it14729" onMouseOver="hilite(14729)" onMouseOut="lolite()" onClick="logVariable('oa')" href="../../../_variables/oa.html">$oa</a>) {
<a name="l120"><span class="linenum"> 120</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('question_answers', array('id' =&gt; <a class="var it14729" onMouseOver="hilite(14729)" onMouseOut="lolite()" onClick="logVariable('oa')" href="../../../_variables/oa.html">$oa</a>-&gt;<a onClick="logVariable('id')" class="var it39859" onMouseOver="hilite(39859)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>));
<a name="l121"><span class="linenum"> 121</span></a>              }
<a name="l122"><span class="linenum"> 122</span></a>          }
<a name="l123"><span class="linenum"> 123</span></a>  
<a name="l124"><span class="linenum"> 124</span></a>  <span class="comment">        // Delete old answer records.</span>
<a name="l125"><span class="linenum"> 125</span></a>          if (!empty(<a class="var it14728" onMouseOver="hilite(14728)" onMouseOut="lolite()" onClick="logVariable('oldoptions')" href="../../../_variables/oldoptions.html">$oldoptions</a>)) {
<a name="l126"><span class="linenum"> 126</span></a>              foreach (<a class="var it14728" onMouseOver="hilite(14728)" onMouseOut="lolite()" onClick="logVariable('oldoptions')" href="../../../_variables/oldoptions.html">$oldoptions</a> as <a class="var it14730" onMouseOver="hilite(14730)" onMouseOut="lolite()" onClick="logVariable('oo')" href="../../../_variables/oo.html">$oo</a>) {
<a name="l127"><span class="linenum"> 127</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('question_calculated', array('id' =&gt; <a class="var it14730" onMouseOver="hilite(14730)" onMouseOut="lolite()" onClick="logVariable('oo')" href="../../../_variables/oo.html">$oo</a>-&gt;<a onClick="logVariable('id')" class="var it39860" onMouseOver="hilite(39860)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>));
<a name="l128"><span class="linenum"> 128</span></a>              }
<a name="l129"><span class="linenum"> 129</span></a>          }
<a name="l130"><span class="linenum"> 130</span></a>  
<a name="l131"><span class="linenum"> 131</span></a>          if (isset(<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('import_process')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/import_process.html">import_process</a>) &amp;&amp; <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('import_process')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/import_process.html">import_process</a>) {
<a name="l132"><span class="linenum"> 132</span></a>              <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('import_datasets')" href="../../../_functions/import_datasets.html" onMouseOver="funcPopup(event,'import_datasets')">import_datasets</a>(<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>);
<a name="l133"><span class="linenum"> 133</span></a>          } else {
<a name="l134"><span class="linenum"> 134</span></a>  <span class="comment">            // Save datasets and datatitems from form i.e in question.</span>
<a name="l135"><span class="linenum"> 135</span></a>              <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('dataset')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/dataset.html">dataset</a> = <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('datasetdef')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/datasetdef.html">datasetdef</a>;
<a name="l136"><span class="linenum"> 136</span></a>  
<a name="l137"><span class="linenum"> 137</span></a>  <span class="comment">            // Save datasets.</span>
<a name="l138"><span class="linenum"> 138</span></a>              <a class="var it20703" onMouseOver="hilite(20703)" onMouseOut="lolite()" onClick="logVariable('datasetdefinitions')" href="../../../_variables/datasetdefinitions.html">$datasetdefinitions</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_dataset_definitions')" href="../../../_functions/get_dataset_definitions.html" onMouseOver="funcPopup(event,'get_dataset_definitions')">get_dataset_definitions</a>(<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>, <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('dataset')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/dataset.html">dataset</a>);
<a name="l139"><span class="linenum"> 139</span></a>              <a class="var it20704" onMouseOver="hilite(20704)" onMouseOut="lolite()" onClick="logVariable('tmpdatasets')" href="../../../_variables/tmpdatasets.html">$tmpdatasets</a> = <a class="phpfunction" onClick="logFunction('array_flip')" href="../../../_functions/array_flip.html" onMouseOver="phpfuncPopup(event,'array_flip')">array_flip</a>(<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('dataset')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/dataset.html">dataset</a>);
<a name="l140"><span class="linenum"> 140</span></a>              <a class="var it20705" onMouseOver="hilite(20705)" onMouseOut="lolite()" onClick="logVariable('defids')" href="../../../_variables/defids.html">$defids</a> = <a class="phpfunction" onClick="logFunction('array_keys')" href="../../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it20703" onMouseOver="hilite(20703)" onMouseOut="lolite()" onClick="logVariable('datasetdefinitions')" href="../../../_variables/datasetdefinitions.html">$datasetdefinitions</a>);
<a name="l141"><span class="linenum"> 141</span></a>              <a class="var it20652" onMouseOver="hilite(20652)" onMouseOut="lolite()" onClick="logVariable('datasetdefs')" href="../../../_variables/datasetdefs.html">$datasetdefs</a> = array();
<a name="l142"><span class="linenum"> 142</span></a>              foreach (<a class="var it20705" onMouseOver="hilite(20705)" onMouseOut="lolite()" onClick="logVariable('defids')" href="../../../_variables/defids.html">$defids</a> as <a class="var it20671" onMouseOver="hilite(20671)" onMouseOut="lolite()" onClick="logVariable('defid')" href="../../../_variables/defid.html">$defid</a>) {
<a name="l143"><span class="linenum"> 143</span></a>                  <a class="var it20658" onMouseOver="hilite(20658)" onMouseOut="lolite()" onClick="logVariable('datasetdef')" href="../../../_variables/datasetdef.html">$datasetdef</a> = &amp;<a class="var it20703" onMouseOver="hilite(20703)" onMouseOut="lolite()" onClick="logVariable('datasetdefinitions')" href="../../../_variables/datasetdefinitions.html">$datasetdefinitions</a>[<a class="var it20671" onMouseOver="hilite(20671)" onMouseOut="lolite()" onClick="logVariable('defid')" href="../../../_variables/defid.html">$defid</a>];
<a name="l144"><span class="linenum"> 144</span></a>                  if (isset(<a class="var it20658" onMouseOver="hilite(20658)" onMouseOut="lolite()" onClick="logVariable('datasetdef')" href="../../../_variables/datasetdef.html">$datasetdef</a>-&gt;<a onClick="logVariable('id')" class="var it39855" onMouseOver="hilite(39855)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>)) {
<a name="l145"><span class="linenum"> 145</span></a>                      if (!isset(<a class="var it20704" onMouseOver="hilite(20704)" onMouseOut="lolite()" onClick="logVariable('tmpdatasets')" href="../../../_variables/tmpdatasets.html">$tmpdatasets</a>[<a class="var it20671" onMouseOver="hilite(20671)" onMouseOut="lolite()" onClick="logVariable('defid')" href="../../../_variables/defid.html">$defid</a>])) {
<a name="l146"><span class="linenum"> 146</span></a>  <span class="comment">                        // This dataset is not used any more, delete it.</span>
<a name="l147"><span class="linenum"> 147</span></a>                          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('question_datasets', array('question' =&gt; <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>,
<a name="l148"><span class="linenum"> 148</span></a>                                  'datasetdefinition' =&gt; <a class="var it20658" onMouseOver="hilite(20658)" onMouseOut="lolite()" onClick="logVariable('datasetdef')" href="../../../_variables/datasetdef.html">$datasetdef</a>-&gt;<a onClick="logVariable('id')" class="var it39855" onMouseOver="hilite(39855)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>));
<a name="l149"><span class="linenum"> 149</span></a>                          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('question_dataset_definitions',
<a name="l150"><span class="linenum"> 150</span></a>                                  array('id' =&gt; <a class="var it20658" onMouseOver="hilite(20658)" onMouseOut="lolite()" onClick="logVariable('datasetdef')" href="../../../_variables/datasetdef.html">$datasetdef</a>-&gt;<a onClick="logVariable('id')" class="var it39855" onMouseOver="hilite(39855)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>));
<a name="l151"><span class="linenum"> 151</span></a>                          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('question_dataset_items',
<a name="l152"><span class="linenum"> 152</span></a>                                  array('definition' =&gt; <a class="var it20658" onMouseOver="hilite(20658)" onMouseOut="lolite()" onClick="logVariable('datasetdef')" href="../../../_variables/datasetdef.html">$datasetdef</a>-&gt;<a onClick="logVariable('id')" class="var it39855" onMouseOver="hilite(39855)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>));
<a name="l153"><span class="linenum"> 153</span></a>                      }
<a name="l154"><span class="linenum"> 154</span></a>  <span class="comment">                    // This has already been saved or just got deleted.</span>
<a name="l155"><span class="linenum"> 155</span></a>                      unset(<a class="var it20703" onMouseOver="hilite(20703)" onMouseOut="lolite()" onClick="logVariable('datasetdefinitions')" href="../../../_variables/datasetdefinitions.html">$datasetdefinitions</a>[<a class="var it20671" onMouseOver="hilite(20671)" onMouseOut="lolite()" onClick="logVariable('defid')" href="../../../_variables/defid.html">$defid</a>]);
<a name="l156"><span class="linenum"> 156</span></a>                      continue;
<a name="l157"><span class="linenum"> 157</span></a>                  }
<a name="l158"><span class="linenum"> 158</span></a>                  <a class="var it20658" onMouseOver="hilite(20658)" onMouseOut="lolite()" onClick="logVariable('datasetdef')" href="../../../_variables/datasetdef.html">$datasetdef</a>-&gt;<a onClick="logVariable('id')" class="var it39855" onMouseOver="hilite(39855)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('question_dataset_definitions', <a class="var it20658" onMouseOver="hilite(20658)" onMouseOut="lolite()" onClick="logVariable('datasetdef')" href="../../../_variables/datasetdef.html">$datasetdef</a>);
<a name="l159"><span class="linenum"> 159</span></a>                  <a class="var it20652" onMouseOver="hilite(20652)" onMouseOut="lolite()" onClick="logVariable('datasetdefs')" href="../../../_variables/datasetdefs.html">$datasetdefs</a>[] = <a class="function" onClick="logFunction('clone')" href="../../../_functions/clone.html" onMouseOver="funcPopup(event,'clone')">clone</a>(<a class="var it20658" onMouseOver="hilite(20658)" onMouseOut="lolite()" onClick="logVariable('datasetdef')" href="../../../_variables/datasetdef.html">$datasetdef</a>);
<a name="l160"><span class="linenum"> 160</span></a>                  <a class="var it14964" onMouseOver="hilite(14964)" onMouseOut="lolite()" onClick="logVariable('questiondataset')" href="../../../_variables/questiondataset.html">$questiondataset</a> = new stdClass();
<a name="l161"><span class="linenum"> 161</span></a>                  <a class="var it14964" onMouseOver="hilite(14964)" onMouseOut="lolite()" onClick="logVariable('questiondataset')" href="../../../_variables/questiondataset.html">$questiondataset</a>-&gt;<a onClick="logVariable('question')" class="var it39863" onMouseOver="hilite(39863)" onMouseOut="lolite()" href="../../../_variables/question.html">question</a> = <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>;
<a name="l162"><span class="linenum"> 162</span></a>                  <a class="var it14964" onMouseOver="hilite(14964)" onMouseOut="lolite()" onClick="logVariable('questiondataset')" href="../../../_variables/questiondataset.html">$questiondataset</a>-&gt;<a onClick="logVariable('datasetdefinition')" class="var it39863" onMouseOver="hilite(39863)" onMouseOut="lolite()" href="../../../_variables/datasetdefinition.html">datasetdefinition</a> = <a class="var it20658" onMouseOver="hilite(20658)" onMouseOut="lolite()" onClick="logVariable('datasetdef')" href="../../../_variables/datasetdef.html">$datasetdef</a>-&gt;<a onClick="logVariable('id')" class="var it39855" onMouseOver="hilite(39855)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>;
<a name="l163"><span class="linenum"> 163</span></a>                  <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('question_datasets', <a class="var it14964" onMouseOver="hilite(14964)" onMouseOut="lolite()" onClick="logVariable('questiondataset')" href="../../../_variables/questiondataset.html">$questiondataset</a>);
<a name="l164"><span class="linenum"> 164</span></a>                  unset(<a class="var it20703" onMouseOver="hilite(20703)" onMouseOut="lolite()" onClick="logVariable('datasetdefinitions')" href="../../../_variables/datasetdefinitions.html">$datasetdefinitions</a>[<a class="var it20671" onMouseOver="hilite(20671)" onMouseOut="lolite()" onClick="logVariable('defid')" href="../../../_variables/defid.html">$defid</a>]);
<a name="l165"><span class="linenum"> 165</span></a>              }
<a name="l166"><span class="linenum"> 166</span></a>  <span class="comment">            // Remove local obsolete datasets as well as relations</span>
<a name="l167"><span class="linenum"> 167</span></a>  <span class="comment">            // to datasets in other categories.</span>
<a name="l168"><span class="linenum"> 168</span></a>              if (!empty(<a class="var it20703" onMouseOver="hilite(20703)" onMouseOut="lolite()" onClick="logVariable('datasetdefinitions')" href="../../../_variables/datasetdefinitions.html">$datasetdefinitions</a>)) {
<a name="l169"><span class="linenum"> 169</span></a>                  foreach (<a class="var it20703" onMouseOver="hilite(20703)" onMouseOut="lolite()" onClick="logVariable('datasetdefinitions')" href="../../../_variables/datasetdefinitions.html">$datasetdefinitions</a> as <a class="var it307" onMouseOver="hilite(307)" onMouseOut="lolite()" onClick="logVariable('def')" href="../../../_variables/def.html">$def</a>) {
<a name="l170"><span class="linenum"> 170</span></a>                      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('question_datasets', array('question' =&gt; <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>,
<a name="l171"><span class="linenum"> 171</span></a>                              'datasetdefinition' =&gt; <a class="var it307" onMouseOver="hilite(307)" onMouseOut="lolite()" onClick="logVariable('def')" href="../../../_variables/def.html">$def</a>-&gt;<a onClick="logVariable('id')" class="var it39459" onMouseOver="hilite(39459)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>));
<a name="l172"><span class="linenum"> 172</span></a>                      if (<a class="var it307" onMouseOver="hilite(307)" onMouseOut="lolite()" onClick="logVariable('def')" href="../../../_variables/def.html">$def</a>-&gt;<a onClick="logVariable('category')" class="var it39459" onMouseOver="hilite(39459)" onMouseOut="lolite()" href="../../../_variables/category.html">category</a> == 0) { // Question local dataset.
<a name="l173"><span class="linenum"> 173</span></a>                          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('question_dataset_definitions',
<a name="l174"><span class="linenum"> 174</span></a>                                  array('id' =&gt; <a class="var it307" onMouseOver="hilite(307)" onMouseOut="lolite()" onClick="logVariable('def')" href="../../../_variables/def.html">$def</a>-&gt;<a onClick="logVariable('id')" class="var it39459" onMouseOver="hilite(39459)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>));
<a name="l175"><span class="linenum"> 175</span></a>                          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../../../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('question_dataset_items',
<a name="l176"><span class="linenum"> 176</span></a>                                  array('definition' =&gt; <a class="var it307" onMouseOver="hilite(307)" onMouseOut="lolite()" onClick="logVariable('def')" href="../../../_variables/def.html">$def</a>-&gt;<a onClick="logVariable('id')" class="var it39459" onMouseOver="hilite(39459)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>));
<a name="l177"><span class="linenum"> 177</span></a>                      }
<a name="l178"><span class="linenum"> 178</span></a>                  }
<a name="l179"><span class="linenum"> 179</span></a>              }
<a name="l180"><span class="linenum"> 180</span></a>              <a class="var it20652" onMouseOver="hilite(20652)" onMouseOut="lolite()" onClick="logVariable('datasetdefs')" href="../../../_variables/datasetdefs.html">$datasetdefs</a> = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_dataset_definitions')" href="../../../_functions/get_dataset_definitions.html" onMouseOver="funcPopup(event,'get_dataset_definitions')">get_dataset_definitions</a>(<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>, <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('dataset')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/dataset.html">dataset</a>);
<a name="l181"><span class="linenum"> 181</span></a>  <span class="comment">            // Handle adding and removing of dataset items.</span>
<a name="l182"><span class="linenum"> 182</span></a>              <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../../_variables/i.html">$i</a> = 1;
<a name="l183"><span class="linenum"> 183</span></a>              <a class="phpfunction" onClick="logFunction('ksort')" href="../../../_functions/ksort.html" onMouseOver="phpfuncPopup(event,'ksort')">ksort</a>(<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('definition')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/definition.html">definition</a>);
<a name="l184"><span class="linenum"> 184</span></a>              foreach (<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('definition')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/definition.html">definition</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> =&gt; <a class="var it20671" onMouseOver="hilite(20671)" onMouseOut="lolite()" onClick="logVariable('defid')" href="../../../_variables/defid.html">$defid</a>) {
<a name="l185"><span class="linenum"> 185</span></a>                  <a class="var it20685" onMouseOver="hilite(20685)" onMouseOut="lolite()" onClick="logVariable('addeditem')" href="../../../_variables/addeditem.html">$addeditem</a> = new stdClass();
<a name="l186"><span class="linenum"> 186</span></a>                  <a class="var it20685" onMouseOver="hilite(20685)" onMouseOut="lolite()" onClick="logVariable('addeditem')" href="../../../_variables/addeditem.html">$addeditem</a>-&gt;<a onClick="logVariable('definition')" class="var it39866" onMouseOver="hilite(39866)" onMouseOut="lolite()" href="../../../_variables/definition.html">definition</a> = <a class="var it20652" onMouseOver="hilite(20652)" onMouseOut="lolite()" onClick="logVariable('datasetdefs')" href="../../../_variables/datasetdefs.html">$datasetdefs</a>[<a class="var it20671" onMouseOver="hilite(20671)" onMouseOut="lolite()" onClick="logVariable('defid')" href="../../../_variables/defid.html">$defid</a>]-&gt;id;
<a name="l187"><span class="linenum"> 187</span></a>                  <a class="var it20685" onMouseOver="hilite(20685)" onMouseOut="lolite()" onClick="logVariable('addeditem')" href="../../../_variables/addeditem.html">$addeditem</a>-&gt;<a onClick="logVariable('value')" class="var it39866" onMouseOver="hilite(39866)" onMouseOut="lolite()" href="../../../_variables/value.html">value</a> = <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('number')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/number.html">number</a>[<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../../_variables/i.html">$i</a>];
<a name="l188"><span class="linenum"> 188</span></a>                  <a class="var it20685" onMouseOver="hilite(20685)" onMouseOut="lolite()" onClick="logVariable('addeditem')" href="../../../_variables/addeditem.html">$addeditem</a>-&gt;<a onClick="logVariable('itemnumber')" class="var it39866" onMouseOver="hilite(39866)" onMouseOut="lolite()" href="../../../_variables/itemnumber.html">itemnumber</a> = <a class="phpfunction" onClick="logFunction('ceil')" href="../../../_functions/ceil.html" onMouseOver="phpfuncPopup(event,'ceil')">ceil</a>(<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../../_variables/i.html">$i</a> / <a class="phpfunction" onClick="logFunction('count')" href="../../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it20652" onMouseOver="hilite(20652)" onMouseOut="lolite()" onClick="logVariable('datasetdefs')" href="../../../_variables/datasetdefs.html">$datasetdefs</a>));
<a name="l189"><span class="linenum"> 189</span></a>                  if (empty(<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('makecopy')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/makecopy.html">makecopy</a>) &amp;&amp; <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('itemid')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/itemid.html">itemid</a>[<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../../_variables/i.html">$i</a>]) {
<a name="l190"><span class="linenum"> 190</span></a>  <span class="comment">                    // Reuse any previously used record.</span>
<a name="l191"><span class="linenum"> 191</span></a>                      <a class="var it20685" onMouseOver="hilite(20685)" onMouseOut="lolite()" onClick="logVariable('addeditem')" href="../../../_variables/addeditem.html">$addeditem</a>-&gt;<a onClick="logVariable('id')" class="var it39866" onMouseOver="hilite(39866)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a> = <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('itemid')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/itemid.html">itemid</a>[<a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../../_variables/i.html">$i</a>];
<a name="l192"><span class="linenum"> 192</span></a>                      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('question_dataset_items', <a class="var it20685" onMouseOver="hilite(20685)" onMouseOut="lolite()" onClick="logVariable('addeditem')" href="../../../_variables/addeditem.html">$addeditem</a>);
<a name="l193"><span class="linenum"> 193</span></a>                  } else {
<a name="l194"><span class="linenum"> 194</span></a>                      <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../../../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('question_dataset_items', <a class="var it20685" onMouseOver="hilite(20685)" onMouseOut="lolite()" onClick="logVariable('addeditem')" href="../../../_variables/addeditem.html">$addeditem</a>);
<a name="l195"><span class="linenum"> 195</span></a>                  }
<a name="l196"><span class="linenum"> 196</span></a>                  <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../../_variables/i.html">$i</a>++;
<a name="l197"><span class="linenum"> 197</span></a>              }
<a name="l198"><span class="linenum"> 198</span></a>              <a class="var it20684" onMouseOver="hilite(20684)" onMouseOut="lolite()" onClick="logVariable('maxnumber')" href="../../../_variables/maxnumber.html">$maxnumber</a> = -1;
<a name="l199"><span class="linenum"> 199</span></a>              if (isset(<a class="var it20685" onMouseOver="hilite(20685)" onMouseOut="lolite()" onClick="logVariable('addeditem')" href="../../../_variables/addeditem.html">$addeditem</a>-&gt;<a onClick="logVariable('itemnumber')" class="var it39866" onMouseOver="hilite(39866)" onMouseOut="lolite()" href="../../../_variables/itemnumber.html">itemnumber</a>) &amp;&amp; <a class="var it20684" onMouseOver="hilite(20684)" onMouseOut="lolite()" onClick="logVariable('maxnumber')" href="../../../_variables/maxnumber.html">$maxnumber</a> &lt; <a class="var it20685" onMouseOver="hilite(20685)" onMouseOut="lolite()" onClick="logVariable('addeditem')" href="../../../_variables/addeditem.html">$addeditem</a>-&gt;<a onClick="logVariable('itemnumber')" class="var it39866" onMouseOver="hilite(39866)" onMouseOut="lolite()" href="../../../_variables/itemnumber.html">itemnumber</a>) {
<a name="l200"><span class="linenum"> 200</span></a>                  <a class="var it20684" onMouseOver="hilite(20684)" onMouseOut="lolite()" onClick="logVariable('maxnumber')" href="../../../_variables/maxnumber.html">$maxnumber</a> = <a class="var it20685" onMouseOver="hilite(20685)" onMouseOut="lolite()" onClick="logVariable('addeditem')" href="../../../_variables/addeditem.html">$addeditem</a>-&gt;<a onClick="logVariable('itemnumber')" class="var it39866" onMouseOver="hilite(39866)" onMouseOut="lolite()" href="../../../_variables/itemnumber.html">itemnumber</a>;
<a name="l201"><span class="linenum"> 201</span></a>                  foreach (<a class="var it20652" onMouseOver="hilite(20652)" onMouseOut="lolite()" onClick="logVariable('datasetdefs')" href="../../../_variables/datasetdefs.html">$datasetdefs</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> =&gt; <a class="var it20686" onMouseOver="hilite(20686)" onMouseOut="lolite()" onClick="logVariable('newdef')" href="../../../_variables/newdef.html">$newdef</a>) {
<a name="l202"><span class="linenum"> 202</span></a>                      if (isset(<a class="var it20686" onMouseOver="hilite(20686)" onMouseOut="lolite()" onClick="logVariable('newdef')" href="../../../_variables/newdef.html">$newdef</a>-&gt;<a onClick="logVariable('id')" class="var it39867" onMouseOver="hilite(39867)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>) &amp;&amp; <a class="var it20686" onMouseOver="hilite(20686)" onMouseOut="lolite()" onClick="logVariable('newdef')" href="../../../_variables/newdef.html">$newdef</a>-&gt;<a onClick="logVariable('itemcount')" class="var it39867" onMouseOver="hilite(39867)" onMouseOut="lolite()" href="../../../_variables/itemcount.html">itemcount</a> &lt;= <a class="var it20684" onMouseOver="hilite(20684)" onMouseOut="lolite()" onClick="logVariable('maxnumber')" href="../../../_variables/maxnumber.html">$maxnumber</a>) {
<a name="l203"><span class="linenum"> 203</span></a>                          <a class="var it20686" onMouseOver="hilite(20686)" onMouseOut="lolite()" onClick="logVariable('newdef')" href="../../../_variables/newdef.html">$newdef</a>-&gt;<a onClick="logVariable('itemcount')" class="var it39867" onMouseOver="hilite(39867)" onMouseOut="lolite()" href="../../../_variables/itemcount.html">itemcount</a> = <a class="var it20684" onMouseOver="hilite(20684)" onMouseOut="lolite()" onClick="logVariable('maxnumber')" href="../../../_variables/maxnumber.html">$maxnumber</a>;
<a name="l204"><span class="linenum"> 204</span></a>  <span class="comment">                        // Save the new value for options.</span>
<a name="l205"><span class="linenum"> 205</span></a>                          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../../../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('question_dataset_definitions', <a class="var it20686" onMouseOver="hilite(20686)" onMouseOut="lolite()" onClick="logVariable('newdef')" href="../../../_variables/newdef.html">$newdef</a>);
<a name="l206"><span class="linenum"> 206</span></a>                      }
<a name="l207"><span class="linenum"> 207</span></a>                  }
<a name="l208"><span class="linenum"> 208</span></a>              }
<a name="l209"><span class="linenum"> 209</span></a>          }
<a name="l210"><span class="linenum"> 210</span></a>  
<a name="l211"><span class="linenum"> 211</span></a>          <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('save_hints')" href="../../../_functions/save_hints.html" onMouseOver="funcPopup(event,'save_hints')">save_hints</a>(<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>);
<a name="l212"><span class="linenum"> 212</span></a>  
<a name="l213"><span class="linenum"> 213</span></a>  <span class="comment">        // Report any problems.</span>
<a name="l214"><span class="linenum"> 214</span></a>          if (!empty(<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('makecopy')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/makecopy.html">makecopy</a>) &amp;&amp; !empty(<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('convert')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/convert.html">convert</a>)) {
<a name="l215"><span class="linenum"> 215</span></a>              <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('set_field')" href="../../../_functions/set_field.html" onMouseOver="funcPopup(event,'set_field')">set_field</a>('question', 'qtype', 'calculated', array('id' =&gt; <a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>-&gt;<a onClick="logVariable('id')" class="var it39488" onMouseOver="hilite(39488)" onMouseOut="lolite()" href="../../../_variables/id.html">id</a>));
<a name="l216"><span class="linenum"> 216</span></a>          }
<a name="l217"><span class="linenum"> 217</span></a>  
<a name="l218"><span class="linenum"> 218</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a> = <a class="var it20657" onMouseOver="hilite(20657)" onMouseOut="lolite()" onClick="logVariable('virtualqtype')" href="../../../_variables/virtualqtype.html">$virtualqtype</a>-&gt;<a class="function" onClick="logFunction('save_unit_options')" href="../../../_functions/save_unit_options.html" onMouseOver="funcPopup(event,'save_unit_options')">save_unit_options</a>(<a class="var it480" onMouseOver="hilite(480)" onMouseOut="lolite()" onClick="logVariable('question')" href="../../../_variables/question.html">$question</a>);
<a name="l219"><span class="linenum"> 219</span></a>          if (isset(<a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('error')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../../_variables/error.html">error</a>)) {
<a name="l220"><span class="linenum"> 220</span></a>              return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a>;
<a name="l221"><span class="linenum"> 221</span></a>          }
<a name="l222"><span class="linenum"> 222</span></a>  
<a name="l223"><span class="linenum"> 223</span></a>          if (!empty(<a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a>-&gt;<a onClick="logVariable('notice')" class="var it39442" onMouseOver="hilite(39442)" onMouseOut="lolite()" href="../../../_variables/notice.html">notice</a>)) {
<a name="l224"><span class="linenum"> 224</span></a>              return <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a>;
<a name="l225"><span class="linenum"> 225</span></a>          }
<a name="l226"><span class="linenum"> 226</span></a>  
<a name="l227"><span class="linenum"> 227</span></a>          return true;
<a name="l228"><span class="linenum"> 228</span></a>      }
<a name="l229"><span class="linenum"> 229</span></a>  
<a name="l230"><span class="linenum"> 230</span></a>      public function <a class="function" onClick="logFunction('finished_edit_wizard')" href="../../../_functions/finished_edit_wizard.html" onMouseOver="funcPopup(event,'finished_edit_wizard')">finished_edit_wizard</a>(<a class="var it596" onMouseOver="hilite(596)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../../_variables/form.html">$form</a>) {
<a name="l231"><span class="linenum"> 231</span></a>          return true;
<a name="l232"><span class="linenum"> 232</span></a>      }
<a name="l233"><span class="linenum"> 233</span></a>  
<a name="l234"><span class="linenum"> 234</span></a>      public function <a class="function" onClick="logFunction('wizard_pages_number')" href="../../../_functions/wizard_pages_number.html" onMouseOver="funcPopup(event,'wizard_pages_number')">wizard_pages_number</a>() {
<a name="l235"><span class="linenum"> 235</span></a>          return 1;
<a name="l236"><span class="linenum"> 236</span></a>      }
<a name="l237"><span class="linenum"> 237</span></a>  
<a name="l238"><span class="linenum"> 238</span></a>      public function <a class="function" onClick="logFunction('custom_generator_tools_part')" href="../../../_functions/custom_generator_tools_part.html" onMouseOver="funcPopup(event,'custom_generator_tools_part')">custom_generator_tools_part</a>(<a class="var it1037" onMouseOver="hilite(1037)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../../../_variables/mform.html">$mform</a>, <a class="var it2039" onMouseOver="hilite(2039)" onMouseOut="lolite()" onClick="logVariable('idx')" href="../../../_variables/idx.html">$idx</a>, <a class="var it84" onMouseOver="hilite(84)" onMouseOut="lolite()" onClick="logVariable('j')" href="../../../_variables/j.html">$j</a>) {
<a name="l239"><span class="linenum"> 239</span></a>  
<a name="l240"><span class="linenum"> 240</span></a>          <a class="var it20668" onMouseOver="hilite(20668)" onMouseOut="lolite()" onClick="logVariable('minmaxgrp')" href="../../../_variables/minmaxgrp.html">$minmaxgrp</a> = array();
<a name="l241"><span class="linenum"> 241</span></a>          <a class="var it20668" onMouseOver="hilite(20668)" onMouseOut="lolite()" onClick="logVariable('minmaxgrp')" href="../../../_variables/minmaxgrp.html">$minmaxgrp</a>[] = <a class="var it1037" onMouseOver="hilite(1037)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../../../_variables/mform.html">$mform</a>-&gt;<a class="function" onClick="logFunction('createElement')" href="../../../_functions/createelement.html" onMouseOver="funcPopup(event,'createelement')">createElement</a>('text', &quot;calcmin[{<a class="var it2039" onMouseOver="hilite(2039)" onMouseOut="lolite()" onClick="logVariable('idx')" href="../../../_variables/idx.html">$idx</a>}]&quot;,
<a name="l242"><span class="linenum"> 242</span></a>                  <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('calcmin', 'qtype_calculated'));
<a name="l243"><span class="linenum"> 243</span></a>          <a class="var it20668" onMouseOver="hilite(20668)" onMouseOut="lolite()" onClick="logVariable('minmaxgrp')" href="../../../_variables/minmaxgrp.html">$minmaxgrp</a>[] = <a class="var it1037" onMouseOver="hilite(1037)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../../../_variables/mform.html">$mform</a>-&gt;<a class="function" onClick="logFunction('createElement')" href="../../../_functions/createelement.html" onMouseOver="funcPopup(event,'createelement')">createElement</a>('text', &quot;calcmax[{<a class="var it2039" onMouseOver="hilite(2039)" onMouseOut="lolite()" onClick="logVariable('idx')" href="../../../_variables/idx.html">$idx</a>}]&quot;,
<a name="l244"><span class="linenum"> 244</span></a>                  <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('calcmax', 'qtype_calculated'));
<a name="l245"><span class="linenum"> 245</span></a>          <a class="var it1037" onMouseOver="hilite(1037)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../../../_variables/mform.html">$mform</a>-&gt;<a class="function" onClick="logFunction('addGroup')" href="../../../_functions/addgroup.html" onMouseOver="funcPopup(event,'addgroup')">addGroup</a>(<a class="var it20668" onMouseOver="hilite(20668)" onMouseOut="lolite()" onClick="logVariable('minmaxgrp')" href="../../../_variables/minmaxgrp.html">$minmaxgrp</a>, 'minmaxgrp',
<a name="l246"><span class="linenum"> 246</span></a>                  <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('minmax', 'qtype_calculated'), ' - ', false);
<a name="l247"><span class="linenum"> 247</span></a>          <a class="var it1037" onMouseOver="hilite(1037)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../../../_variables/mform.html">$mform</a>-&gt;<a class="phpfunction" onClick="logFunction('setType')" href="../../../_functions/settype.html" onMouseOver="phpfuncPopup(event,'settype')">setType</a>(&quot;calcmin[{<a class="var it2039" onMouseOver="hilite(2039)" onMouseOut="lolite()" onClick="logVariable('idx')" href="../../../_variables/idx.html">$idx</a>}]&quot;, <a class="constant" onClick="logConstant('PARAM_FLOAT')" href="../../../_constants/PARAM_FLOAT.html" onMouseOver="constPopup(event,'PARAM_FLOAT')">PARAM_FLOAT</a>);
<a name="l248"><span class="linenum"> 248</span></a>          <a class="var it1037" onMouseOver="hilite(1037)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../../../_variables/mform.html">$mform</a>-&gt;<a class="phpfunction" onClick="logFunction('setType')" href="../../../_functions/settype.html" onMouseOver="phpfuncPopup(event,'settype')">setType</a>(&quot;calcmax[{<a class="var it2039" onMouseOver="hilite(2039)" onMouseOut="lolite()" onClick="logVariable('idx')" href="../../../_variables/idx.html">$idx</a>}]&quot;, <a class="constant" onClick="logConstant('PARAM_FLOAT')" href="../../../_constants/PARAM_FLOAT.html" onMouseOver="constPopup(event,'PARAM_FLOAT')">PARAM_FLOAT</a>);
<a name="l249"><span class="linenum"> 249</span></a>  
<a name="l250"><span class="linenum"> 250</span></a>          <a class="var it20669" onMouseOver="hilite(20669)" onMouseOut="lolite()" onClick="logVariable('precisionoptions')" href="../../../_variables/precisionoptions.html">$precisionoptions</a> = <a class="phpfunction" onClick="logFunction('range')" href="../../../_functions/range.html" onMouseOver="phpfuncPopup(event,'range')">range</a>(0, 10);
<a name="l251"><span class="linenum"> 251</span></a>          <a class="var it1037" onMouseOver="hilite(1037)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../../../_variables/mform.html">$mform</a>-&gt;<a class="function" onClick="logFunction('addElement')" href="../../../_functions/addelement.html" onMouseOver="funcPopup(event,'addelement')">addElement</a>('select', &quot;calclength[{<a class="var it2039" onMouseOver="hilite(2039)" onMouseOut="lolite()" onClick="logVariable('idx')" href="../../../_variables/idx.html">$idx</a>}]&quot;,
<a name="l252"><span class="linenum"> 252</span></a>                  <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('calclength', 'qtype_calculated'), <a class="var it20669" onMouseOver="hilite(20669)" onMouseOut="lolite()" onClick="logVariable('precisionoptions')" href="../../../_variables/precisionoptions.html">$precisionoptions</a>);
<a name="l253"><span class="linenum"> 253</span></a>  
<a name="l254"><span class="linenum"> 254</span></a>          <a class="var it20670" onMouseOver="hilite(20670)" onMouseOut="lolite()" onClick="logVariable('distriboptions')" href="../../../_variables/distriboptions.html">$distriboptions</a> = array('uniform' =&gt; <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('uniform', 'qtype_calculated'),
<a name="l255"><span class="linenum"> 255</span></a>                  'loguniform' =&gt; <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('loguniform', 'qtype_calculated'));
<a name="l256"><span class="linenum"> 256</span></a>          <a class="var it1037" onMouseOver="hilite(1037)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../../../_variables/mform.html">$mform</a>-&gt;<a class="function" onClick="logFunction('addElement')" href="../../../_functions/addelement.html" onMouseOver="funcPopup(event,'addelement')">addElement</a>('hidden', &quot;calcdistribution[{<a class="var it2039" onMouseOver="hilite(2039)" onMouseOut="lolite()" onClick="logVariable('idx')" href="../../../_variables/idx.html">$idx</a>}]&quot;, 'uniform');
<a name="l257"><span class="linenum"> 257</span></a>          <a class="var it1037" onMouseOver="hilite(1037)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../../../_variables/mform.html">$mform</a>-&gt;<a class="phpfunction" onClick="logFunction('setType')" href="../../../_functions/settype.html" onMouseOver="phpfuncPopup(event,'settype')">setType</a>(&quot;calcdistribution[{<a class="var it2039" onMouseOver="hilite(2039)" onMouseOut="lolite()" onClick="logVariable('idx')" href="../../../_variables/idx.html">$idx</a>}]&quot;, <a class="constant" onClick="logConstant('PARAM_INT')" href="../../../_constants/PARAM_INT.html" onMouseOver="constPopup(event,'PARAM_INT')">PARAM_INT</a>);
<a name="l258"><span class="linenum"> 258</span></a>      }
<a name="l259"><span class="linenum"> 259</span></a>  
<a name="l260"><span class="linenum"> 260</span></a>      public function <a class="function" onClick="logFunction('comment_header')" href="../../../_functions/comment_header.html" onMouseOver="funcPopup(event,'comment_header')">comment_header</a>(<a class="var it489" onMouseOver="hilite(489)" onMouseOut="lolite()" onClick="logVariable('answers')" href="../../../_variables/answers.html">$answers</a>) {
<a name="l261"><span class="linenum"> 261</span></a>          <a class="var it14732" onMouseOver="hilite(14732)" onMouseOut="lolite()" onClick="logVariable('strheader')" href="../../../_variables/strheader.html">$strheader</a> = &quot;&quot;;
<a name="l262"><span class="linenum"> 262</span></a>          <a class="var it1015" onMouseOver="hilite(1015)" onMouseOut="lolite()" onClick="logVariable('delimiter')" href="../../../_variables/delimiter.html">$delimiter</a> = '';
<a name="l263"><span class="linenum"> 263</span></a>  
<a name="l264"><span class="linenum"> 264</span></a>          foreach (<a class="var it489" onMouseOver="hilite(489)" onMouseOut="lolite()" onClick="logVariable('answers')" href="../../../_variables/answers.html">$answers</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> =&gt; <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../../_variables/answer.html">$answer</a>) {
<a name="l265"><span class="linenum"> 265</span></a>              <a class="var it2277" onMouseOver="hilite(2277)" onMouseOut="lolite()" onClick="logVariable('ans')" href="../../../_variables/ans.html">$ans</a> = <a class="function" onClick="logFunction('shorten_text')" href="../../../_functions/shorten_text.html" onMouseOver="funcPopup(event,'shorten_text')">shorten_text</a>(<a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('answer')" href="../../../_variables/answer.html">$answer</a>-&gt;<a onClick="logVariable('answer')" class="var it39604" onMouseOver="hilite(39604)" onMouseOut="lolite()" href="../../../_variables/answer.html">answer</a>, 17, true);
<a name="l266"><span class="linenum"> 266</span></a>              <a class="var it14732" onMouseOver="hilite(14732)" onMouseOut="lolite()" onClick="logVariable('strheader')" href="../../../_variables/strheader.html">$strheader</a> .= <a class="var it1015" onMouseOver="hilite(1015)" onMouseOut="lolite()" onClick="logVariable('delimiter')" href="../../../_variables/delimiter.html">$delimiter</a>.<a class="var it2277" onMouseOver="hilite(2277)" onMouseOut="lolite()" onClick="logVariable('ans')" href="../../../_variables/ans.html">$ans</a>;
<a name="l267"><span class="linenum"> 267</span></a>              <a class="var it1015" onMouseOver="hilite(1015)" onMouseOut="lolite()" onClick="logVariable('delimiter')" href="../../../_variables/delimiter.html">$delimiter</a> = '&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;';
<a name="l268"><span class="linenum"> 268</span></a>          }
<a name="l269"><span class="linenum"> 269</span></a>          return <a class="var it14732" onMouseOver="hilite(14732)" onMouseOut="lolite()" onClick="logVariable('strheader')" href="../../../_variables/strheader.html">$strheader</a>;
<a name="l270"><span class="linenum"> 270</span></a>      }
<a name="l271"><span class="linenum"> 271</span></a>  
<a name="l272"><span class="linenum"> 272</span></a>      public function <a class="function" onClick="logFunction('tolerance_types')" href="../../../_functions/tolerance_types.html" onMouseOver="funcPopup(event,'tolerance_types')">tolerance_types</a>() {
<a name="l273"><span class="linenum"> 273</span></a>          return array(
<a name="l274"><span class="linenum"> 274</span></a>              '1'  =&gt; <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('relative', 'qtype_numerical'),
<a name="l275"><span class="linenum"> 275</span></a>              '2'  =&gt; <a class="function" onClick="logFunction('get_string')" href="../../../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('nominal', 'qtype_numerical'),
<a name="l276"><span class="linenum"> 276</span></a>          );
<a name="l277"><span class="linenum"> 277</span></a>      }
<a name="l278"><span class="linenum"> 278</span></a>  
<a name="l279"><span class="linenum"> 279</span></a>      public function <a class="function" onClick="logFunction('dataset_options')" href="../../../_functions/dataset_options.html" onMouseOver="funcPopup(event,'dataset_options')">dataset_options</a>(<a class="var it596" onMouseOver="hilite(596)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../../_variables/form.html">$form</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../../_variables/name.html">$name</a>, <a class="var it20698" onMouseOver="hilite(20698)" onMouseOut="lolite()" onClick="logVariable('mandatory')" href="../../../_variables/mandatory.html">$mandatory</a> = true, <a class="var it20699" onMouseOver="hilite(20699)" onMouseOut="lolite()" onClick="logVariable('renameabledatasets')" href="../../../_variables/renameabledatasets.html">$renameabledatasets</a> = false) {
<a name="l280"><span class="linenum"> 280</span></a>  <span class="comment">        // Takes datasets from the parent implementation but</span>
<a name="l281"><span class="linenum"> 281</span></a>  <span class="comment">        // filters options that are currently not accepted by calculated.</span>
<a name="l282"><span class="linenum"> 282</span></a>  <span class="comment">        // It also determines a default selection</span>
<a name="l283"><span class="linenum"> 283</span></a>  <span class="comment">        // $renameabledatasets not implemented anywhere.</span>
<a name="l284"><span class="linenum"> 284</span></a>          <a class="function" onClick="logFunction('list')" href="../../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../_variables/options.html">$options</a>, <a class="var it4428" onMouseOver="hilite(4428)" onMouseOut="lolite()" onClick="logVariable('selected')" href="../../../_variables/selected.html">$selected</a>) = <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('dataset_options_from_database')" href="../../../_functions/dataset_options_from_database.html" onMouseOver="funcPopup(event,'dataset_options_from_database')">dataset_options_from_database</a>(
<a name="l285"><span class="linenum"> 285</span></a>                  <a class="var it596" onMouseOver="hilite(596)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../../_variables/form.html">$form</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../../_variables/name.html">$name</a>, '', 'qtype_calculated');
<a name="l286"><span class="linenum"> 286</span></a>  
<a name="l287"><span class="linenum"> 287</span></a>          foreach (<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../_variables/options.html">$options</a> as <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> =&gt; <a class="var it20700" onMouseOver="hilite(20700)" onMouseOut="lolite()" onClick="logVariable('whatever')" href="../../../_variables/whatever.html">$whatever</a>) {
<a name="l288"><span class="linenum"> 288</span></a>              if (!<a class="phpfunction" onClick="logFunction('preg_match')" href="../../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('~^1-~', <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>) &amp;&amp; <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> != '0') {
<a name="l289"><span class="linenum"> 289</span></a>                  unset(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../_variables/options.html">$options</a>[<a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>]);
<a name="l290"><span class="linenum"> 290</span></a>              }
<a name="l291"><span class="linenum"> 291</span></a>          }
<a name="l292"><span class="linenum"> 292</span></a>          if (!<a class="var it4428" onMouseOver="hilite(4428)" onMouseOut="lolite()" onClick="logVariable('selected')" href="../../../_variables/selected.html">$selected</a>) {
<a name="l293"><span class="linenum"> 293</span></a>              if (<a class="var it20698" onMouseOver="hilite(20698)" onMouseOut="lolite()" onClick="logVariable('mandatory')" href="../../../_variables/mandatory.html">$mandatory</a>) {
<a name="l294"><span class="linenum"> 294</span></a>                  <a class="var it4428" onMouseOver="hilite(4428)" onMouseOut="lolite()" onClick="logVariable('selected')" href="../../../_variables/selected.html">$selected</a> =  &quot;1-0-{<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../../_variables/name.html">$name</a>}&quot;; <span class="comment">// Default.</span>
<a name="l295"><span class="linenum"> 295</span></a>              } else {
<a name="l296"><span class="linenum"> 296</span></a>                  <a class="var it4428" onMouseOver="hilite(4428)" onMouseOut="lolite()" onClick="logVariable('selected')" href="../../../_variables/selected.html">$selected</a> = &quot;0&quot;; <span class="comment">// Default.</span>
<a name="l297"><span class="linenum"> 297</span></a>              }
<a name="l298"><span class="linenum"> 298</span></a>          }
<a name="l299"><span class="linenum"> 299</span></a>          return array(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../../_variables/options.html">$options</a>, <a class="var it4428" onMouseOver="hilite(4428)" onMouseOut="lolite()" onClick="logVariable('selected')" href="../../../_variables/selected.html">$selected</a>);
<a name="l300"><span class="linenum"> 300</span></a>      }
<a name="l301"><span class="linenum"> 301</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'get_virtual_qtype': ['get_virtual_qtype', '', [['question/type/calculatedmulti','questiontype.php',258],['question/type/calculated','questiontype.php',1755]], 7],
'import_datasets': ['import_datasets', '', [['question/type/calculated','questiontype.php',265]], 3],
'addelement': ['addelement', 'Adds a custom element to your HTML definition ', [['lib/htmlpurifier/HTMLPurifier','HTMLDefinition.php',124],['lib/zend/Zend/Soap','Wsdl.php',641],['lib/htmlpurifier/HTMLPurifier','HTMLModule.php',130],['lib/pear/HTML','QuickForm.php',582]], 3296],
'dataset_options': ['dataset_options', '', [['question/type/calculated','questiontype.php',1126],['question/type/calculatedsimple','questiontype.php',279]], 6],
'clone': ['clone', '', [['lib/editor/tinymce/tiny_mce/3.5.11/plugins/media/js','media.js',11]], 315],
'validate_question_data': ['validate_question_data', '', [['question/type/calculatedmulti','questiontype.php',166],['question/type/calculated','questiontype.php',469]], 4],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required. ', [['lib/dml','pgsql_native_moodle_database.php',883],['lib/dml','oci_native_moodle_database.php',1249],['lib/dml','sqlsrv_native_moodle_database.php',978],['lib/dml','mssql_native_moodle_database.php',898],['lib/dml','mysqli_native_moodle_database.php',1177],['lib/dml/tests','dml_test.php',5427],['lib/dml','pdo_moodle_database.php',386],['question/engine/upgrade','upgradelib.php',121]], 1512],
'get_dataset_definitions': ['get_dataset_definitions', '', [['question/type/calculated','questiontype.php',1223]], 8],
'shorten_text': ['shorten_text', 'Given some text (which may contain HTML) and an ideal length, this function truncates the text neatly on a word boundary if possible ', [['lib','moodlelib.php',7484]], 79],
'import_or_save_files': ['import_or_save_files', 'Save the file belonging to one text field. ', [['question/type','questiontypebase.php',1218]], 16],
'get_string': ['get_string', 'Return a core get_string() call ', [['lib/external','externallib.php',112],['lib','moodlelib.php',6538],['lib','moodlelib.php',9417],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38],['lib/classes','string_manager_install.php',95],['question/behaviour','behaviourbase.php',756]], 19235],
'save_unit_options': ['save_unit_options', 'The numerical options control the display and the grading of the unit part of the numerical question and related types (calculateds) Questions previous to 2.0 do not have this table as multianswer questions in all versions including 2.0. The default values are set to give the same grade as old question. ', [['question/type/numerical','questiontype.php',245]], 3],
'save_question_options': ['save_question_options', '', [['question/type/multianswer','questiontype.php',81],['question/type/multichoice','questiontype.php',47],['question/type/match','questiontype.php',50],['question/type/essay','questiontype.php',54],['question/type/calculatedmulti','questiontype.php',41],['question/type/numerical','questiontype.php',149],['question/type/randomsamatch','questiontype.php',63],['question/type/calculated','questiontype.php',132],['question/type','questiontypebase.php',412],['question/type/random','questiontype.php',161],['question/type/calculatedsimple','questiontype.php',43],['question/type/shortanswer','questiontype.php',57],['question/type/truefalse','questiontype.php',39]], 3],
'get_records': ['get_records', 'Get a number of records as an array of objects where all the given conditions met. ', [['lib/dml','moodle_database.php',1236],['lib','coursecatlib.php',654],['question','category_class.php',63]], 860],
'createelement': ['createelement', 'Create an element, set its class name and optionally install the element to its parent. ', [['lib/yuilib/2in3/2.9.0/build/yui2-carousel','yui2-carousel.js',298],['lib/yuilib/2in3/2.9.0/build/yui2-carousel','yui2-carousel-debug.js',299],['theme/bootstrapbase/javascript','html5shiv.js',102],['lib/pear/HTML','QuickForm.php',523]], 1968],
'finished_edit_wizard': ['finished_edit_wizard', '', [['question/type/calculated','questiontype.php',344],['question/type','questiontypebase.php',1068],['question/type/calculatedsimple','questiontype.php',230]], 1],
'set_field': ['set_field', 'Sets the custom profile field used for testing. ', [['availability/condition/profile/tests','condition_test.php',349],['lib/dml','moodle_database.php',1688]], 462],
'addgroup': ['addgroup', 'Adds an element group ', [['lib/pear/HTML','QuickForm.php',707]], 109],
'dataset_options_from_database': ['dataset_options_from_database', '', [['question/type/calculated','questiontype.php',1470]], 2],
'wizard_pages_number': ['wizard_pages_number', '', [['question/type/calculatedsimple','questiontype.php',234]], 0],
'save_hints': ['save_hints', '', [['question/type','questiontypebase.php',602]], 10],
'list': ['list', '', [['mod/data/preset/imagegallery','jstemplate.js',9]], 1891],
'tolerance_types': ['tolerance_types', '', [['question/type/calculated','questiontype.php',1118],['question/type/calculatedsimple','questiontype.php',272]], 3],
'comment_header': ['comment_header', '', [['question/type/calculatedmulti','questiontype.php',207],['question/type/calculated','questiontype.php',1034],['question/type/calculatedsimple','questiontype.php',260]], 2],
'update_record': ['update_record', 'Update a record in a table ', [['lib/dml','pgsql_native_moodle_database.php',1137],['lib/dml','oci_native_moodle_database.php',1355],['lib/dml','sqlsrv_native_moodle_database.php',1081],['lib/dml','mssql_native_moodle_database.php',1003],['lib/dml','mysqli_native_moodle_database.php',1397],['lib/dml/tests','dml_test.php',5430],['lib/dml','pdo_moodle_database.php',460]], 565],
'save_units': ['save_units', '', [['question/type/numerical','questiontype.php',309]], 3],
'custom_generator_tools_part': ['custom_generator_tools_part', '', [['question/type/calculated','questiontype.php',712],['question/type/calculatedsimple','questiontype.php',238]], 2],
'delete_records': ['delete_records', 'Delete the records from a table where all the given conditions met. If conditions not specified, table is truncated. ', [['lib/dml','moodle_database.php',1815],['lib/dml','sqlite3_pdo_moodle_database.php',337]], 778],
'is_array': ['is_array', '', [], 1820],
'count': ['count', '', [], 3984],
'trim': ['trim', '', [], 1889],
'array_shift': ['array_shift', '', [], 607],
'array_flip': ['array_flip', '', [], 118],
'array_keys': ['array_keys', '', [], 1152],
'settype': ['settype', '', [], 1490],
'range': ['range', '', [], 73],
'ksort': ['ksort', '', [], 158],
'defined': ['defined', '', [], 4098],
'preg_match': ['preg_match', '', [], 1317],
'ceil': ['ceil', '', [], 213]};
CLASS_DATA={
'qtype_calculatedsimple': ['qtype_calculatedsimple', 'The simple calculated question type. ', [['question/type/calculatedsimple','questiontype.php',32]], 1],
'qtype_calculated': ['qtype_calculated', 'The calculated question type. ', [['question/type/calculated','questiontype.php',33]], 5]};
CONST_DATA={
'PARAM_INT': ['PARAM_INT', '', [['lib','moodlelib.php',156]], 2948],
'PARAM_FLOAT': ['PARAM_FLOAT', '', [['lib','moodlelib.php',146]], 93],
'MOODLE_INTERNAL': ['MOODLE_INTERNAL', '', [['admin/cli','install.php',138],['','install.php',93],['lib','setup.php',386]], 3532]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu May 28 19:17:31 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
