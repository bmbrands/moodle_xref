<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /login/lib.php source</title>
    <link rel="stylesheet" href="../sample.css" type="text/css">
    <link rel="stylesheet" href="../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Thu Aug 11 10:00:09 2016 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../';
subdir='login';
filename='lib.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/login/</a> -> <a href="lib.php.html">lib.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="lib.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="lib.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">// This file is part of Moodle - http://moodle.org/</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">//</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment">// Moodle is free software: you can redistribute it and/or modify</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment">// it under the terms of the GNU General Public License as published by</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment">// the Free Software Foundation, either version 3 of the License, or</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment">// (at your option) any later version.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment">//</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment">// Moodle is distributed in the hope that it will be useful,</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment">// GNU General Public License for more details.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">//</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment">// You should have received a copy of the GNU General Public License</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment">// along with Moodle.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> *</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> * Login library file of login/password related Moodle functions.</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> *</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @package    core</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @subpackage lib</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * @copyright  Catalyst IT</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> * @copyright  Peter Bulmer</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment"> * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later</span>
<a name="l26"><span class="linenum">  26</span></a>  <span class="comment"> */</span>
<a name="l27"><span class="linenum">  27</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PWRESET_STATUS_NOEMAILSENT')" href="../_constants/PWRESET_STATUS_NOEMAILSENT.html" onMouseOver="constPopup(event,'PWRESET_STATUS_NOEMAILSENT')">PWRESET_STATUS_NOEMAILSENT</a>', 1);
<a name="l28"><span class="linenum">  28</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PWRESET_STATUS_TOKENSENT')" href="../_constants/PWRESET_STATUS_TOKENSENT.html" onMouseOver="constPopup(event,'PWRESET_STATUS_TOKENSENT')">PWRESET_STATUS_TOKENSENT</a>', 2);
<a name="l29"><span class="linenum">  29</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PWRESET_STATUS_OTHEREMAILSENT')" href="../_constants/PWRESET_STATUS_OTHEREMAILSENT.html" onMouseOver="constPopup(event,'PWRESET_STATUS_OTHEREMAILSENT')">PWRESET_STATUS_OTHEREMAILSENT</a>', 3);
<a name="l30"><span class="linenum">  30</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('PWRESET_STATUS_ALREADYSENT')" href="../_constants/PWRESET_STATUS_ALREADYSENT.html" onMouseOver="constPopup(event,'PWRESET_STATUS_ALREADYSENT')">PWRESET_STATUS_ALREADYSENT</a>', 4);
<a name="l31"><span class="linenum">  31</span></a>  
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment">/**</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> *  Processes a user's request to set a new password in the event they forgot the old one.</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> *  If no user identifier has been supplied, it displays a form where they can submit their identifier.</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> *  Where they have supplied identifier, the function will check their status, and send email as appropriate.</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment"> */</span>
<a name="l37"><span class="linenum">  37</span></a>  function <a class="function" onClick="logFunction('core_login_process_password_reset_request')" href="../_functions/core_login_process_password_reset_request.html" onMouseOver="funcPopup(event,'core_login_process_password_reset_request')">core_login_process_password_reset_request</a>() {
<a name="l38"><span class="linenum">  38</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>, <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>;
<a name="l39"><span class="linenum">  39</span></a>      <a class="var it221" onMouseOver="hilite(221)" onMouseOut="lolite()" onClick="logVariable('systemcontext')" href="../_variables/systemcontext.html">$systemcontext</a> = <a class="class" onClick="logClass('context_system')" href="../_classes/context_system.html" onMouseOver="classPopup(event,'context_system')">context_system</a>::<a class="function" onClick="logFunction('instance')" href="../_functions/instance.html" onMouseOver="funcPopup(event,'instance')">instance</a>();
<a name="l40"><span class="linenum">  40</span></a>      <a class="var it219" onMouseOver="hilite(219)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../_variables/mform.html">$mform</a> = <span class="keyword">new </span><a class="class" onClick="logClass('login_forgot_password_form')" href="../_classes/login_forgot_password_form.html" onMouseOver="classPopup(event,'login_forgot_password_form')">login_forgot_password_form</a>();
<a name="l41"><span class="linenum">  41</span></a>  
<a name="l42"><span class="linenum">  42</span></a>      if (<a class="var it219" onMouseOver="hilite(219)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../_variables/mform.html">$mform</a>-&gt;<a class="function" onClick="logFunction('is_cancelled')" href="../_functions/is_cancelled.html" onMouseOver="funcPopup(event,'is_cancelled')">is_cancelled</a>()) {
<a name="l43"><span class="linenum">  43</span></a>          <a class="function" onClick="logFunction('redirect')" href="../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<a class="function" onClick="logFunction('get_login_url')" href="../_functions/get_login_url.html" onMouseOver="funcPopup(event,'get_login_url')">get_login_url</a>());
<a name="l44"><span class="linenum">  44</span></a>  
<a name="l45"><span class="linenum">  45</span></a>      } else if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a> = <a class="var it219" onMouseOver="hilite(219)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../_variables/mform.html">$mform</a>-&gt;<a class="function" onClick="logFunction('get_data')" href="../_functions/get_data.html" onMouseOver="funcPopup(event,'get_data')">get_data</a>()) {
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment">        // Requesting user has submitted form data.</span>
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment">        // Next find the user account in the database which the requesting user claims to own.</span>
<a name="l48"><span class="linenum">  48</span></a>          if (!empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('username')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../_variables/username.html">username</a>)) {
<a name="l49"><span class="linenum">  49</span></a>  <span class="comment">            // Username has been specified - load the user record based on that.</span>
<a name="l50"><span class="linenum">  50</span></a>              <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a> = <a class="class" onClick="logClass('core_text')" href="../_classes/core_text.html" onMouseOver="classPopup(event,'core_text')">core_text</a>::<a class="phpfunction" onClick="logFunction('strtolower')" href="../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('username')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../_variables/username.html">username</a>); <span class="comment">// Mimic the login page process.</span>
<a name="l51"><span class="linenum">  51</span></a>              <a class="var it4307" onMouseOver="hilite(4307)" onMouseOut="lolite()" onClick="logVariable('userparams')" href="../_variables/userparams.html">$userparams</a> = array('username' =&gt; <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('username')" href="../_variables/username.html">$username</a>, 'mnethostid' =&gt; <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/mnet_localhost_id.html">mnet_localhost_id</a>, 'deleted' =&gt; 0, 'suspended' =&gt; 0);
<a name="l52"><span class="linenum">  52</span></a>              <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user', <a class="var it4307" onMouseOver="hilite(4307)" onMouseOut="lolite()" onClick="logVariable('userparams')" href="../_variables/userparams.html">$userparams</a>);
<a name="l53"><span class="linenum">  53</span></a>          } else {
<a name="l54"><span class="linenum">  54</span></a>  <span class="comment">            // Try to load the user record based on email address.</span>
<a name="l55"><span class="linenum">  55</span></a>  <span class="comment">            // this is tricky because</span>
<a name="l56"><span class="linenum">  56</span></a>  <span class="comment">            // 1/ the email is not guaranteed to be unique - TODO: send email with all usernames to select the account for pw reset</span>
<a name="l57"><span class="linenum">  57</span></a>  <span class="comment">            // 2/ mailbox may be case sensitive, the email domain is case insensitive - let's pretend it is all case-insensitive.</span>
<a name="l58"><span class="linenum">  58</span></a>  
<a name="l59"><span class="linenum">  59</span></a>              <a class="var it1047" onMouseOver="hilite(1047)" onMouseOut="lolite()" onClick="logVariable('select')" href="../_variables/select.html">$select</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_like')" href="../_functions/sql_like.html" onMouseOver="funcPopup(event,'sql_like')">sql_like</a>('email', ':email', false, true, false, '|') .
<a name="l60"><span class="linenum">  60</span></a>                      &quot; AND mnethostid = :mnethostid AND deleted=0 AND suspended=0&quot;;
<a name="l61"><span class="linenum">  61</span></a>              <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = array('email' =&gt; <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('sql_like_escape')" href="../_functions/sql_like_escape.html" onMouseOver="funcPopup(event,'sql_like_escape')">sql_like_escape</a>(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('email')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../_variables/email.html">email</a>, '|'), 'mnethostid' =&gt; <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('mnet_localhost_id')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/mnet_localhost_id.html">mnet_localhost_id</a>);
<a name="l62"><span class="linenum">  62</span></a>              <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record_select')" href="../_functions/get_record_select.html" onMouseOver="funcPopup(event,'get_record_select')">get_record_select</a>('user', <a class="var it1047" onMouseOver="hilite(1047)" onMouseOut="lolite()" onClick="logVariable('select')" href="../_variables/select.html">$select</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>, '*', <a class="constant" onClick="logConstant('IGNORE_MULTIPLE')" href="../_constants/IGNORE_MULTIPLE.html" onMouseOver="constPopup(event,'IGNORE_MULTIPLE')">IGNORE_MULTIPLE</a>);
<a name="l63"><span class="linenum">  63</span></a>          }
<a name="l64"><span class="linenum">  64</span></a>  
<a name="l65"><span class="linenum">  65</span></a>  <span class="comment">        // Target user details have now been identified, or we know that there is no such account.</span>
<a name="l66"><span class="linenum">  66</span></a>  <span class="comment">        // Send email address to account's email address if appropriate.</span>
<a name="l67"><span class="linenum">  67</span></a>          <a class="var it4308" onMouseOver="hilite(4308)" onMouseOut="lolite()" onClick="logVariable('pwresetstatus')" href="../_variables/pwresetstatus.html">$pwresetstatus</a> = <a class="constant" onClick="logConstant('PWRESET_STATUS_NOEMAILSENT')" href="../_constants/PWRESET_STATUS_NOEMAILSENT.html" onMouseOver="constPopup(event,'PWRESET_STATUS_NOEMAILSENT')">PWRESET_STATUS_NOEMAILSENT</a>;
<a name="l68"><span class="linenum">  68</span></a>          if (<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> and !empty(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('confirmed')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/confirmed.html">confirmed</a>)) {
<a name="l69"><span class="linenum">  69</span></a>              <a class="var it377" onMouseOver="hilite(377)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a> = <a class="function" onClick="logFunction('get_auth_plugin')" href="../_functions/get_auth_plugin.html" onMouseOver="funcPopup(event,'get_auth_plugin')">get_auth_plugin</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>);
<a name="l70"><span class="linenum">  70</span></a>              if (!<a class="var it377" onMouseOver="hilite(377)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a>-&gt;<a class="function" onClick="logFunction('can_reset_password')" href="../_functions/can_reset_password.html" onMouseOver="funcPopup(event,'can_reset_password')">can_reset_password</a>() or !<a class="function" onClick="logFunction('is_enabled_auth')" href="../_functions/is_enabled_auth.html" onMouseOver="funcPopup(event,'is_enabled_auth')">is_enabled_auth</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>)
<a name="l71"><span class="linenum">  71</span></a>                or !<a class="function" onClick="logFunction('has_capability')" href="../_functions/has_capability.html" onMouseOver="funcPopup(event,'has_capability')">has_capability</a>('moodle/user:changeownpassword', <a class="var it221" onMouseOver="hilite(221)" onMouseOut="lolite()" onClick="logVariable('systemcontext')" href="../_variables/systemcontext.html">$systemcontext</a>, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/id.html">id</a>)) {
<a name="l72"><span class="linenum">  72</span></a>                  if (<a class="function" onClick="logFunction('send_password_change_info')" href="../_functions/send_password_change_info.html" onMouseOver="funcPopup(event,'send_password_change_info')">send_password_change_info</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l73"><span class="linenum">  73</span></a>                      <a class="var it4308" onMouseOver="hilite(4308)" onMouseOut="lolite()" onClick="logVariable('pwresetstatus')" href="../_variables/pwresetstatus.html">$pwresetstatus</a> = <a class="constant" onClick="logConstant('PWRESET_STATUS_OTHEREMAILSENT')" href="../_constants/PWRESET_STATUS_OTHEREMAILSENT.html" onMouseOver="constPopup(event,'PWRESET_STATUS_OTHEREMAILSENT')">PWRESET_STATUS_OTHEREMAILSENT</a>;
<a name="l74"><span class="linenum">  74</span></a>                  } else {
<a name="l75"><span class="linenum">  75</span></a>                      <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('cannotmailconfirm');
<a name="l76"><span class="linenum">  76</span></a>                  }
<a name="l77"><span class="linenum">  77</span></a>              } else {
<a name="l78"><span class="linenum">  78</span></a>  <span class="comment">                // The account the requesting user claims to be is entitled to change their password.</span>
<a name="l79"><span class="linenum">  79</span></a>  <span class="comment">                // Next, check if they have an existing password reset in progress.</span>
<a name="l80"><span class="linenum">  80</span></a>                  <a class="var it4309" onMouseOver="hilite(4309)" onMouseOut="lolite()" onClick="logVariable('resetinprogress')" href="../_variables/resetinprogress.html">$resetinprogress</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record')" href="../_functions/get_record.html" onMouseOver="funcPopup(event,'get_record')">get_record</a>('user_password_resets', array('userid' =&gt; <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l81"><span class="linenum">  81</span></a>                  if (empty(<a class="var it4309" onMouseOver="hilite(4309)" onMouseOut="lolite()" onClick="logVariable('resetinprogress')" href="../_variables/resetinprogress.html">$resetinprogress</a>)) {
<a name="l82"><span class="linenum">  82</span></a>  <span class="comment">                    // Completely new reset request - common case.</span>
<a name="l83"><span class="linenum">  83</span></a>                      <a class="var it4310" onMouseOver="hilite(4310)" onMouseOut="lolite()" onClick="logVariable('resetrecord')" href="../_variables/resetrecord.html">$resetrecord</a> = <a class="function" onClick="logFunction('core_login_generate_password_reset')" href="../_functions/core_login_generate_password_reset.html" onMouseOver="funcPopup(event,'core_login_generate_password_reset')">core_login_generate_password_reset</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l84"><span class="linenum">  84</span></a>                      <a class="var it4311" onMouseOver="hilite(4311)" onMouseOut="lolite()" onClick="logVariable('sendemail')" href="../_variables/sendemail.html">$sendemail</a> = true;
<a name="l85"><span class="linenum">  85</span></a>                  } else if (<a class="var it4309" onMouseOver="hilite(4309)" onMouseOut="lolite()" onClick="logVariable('resetinprogress')" href="../_variables/resetinprogress.html">$resetinprogress</a>-&gt;<a onClick="logVariable('timerequested')" class="var it45259" onMouseOver="hilite(45259)" onMouseOut="lolite()" href="../_variables/timerequested.html">timerequested</a> &lt; (<a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() - <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('pwresettime')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/pwresettime.html">pwresettime</a>)) {
<a name="l86"><span class="linenum">  86</span></a>  <span class="comment">                    // Preexisting, but expired request - delete old record &amp; create new one.</span>
<a name="l87"><span class="linenum">  87</span></a>  <span class="comment">                    // Uncommon case - expired requests are cleaned up by cron.</span>
<a name="l88"><span class="linenum">  88</span></a>                      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('user_password_resets', array('id' =&gt; <a class="var it4309" onMouseOver="hilite(4309)" onMouseOut="lolite()" onClick="logVariable('resetinprogress')" href="../_variables/resetinprogress.html">$resetinprogress</a>-&gt;<a onClick="logVariable('id')" class="var it45259" onMouseOver="hilite(45259)" onMouseOut="lolite()" href="../_variables/id.html">id</a>));
<a name="l89"><span class="linenum">  89</span></a>                      <a class="var it4310" onMouseOver="hilite(4310)" onMouseOut="lolite()" onClick="logVariable('resetrecord')" href="../_variables/resetrecord.html">$resetrecord</a> = <a class="function" onClick="logFunction('core_login_generate_password_reset')" href="../_functions/core_login_generate_password_reset.html" onMouseOver="funcPopup(event,'core_login_generate_password_reset')">core_login_generate_password_reset</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l90"><span class="linenum">  90</span></a>                      <a class="var it4311" onMouseOver="hilite(4311)" onMouseOut="lolite()" onClick="logVariable('sendemail')" href="../_variables/sendemail.html">$sendemail</a> = true;
<a name="l91"><span class="linenum">  91</span></a>                  } else if (empty(<a class="var it4309" onMouseOver="hilite(4309)" onMouseOut="lolite()" onClick="logVariable('resetinprogress')" href="../_variables/resetinprogress.html">$resetinprogress</a>-&gt;<a onClick="logVariable('timererequested')" class="var it45259" onMouseOver="hilite(45259)" onMouseOut="lolite()" href="../_variables/timererequested.html">timererequested</a>)) {
<a name="l92"><span class="linenum">  92</span></a>  <span class="comment">                    // Preexisting, valid request. This is the first time user has re-requested the reset.</span>
<a name="l93"><span class="linenum">  93</span></a>  <span class="comment">                    // Re-sending the same email once can actually help in certain circumstances</span>
<a name="l94"><span class="linenum">  94</span></a>  <span class="comment">                    // eg by reducing the delay caused by greylisting.</span>
<a name="l95"><span class="linenum">  95</span></a>                      <a class="var it4309" onMouseOver="hilite(4309)" onMouseOut="lolite()" onClick="logVariable('resetinprogress')" href="../_variables/resetinprogress.html">$resetinprogress</a>-&gt;<a onClick="logVariable('timererequested')" class="var it45259" onMouseOver="hilite(45259)" onMouseOut="lolite()" href="../_variables/timererequested.html">timererequested</a> = <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l96"><span class="linenum">  96</span></a>                      <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('update_record')" href="../_functions/update_record.html" onMouseOver="funcPopup(event,'update_record')">update_record</a>('user_password_resets', <a class="var it4309" onMouseOver="hilite(4309)" onMouseOut="lolite()" onClick="logVariable('resetinprogress')" href="../_variables/resetinprogress.html">$resetinprogress</a>);
<a name="l97"><span class="linenum">  97</span></a>                      <a class="var it4310" onMouseOver="hilite(4310)" onMouseOut="lolite()" onClick="logVariable('resetrecord')" href="../_variables/resetrecord.html">$resetrecord</a> = <a class="var it4309" onMouseOver="hilite(4309)" onMouseOut="lolite()" onClick="logVariable('resetinprogress')" href="../_variables/resetinprogress.html">$resetinprogress</a>;
<a name="l98"><span class="linenum">  98</span></a>                      <a class="var it4311" onMouseOver="hilite(4311)" onMouseOut="lolite()" onClick="logVariable('sendemail')" href="../_variables/sendemail.html">$sendemail</a> = true;
<a name="l99"><span class="linenum">  99</span></a>                  } else {
<a name="l100"><span class="linenum"> 100</span></a>  <span class="comment">                    // Preexisting, valid request. User has already re-requested email.</span>
<a name="l101"><span class="linenum"> 101</span></a>                      <a class="var it4308" onMouseOver="hilite(4308)" onMouseOut="lolite()" onClick="logVariable('pwresetstatus')" href="../_variables/pwresetstatus.html">$pwresetstatus</a> = <a class="constant" onClick="logConstant('PWRESET_STATUS_ALREADYSENT')" href="../_constants/PWRESET_STATUS_ALREADYSENT.html" onMouseOver="constPopup(event,'PWRESET_STATUS_ALREADYSENT')">PWRESET_STATUS_ALREADYSENT</a>;
<a name="l102"><span class="linenum"> 102</span></a>                      <a class="var it4311" onMouseOver="hilite(4311)" onMouseOut="lolite()" onClick="logVariable('sendemail')" href="../_variables/sendemail.html">$sendemail</a> = false;
<a name="l103"><span class="linenum"> 103</span></a>                  }
<a name="l104"><span class="linenum"> 104</span></a>  
<a name="l105"><span class="linenum"> 105</span></a>                  if (<a class="var it4311" onMouseOver="hilite(4311)" onMouseOut="lolite()" onClick="logVariable('sendemail')" href="../_variables/sendemail.html">$sendemail</a>) {
<a name="l106"><span class="linenum"> 106</span></a>                      <a class="var it4315" onMouseOver="hilite(4315)" onMouseOut="lolite()" onClick="logVariable('sendresult')" href="../_variables/sendresult.html">$sendresult</a> = <a class="function" onClick="logFunction('send_password_change_confirmation_email')" href="../_functions/send_password_change_confirmation_email.html" onMouseOver="funcPopup(event,'send_password_change_confirmation_email')">send_password_change_confirmation_email</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it4310" onMouseOver="hilite(4310)" onMouseOut="lolite()" onClick="logVariable('resetrecord')" href="../_variables/resetrecord.html">$resetrecord</a>);
<a name="l107"><span class="linenum"> 107</span></a>                      if (<a class="var it4315" onMouseOver="hilite(4315)" onMouseOut="lolite()" onClick="logVariable('sendresult')" href="../_variables/sendresult.html">$sendresult</a>) {
<a name="l108"><span class="linenum"> 108</span></a>                          <a class="var it4308" onMouseOver="hilite(4308)" onMouseOut="lolite()" onClick="logVariable('pwresetstatus')" href="../_variables/pwresetstatus.html">$pwresetstatus</a> = <a class="constant" onClick="logConstant('PWRESET_STATUS_TOKENSENT')" href="../_constants/PWRESET_STATUS_TOKENSENT.html" onMouseOver="constPopup(event,'PWRESET_STATUS_TOKENSENT')">PWRESET_STATUS_TOKENSENT</a>;
<a name="l109"><span class="linenum"> 109</span></a>                      } else {
<a name="l110"><span class="linenum"> 110</span></a>                          <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('cannotmailconfirm');
<a name="l111"><span class="linenum"> 111</span></a>                      }
<a name="l112"><span class="linenum"> 112</span></a>                  }
<a name="l113"><span class="linenum"> 113</span></a>              }
<a name="l114"><span class="linenum"> 114</span></a>          }
<a name="l115"><span class="linenum"> 115</span></a>  
<a name="l116"><span class="linenum"> 116</span></a>  <span class="comment">        // Any email has now been sent.</span>
<a name="l117"><span class="linenum"> 117</span></a>  <span class="comment">        // Next display results to requesting user if settings permit.</span>
<a name="l118"><span class="linenum"> 118</span></a>          echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="phpfunction" onClick="logFunction('header')" href="../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>();
<a name="l119"><span class="linenum"> 119</span></a>  
<a name="l120"><span class="linenum"> 120</span></a>          if (!empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('protectusernames')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/protectusernames.html">protectusernames</a>)) {
<a name="l121"><span class="linenum"> 121</span></a>  <span class="comment">            // Neither confirm, nor deny existance of any username or email address in database.</span>
<a name="l122"><span class="linenum"> 122</span></a>  <span class="comment">            // Print general (non-commital) message.</span>
<a name="l123"><span class="linenum"> 123</span></a>              <a class="function" onClick="logFunction('notice')" href="../_functions/notice.html" onMouseOver="funcPopup(event,'notice')">notice</a>(<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailpasswordconfirmmaybesent'), <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>.'<a class="filename" href="../index.php.html">/index.php</a>');
<a name="l124"><span class="linenum"> 124</span></a>              die; <span class="comment">// Never reached.</span>
<a name="l125"><span class="linenum"> 125</span></a>          } else if (empty(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l126"><span class="linenum"> 126</span></a>  <span class="comment">            // Protect usernames is off, and we couldn't find the user with details specified.</span>
<a name="l127"><span class="linenum"> 127</span></a>  <span class="comment">            // Print failure advice.</span>
<a name="l128"><span class="linenum"> 128</span></a>              <a class="function" onClick="logFunction('notice')" href="../_functions/notice.html" onMouseOver="funcPopup(event,'notice')">notice</a>(<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailpasswordconfirmnotsent'), <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>.'/forgot_password.php');
<a name="l129"><span class="linenum"> 129</span></a>              die; <span class="comment">// Never reached.</span>
<a name="l130"><span class="linenum"> 130</span></a>          } else if (empty(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('email')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/email.html">email</a>)) {
<a name="l131"><span class="linenum"> 131</span></a>  <span class="comment">            // User doesn't have an email set - can't send a password change confimation email.</span>
<a name="l132"><span class="linenum"> 132</span></a>              <a class="function" onClick="logFunction('notice')" href="../_functions/notice.html" onMouseOver="funcPopup(event,'notice')">notice</a>(<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailpasswordconfirmnoemail'), <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>.'<a class="filename" href="../index.php.html">/index.php</a>');
<a name="l133"><span class="linenum"> 133</span></a>              die; <span class="comment">// Never reached.</span>
<a name="l134"><span class="linenum"> 134</span></a>          } else if (<a class="var it4308" onMouseOver="hilite(4308)" onMouseOut="lolite()" onClick="logVariable('pwresetstatus')" href="../_variables/pwresetstatus.html">$pwresetstatus</a> == <a class="constant" onClick="logConstant('PWRESET_STATUS_ALREADYSENT')" href="../_constants/PWRESET_STATUS_ALREADYSENT.html" onMouseOver="constPopup(event,'PWRESET_STATUS_ALREADYSENT')">PWRESET_STATUS_ALREADYSENT</a>) {
<a name="l135"><span class="linenum"> 135</span></a>  <span class="comment">            // User found, protectusernames is off, but user has already (re) requested a reset.</span>
<a name="l136"><span class="linenum"> 136</span></a>  <span class="comment">            // Don't send a 3rd reset email.</span>
<a name="l137"><span class="linenum"> 137</span></a>              <a class="var it4316" onMouseOver="hilite(4316)" onMouseOut="lolite()" onClick="logVariable('stremailalreadysent')" href="../_variables/stremailalreadysent.html">$stremailalreadysent</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailalreadysent');
<a name="l138"><span class="linenum"> 138</span></a>              <a class="function" onClick="logFunction('notice')" href="../_functions/notice.html" onMouseOver="funcPopup(event,'notice')">notice</a>(<a class="var it4316" onMouseOver="hilite(4316)" onMouseOut="lolite()" onClick="logVariable('stremailalreadysent')" href="../_variables/stremailalreadysent.html">$stremailalreadysent</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>.'<a class="filename" href="../index.php.html">/index.php</a>');
<a name="l139"><span class="linenum"> 139</span></a>              die; <span class="comment">// Never reached.</span>
<a name="l140"><span class="linenum"> 140</span></a>          } else if (<a class="var it4308" onMouseOver="hilite(4308)" onMouseOut="lolite()" onClick="logVariable('pwresetstatus')" href="../_variables/pwresetstatus.html">$pwresetstatus</a> == <a class="constant" onClick="logConstant('PWRESET_STATUS_NOEMAILSENT')" href="../_constants/PWRESET_STATUS_NOEMAILSENT.html" onMouseOver="constPopup(event,'PWRESET_STATUS_NOEMAILSENT')">PWRESET_STATUS_NOEMAILSENT</a>) {
<a name="l141"><span class="linenum"> 141</span></a>  <span class="comment">            // User found, protectusernames is off, but user is not confirmed.</span>
<a name="l142"><span class="linenum"> 142</span></a>  <span class="comment">            // Pretend we sent them an email.</span>
<a name="l143"><span class="linenum"> 143</span></a>  <span class="comment">            // This is a big usability problem - need to tell users why we didn't send them an email.</span>
<a name="l144"><span class="linenum"> 144</span></a>  <span class="comment">            // Obfuscate email address to protect privacy.</span>
<a name="l145"><span class="linenum"> 145</span></a>              <a class="var it4317" onMouseOver="hilite(4317)" onMouseOut="lolite()" onClick="logVariable('protectedemail')" href="../_variables/protectedemail.html">$protectedemail</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/([^@]*)@(.*)/', '******@<a class="var it2020" onMouseOver="hilite(2020)" onMouseOut="lolite()" onClick="logVariable('2')" href="../_variables/2.html">$2</a>', <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('email')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/email.html">email</a>);
<a name="l146"><span class="linenum"> 146</span></a>              <a class="var it4318" onMouseOver="hilite(4318)" onMouseOut="lolite()" onClick="logVariable('stremailpasswordconfirmsent')" href="../_variables/stremailpasswordconfirmsent.html">$stremailpasswordconfirmsent</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailpasswordconfirmsent', '', <a class="var it4317" onMouseOver="hilite(4317)" onMouseOut="lolite()" onClick="logVariable('protectedemail')" href="../_variables/protectedemail.html">$protectedemail</a>);
<a name="l147"><span class="linenum"> 147</span></a>              <a class="function" onClick="logFunction('notice')" href="../_functions/notice.html" onMouseOver="funcPopup(event,'notice')">notice</a>(<a class="var it4318" onMouseOver="hilite(4318)" onMouseOut="lolite()" onClick="logVariable('stremailpasswordconfirmsent')" href="../_variables/stremailpasswordconfirmsent.html">$stremailpasswordconfirmsent</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>.'<a class="filename" href="../index.php.html">/index.php</a>');
<a name="l148"><span class="linenum"> 148</span></a>              die; <span class="comment">// Never reached.</span>
<a name="l149"><span class="linenum"> 149</span></a>          } else {
<a name="l150"><span class="linenum"> 150</span></a>  <span class="comment">            // Confirm email sent. (Obfuscate email address to protect privacy).</span>
<a name="l151"><span class="linenum"> 151</span></a>              <a class="var it4317" onMouseOver="hilite(4317)" onMouseOut="lolite()" onClick="logVariable('protectedemail')" href="../_variables/protectedemail.html">$protectedemail</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>('/([^@]*)@(.*)/', '******@<a class="var it2020" onMouseOver="hilite(2020)" onMouseOut="lolite()" onClick="logVariable('2')" href="../_variables/2.html">$2</a>', <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('email')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/email.html">email</a>);
<a name="l152"><span class="linenum"> 152</span></a>  <span class="comment">            // This is a small usability problem - may be obfuscating the email address which the user has just supplied.</span>
<a name="l153"><span class="linenum"> 153</span></a>              <a class="var it4319" onMouseOver="hilite(4319)" onMouseOut="lolite()" onClick="logVariable('stremailresetconfirmsent')" href="../_variables/stremailresetconfirmsent.html">$stremailresetconfirmsent</a> = <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('emailresetconfirmsent', '', <a class="var it4317" onMouseOver="hilite(4317)" onMouseOut="lolite()" onClick="logVariable('protectedemail')" href="../_variables/protectedemail.html">$protectedemail</a>);
<a name="l154"><span class="linenum"> 154</span></a>              <a class="function" onClick="logFunction('notice')" href="../_functions/notice.html" onMouseOver="funcPopup(event,'notice')">notice</a>(<a class="var it4319" onMouseOver="hilite(4319)" onMouseOut="lolite()" onClick="logVariable('stremailresetconfirmsent')" href="../_variables/stremailresetconfirmsent.html">$stremailresetconfirmsent</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>.'<a class="filename" href="../index.php.html">/index.php</a>');
<a name="l155"><span class="linenum"> 155</span></a>              die; <span class="comment">// Never reached.</span>
<a name="l156"><span class="linenum"> 156</span></a>          }
<a name="l157"><span class="linenum"> 157</span></a>          die; <span class="comment">// Never reached.</span>
<a name="l158"><span class="linenum"> 158</span></a>      }
<a name="l159"><span class="linenum"> 159</span></a>  
<a name="l160"><span class="linenum"> 160</span></a>  <span class="comment">    // Make sure we really are on the https page when https login required.</span>
<a name="l161"><span class="linenum"> 161</span></a>      <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('verify_https_required')" href="../_functions/verify_https_required.html" onMouseOver="funcPopup(event,'verify_https_required')">verify_https_required</a>();
<a name="l162"><span class="linenum"> 162</span></a>  
<a name="l163"><span class="linenum"> 163</span></a>  <span class="comment">    // DISPLAY FORM.</span>
<a name="l164"><span class="linenum"> 164</span></a>  
<a name="l165"><span class="linenum"> 165</span></a>      echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="phpfunction" onClick="logFunction('header')" href="../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>();
<a name="l166"><span class="linenum"> 166</span></a>      echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box')" href="../_functions/box.html" onMouseOver="funcPopup(event,'box')">box</a>(<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('passwordforgotteninstructions2'), 'generalbox boxwidthnormal boxaligncenter');
<a name="l167"><span class="linenum"> 167</span></a>      <a class="var it219" onMouseOver="hilite(219)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../_variables/mform.html">$mform</a>-&gt;<a class="function" onClick="logFunction('display')" href="../_functions/display.html" onMouseOver="funcPopup(event,'display')">display</a>();
<a name="l168"><span class="linenum"> 168</span></a>  
<a name="l169"><span class="linenum"> 169</span></a>      echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('footer')" href="../_functions/footer.html" onMouseOver="funcPopup(event,'footer')">footer</a>();
<a name="l170"><span class="linenum"> 170</span></a>  }
<a name="l171"><span class="linenum"> 171</span></a>  
<a name="l172"><span class="linenum"> 172</span></a>  <span class="comment">/**</span>
<a name="l173"><span class="linenum"> 173</span></a>  <span class="comment"> * This function processes a user's submitted token to validate the request to set a new password.</span>
<a name="l174"><span class="linenum"> 174</span></a>  <span class="comment"> * If the user's token is validated, they are prompted to set a new password.</span>
<a name="l175"><span class="linenum"> 175</span></a>  <span class="comment"> * @param string $token the one-use identifier which should verify the password reset request as being valid.</span>
<a name="l176"><span class="linenum"> 176</span></a>  <span class="comment"> * @return void</span>
<a name="l177"><span class="linenum"> 177</span></a>  <span class="comment"> */</span>
<a name="l178"><span class="linenum"> 178</span></a>  function <a class="function" onClick="logFunction('core_login_process_password_set')" href="../_functions/core_login_process_password_set.html" onMouseOver="funcPopup(event,'core_login_process_password_set')">core_login_process_password_set</a>(<a class="var it310" onMouseOver="hilite(310)" onMouseOut="lolite()" onClick="logVariable('token')" href="../_variables/token.html">$token</a>) {
<a name="l179"><span class="linenum"> 179</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>, <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>, <a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>;
<a name="l180"><span class="linenum"> 180</span></a>      require_once(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('dirroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/dirroot.html">dirroot</a>.'<a class="filename" href="../user/lib.php.html">/user/lib.php</a>');
<a name="l181"><span class="linenum"> 181</span></a>  
<a name="l182"><span class="linenum"> 182</span></a>      <a class="var it4313" onMouseOver="hilite(4313)" onMouseOut="lolite()" onClick="logVariable('pwresettime')" href="../_variables/pwresettime.html">$pwresettime</a> = isset(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('pwresettime')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/pwresettime.html">pwresettime</a>) ? <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('pwresettime')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/pwresettime.html">pwresettime</a> : 1800;
<a name="l183"><span class="linenum"> 183</span></a>      <a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../_variables/sql.html">$sql</a> = &quot;SELECT u.*, upr.token, upr.timerequested, upr.id as tokenid
<a name="l184"><span class="linenum"> 184</span></a>                FROM {user} u
<a name="l185"><span class="linenum"> 185</span></a>                JOIN {user_password_resets} upr ON upr.userid = u.id
<a name="l186"><span class="linenum"> 186</span></a>               WHERE upr.token = ?&quot;;
<a name="l187"><span class="linenum"> 187</span></a>      <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_record_sql')" href="../_functions/get_record_sql.html" onMouseOver="funcPopup(event,'get_record_sql')">get_record_sql</a>(<a class="var it64" onMouseOver="hilite(64)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../_variables/sql.html">$sql</a>, array(<a class="var it310" onMouseOver="hilite(310)" onMouseOut="lolite()" onClick="logVariable('token')" href="../_variables/token.html">$token</a>));
<a name="l188"><span class="linenum"> 188</span></a>  
<a name="l189"><span class="linenum"> 189</span></a>      <a class="var it4320" onMouseOver="hilite(4320)" onMouseOut="lolite()" onClick="logVariable('forgotpasswordurl')" href="../_variables/forgotpasswordurl.html">$forgotpasswordurl</a> = &quot;{<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('httpswwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/httpswwwroot.html">httpswwwroot</a>}/login/forgot_password.php&quot;;
<a name="l190"><span class="linenum"> 190</span></a>      if (empty(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>) <a class="function" onClick="logFunction('or')" href="../_functions/or.html" onMouseOver="funcPopup(event,'or')">or</a> (<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('timerequested')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/timerequested.html">timerequested</a> &lt; (<a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() - <a class="var it4313" onMouseOver="hilite(4313)" onMouseOut="lolite()" onClick="logVariable('pwresettime')" href="../_variables/pwresettime.html">$pwresettime</a> - <a class="constant" onClick="logConstant('DAYSECS')" href="../_constants/DAYSECS.html" onMouseOver="constPopup(event,'DAYSECS')">DAYSECS</a>))) {
<a name="l191"><span class="linenum"> 191</span></a>  <span class="comment">        // There is no valid reset request record - not even a recently expired one.</span>
<a name="l192"><span class="linenum"> 192</span></a>  <span class="comment">        // (suspicious)</span>
<a name="l193"><span class="linenum"> 193</span></a>  <span class="comment">        // Direct the user to the forgot password page to request a password reset.</span>
<a name="l194"><span class="linenum"> 194</span></a>          echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="phpfunction" onClick="logFunction('header')" href="../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>();
<a name="l195"><span class="linenum"> 195</span></a>          <a class="function" onClick="logFunction('notice')" href="../_functions/notice.html" onMouseOver="funcPopup(event,'notice')">notice</a>(<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('noresetrecord'), <a class="var it4320" onMouseOver="hilite(4320)" onMouseOut="lolite()" onClick="logVariable('forgotpasswordurl')" href="../_variables/forgotpasswordurl.html">$forgotpasswordurl</a>);
<a name="l196"><span class="linenum"> 196</span></a>          die; <span class="comment">// Never reached.</span>
<a name="l197"><span class="linenum"> 197</span></a>      }
<a name="l198"><span class="linenum"> 198</span></a>      if (<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('timerequested')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/timerequested.html">timerequested</a> &lt; (<a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() - <a class="var it4313" onMouseOver="hilite(4313)" onMouseOut="lolite()" onClick="logVariable('pwresettime')" href="../_variables/pwresettime.html">$pwresettime</a>)) {
<a name="l199"><span class="linenum"> 199</span></a>  <span class="comment">        // There is a reset record, but it's expired.</span>
<a name="l200"><span class="linenum"> 200</span></a>  <span class="comment">        // Direct the user to the forgot password page to request a password reset.</span>
<a name="l201"><span class="linenum"> 201</span></a>          <a class="var it4321" onMouseOver="hilite(4321)" onMouseOut="lolite()" onClick="logVariable('pwresetmins')" href="../_variables/pwresetmins.html">$pwresetmins</a> = <a class="phpfunction" onClick="logFunction('floor')" href="../_functions/floor.html" onMouseOver="phpfuncPopup(event,'floor')">floor</a>(<a class="var it4313" onMouseOver="hilite(4313)" onMouseOut="lolite()" onClick="logVariable('pwresettime')" href="../_variables/pwresettime.html">$pwresettime</a> / <a class="constant" onClick="logConstant('MINSECS')" href="../_constants/MINSECS.html" onMouseOver="constPopup(event,'MINSECS')">MINSECS</a>);
<a name="l202"><span class="linenum"> 202</span></a>          echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="phpfunction" onClick="logFunction('header')" href="../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>();
<a name="l203"><span class="linenum"> 203</span></a>          <a class="function" onClick="logFunction('notice')" href="../_functions/notice.html" onMouseOver="funcPopup(event,'notice')">notice</a>(<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('resetrecordexpired', '', <a class="var it4321" onMouseOver="hilite(4321)" onMouseOut="lolite()" onClick="logVariable('pwresetmins')" href="../_variables/pwresetmins.html">$pwresetmins</a>), <a class="var it4320" onMouseOver="hilite(4320)" onMouseOut="lolite()" onClick="logVariable('forgotpasswordurl')" href="../_variables/forgotpasswordurl.html">$forgotpasswordurl</a>);
<a name="l204"><span class="linenum"> 204</span></a>          die; <span class="comment">// Never reached.</span>
<a name="l205"><span class="linenum"> 205</span></a>      }
<a name="l206"><span class="linenum"> 206</span></a>  
<a name="l207"><span class="linenum"> 207</span></a>      if (<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a> === 'nologin' or !<a class="function" onClick="logFunction('is_enabled_auth')" href="../_functions/is_enabled_auth.html" onMouseOver="funcPopup(event,'is_enabled_auth')">is_enabled_auth</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>)) {
<a name="l208"><span class="linenum"> 208</span></a>  <span class="comment">        // Bad luck - user is not able to login, do not let them set password.</span>
<a name="l209"><span class="linenum"> 209</span></a>          echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="phpfunction" onClick="logFunction('header')" href="../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>();
<a name="l210"><span class="linenum"> 210</span></a>          <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('forgotteninvalidurl');
<a name="l211"><span class="linenum"> 211</span></a>          die; <span class="comment">// Never reached.</span>
<a name="l212"><span class="linenum"> 212</span></a>      }
<a name="l213"><span class="linenum"> 213</span></a>  
<a name="l214"><span class="linenum"> 214</span></a>  <span class="comment">    // Check this isn't guest user.</span>
<a name="l215"><span class="linenum"> 215</span></a>      if (<a class="function" onClick="logFunction('isguestuser')" href="../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>)) {
<a name="l216"><span class="linenum"> 216</span></a>          <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('cannotresetguestpwd');
<a name="l217"><span class="linenum"> 217</span></a>      }
<a name="l218"><span class="linenum"> 218</span></a>  
<a name="l219"><span class="linenum"> 219</span></a>  <span class="comment">    // Token is correct, and unexpired.</span>
<a name="l220"><span class="linenum"> 220</span></a>      <a class="var it219" onMouseOver="hilite(219)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../_variables/mform.html">$mform</a> = <span class="keyword">new </span><a class="class" onClick="logClass('login_set_password_form')" href="../_classes/login_set_password_form.html" onMouseOver="classPopup(event,'login_set_password_form')">login_set_password_form</a>(null, <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, 'post', '', 'autocomplete=&quot;yes&quot;');
<a name="l221"><span class="linenum"> 221</span></a>      <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a> = <a class="var it219" onMouseOver="hilite(219)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../_variables/mform.html">$mform</a>-&gt;<a class="function" onClick="logFunction('get_data')" href="../_functions/get_data.html" onMouseOver="funcPopup(event,'get_data')">get_data</a>();
<a name="l222"><span class="linenum"> 222</span></a>      if (empty(<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>)) {
<a name="l223"><span class="linenum"> 223</span></a>  <span class="comment">        // User hasn't submitted form, they got here directly from email link.</span>
<a name="l224"><span class="linenum"> 224</span></a>  <span class="comment">        // Next, display the form.</span>
<a name="l225"><span class="linenum"> 225</span></a>          <a class="var it4322" onMouseOver="hilite(4322)" onMouseOut="lolite()" onClick="logVariable('setdata')" href="../_variables/setdata.html">$setdata</a> = new stdClass();
<a name="l226"><span class="linenum"> 226</span></a>          <a class="var it4322" onMouseOver="hilite(4322)" onMouseOut="lolite()" onClick="logVariable('setdata')" href="../_variables/setdata.html">$setdata</a>-&gt;<a onClick="logVariable('username')" class="var it45260" onMouseOver="hilite(45260)" onMouseOut="lolite()" href="../_variables/username.html">username</a> = <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/username.html">username</a>;
<a name="l227"><span class="linenum"> 227</span></a>          <a class="var it4322" onMouseOver="hilite(4322)" onMouseOut="lolite()" onClick="logVariable('setdata')" href="../_variables/setdata.html">$setdata</a>-&gt;<a onClick="logVariable('username2')" class="var it45260" onMouseOver="hilite(45260)" onMouseOut="lolite()" href="../_variables/username2.html">username2</a> = <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('username')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/username.html">username</a>;
<a name="l228"><span class="linenum"> 228</span></a>          <a class="var it4322" onMouseOver="hilite(4322)" onMouseOut="lolite()" onClick="logVariable('setdata')" href="../_variables/setdata.html">$setdata</a>-&gt;<a onClick="logVariable('token')" class="var it45260" onMouseOver="hilite(45260)" onMouseOut="lolite()" href="../_variables/token.html">token</a> = <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('token')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/token.html">token</a>;
<a name="l229"><span class="linenum"> 229</span></a>          <a class="var it219" onMouseOver="hilite(219)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../_variables/mform.html">$mform</a>-&gt;<a class="function" onClick="logFunction('set_data')" href="../_functions/set_data.html" onMouseOver="funcPopup(event,'set_data')">set_data</a>(<a class="var it4322" onMouseOver="hilite(4322)" onMouseOut="lolite()" onClick="logVariable('setdata')" href="../_variables/setdata.html">$setdata</a>);
<a name="l230"><span class="linenum"> 230</span></a>          <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('PAGE')" href="../_variables/PAGE.html">$PAGE</a>-&gt;<a class="function" onClick="logFunction('verify_https_required')" href="../_functions/verify_https_required.html" onMouseOver="funcPopup(event,'verify_https_required')">verify_https_required</a>();
<a name="l231"><span class="linenum"> 231</span></a>          echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="phpfunction" onClick="logFunction('header')" href="../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>();
<a name="l232"><span class="linenum"> 232</span></a>          echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('box')" href="../_functions/box.html" onMouseOver="funcPopup(event,'box')">box</a>(<a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('setpasswordinstructions'), 'generalbox boxwidthnormal boxaligncenter');
<a name="l233"><span class="linenum"> 233</span></a>          <a class="var it219" onMouseOver="hilite(219)" onMouseOut="lolite()" onClick="logVariable('mform')" href="../_variables/mform.html">$mform</a>-&gt;<a class="function" onClick="logFunction('display')" href="../_functions/display.html" onMouseOver="funcPopup(event,'display')">display</a>();
<a name="l234"><span class="linenum"> 234</span></a>          echo <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('OUTPUT')" href="../_variables/OUTPUT.html">$OUTPUT</a>-&gt;<a class="function" onClick="logFunction('footer')" href="../_functions/footer.html" onMouseOver="funcPopup(event,'footer')">footer</a>();
<a name="l235"><span class="linenum"> 235</span></a>          return;
<a name="l236"><span class="linenum"> 236</span></a>      } else {
<a name="l237"><span class="linenum"> 237</span></a>  <span class="comment">        // User has submitted form.</span>
<a name="l238"><span class="linenum"> 238</span></a>  <span class="comment">        // Delete this token so it can't be used again.</span>
<a name="l239"><span class="linenum"> 239</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('delete_records')" href="../_functions/delete_records.html" onMouseOver="funcPopup(event,'delete_records')">delete_records</a>('user_password_resets', array('id' =&gt; <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('tokenid')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/tokenid.html">tokenid</a>));
<a name="l240"><span class="linenum"> 240</span></a>          <a class="var it377" onMouseOver="hilite(377)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a> = <a class="function" onClick="logFunction('get_auth_plugin')" href="../_functions/get_auth_plugin.html" onMouseOver="funcPopup(event,'get_auth_plugin')">get_auth_plugin</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('auth')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/auth.html">auth</a>);
<a name="l241"><span class="linenum"> 241</span></a>          if (!<a class="var it377" onMouseOver="hilite(377)" onMouseOut="lolite()" onClick="logVariable('userauth')" href="../_variables/userauth.html">$userauth</a>-&gt;<a class="function" onClick="logFunction('user_update_password')" href="../_functions/user_update_password.html" onMouseOver="funcPopup(event,'user_update_password')">user_update_password</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('password')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../_variables/password.html">password</a>)) {
<a name="l242"><span class="linenum"> 242</span></a>              <a class="function" onClick="logFunction('print_error')" href="../_functions/print_error.html" onMouseOver="funcPopup(event,'print_error')">print_error</a>('errorpasswordupdate', 'auth');
<a name="l243"><span class="linenum"> 243</span></a>          }
<a name="l244"><span class="linenum"> 244</span></a>          <a class="function" onClick="logFunction('user_add_password_history')" href="../_functions/user_add_password_history.html" onMouseOver="funcPopup(event,'user_add_password_history')">user_add_password_history</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>-&gt;<a onClick="logVariable('password')" class="var it42917" onMouseOver="hilite(42917)" onMouseOut="lolite()" href="../_variables/password.html">password</a>);
<a name="l245"><span class="linenum"> 245</span></a>          if (!empty(<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('passwordchangelogout')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/passwordchangelogout.html">passwordchangelogout</a>)) {
<a name="l246"><span class="linenum"> 246</span></a>              \core\session\<a class="class" onClick="logClass('manager')" href="../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('kill_user_sessions')" href="../_functions/kill_user_sessions.html" onMouseOver="funcPopup(event,'kill_user_sessions')">kill_user_sessions</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, <a class="phpfunction" onClick="logFunction('session_id')" href="../_functions/session_id.html" onMouseOver="phpfuncPopup(event,'session_id')">session_id</a>());
<a name="l247"><span class="linenum"> 247</span></a>          }
<a name="l248"><span class="linenum"> 248</span></a>  <span class="comment">        // Reset login lockout (if present) before a new password is set.</span>
<a name="l249"><span class="linenum"> 249</span></a>          <a class="function" onClick="logFunction('login_unlock_account')" href="../_functions/login_unlock_account.html" onMouseOver="funcPopup(event,'login_unlock_account')">login_unlock_account</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l250"><span class="linenum"> 250</span></a>  <span class="comment">        // Clear any requirement to change passwords.</span>
<a name="l251"><span class="linenum"> 251</span></a>          <a class="function" onClick="logFunction('unset_user_preference')" href="../_functions/unset_user_preference.html" onMouseOver="funcPopup(event,'unset_user_preference')">unset_user_preference</a>('auth_forcepasswordchange', <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l252"><span class="linenum"> 252</span></a>          <a class="function" onClick="logFunction('unset_user_preference')" href="../_functions/unset_user_preference.html" onMouseOver="funcPopup(event,'unset_user_preference')">unset_user_preference</a>('create_password', <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l253"><span class="linenum"> 253</span></a>  
<a name="l254"><span class="linenum"> 254</span></a>          if (!empty(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('lang')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>)) {
<a name="l255"><span class="linenum"> 255</span></a>  <span class="comment">            // Unset previous session language - use user preference instead.</span>
<a name="l256"><span class="linenum"> 256</span></a>              unset(<a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('lang')" class="var it42907" onMouseOver="hilite(42907)" onMouseOut="lolite()" href="../_variables/lang.html">lang</a>);
<a name="l257"><span class="linenum"> 257</span></a>          }
<a name="l258"><span class="linenum"> 258</span></a>          <a class="function" onClick="logFunction('complete_user_login')" href="../_functions/complete_user_login.html" onMouseOver="funcPopup(event,'complete_user_login')">complete_user_login</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>); <span class="comment">// Triggers the login event.</span>
<a name="l259"><span class="linenum"> 259</span></a>  
<a name="l260"><span class="linenum"> 260</span></a>          \core\session\<a class="class" onClick="logClass('manager')" href="../_classes/manager.html" onMouseOver="classPopup(event,'manager')">manager</a>::<a class="function" onClick="logFunction('apply_concurrent_login_limit')" href="../_functions/apply_concurrent_login_limit.html" onMouseOver="funcPopup(event,'apply_concurrent_login_limit')">apply_concurrent_login_limit</a>(<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/id.html">id</a>, <a class="phpfunction" onClick="logFunction('session_id')" href="../_functions/session_id.html" onMouseOver="phpfuncPopup(event,'session_id')">session_id</a>());
<a name="l261"><span class="linenum"> 261</span></a>  
<a name="l262"><span class="linenum"> 262</span></a>          <a class="var it357" onMouseOver="hilite(357)" onMouseOut="lolite()" onClick="logVariable('urltogo')" href="../_variables/urltogo.html">$urltogo</a> = <a class="function" onClick="logFunction('core_login_get_return_url')" href="../_functions/core_login_get_return_url.html" onMouseOver="funcPopup(event,'core_login_get_return_url')">core_login_get_return_url</a>();
<a name="l263"><span class="linenum"> 263</span></a>          unset(<a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it42907" onMouseOver="hilite(42907)" onMouseOut="lolite()" href="../_variables/wantsurl.html">wantsurl</a>);
<a name="l264"><span class="linenum"> 264</span></a>          <a class="function" onClick="logFunction('redirect')" href="../_functions/redirect.html" onMouseOver="funcPopup(event,'redirect')">redirect</a>(<a class="var it357" onMouseOver="hilite(357)" onMouseOut="lolite()" onClick="logVariable('urltogo')" href="../_variables/urltogo.html">$urltogo</a>, <a class="function" onClick="logFunction('get_string')" href="../_functions/get_string.html" onMouseOver="funcPopup(event,'get_string')">get_string</a>('passwordset'), 1);
<a name="l265"><span class="linenum"> 265</span></a>      }
<a name="l266"><span class="linenum"> 266</span></a>  }
<a name="l267"><span class="linenum"> 267</span></a>  
<a name="l268"><span class="linenum"> 268</span></a>  <span class="comment">/** Create a new record in the database to track a new password set request for user.</span>
<a name="l269"><span class="linenum"> 269</span></a>  <span class="comment"> * @param object $user the user record, the requester would like a new password set for.</span>
<a name="l270"><span class="linenum"> 270</span></a>  <span class="comment"> * @return record created.</span>
<a name="l271"><span class="linenum"> 271</span></a>  <span class="comment"> */</span>
<a name="l272"><span class="linenum"> 272</span></a>  function <a class="function" onClick="logFunction('core_login_generate_password_reset')" href="../_functions/core_login_generate_password_reset.html" onMouseOver="funcPopup(event,'core_login_generate_password_reset')">core_login_generate_password_reset</a> (<a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>) {
<a name="l273"><span class="linenum"> 273</span></a>      global <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>;
<a name="l274"><span class="linenum"> 274</span></a>      <a class="var it4310" onMouseOver="hilite(4310)" onMouseOut="lolite()" onClick="logVariable('resetrecord')" href="../_variables/resetrecord.html">$resetrecord</a> = new stdClass();
<a name="l275"><span class="linenum"> 275</span></a>      <a class="var it4310" onMouseOver="hilite(4310)" onMouseOut="lolite()" onClick="logVariable('resetrecord')" href="../_variables/resetrecord.html">$resetrecord</a>-&gt;<a onClick="logVariable('timerequested')" class="var it44295" onMouseOver="hilite(44295)" onMouseOut="lolite()" href="../_variables/timerequested.html">timerequested</a> = <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l276"><span class="linenum"> 276</span></a>      <a class="var it4310" onMouseOver="hilite(4310)" onMouseOut="lolite()" onClick="logVariable('resetrecord')" href="../_variables/resetrecord.html">$resetrecord</a>-&gt;<a onClick="logVariable('userid')" class="var it44295" onMouseOver="hilite(44295)" onMouseOut="lolite()" href="../_variables/userid.html">userid</a> = <a class="var it362" onMouseOver="hilite(362)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>-&gt;<a onClick="logVariable('id')" class="var it42948" onMouseOver="hilite(42948)" onMouseOut="lolite()" href="../_variables/id.html">id</a>;
<a name="l277"><span class="linenum"> 277</span></a>      <a class="var it4310" onMouseOver="hilite(4310)" onMouseOut="lolite()" onClick="logVariable('resetrecord')" href="../_variables/resetrecord.html">$resetrecord</a>-&gt;<a onClick="logVariable('token')" class="var it44295" onMouseOver="hilite(44295)" onMouseOut="lolite()" href="../_variables/token.html">token</a> = <a class="function" onClick="logFunction('random_string')" href="../_functions/random_string.html" onMouseOver="funcPopup(event,'random_string')">random_string</a>(32);
<a name="l278"><span class="linenum"> 278</span></a>      <a class="var it4310" onMouseOver="hilite(4310)" onMouseOut="lolite()" onClick="logVariable('resetrecord')" href="../_variables/resetrecord.html">$resetrecord</a>-&gt;<a onClick="logVariable('id')" class="var it44295" onMouseOver="hilite(44295)" onMouseOut="lolite()" href="../_variables/id.html">id</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('insert_record')" href="../_functions/insert_record.html" onMouseOver="funcPopup(event,'insert_record')">insert_record</a>('user_password_resets', <a class="var it4310" onMouseOver="hilite(4310)" onMouseOut="lolite()" onClick="logVariable('resetrecord')" href="../_variables/resetrecord.html">$resetrecord</a>);
<a name="l279"><span class="linenum"> 279</span></a>      return <a class="var it4310" onMouseOver="hilite(4310)" onMouseOut="lolite()" onClick="logVariable('resetrecord')" href="../_variables/resetrecord.html">$resetrecord</a>;
<a name="l280"><span class="linenum"> 280</span></a>  }
<a name="l281"><span class="linenum"> 281</span></a>  
<a name="l282"><span class="linenum"> 282</span></a>  <span class="comment">/**  Determine where a user should be redirected after they have been logged in.</span>
<a name="l283"><span class="linenum"> 283</span></a>  <span class="comment"> * @return string url the user should be redirected to.</span>
<a name="l284"><span class="linenum"> 284</span></a>  <span class="comment"> */</span>
<a name="l285"><span class="linenum"> 285</span></a>  function <a class="function" onClick="logFunction('core_login_get_return_url')" href="../_functions/core_login_get_return_url.html" onMouseOver="funcPopup(event,'core_login_get_return_url')">core_login_get_return_url</a>() {
<a name="l286"><span class="linenum"> 286</span></a>      global <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>, <a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>, <a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>;
<a name="l287"><span class="linenum"> 287</span></a>  <span class="comment">    // Prepare redirection.</span>
<a name="l288"><span class="linenum"> 288</span></a>      if (<a class="function" onClick="logFunction('user_not_fully_set_up')" href="../_functions/user_not_fully_set_up.html" onMouseOver="funcPopup(event,'user_not_fully_set_up')">user_not_fully_set_up</a>(<a class="var it354" onMouseOver="hilite(354)" onMouseOut="lolite()" onClick="logVariable('USER')" href="../_variables/USER.html">$USER</a>)) {
<a name="l289"><span class="linenum"> 289</span></a>          <a class="var it357" onMouseOver="hilite(357)" onMouseOut="lolite()" onClick="logVariable('urltogo')" href="../_variables/urltogo.html">$urltogo</a> = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>.'<a class="filename" href="../user/edit.php.html">/user/edit.php</a>';
<a name="l290"><span class="linenum"> 290</span></a>  <span class="comment">        // We don't delete $SESSION-&gt;wantsurl yet, so we get there later.</span>
<a name="l291"><span class="linenum"> 291</span></a>  
<a name="l292"><span class="linenum"> 292</span></a>      } else if (isset(<a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it42907" onMouseOver="hilite(42907)" onMouseOut="lolite()" href="../_variables/wantsurl.html">wantsurl</a>) and (<a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it42907" onMouseOver="hilite(42907)" onMouseOut="lolite()" href="../_variables/wantsurl.html">wantsurl</a>, <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>) === 0
<a name="l293"><span class="linenum"> 293</span></a>              or <a class="phpfunction" onClick="logFunction('strpos')" href="../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it42907" onMouseOver="hilite(42907)" onMouseOut="lolite()" href="../_variables/wantsurl.html">wantsurl</a>, <a class="phpfunction" onClick="logFunction('str_replace')" href="../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('http://', 'https://', <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>)) === 0)) {
<a name="l294"><span class="linenum"> 294</span></a>          <a class="var it357" onMouseOver="hilite(357)" onMouseOut="lolite()" onClick="logVariable('urltogo')" href="../_variables/urltogo.html">$urltogo</a> = <a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it42907" onMouseOver="hilite(42907)" onMouseOut="lolite()" href="../_variables/wantsurl.html">wantsurl</a>;    <span class="comment">// Because it's an address in this site.</span>
<a name="l295"><span class="linenum"> 295</span></a>          unset(<a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it42907" onMouseOver="hilite(42907)" onMouseOut="lolite()" href="../_variables/wantsurl.html">wantsurl</a>);
<a name="l296"><span class="linenum"> 296</span></a>      } else {
<a name="l297"><span class="linenum"> 297</span></a>  <span class="comment">        // No wantsurl stored or external - go to homepage.</span>
<a name="l298"><span class="linenum"> 298</span></a>          <a class="var it357" onMouseOver="hilite(357)" onMouseOut="lolite()" onClick="logVariable('urltogo')" href="../_variables/urltogo.html">$urltogo</a> = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>.'/';
<a name="l299"><span class="linenum"> 299</span></a>          unset(<a class="var it355" onMouseOver="hilite(355)" onMouseOut="lolite()" onClick="logVariable('SESSION')" href="../_variables/SESSION.html">$SESSION</a>-&gt;<a onClick="logVariable('wantsurl')" class="var it42907" onMouseOver="hilite(42907)" onMouseOut="lolite()" href="../_variables/wantsurl.html">wantsurl</a>);
<a name="l300"><span class="linenum"> 300</span></a>      }
<a name="l301"><span class="linenum"> 301</span></a>  
<a name="l302"><span class="linenum"> 302</span></a>  <span class="comment">    // If the url to go to is the same as the site page, check for default homepage.</span>
<a name="l303"><span class="linenum"> 303</span></a>      if (<a class="var it357" onMouseOver="hilite(357)" onMouseOut="lolite()" onClick="logVariable('urltogo')" href="../_variables/urltogo.html">$urltogo</a> == (<a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a> . '/')) {
<a name="l304"><span class="linenum"> 304</span></a>          <a class="var it4325" onMouseOver="hilite(4325)" onMouseOut="lolite()" onClick="logVariable('homepage')" href="../_variables/homepage.html">$homepage</a> = <a class="function" onClick="logFunction('get_home_page')" href="../_functions/get_home_page.html" onMouseOver="funcPopup(event,'get_home_page')">get_home_page</a>();
<a name="l305"><span class="linenum"> 305</span></a>  <span class="comment">        // Go to my-moodle page instead of site homepage if defaulthomepage set to homepage_my.</span>
<a name="l306"><span class="linenum"> 306</span></a>          if (<a class="var it4325" onMouseOver="hilite(4325)" onMouseOut="lolite()" onClick="logVariable('homepage')" href="../_variables/homepage.html">$homepage</a> == <a class="constant" onClick="logConstant('HOMEPAGE_MY')" href="../_constants/HOMEPAGE_MY.html" onMouseOver="constPopup(event,'HOMEPAGE_MY')">HOMEPAGE_MY</a> &amp;&amp; !<a class="function" onClick="logFunction('is_siteadmin')" href="../_functions/is_siteadmin.html" onMouseOver="funcPopup(event,'is_siteadmin')">is_siteadmin</a>() &amp;&amp; !<a class="function" onClick="logFunction('isguestuser')" href="../_functions/isguestuser.html" onMouseOver="funcPopup(event,'isguestuser')">isguestuser</a>()) {
<a name="l307"><span class="linenum"> 307</span></a>              if (<a class="var it357" onMouseOver="hilite(357)" onMouseOut="lolite()" onClick="logVariable('urltogo')" href="../_variables/urltogo.html">$urltogo</a> == <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a> or <a class="var it357" onMouseOver="hilite(357)" onMouseOut="lolite()" onClick="logVariable('urltogo')" href="../_variables/urltogo.html">$urltogo</a> == <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>.'/' or <a class="var it357" onMouseOver="hilite(357)" onMouseOut="lolite()" onClick="logVariable('urltogo')" href="../_variables/urltogo.html">$urltogo</a> == <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>.'<a class="filename" href="../index.php.html">/index.php</a>') {
<a name="l308"><span class="linenum"> 308</span></a>                  <a class="var it357" onMouseOver="hilite(357)" onMouseOut="lolite()" onClick="logVariable('urltogo')" href="../_variables/urltogo.html">$urltogo</a> = <a class="var it31" onMouseOver="hilite(31)" onMouseOut="lolite()" onClick="logVariable('CFG')" href="../_variables/CFG.html">$CFG</a>-&gt;<a onClick="logVariable('wwwroot')" class="var it42902" onMouseOver="hilite(42902)" onMouseOut="lolite()" href="../_variables/wwwroot.html">wwwroot</a>.'/my/';
<a name="l309"><span class="linenum"> 309</span></a>              }
<a name="l310"><span class="linenum"> 310</span></a>          }
<a name="l311"><span class="linenum"> 311</span></a>      }
<a name="l312"><span class="linenum"> 312</span></a>      return <a class="var it357" onMouseOver="hilite(357)" onMouseOut="lolite()" onClick="logVariable('urltogo')" href="../_variables/urltogo.html">$urltogo</a>;
<a name="l313"><span class="linenum"> 313</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'redirect': ['redirect', '', [['enrol/lti/ims-blti','blti.php',230],['lib','weblib.php',2659]], 999],
'print_error': ['print_error', 'Abort execution by throwing of a general exception, default exception handler displays the error message in most cases. ', [['lib','setuplib.php',481]], 1488],
'get_home_page': ['get_home_page', 'Gets the homepage to use for the current user ', [['lib','moodlelib.php',9514]], 7],
'notice': ['notice', 'Print a message and exit. ', [['lib','weblib.php',2626],['lib/mustache/src/Mustache/Logger','AbstractLogger.php',87],['lib/google/src/Google/Logger','Abstract.php',226],['lib/mustache/src/Mustache','Logger.php',92]], 70],
'get_record_select': ['get_record_select', 'Get a single database record as an object which match a particular WHERE clause. ', [['lib/dml','moodle_database.php',1481]], 19],
'send_password_change_info': ['send_password_change_info', 'Sends an email containinginformation on how to change your password. ', [['lib','moodlelib.php',6042]], 1],
'user_add_password_history': ['user_add_password_history', 'Add password to the list of used hashes for this user. ', [['user','lib.php',942]], 28],
'update_record': ['update_record', 'Update a record in a table ', [['lib/dml','pdo_moodle_database.php',461],['lib/dml','oci_native_moodle_database.php',1404],['lib/dml','pgsql_native_moodle_database.php',1089],['lib/dml','mssql_native_moodle_database.php',1067],['lib/dml','mysqli_native_moodle_database.php',1405],['lib/dml','sqlsrv_native_moodle_database.php',1148],['lib/dml/tests','dml_test.php',5551]], 650],
'can_reset_password': ['can_reset_password', 'Returns true if plugin allows resetting of internal password. ', [['auth/email','auth.php',203],['auth/webservice','auth.php',131],['auth/manual','auth.php',142],['auth/none','auth.php',119],['auth/ldap','auth.php',490],['lib','authlib.php',288],['auth/nologin','auth.php',91],['auth/db','auth.php',740]], 3],
'isguestuser': ['isguestuser', 'Determines if a user is logged in as real guest user with username \'guest\'. ', [['lib','accesslib.php',1923]], 260],
'delete_records': ['delete_records', 'Delete the records from a table where all the given conditions met. If conditions not specified, table is truncated. ', [['lib/dml','sqlite3_pdo_moodle_database.php',345],['lib/dml','moodle_database.php',1864]], 773],
'footer': ['footer', 'This method is used to render the page footer. It is automatically called by AddPage() and could be overwritten in your own inherited class. ', [['lib/tcpdf','tcpdf.php',3464],['lib','outputrenderers.php',1034],['lib','outputrenderers.php',4427],['lib','outputrenderers.php',4546],['mod/lesson','renderer.php',78]], 810],
'core_login_process_password_reset_request': ['core_login_process_password_reset_request', 'Processes a user\'s request to set a new password in the event they forgot the old one. If no user identifier has been supplied, it displays a form where they can submit their identifier. Where they have supplied identifier, the function will check their status, and send email as appropriate. ', [['login','lib.php',32]], 1],
'core_login_process_password_set': ['core_login_process_password_set', 'This function processes a user\'s submitted token to validate the request to set a new password. If the user\'s token is validated, they are prompted to set a new password. ', [['login','lib.php',172]], 1],
'complete_user_login': ['complete_user_login', 'Call to complete the user login process after authenticate_user_login() has succeeded. It will setup the $USER variable and other required bits and pieces. ', [['lib','moodlelib.php',4292]], 11],
'get_auth_plugin': ['get_auth_plugin', 'Returns an authentication plugin instance. ', [['lib','moodlelib.php',3608]], 81],
'send_password_change_confirmation_email': ['send_password_change_confirmation_email', 'Sends a password change confirmation email. ', [['lib','moodlelib.php',6011]], 1],
'set_data': ['set_data', '', [['mod/scorm','mod_form.php',456],['mod/feedback/item/multichoicerated','multichoicerated_form.php',84],['backup/util/structure','restore_path_element.class.php',95],['course','moodleform_mod.php',458],['blocks/html','edit_form.php',53],['question/type','edit_question_form.php',450],['question/type/random','edit_random_form.php',68],['lib','formslib.php',456],['question/type/missingtype','edit_missingtype_form.php',52],['badges','edit_form.php',137],['blocks','edit_form.php',255],['course','editsection_form.php',88],['admin/tool/filetypes','edit_form.php',83],['question','category_form.php',73],['lib/classes/message/inbound','address_manager.php',146],['question/type/multianswer','edit_multianswer_form.php',262],['cache','forms.php',242],['question/type/calculated','datasetitems_form.php',360],['mod/feedback/item/multichoice','multichoice_form.php',79]], 235],
'get_data': ['get_data', '', [['mod/scorm','mod_form.php',526],['mod/feedback/item/multichoicerated','multichoicerated_form.php',96],['backup/util/structure','restore_path_element.class.php',118],['admin/tool/uploaduser','user_form.php',399],['mod/feedback/item/textfield','textfield_form.php',58],['admin/tool/lp/classes/form','persistent.php',202],['grade/export','grade_export_form.php',206],['mod/feedback','mod_form.php',163],['message/tests','inbound_test.php',632],['mod/feedback/item/textarea','textarea_form.php',57],['mod/survey','mod_form.php',49],['lib/simplepie/library/SimplePie','Parser.php',263],['lib','formslib.php',606],['mod/feedback/item/numeric','numeric_form.php',60],['admin/tool/uploadcourse/classes','course.php',269],['mod/feedback/item','feedback_item_class.php',52],['mod/feedback/item','feedback_item_class.php',264],['admin/webservice','forms.php',299],['grade/grading/form','lib.php',841],['blocks/rss_client','editfeed.php',101],['mod/lesson','mod_form.php',417],['grade/grading/form/guide','edit_form.php',142],['course','editsection_form.php',105],['lib/classes/event','base.php',647],['grade/grading/form/rubric','edit_form.php',136],['mod/feedback/item','feedback_item_form_class.php',112],['admin/tool/filetypes','edit_form.php',97],['mod/forum','mod_form.php',270],['mod/scorm/report/graphs/classes','report.php',49],['lib/classes/message/inbound','address_manager.php',361],['mod/workshop','locallib.php',3990],['mod/glossary','mod_form.php',203],['mod/feedback/item/captcha','lib.php',67],['lib','completionlib.php',869],['mod/feedback/item/multichoice','multichoice_form.php',93],['mod/choice','mod_form.php',121]], 388],
'user_not_fully_set_up': ['user_not_fully_set_up', 'Determines if a user has completed setting up their account. ', [['lib','moodlelib.php',3135]], 8],
'has_capability': ['has_capability', 'Wrapper round the has_capability funciton that automatically passes in the quiz context. ', [['mod/quiz','attemptlib.php',299],['mod/quiz','attemptlib.php',922],['lib','accesslib.php',344]], 2064],
'apply_concurrent_login_limit': ['apply_concurrent_login_limit', 'Terminate other sessions of current user depending on $CFG->limitconcurrentlogins restriction. ', [['lib/classes/session','manager.php',650]], 21],
'core_login_generate_password_reset': ['core_login_generate_password_reset', '', [['login','lib.php',272]], 2],
'login_unlock_account': ['login_unlock_account', 'Unlock user account and reset timers. ', [['lib','authlib.php',787]], 8],
'display': ['display', 'Displays the form ', [['backup/util/ui','base_moodleform.class.php',365],['mod/feedback/classes','complete_form.php',536],['lib/minify/lib/Minify/Cache','APC.php',79],['mod/lesson/pagetypes','numerical.php',50],['mod/scorm/report/interactions/classes','report.php',31],['mod/scorm/report/basic/classes','report.php',30],['backup/util/ui','restore_ui.class.php',375],['mod/scorm/report/objectives/classes','report.php',37],['mod/lesson/pagetypes','endofcluster.php',39],['mod/lesson/pagetypes','matching.php',50],['mod/feedback/classes','responses_table.php',344],['user/selector','lib.php',205],['lib/minify/lib/Minify/Cache','File.php',72],['lib','formslib.php',935],['backup/util/ui','base_ui.class.php',169],['mod/lesson/pagetypes','multichoice.php',87],['question/classes/bank','column_base.php',164],['cohort','upload_form.php',316],['mod/quiz/report/statistics','report.php',51],['admin/roles/classes','capability_table_with_risks.php',131],['mod/lesson/pagetypes','truefalse.php',50],['admin/roles/classes','capability_table_base.php',71],['mod/quiz/report/overview','report.php',42],['mod/feedback/classes','templates_table.php',62],['lib/minify/lib/Minify/Cache','ZendPlatform.php',84],['mod/lesson/pagetypes','endofbranch.php',39],['mod/scorm/classes','report.php',39],['backup/util/ui','import_extensions.php',154],['question/classes/bank','view.php',451],['backup/util/ui','backup_ui_stage.class.php',545],['backup/util/ui','backup_ui_stage.class.php',588],['mod/quiz/report/grading','report.php',51],['mod/lesson/pagetypes','shortanswer.php',50],['lib/pear/HTML','Common.php',438],['mod/lesson/pagetypes','essay.php',67],['lib/minify/lib/Minify/Cache','Memcache.php',85],['backup/util/ui','base_ui_stage.class.php',126],['mod/scorm/report/graphs/classes','report.php',127],['mod/lesson/pagetypes','branchtable.php',105],['repository/flickr_public','image.php',149],['admin/roles/classes','define_role_table_advanced.php',612],['mod/quiz/report/responses','report.php',51],['mod/lesson/pagetypes','cluster.php',39],['lib/minify/lib/Minify/Cache','WinCache.php',79],['lib/minify/lib/Minify/Cache','XCache.php',74],['course/format/singleactivity','renderer.php',36],['backup/util/ui','restore_ui_stage.class.php',355],['backup/util/ui','restore_ui_stage.class.php',497],['backup/util/ui','restore_ui_stage.class.php',1025],['backup/util/ui','restore_ui_stage.class.php',1112]], 320],
'is_siteadmin': ['is_siteadmin', 'Check if the user is an admin at the site level. ', [['lib','accesslib.php',602]], 95],
'random_string': ['random_string', 'Generate and return a random string of the specified length. ', [['lib','moodlelib.php',7736]], 42],
'is_enabled_auth': ['is_enabled_auth', 'Checks if a given plugin is in the list of enabled authentication plugins. ', [['lib','moodlelib.php',3592]], 38],
'get_record': ['get_record', 'Load a single record. ', [['competency/classes','persistent.php',738],['lib/dml','moodle_database.php',1462]], 3224],
'verify_https_required': ['verify_https_required', 'Makes sure that page previously marked with https_required() is really using https://, if not it redirects to https:// ', [['lib','pagelib.php',1430]], 9],
'get_string': ['get_string', 'Get String returns a requested string ', [['lib/classes','string_manager_install.php',95],['lib','moodlelib.php',6735],['lib','moodlelib.php',9695],['lib/external','externallib.php',102],['question/behaviour','behaviourbase.php',770],['lib/classes','string_manager_standard.php',280],['lib/classes','string_manager.php',38]], 20134],
'get_record_sql': ['get_record_sql', 'Get a single database record as an object using a SQL statement. ', [['lib/dml','oci_native_moodle_database.php',1076],['lib/dml','moodle_database.php',1506]], 157],
'kill_user_sessions': ['kill_user_sessions', 'Terminate all sessions of given user unconditionally. ', [['lib/classes/session','manager.php',633]], 13],
'is_cancelled': ['is_cancelled', 'Returns true if the form was cancelled, false otherwise ', [['backup/util/ui','base_moodleform.class.php',330],['lib','formslib.php',589],['mod/feedback/item','feedback_item_class.php',43],['mod/feedback/item','feedback_item_class.php',258],['mod/feedback/item/captcha','lib.php',63]], 156],
'user_update_password': ['user_update_password', 'Updates the user\'s password. ', [['auth/email','auth.php',68],['auth/webservice','auth.php',82],['auth/manual','auth.php',91],['auth/none','auth.php',68],['auth/ldap','auth.php',1316],['lib','authlib.php',243],['auth/nologin','auth.php',60],['auth/db','auth.php',243]], 14],
'insert_record': ['insert_record', 'Insert a record into a table and return the "id" field if required, Some conversions and safety checks are carried out. Lobs are supported. If the return ID isn\'t required, then this just reports success as true/false. $data is an object containing needed data ', [['lib/dml','pdo_moodle_database.php',387],['lib/dml','oci_native_moodle_database.php',1297],['lib/dml','pgsql_native_moodle_database.php',889],['lib/dml','mssql_native_moodle_database.php',962],['lib/dml','mysqli_native_moodle_database.php',1185],['question/engine/upgrade','upgradelib.php',124],['lib/dml','sqlsrv_native_moodle_database.php',1045],['lib/dml/tests','dml_test.php',5548]], 1611],
'box': ['box', 'Outputs a box. ', [['lib','outputrenderers.php',3089]], 288],
'get_login_url': ['get_login_url', 'Returns full login url. ', [['lib','moodlelib.php',2432],['lib','oauthlib.php',466]], 48],
'unset_user_preference': ['unset_user_preference', 'Unsets a preference completely by deleting it from the database ', [['lib','moodlelib.php',1924]], 35],
'or': ['or', '', [['lib/tcpdf','LICENSE.TXT',69]], 556],
'sql_like': ['sql_like', 'Returns \'LIKE\' part of a query. ', [['lib/dml','oci_native_moodle_database.php',1575],['lib/dml','pgsql_native_moodle_database.php',1188],['lib/dml','mssql_native_moodle_database.php',1224],['lib/dml','mysqli_native_moodle_database.php',1514],['lib/dml','moodle_database.php',2053],['lib/dml','sqlsrv_native_moodle_database.php',1291]], 159],
'sql_like_escape': ['sql_like_escape', 'Escape sql LIKE special characters like \'_\' or \'%\'. ', [['lib/dml','moodle_database.php',2073]], 26],
'core_login_get_return_url': ['core_login_get_return_url', '', [['login','lib.php',285]], 3],
'instance': ['instance', 'Returns an instance of the cache_factor method. ', [['cache','disabledlib.php',171],['cache','disabledlib.php',296],['lib/classes','useragent.php',101],['lib/htmlpurifier/HTMLPurifier','ConfigSchema.php',80],['lib/htmlpurifier/HTMLPurifier','URISchemeRegistry.php',9],['search/classes','manager.php',109],['cache','locallib.php',52],['lib/htmlpurifier/HTMLPurifier','LanguageFactory.php',53],['lib/classes','plugin_manager.php',103],['lib/htmlpurifier','HTMLPurifier.php',251],['course/format','lib.php',156],['lib/classes/update','checker.php',62],['lib/htmlpurifier/HTMLPurifier','DefinitionCacheFactory.php',31],['admin/tool/installaddon/classes','installer.php',40],['lib','modinfolib.php',373],['cache/classes','helper.php',76],['lib/tests','string_manager_standard_test.php',124],['lib/portfolio','exporter.php',251],['lib/classes/update','validator.php',88],['search/classes','document_factory.php',49],['lib','accesslib.php',6235],['lib','accesslib.php',6487],['lib','accesslib.php',6665],['lib','accesslib.php',6919],['lib','accesslib.php',7180],['lib','accesslib.php',7392],['backup/cc/cc_lib','cc_utils.php',387],['backup/cc/cc_lib','cc_utils.php',443],['lib','filterlib.php',80],['search/tests/fixtures','testable_core_search.php',43],['lib/tests/fixtures','testable_update_checker.php',45],['backup/cc','validator.php',35],['cache/classes','config.php',87],['cache/classes','factory.php',114],['lib/htmlpurifier/HTMLPurifier','EntityLookup.php',29]], 4647],
'strtolower': ['strtolower', '', [], 817],
'strpos': ['strpos', '', [], 1604],
'define': ['define', '', [], 2373],
'time': ['time', '', [], 1959],
'session_id': ['session_id', '', [], 37],
'str_replace': ['str_replace', '', [], 1648],
'header': ['header', '', [], 1355],
'preg_replace': ['preg_replace', '', [], 917],
'floor': ['floor', '', [], 514]};
CLASS_DATA={
'core_text': ['core_text', 'defines string api\'s for manipulating strings ', [['lib/classes','text.php',27]], 566],
'manager': ['manager', 'Search subsystem manager. ', [['search/classes','manager.php',31],['user/classes/output/myprofile','manager.php',28],['lib/classes/antivirus','manager.php',29],['lib/classes/event','manager.php',30],['lib/classes/task','manager.php',28],['admin/tool/messageinbound/classes','manager.php',29],['lib/classes/message/inbound','manager.php',29],['admin/tool/log/classes/log','manager.php',29],['lib/classes/log','manager.php',29],['lib/classes/session','manager.php',29],['lib/classes/message','manager.php',31]], 585],
'login_set_password_form': ['login_set_password_form', 'Set forgotten password form definition. ', [['login','set_password_form.php',31]], 1],
'context_system': ['context_system', 'System context class ', [['lib','accesslib.php',6157]], 1147],
'login_forgot_password_form': ['login_forgot_password_form', 'Reset forgotten password form definition. ', [['login','forgot_password_form.php',29],['login','restored_password_form.php',42]], 2]};
CONST_DATA={
'IGNORE_MULTIPLE': ['IGNORE_MULTIPLE', '', [['lib','dmllib.php',50]], 43],
'PWRESET_STATUS_TOKENSENT': ['PWRESET_STATUS_TOKENSENT', '', [['login','lib.php',28]], 2],
'HOMEPAGE_MY': ['HOMEPAGE_MY', '', [['lib','moodlelib.php',482]], 15],
'PWRESET_STATUS_ALREADYSENT': ['PWRESET_STATUS_ALREADYSENT', '', [['login','lib.php',30]], 3],
'PWRESET_STATUS_OTHEREMAILSENT': ['PWRESET_STATUS_OTHEREMAILSENT', '', [['login','lib.php',29]], 2],
'PWRESET_STATUS_NOEMAILSENT': ['PWRESET_STATUS_NOEMAILSENT', '', [['login','lib.php',27]], 3],
'DAYSECS': ['DAYSECS', '', [['lib','moodlelib.php',49]], 122],
'MINSECS': ['MINSECS', '', [['lib','moodlelib.php',59]], 12]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Thu Aug 11 10:00:09 2016</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
